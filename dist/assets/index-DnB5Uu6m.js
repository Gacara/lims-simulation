(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function jS(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var FC={exports:{}},Gv={},zC={exports:{}},Zt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pd=Symbol.for("react.element"),WN=Symbol.for("react.portal"),jN=Symbol.for("react.fragment"),XN=Symbol.for("react.strict_mode"),qN=Symbol.for("react.profiler"),YN=Symbol.for("react.provider"),$N=Symbol.for("react.context"),KN=Symbol.for("react.forward_ref"),ZN=Symbol.for("react.suspense"),JN=Symbol.for("react.memo"),QN=Symbol.for("react.lazy"),CE=Symbol.iterator;function eD(n){return n===null||typeof n!="object"?null:(n=CE&&n[CE]||n["@@iterator"],typeof n=="function"?n:null)}var BC={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},HC=Object.assign,VC={};function oh(n,e,t){this.props=n,this.context=e,this.refs=VC,this.updater=t||BC}oh.prototype.isReactComponent={};oh.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};oh.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function GC(){}GC.prototype=oh.prototype;function XS(n,e,t){this.props=n,this.context=e,this.refs=VC,this.updater=t||BC}var qS=XS.prototype=new GC;qS.constructor=XS;HC(qS,oh.prototype);qS.isPureReactComponent=!0;var IE=Array.isArray,WC=Object.prototype.hasOwnProperty,YS={current:null},jC={key:!0,ref:!0,__self:!0,__source:!0};function XC(n,e,t){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)WC.call(e,i)&&!jC.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){for(var c=Array(a),h=0;h<a;h++)c[h]=arguments[h+2];r.children=c}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:Pd,type:n,key:s,ref:o,props:r,_owner:YS.current}}function tD(n,e){return{$$typeof:Pd,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function $S(n){return typeof n=="object"&&n!==null&&n.$$typeof===Pd}function nD(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var RE=/\/+/g;function zy(n,e){return typeof n=="object"&&n!==null&&n.key!=null?nD(""+n.key):e.toString(36)}function og(n,e,t,i,r){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case Pd:case WN:o=!0}}if(o)return o=n,r=r(o),n=i===""?"."+zy(o,0):i,IE(r)?(t="",n!=null&&(t=n.replace(RE,"$&/")+"/"),og(r,e,t,"",function(h){return h})):r!=null&&($S(r)&&(r=tD(r,t+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(RE,"$&/")+"/")+n)),e.push(r)),1;if(o=0,i=i===""?".":i+":",IE(n))for(var a=0;a<n.length;a++){s=n[a];var c=i+zy(s,a);o+=og(s,e,t,c,r)}else if(c=eD(n),typeof c=="function")for(n=c.call(n),a=0;!(s=n.next()).done;)s=s.value,c=i+zy(s,a++),o+=og(s,e,t,c,r);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Gp(n,e,t){if(n==null)return n;var i=[],r=0;return og(n,i,"","",function(s){return e.call(t,s,r++)}),i}function iD(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var sr={current:null},ag={transition:null},rD={ReactCurrentDispatcher:sr,ReactCurrentBatchConfig:ag,ReactCurrentOwner:YS};function qC(){throw Error("act(...) is not supported in production builds of React.")}Zt.Children={map:Gp,forEach:function(n,e,t){Gp(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Gp(n,function(){e++}),e},toArray:function(n){return Gp(n,function(e){return e})||[]},only:function(n){if(!$S(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Zt.Component=oh;Zt.Fragment=jN;Zt.Profiler=qN;Zt.PureComponent=XS;Zt.StrictMode=XN;Zt.Suspense=ZN;Zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rD;Zt.act=qC;Zt.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=HC({},n.props),r=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=YS.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(c in e)WC.call(e,c)&&!jC.hasOwnProperty(c)&&(i[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)i.children=t;else if(1<c){a=Array(c);for(var h=0;h<c;h++)a[h]=arguments[h+2];i.children=a}return{$$typeof:Pd,type:n.type,key:r,ref:s,props:i,_owner:o}};Zt.createContext=function(n){return n={$$typeof:$N,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:YN,_context:n},n.Consumer=n};Zt.createElement=XC;Zt.createFactory=function(n){var e=XC.bind(null,n);return e.type=n,e};Zt.createRef=function(){return{current:null}};Zt.forwardRef=function(n){return{$$typeof:KN,render:n}};Zt.isValidElement=$S;Zt.lazy=function(n){return{$$typeof:QN,_payload:{_status:-1,_result:n},_init:iD}};Zt.memo=function(n,e){return{$$typeof:JN,type:n,compare:e===void 0?null:e}};Zt.startTransition=function(n){var e=ag.transition;ag.transition={};try{n()}finally{ag.transition=e}};Zt.unstable_act=qC;Zt.useCallback=function(n,e){return sr.current.useCallback(n,e)};Zt.useContext=function(n){return sr.current.useContext(n)};Zt.useDebugValue=function(){};Zt.useDeferredValue=function(n){return sr.current.useDeferredValue(n)};Zt.useEffect=function(n,e){return sr.current.useEffect(n,e)};Zt.useId=function(){return sr.current.useId()};Zt.useImperativeHandle=function(n,e,t){return sr.current.useImperativeHandle(n,e,t)};Zt.useInsertionEffect=function(n,e){return sr.current.useInsertionEffect(n,e)};Zt.useLayoutEffect=function(n,e){return sr.current.useLayoutEffect(n,e)};Zt.useMemo=function(n,e){return sr.current.useMemo(n,e)};Zt.useReducer=function(n,e,t){return sr.current.useReducer(n,e,t)};Zt.useRef=function(n){return sr.current.useRef(n)};Zt.useState=function(n){return sr.current.useState(n)};Zt.useSyncExternalStore=function(n,e,t){return sr.current.useSyncExternalStore(n,e,t)};Zt.useTransition=function(){return sr.current.useTransition()};Zt.version="18.3.1";zC.exports=Zt;var be=zC.exports;const sD=jS(be);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oD=be,aD=Symbol.for("react.element"),lD=Symbol.for("react.fragment"),cD=Object.prototype.hasOwnProperty,uD=oD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hD={key:!0,ref:!0,__self:!0,__source:!0};function YC(n,e,t){var i,r={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)cD.call(e,i)&&!hD.hasOwnProperty(i)&&(r[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:aD,type:n,key:s,ref:o,props:r,_owner:uD.current}}Gv.Fragment=lD;Gv.jsx=YC;Gv.jsxs=YC;FC.exports=Gv;var K=FC.exports,$C={exports:{}},qr={},KC={exports:{}},ZC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(q,le){var ie=q.length;q.push(le);e:for(;0<ie;){var ye=ie-1>>>1,Ae=q[ye];if(0<r(Ae,le))q[ye]=le,q[ie]=Ae,ie=ye;else break e}}function t(q){return q.length===0?null:q[0]}function i(q){if(q.length===0)return null;var le=q[0],ie=q.pop();if(ie!==le){q[0]=ie;e:for(var ye=0,Ae=q.length,ze=Ae>>>1;ye<ze;){var pe=2*(ye+1)-1,De=q[pe],Oe=pe+1,He=q[Oe];if(0>r(De,ie))Oe<Ae&&0>r(He,De)?(q[ye]=He,q[Oe]=ie,ye=Oe):(q[ye]=De,q[pe]=ie,ye=pe);else if(Oe<Ae&&0>r(He,ie))q[ye]=He,q[Oe]=ie,ye=Oe;else break e}}return le}function r(q,le){var ie=q.sortIndex-le.sortIndex;return ie!==0?ie:q.id-le.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var c=[],h=[],f=1,d=null,m=3,v=!1,_=!1,E=!1,S=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(q){for(var le=t(h);le!==null;){if(le.callback===null)i(h);else if(le.startTime<=q)i(h),le.sortIndex=le.expirationTime,e(c,le);else break;le=t(h)}}function R(q){if(E=!1,M(q),!_)if(t(c)!==null)_=!0,oe(z);else{var le=t(h);le!==null&&Se(R,le.startTime-q)}}function z(q,le){_=!1,E&&(E=!1,y(b),b=-1),v=!0;var ie=m;try{for(M(le),d=t(c);d!==null&&(!(d.expirationTime>le)||q&&!L());){var ye=d.callback;if(typeof ye=="function"){d.callback=null,m=d.priorityLevel;var Ae=ye(d.expirationTime<=le);le=n.unstable_now(),typeof Ae=="function"?d.callback=Ae:d===t(c)&&i(c),M(le)}else i(c);d=t(c)}if(d!==null)var ze=!0;else{var pe=t(h);pe!==null&&Se(R,pe.startTime-le),ze=!1}return ze}finally{d=null,m=ie,v=!1}}var k=!1,P=null,b=-1,A=5,T=-1;function L(){return!(n.unstable_now()-T<A)}function H(){if(P!==null){var q=n.unstable_now();T=q;var le=!0;try{le=P(!0,q)}finally{le?U():(k=!1,P=null)}}else k=!1}var U;if(typeof w=="function")U=function(){w(H)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,fe=se.port2;se.port1.onmessage=H,U=function(){fe.postMessage(null)}}else U=function(){S(H,0)};function oe(q){P=q,k||(k=!0,U())}function Se(q,le){b=S(function(){q(n.unstable_now())},le)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(q){q.callback=null},n.unstable_continueExecution=function(){_||v||(_=!0,oe(z))},n.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<q?Math.floor(1e3/q):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(q){switch(m){case 1:case 2:case 3:var le=3;break;default:le=m}var ie=m;m=le;try{return q()}finally{m=ie}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(q,le){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ie=m;m=q;try{return le()}finally{m=ie}},n.unstable_scheduleCallback=function(q,le,ie){var ye=n.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?ye+ie:ye):ie=ye,q){case 1:var Ae=-1;break;case 2:Ae=250;break;case 5:Ae=1073741823;break;case 4:Ae=1e4;break;default:Ae=5e3}return Ae=ie+Ae,q={id:f++,callback:le,priorityLevel:q,startTime:ie,expirationTime:Ae,sortIndex:-1},ie>ye?(q.sortIndex=ie,e(h,q),t(c)===null&&q===t(h)&&(E?(y(b),b=-1):E=!0,Se(R,ie-ye))):(q.sortIndex=Ae,e(c,q),_||v||(_=!0,oe(z))),q},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(q){var le=m;return function(){var ie=m;m=le;try{return q.apply(this,arguments)}finally{m=ie}}}})(ZC);KC.exports=ZC;var fD=KC.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dD=be,Wr=fD;function Xe(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var JC=new Set,Vf={};function fc(n,e){Vu(n,e),Vu(n+"Capture",e)}function Vu(n,e){for(Vf[n]=e,n=0;n<e.length;n++)JC.add(e[n])}var Ho=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xx=Object.prototype.hasOwnProperty,pD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,PE={},LE={};function mD(n){return xx.call(LE,n)?!0:xx.call(PE,n)?!1:pD.test(n)?LE[n]=!0:(PE[n]=!0,!1)}function gD(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function vD(n,e,t,i){if(e===null||typeof e>"u"||gD(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function or(n,e,t,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ci={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Ci[n]=new or(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Ci[e]=new or(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Ci[n]=new or(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Ci[n]=new or(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Ci[n]=new or(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Ci[n]=new or(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Ci[n]=new or(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Ci[n]=new or(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Ci[n]=new or(n,5,!1,n.toLowerCase(),null,!1,!1)});var KS=/[\-:]([a-z])/g;function ZS(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(KS,ZS);Ci[e]=new or(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(KS,ZS);Ci[e]=new or(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(KS,ZS);Ci[e]=new or(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Ci[n]=new or(n,1,!1,n.toLowerCase(),null,!1,!1)});Ci.xlinkHref=new or("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Ci[n]=new or(n,1,!1,n.toLowerCase(),null,!0,!0)});function JS(n,e,t,i){var r=Ci.hasOwnProperty(e)?Ci[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(vD(e,t,r,i)&&(t=null),i||r===null?mD(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,i=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var $o=dD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Wp=Symbol.for("react.element"),uu=Symbol.for("react.portal"),hu=Symbol.for("react.fragment"),QS=Symbol.for("react.strict_mode"),Sx=Symbol.for("react.profiler"),QC=Symbol.for("react.provider"),eI=Symbol.for("react.context"),ew=Symbol.for("react.forward_ref"),wx=Symbol.for("react.suspense"),Mx=Symbol.for("react.suspense_list"),tw=Symbol.for("react.memo"),ga=Symbol.for("react.lazy"),tI=Symbol.for("react.offscreen"),NE=Symbol.iterator;function zh(n){return n===null||typeof n!="object"?null:(n=NE&&n[NE]||n["@@iterator"],typeof n=="function"?n:null)}var Vn=Object.assign,By;function hf(n){if(By===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);By=e&&e[1]||""}return`
`+By+n}var Hy=!1;function Vy(n,e){if(!n||Hy)return"";Hy=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(h){var i=h}Reflect.construct(n,[],e)}else{try{e.call()}catch(h){i=h}n.call(e.prototype)}else{try{throw Error()}catch(h){i=h}n()}}catch(h){if(h&&i&&typeof h.stack=="string"){for(var r=h.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var c=`
`+r[o].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=o&&0<=a);break}}}finally{Hy=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?hf(n):""}function yD(n){switch(n.tag){case 5:return hf(n.type);case 16:return hf("Lazy");case 13:return hf("Suspense");case 19:return hf("SuspenseList");case 0:case 2:case 15:return n=Vy(n.type,!1),n;case 11:return n=Vy(n.type.render,!1),n;case 1:return n=Vy(n.type,!0),n;default:return""}}function Ex(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case hu:return"Fragment";case uu:return"Portal";case Sx:return"Profiler";case QS:return"StrictMode";case wx:return"Suspense";case Mx:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case eI:return(n.displayName||"Context")+".Consumer";case QC:return(n._context.displayName||"Context")+".Provider";case ew:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case tw:return e=n.displayName||null,e!==null?e:Ex(n.type)||"Memo";case ga:e=n._payload,n=n._init;try{return Ex(n(e))}catch{}}return null}function _D(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ex(e);case 8:return e===QS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ba(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function nI(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function xD(n){var e=nI(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function jp(n){n._valueTracker||(n._valueTracker=xD(n))}function iI(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=nI(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function bg(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Tx(n,e){var t=e.checked;return Vn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function DE(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=Ba(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function rI(n,e){e=e.checked,e!=null&&JS(n,"checked",e,!1)}function Ax(n,e){rI(n,e);var t=Ba(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?bx(n,e.type,t):e.hasOwnProperty("defaultValue")&&bx(n,e.type,Ba(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function kE(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function bx(n,e,t){(e!=="number"||bg(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var ff=Array.isArray;function Iu(n,e,t,i){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&i&&(n[t].defaultSelected=!0)}else{for(t=""+Ba(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,i&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function Cx(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Xe(91));return Vn({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function OE(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(Xe(92));if(ff(t)){if(1<t.length)throw Error(Xe(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Ba(t)}}function sI(n,e){var t=Ba(e.value),i=Ba(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function UE(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function oI(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ix(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?oI(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Xp,aI=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Xp=Xp||document.createElement("div"),Xp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Xp.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Gf(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var vf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},SD=["Webkit","ms","Moz","O"];Object.keys(vf).forEach(function(n){SD.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),vf[e]=vf[n]})});function lI(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||vf.hasOwnProperty(n)&&vf[n]?(""+e).trim():e+"px"}function cI(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,r=lI(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,r):n[t]=r}}var wD=Vn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Rx(n,e){if(e){if(wD[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Xe(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Xe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Xe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Xe(62))}}function Px(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lx=null;function nw(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Nx=null,Ru=null,Pu=null;function FE(n){if(n=Dd(n)){if(typeof Nx!="function")throw Error(Xe(280));var e=n.stateNode;e&&(e=Yv(e),Nx(n.stateNode,n.type,e))}}function uI(n){Ru?Pu?Pu.push(n):Pu=[n]:Ru=n}function hI(){if(Ru){var n=Ru,e=Pu;if(Pu=Ru=null,FE(n),e)for(n=0;n<e.length;n++)FE(e[n])}}function fI(n,e){return n(e)}function dI(){}var Gy=!1;function pI(n,e,t){if(Gy)return n(e,t);Gy=!0;try{return fI(n,e,t)}finally{Gy=!1,(Ru!==null||Pu!==null)&&(dI(),hI())}}function Wf(n,e){var t=n.stateNode;if(t===null)return null;var i=Yv(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(Xe(231,e,typeof t));return t}var Dx=!1;if(Ho)try{var Bh={};Object.defineProperty(Bh,"passive",{get:function(){Dx=!0}}),window.addEventListener("test",Bh,Bh),window.removeEventListener("test",Bh,Bh)}catch{Dx=!1}function MD(n,e,t,i,r,s,o,a,c){var h=Array.prototype.slice.call(arguments,3);try{e.apply(t,h)}catch(f){this.onError(f)}}var yf=!1,Cg=null,Ig=!1,kx=null,ED={onError:function(n){yf=!0,Cg=n}};function TD(n,e,t,i,r,s,o,a,c){yf=!1,Cg=null,MD.apply(ED,arguments)}function AD(n,e,t,i,r,s,o,a,c){if(TD.apply(this,arguments),yf){if(yf){var h=Cg;yf=!1,Cg=null}else throw Error(Xe(198));Ig||(Ig=!0,kx=h)}}function dc(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function mI(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function zE(n){if(dc(n)!==n)throw Error(Xe(188))}function bD(n){var e=n.alternate;if(!e){if(e=dc(n),e===null)throw Error(Xe(188));return e!==n?null:n}for(var t=n,i=e;;){var r=t.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){t=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===t)return zE(r),n;if(s===i)return zE(r),e;s=s.sibling}throw Error(Xe(188))}if(t.return!==i.return)t=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===t){o=!0,t=r,i=s;break}if(a===i){o=!0,i=r,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,i=r;break}if(a===i){o=!0,i=s,t=r;break}a=a.sibling}if(!o)throw Error(Xe(189))}}if(t.alternate!==i)throw Error(Xe(190))}if(t.tag!==3)throw Error(Xe(188));return t.stateNode.current===t?n:e}function gI(n){return n=bD(n),n!==null?vI(n):null}function vI(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=vI(n);if(e!==null)return e;n=n.sibling}return null}var yI=Wr.unstable_scheduleCallback,BE=Wr.unstable_cancelCallback,CD=Wr.unstable_shouldYield,ID=Wr.unstable_requestPaint,Zn=Wr.unstable_now,RD=Wr.unstable_getCurrentPriorityLevel,iw=Wr.unstable_ImmediatePriority,_I=Wr.unstable_UserBlockingPriority,Rg=Wr.unstable_NormalPriority,PD=Wr.unstable_LowPriority,xI=Wr.unstable_IdlePriority,Wv=null,Qs=null;function LD(n){if(Qs&&typeof Qs.onCommitFiberRoot=="function")try{Qs.onCommitFiberRoot(Wv,n,void 0,(n.current.flags&128)===128)}catch{}}var Ls=Math.clz32?Math.clz32:kD,ND=Math.log,DD=Math.LN2;function kD(n){return n>>>=0,n===0?32:31-(ND(n)/DD|0)|0}var qp=64,Yp=4194304;function df(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Pg(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,r=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~r;a!==0?i=df(a):(s&=o,s!==0&&(i=df(s)))}else o=t&~r,o!==0?i=df(o):s!==0&&(i=df(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-Ls(e),r=1<<t,i|=n[t],e&=~r;return i}function OD(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function UD(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,r=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-Ls(s),a=1<<o,c=r[o];c===-1?(!(a&t)||a&i)&&(r[o]=OD(a,e)):c<=e&&(n.expiredLanes|=a),s&=~a}}function Ox(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function SI(){var n=qp;return qp<<=1,!(qp&4194240)&&(qp=64),n}function Wy(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function Ld(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Ls(e),n[e]=t}function FD(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-Ls(t),s=1<<r;e[r]=0,i[r]=-1,n[r]=-1,t&=~s}}function rw(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-Ls(t),r=1<<i;r&e|n[i]&e&&(n[i]|=e),t&=~r}}var vn=0;function wI(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var MI,sw,EI,TI,AI,Ux=!1,$p=[],Ra=null,Pa=null,La=null,jf=new Map,Xf=new Map,_a=[],zD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function HE(n,e){switch(n){case"focusin":case"focusout":Ra=null;break;case"dragenter":case"dragleave":Pa=null;break;case"mouseover":case"mouseout":La=null;break;case"pointerover":case"pointerout":jf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xf.delete(e.pointerId)}}function Hh(n,e,t,i,r,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Dd(e),e!==null&&sw(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function BD(n,e,t,i,r){switch(e){case"focusin":return Ra=Hh(Ra,n,e,t,i,r),!0;case"dragenter":return Pa=Hh(Pa,n,e,t,i,r),!0;case"mouseover":return La=Hh(La,n,e,t,i,r),!0;case"pointerover":var s=r.pointerId;return jf.set(s,Hh(jf.get(s)||null,n,e,t,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Xf.set(s,Hh(Xf.get(s)||null,n,e,t,i,r)),!0}return!1}function bI(n){var e=kl(n.target);if(e!==null){var t=dc(e);if(t!==null){if(e=t.tag,e===13){if(e=mI(t),e!==null){n.blockedOn=e,AI(n.priority,function(){EI(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function lg(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Fx(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);Lx=i,t.target.dispatchEvent(i),Lx=null}else return e=Dd(t),e!==null&&sw(e),n.blockedOn=t,!1;e.shift()}return!0}function VE(n,e,t){lg(n)&&t.delete(e)}function HD(){Ux=!1,Ra!==null&&lg(Ra)&&(Ra=null),Pa!==null&&lg(Pa)&&(Pa=null),La!==null&&lg(La)&&(La=null),jf.forEach(VE),Xf.forEach(VE)}function Vh(n,e){n.blockedOn===e&&(n.blockedOn=null,Ux||(Ux=!0,Wr.unstable_scheduleCallback(Wr.unstable_NormalPriority,HD)))}function qf(n){function e(r){return Vh(r,n)}if(0<$p.length){Vh($p[0],n);for(var t=1;t<$p.length;t++){var i=$p[t];i.blockedOn===n&&(i.blockedOn=null)}}for(Ra!==null&&Vh(Ra,n),Pa!==null&&Vh(Pa,n),La!==null&&Vh(La,n),jf.forEach(e),Xf.forEach(e),t=0;t<_a.length;t++)i=_a[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<_a.length&&(t=_a[0],t.blockedOn===null);)bI(t),t.blockedOn===null&&_a.shift()}var Lu=$o.ReactCurrentBatchConfig,Lg=!0;function VD(n,e,t,i){var r=vn,s=Lu.transition;Lu.transition=null;try{vn=1,ow(n,e,t,i)}finally{vn=r,Lu.transition=s}}function GD(n,e,t,i){var r=vn,s=Lu.transition;Lu.transition=null;try{vn=4,ow(n,e,t,i)}finally{vn=r,Lu.transition=s}}function ow(n,e,t,i){if(Lg){var r=Fx(n,e,t,i);if(r===null)e_(n,e,i,Ng,t),HE(n,i);else if(BD(r,n,e,t,i))i.stopPropagation();else if(HE(n,i),e&4&&-1<zD.indexOf(n)){for(;r!==null;){var s=Dd(r);if(s!==null&&MI(s),s=Fx(n,e,t,i),s===null&&e_(n,e,i,Ng,t),s===r)break;r=s}r!==null&&i.stopPropagation()}else e_(n,e,i,null,t)}}var Ng=null;function Fx(n,e,t,i){if(Ng=null,n=nw(i),n=kl(n),n!==null)if(e=dc(n),e===null)n=null;else if(t=e.tag,t===13){if(n=mI(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Ng=n,null}function CI(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(RD()){case iw:return 1;case _I:return 4;case Rg:case PD:return 16;case xI:return 536870912;default:return 16}default:return 16}}var Aa=null,aw=null,cg=null;function II(){if(cg)return cg;var n,e=aw,t=e.length,i,r="value"in Aa?Aa.value:Aa.textContent,s=r.length;for(n=0;n<t&&e[n]===r[n];n++);var o=t-n;for(i=1;i<=o&&e[t-i]===r[s-i];i++);return cg=r.slice(n,1<i?1-i:void 0)}function ug(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Kp(){return!0}function GE(){return!1}function Yr(n){function e(t,i,r,s,o){this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Kp:GE,this.isPropagationStopped=GE,this}return Vn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Kp)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Kp)},persist:function(){},isPersistent:Kp}),e}var ah={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lw=Yr(ah),Nd=Vn({},ah,{view:0,detail:0}),WD=Yr(Nd),jy,Xy,Gh,jv=Vn({},Nd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cw,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Gh&&(Gh&&n.type==="mousemove"?(jy=n.screenX-Gh.screenX,Xy=n.screenY-Gh.screenY):Xy=jy=0,Gh=n),jy)},movementY:function(n){return"movementY"in n?n.movementY:Xy}}),WE=Yr(jv),jD=Vn({},jv,{dataTransfer:0}),XD=Yr(jD),qD=Vn({},Nd,{relatedTarget:0}),qy=Yr(qD),YD=Vn({},ah,{animationName:0,elapsedTime:0,pseudoElement:0}),$D=Yr(YD),KD=Vn({},ah,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),ZD=Yr(KD),JD=Vn({},ah,{data:0}),jE=Yr(JD),QD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ek={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nk(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=tk[n])?!!e[n]:!1}function cw(){return nk}var ik=Vn({},Nd,{key:function(n){if(n.key){var e=QD[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=ug(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?ek[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cw,charCode:function(n){return n.type==="keypress"?ug(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ug(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),rk=Yr(ik),sk=Vn({},jv,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),XE=Yr(sk),ok=Vn({},Nd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cw}),ak=Yr(ok),lk=Vn({},ah,{propertyName:0,elapsedTime:0,pseudoElement:0}),ck=Yr(lk),uk=Vn({},jv,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),hk=Yr(uk),fk=[9,13,27,32],uw=Ho&&"CompositionEvent"in window,_f=null;Ho&&"documentMode"in document&&(_f=document.documentMode);var dk=Ho&&"TextEvent"in window&&!_f,RI=Ho&&(!uw||_f&&8<_f&&11>=_f),qE=" ",YE=!1;function PI(n,e){switch(n){case"keyup":return fk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function LI(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var fu=!1;function pk(n,e){switch(n){case"compositionend":return LI(e);case"keypress":return e.which!==32?null:(YE=!0,qE);case"textInput":return n=e.data,n===qE&&YE?null:n;default:return null}}function mk(n,e){if(fu)return n==="compositionend"||!uw&&PI(n,e)?(n=II(),cg=aw=Aa=null,fu=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return RI&&e.locale!=="ko"?null:e.data;default:return null}}var gk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $E(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!gk[n.type]:e==="textarea"}function NI(n,e,t,i){uI(i),e=Dg(e,"onChange"),0<e.length&&(t=new lw("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var xf=null,Yf=null;function vk(n){WI(n,0)}function Xv(n){var e=mu(n);if(iI(e))return n}function yk(n,e){if(n==="change")return e}var DI=!1;if(Ho){var Yy;if(Ho){var $y="oninput"in document;if(!$y){var KE=document.createElement("div");KE.setAttribute("oninput","return;"),$y=typeof KE.oninput=="function"}Yy=$y}else Yy=!1;DI=Yy&&(!document.documentMode||9<document.documentMode)}function ZE(){xf&&(xf.detachEvent("onpropertychange",kI),Yf=xf=null)}function kI(n){if(n.propertyName==="value"&&Xv(Yf)){var e=[];NI(e,Yf,n,nw(n)),pI(vk,e)}}function _k(n,e,t){n==="focusin"?(ZE(),xf=e,Yf=t,xf.attachEvent("onpropertychange",kI)):n==="focusout"&&ZE()}function xk(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Xv(Yf)}function Sk(n,e){if(n==="click")return Xv(e)}function wk(n,e){if(n==="input"||n==="change")return Xv(e)}function Mk(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var ks=typeof Object.is=="function"?Object.is:Mk;function $f(n,e){if(ks(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var r=t[i];if(!xx.call(e,r)||!ks(n[r],e[r]))return!1}return!0}function JE(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function QE(n,e){var t=JE(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=JE(t)}}function OI(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?OI(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function UI(){for(var n=window,e=bg();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=bg(n.document)}return e}function hw(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function Ek(n){var e=UI(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&OI(t.ownerDocument.documentElement,t)){if(i!==null&&hw(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!n.extend&&s>i&&(r=i,i=s,s=r),r=QE(t,s);var o=QE(t,i);r&&o&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),s>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var Tk=Ho&&"documentMode"in document&&11>=document.documentMode,du=null,zx=null,Sf=null,Bx=!1;function eT(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Bx||du==null||du!==bg(i)||(i=du,"selectionStart"in i&&hw(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Sf&&$f(Sf,i)||(Sf=i,i=Dg(zx,"onSelect"),0<i.length&&(e=new lw("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=du)))}function Zp(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var pu={animationend:Zp("Animation","AnimationEnd"),animationiteration:Zp("Animation","AnimationIteration"),animationstart:Zp("Animation","AnimationStart"),transitionend:Zp("Transition","TransitionEnd")},Ky={},FI={};Ho&&(FI=document.createElement("div").style,"AnimationEvent"in window||(delete pu.animationend.animation,delete pu.animationiteration.animation,delete pu.animationstart.animation),"TransitionEvent"in window||delete pu.transitionend.transition);function qv(n){if(Ky[n])return Ky[n];if(!pu[n])return n;var e=pu[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in FI)return Ky[n]=e[t];return n}var zI=qv("animationend"),BI=qv("animationiteration"),HI=qv("animationstart"),VI=qv("transitionend"),GI=new Map,tT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ja(n,e){GI.set(n,e),fc(e,[n])}for(var Zy=0;Zy<tT.length;Zy++){var Jy=tT[Zy],Ak=Jy.toLowerCase(),bk=Jy[0].toUpperCase()+Jy.slice(1);ja(Ak,"on"+bk)}ja(zI,"onAnimationEnd");ja(BI,"onAnimationIteration");ja(HI,"onAnimationStart");ja("dblclick","onDoubleClick");ja("focusin","onFocus");ja("focusout","onBlur");ja(VI,"onTransitionEnd");Vu("onMouseEnter",["mouseout","mouseover"]);Vu("onMouseLeave",["mouseout","mouseover"]);Vu("onPointerEnter",["pointerout","pointerover"]);Vu("onPointerLeave",["pointerout","pointerover"]);fc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fc("onBeforeInput",["compositionend","keypress","textInput","paste"]);fc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Ck=new Set("cancel close invalid load scroll toggle".split(" ").concat(pf));function nT(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,AD(i,e,void 0,n),n.currentTarget=null}function WI(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],c=a.instance,h=a.currentTarget;if(a=a.listener,c!==s&&r.isPropagationStopped())break e;nT(r,a,h),s=c}else for(o=0;o<i.length;o++){if(a=i[o],c=a.instance,h=a.currentTarget,a=a.listener,c!==s&&r.isPropagationStopped())break e;nT(r,a,h),s=c}}}if(Ig)throw n=kx,Ig=!1,kx=null,n}function Pn(n,e){var t=e[jx];t===void 0&&(t=e[jx]=new Set);var i=n+"__bubble";t.has(i)||(jI(e,n,2,!1),t.add(i))}function Qy(n,e,t){var i=0;e&&(i|=4),jI(t,n,i,e)}var Jp="_reactListening"+Math.random().toString(36).slice(2);function Kf(n){if(!n[Jp]){n[Jp]=!0,JC.forEach(function(t){t!=="selectionchange"&&(Ck.has(t)||Qy(t,!1,n),Qy(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Jp]||(e[Jp]=!0,Qy("selectionchange",!1,e))}}function jI(n,e,t,i){switch(CI(e)){case 1:var r=VD;break;case 4:r=GD;break;default:r=ow}t=r.bind(null,e,t,n),r=void 0,!Dx||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function e_(n,e,t,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;o=o.return}for(;a!==null;){if(o=kl(a),o===null)return;if(c=o.tag,c===5||c===6){i=s=o;continue e}a=a.parentNode}}i=i.return}pI(function(){var h=s,f=nw(t),d=[];e:{var m=GI.get(n);if(m!==void 0){var v=lw,_=n;switch(n){case"keypress":if(ug(t)===0)break e;case"keydown":case"keyup":v=rk;break;case"focusin":_="focus",v=qy;break;case"focusout":_="blur",v=qy;break;case"beforeblur":case"afterblur":v=qy;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=WE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=XD;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=ak;break;case zI:case BI:case HI:v=$D;break;case VI:v=ck;break;case"scroll":v=WD;break;case"wheel":v=hk;break;case"copy":case"cut":case"paste":v=ZD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=XE}var E=(e&4)!==0,S=!E&&n==="scroll",y=E?m!==null?m+"Capture":null:m;E=[];for(var w=h,M;w!==null;){M=w;var R=M.stateNode;if(M.tag===5&&R!==null&&(M=R,y!==null&&(R=Wf(w,y),R!=null&&E.push(Zf(w,R,M)))),S)break;w=w.return}0<E.length&&(m=new v(m,_,null,t,f),d.push({event:m,listeners:E}))}}if(!(e&7)){e:{if(m=n==="mouseover"||n==="pointerover",v=n==="mouseout"||n==="pointerout",m&&t!==Lx&&(_=t.relatedTarget||t.fromElement)&&(kl(_)||_[Vo]))break e;if((v||m)&&(m=f.window===f?f:(m=f.ownerDocument)?m.defaultView||m.parentWindow:window,v?(_=t.relatedTarget||t.toElement,v=h,_=_?kl(_):null,_!==null&&(S=dc(_),_!==S||_.tag!==5&&_.tag!==6)&&(_=null)):(v=null,_=h),v!==_)){if(E=WE,R="onMouseLeave",y="onMouseEnter",w="mouse",(n==="pointerout"||n==="pointerover")&&(E=XE,R="onPointerLeave",y="onPointerEnter",w="pointer"),S=v==null?m:mu(v),M=_==null?m:mu(_),m=new E(R,w+"leave",v,t,f),m.target=S,m.relatedTarget=M,R=null,kl(f)===h&&(E=new E(y,w+"enter",_,t,f),E.target=M,E.relatedTarget=S,R=E),S=R,v&&_)t:{for(E=v,y=_,w=0,M=E;M;M=zc(M))w++;for(M=0,R=y;R;R=zc(R))M++;for(;0<w-M;)E=zc(E),w--;for(;0<M-w;)y=zc(y),M--;for(;w--;){if(E===y||y!==null&&E===y.alternate)break t;E=zc(E),y=zc(y)}E=null}else E=null;v!==null&&iT(d,m,v,E,!1),_!==null&&S!==null&&iT(d,S,_,E,!0)}}e:{if(m=h?mu(h):window,v=m.nodeName&&m.nodeName.toLowerCase(),v==="select"||v==="input"&&m.type==="file")var z=yk;else if($E(m))if(DI)z=wk;else{z=xk;var k=_k}else(v=m.nodeName)&&v.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(z=Sk);if(z&&(z=z(n,h))){NI(d,z,t,f);break e}k&&k(n,m,h),n==="focusout"&&(k=m._wrapperState)&&k.controlled&&m.type==="number"&&bx(m,"number",m.value)}switch(k=h?mu(h):window,n){case"focusin":($E(k)||k.contentEditable==="true")&&(du=k,zx=h,Sf=null);break;case"focusout":Sf=zx=du=null;break;case"mousedown":Bx=!0;break;case"contextmenu":case"mouseup":case"dragend":Bx=!1,eT(d,t,f);break;case"selectionchange":if(Tk)break;case"keydown":case"keyup":eT(d,t,f)}var P;if(uw)e:{switch(n){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else fu?PI(n,t)&&(b="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(b="onCompositionStart");b&&(RI&&t.locale!=="ko"&&(fu||b!=="onCompositionStart"?b==="onCompositionEnd"&&fu&&(P=II()):(Aa=f,aw="value"in Aa?Aa.value:Aa.textContent,fu=!0)),k=Dg(h,b),0<k.length&&(b=new jE(b,n,null,t,f),d.push({event:b,listeners:k}),P?b.data=P:(P=LI(t),P!==null&&(b.data=P)))),(P=dk?pk(n,t):mk(n,t))&&(h=Dg(h,"onBeforeInput"),0<h.length&&(f=new jE("onBeforeInput","beforeinput",null,t,f),d.push({event:f,listeners:h}),f.data=P))}WI(d,e)})}function Zf(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Dg(n,e){for(var t=e+"Capture",i=[];n!==null;){var r=n,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Wf(n,t),s!=null&&i.unshift(Zf(n,s,r)),s=Wf(n,e),s!=null&&i.push(Zf(n,s,r))),n=n.return}return i}function zc(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function iT(n,e,t,i,r){for(var s=e._reactName,o=[];t!==null&&t!==i;){var a=t,c=a.alternate,h=a.stateNode;if(c!==null&&c===i)break;a.tag===5&&h!==null&&(a=h,r?(c=Wf(t,s),c!=null&&o.unshift(Zf(t,c,a))):r||(c=Wf(t,s),c!=null&&o.push(Zf(t,c,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var Ik=/\r\n?/g,Rk=/\u0000|\uFFFD/g;function rT(n){return(typeof n=="string"?n:""+n).replace(Ik,`
`).replace(Rk,"")}function Qp(n,e,t){if(e=rT(e),rT(n)!==e&&t)throw Error(Xe(425))}function kg(){}var Hx=null,Vx=null;function Gx(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Wx=typeof setTimeout=="function"?setTimeout:void 0,Pk=typeof clearTimeout=="function"?clearTimeout:void 0,sT=typeof Promise=="function"?Promise:void 0,Lk=typeof queueMicrotask=="function"?queueMicrotask:typeof sT<"u"?function(n){return sT.resolve(null).then(n).catch(Nk)}:Wx;function Nk(n){setTimeout(function(){throw n})}function t_(n,e){var t=e,i=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(i===0){n.removeChild(r),qf(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=r}while(t);qf(e)}function Na(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function oT(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var lh=Math.random().toString(36).slice(2),Ks="__reactFiber$"+lh,Jf="__reactProps$"+lh,Vo="__reactContainer$"+lh,jx="__reactEvents$"+lh,Dk="__reactListeners$"+lh,kk="__reactHandles$"+lh;function kl(n){var e=n[Ks];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Vo]||t[Ks]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=oT(n);n!==null;){if(t=n[Ks])return t;n=oT(n)}return e}n=t,t=n.parentNode}return null}function Dd(n){return n=n[Ks]||n[Vo],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function mu(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(Xe(33))}function Yv(n){return n[Jf]||null}var Xx=[],gu=-1;function Xa(n){return{current:n}}function Nn(n){0>gu||(n.current=Xx[gu],Xx[gu]=null,gu--)}function bn(n,e){gu++,Xx[gu]=n.current,n.current=e}var Ha={},Wi=Xa(Ha),yr=Xa(!1),ec=Ha;function Gu(n,e){var t=n.type.contextTypes;if(!t)return Ha;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in t)r[s]=e[s];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function _r(n){return n=n.childContextTypes,n!=null}function Og(){Nn(yr),Nn(Wi)}function aT(n,e,t){if(Wi.current!==Ha)throw Error(Xe(168));bn(Wi,e),bn(yr,t)}function XI(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(Xe(108,_D(n)||"Unknown",r));return Vn({},t,i)}function Ug(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Ha,ec=Wi.current,bn(Wi,n),bn(yr,yr.current),!0}function lT(n,e,t){var i=n.stateNode;if(!i)throw Error(Xe(169));t?(n=XI(n,e,ec),i.__reactInternalMemoizedMergedChildContext=n,Nn(yr),Nn(Wi),bn(Wi,n)):Nn(yr),bn(yr,t)}var Ro=null,$v=!1,n_=!1;function qI(n){Ro===null?Ro=[n]:Ro.push(n)}function Ok(n){$v=!0,qI(n)}function qa(){if(!n_&&Ro!==null){n_=!0;var n=0,e=vn;try{var t=Ro;for(vn=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}Ro=null,$v=!1}catch(r){throw Ro!==null&&(Ro=Ro.slice(n+1)),yI(iw,qa),r}finally{vn=e,n_=!1}}return null}var vu=[],yu=0,Fg=null,zg=0,rs=[],ss=0,tc=null,No=1,Do="";function bl(n,e){vu[yu++]=zg,vu[yu++]=Fg,Fg=n,zg=e}function YI(n,e,t){rs[ss++]=No,rs[ss++]=Do,rs[ss++]=tc,tc=n;var i=No;n=Do;var r=32-Ls(i)-1;i&=~(1<<r),t+=1;var s=32-Ls(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,No=1<<32-Ls(e)+r|t<<r|i,Do=s+n}else No=1<<s|t<<r|i,Do=n}function fw(n){n.return!==null&&(bl(n,1),YI(n,1,0))}function dw(n){for(;n===Fg;)Fg=vu[--yu],vu[yu]=null,zg=vu[--yu],vu[yu]=null;for(;n===tc;)tc=rs[--ss],rs[ss]=null,Do=rs[--ss],rs[ss]=null,No=rs[--ss],rs[ss]=null}var Br=null,zr=null,kn=!1,bs=null;function $I(n,e){var t=ls(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function cT(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Br=n,zr=Na(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Br=n,zr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=tc!==null?{id:No,overflow:Do}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=ls(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Br=n,zr=null,!0):!1;default:return!1}}function qx(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Yx(n){if(kn){var e=zr;if(e){var t=e;if(!cT(n,e)){if(qx(n))throw Error(Xe(418));e=Na(t.nextSibling);var i=Br;e&&cT(n,e)?$I(i,t):(n.flags=n.flags&-4097|2,kn=!1,Br=n)}}else{if(qx(n))throw Error(Xe(418));n.flags=n.flags&-4097|2,kn=!1,Br=n}}}function uT(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Br=n}function em(n){if(n!==Br)return!1;if(!kn)return uT(n),kn=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Gx(n.type,n.memoizedProps)),e&&(e=zr)){if(qx(n))throw KI(),Error(Xe(418));for(;e;)$I(n,e),e=Na(e.nextSibling)}if(uT(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Xe(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){zr=Na(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}zr=null}}else zr=Br?Na(n.stateNode.nextSibling):null;return!0}function KI(){for(var n=zr;n;)n=Na(n.nextSibling)}function Wu(){zr=Br=null,kn=!1}function pw(n){bs===null?bs=[n]:bs.push(n)}var Uk=$o.ReactCurrentBatchConfig;function Wh(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(Xe(309));var i=t.stateNode}if(!i)throw Error(Xe(147,n));var r=i,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(Xe(284));if(!t._owner)throw Error(Xe(290,n))}return n}function tm(n,e){throw n=Object.prototype.toString.call(e),Error(Xe(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function hT(n){var e=n._init;return e(n._payload)}function ZI(n){function e(y,w){if(n){var M=y.deletions;M===null?(y.deletions=[w],y.flags|=16):M.push(w)}}function t(y,w){if(!n)return null;for(;w!==null;)e(y,w),w=w.sibling;return null}function i(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function r(y,w){return y=Ua(y,w),y.index=0,y.sibling=null,y}function s(y,w,M){return y.index=M,n?(M=y.alternate,M!==null?(M=M.index,M<w?(y.flags|=2,w):M):(y.flags|=2,w)):(y.flags|=1048576,w)}function o(y){return n&&y.alternate===null&&(y.flags|=2),y}function a(y,w,M,R){return w===null||w.tag!==6?(w=c_(M,y.mode,R),w.return=y,w):(w=r(w,M),w.return=y,w)}function c(y,w,M,R){var z=M.type;return z===hu?f(y,w,M.props.children,R,M.key):w!==null&&(w.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===ga&&hT(z)===w.type)?(R=r(w,M.props),R.ref=Wh(y,w,M),R.return=y,R):(R=vg(M.type,M.key,M.props,null,y.mode,R),R.ref=Wh(y,w,M),R.return=y,R)}function h(y,w,M,R){return w===null||w.tag!==4||w.stateNode.containerInfo!==M.containerInfo||w.stateNode.implementation!==M.implementation?(w=u_(M,y.mode,R),w.return=y,w):(w=r(w,M.children||[]),w.return=y,w)}function f(y,w,M,R,z){return w===null||w.tag!==7?(w=ql(M,y.mode,R,z),w.return=y,w):(w=r(w,M),w.return=y,w)}function d(y,w,M){if(typeof w=="string"&&w!==""||typeof w=="number")return w=c_(""+w,y.mode,M),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Wp:return M=vg(w.type,w.key,w.props,null,y.mode,M),M.ref=Wh(y,null,w),M.return=y,M;case uu:return w=u_(w,y.mode,M),w.return=y,w;case ga:var R=w._init;return d(y,R(w._payload),M)}if(ff(w)||zh(w))return w=ql(w,y.mode,M,null),w.return=y,w;tm(y,w)}return null}function m(y,w,M,R){var z=w!==null?w.key:null;if(typeof M=="string"&&M!==""||typeof M=="number")return z!==null?null:a(y,w,""+M,R);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case Wp:return M.key===z?c(y,w,M,R):null;case uu:return M.key===z?h(y,w,M,R):null;case ga:return z=M._init,m(y,w,z(M._payload),R)}if(ff(M)||zh(M))return z!==null?null:f(y,w,M,R,null);tm(y,M)}return null}function v(y,w,M,R,z){if(typeof R=="string"&&R!==""||typeof R=="number")return y=y.get(M)||null,a(w,y,""+R,z);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case Wp:return y=y.get(R.key===null?M:R.key)||null,c(w,y,R,z);case uu:return y=y.get(R.key===null?M:R.key)||null,h(w,y,R,z);case ga:var k=R._init;return v(y,w,M,k(R._payload),z)}if(ff(R)||zh(R))return y=y.get(M)||null,f(w,y,R,z,null);tm(w,R)}return null}function _(y,w,M,R){for(var z=null,k=null,P=w,b=w=0,A=null;P!==null&&b<M.length;b++){P.index>b?(A=P,P=null):A=P.sibling;var T=m(y,P,M[b],R);if(T===null){P===null&&(P=A);break}n&&P&&T.alternate===null&&e(y,P),w=s(T,w,b),k===null?z=T:k.sibling=T,k=T,P=A}if(b===M.length)return t(y,P),kn&&bl(y,b),z;if(P===null){for(;b<M.length;b++)P=d(y,M[b],R),P!==null&&(w=s(P,w,b),k===null?z=P:k.sibling=P,k=P);return kn&&bl(y,b),z}for(P=i(y,P);b<M.length;b++)A=v(P,y,b,M[b],R),A!==null&&(n&&A.alternate!==null&&P.delete(A.key===null?b:A.key),w=s(A,w,b),k===null?z=A:k.sibling=A,k=A);return n&&P.forEach(function(L){return e(y,L)}),kn&&bl(y,b),z}function E(y,w,M,R){var z=zh(M);if(typeof z!="function")throw Error(Xe(150));if(M=z.call(M),M==null)throw Error(Xe(151));for(var k=z=null,P=w,b=w=0,A=null,T=M.next();P!==null&&!T.done;b++,T=M.next()){P.index>b?(A=P,P=null):A=P.sibling;var L=m(y,P,T.value,R);if(L===null){P===null&&(P=A);break}n&&P&&L.alternate===null&&e(y,P),w=s(L,w,b),k===null?z=L:k.sibling=L,k=L,P=A}if(T.done)return t(y,P),kn&&bl(y,b),z;if(P===null){for(;!T.done;b++,T=M.next())T=d(y,T.value,R),T!==null&&(w=s(T,w,b),k===null?z=T:k.sibling=T,k=T);return kn&&bl(y,b),z}for(P=i(y,P);!T.done;b++,T=M.next())T=v(P,y,b,T.value,R),T!==null&&(n&&T.alternate!==null&&P.delete(T.key===null?b:T.key),w=s(T,w,b),k===null?z=T:k.sibling=T,k=T);return n&&P.forEach(function(H){return e(y,H)}),kn&&bl(y,b),z}function S(y,w,M,R){if(typeof M=="object"&&M!==null&&M.type===hu&&M.key===null&&(M=M.props.children),typeof M=="object"&&M!==null){switch(M.$$typeof){case Wp:e:{for(var z=M.key,k=w;k!==null;){if(k.key===z){if(z=M.type,z===hu){if(k.tag===7){t(y,k.sibling),w=r(k,M.props.children),w.return=y,y=w;break e}}else if(k.elementType===z||typeof z=="object"&&z!==null&&z.$$typeof===ga&&hT(z)===k.type){t(y,k.sibling),w=r(k,M.props),w.ref=Wh(y,k,M),w.return=y,y=w;break e}t(y,k);break}else e(y,k);k=k.sibling}M.type===hu?(w=ql(M.props.children,y.mode,R,M.key),w.return=y,y=w):(R=vg(M.type,M.key,M.props,null,y.mode,R),R.ref=Wh(y,w,M),R.return=y,y=R)}return o(y);case uu:e:{for(k=M.key;w!==null;){if(w.key===k)if(w.tag===4&&w.stateNode.containerInfo===M.containerInfo&&w.stateNode.implementation===M.implementation){t(y,w.sibling),w=r(w,M.children||[]),w.return=y,y=w;break e}else{t(y,w);break}else e(y,w);w=w.sibling}w=u_(M,y.mode,R),w.return=y,y=w}return o(y);case ga:return k=M._init,S(y,w,k(M._payload),R)}if(ff(M))return _(y,w,M,R);if(zh(M))return E(y,w,M,R);tm(y,M)}return typeof M=="string"&&M!==""||typeof M=="number"?(M=""+M,w!==null&&w.tag===6?(t(y,w.sibling),w=r(w,M),w.return=y,y=w):(t(y,w),w=c_(M,y.mode,R),w.return=y,y=w),o(y)):t(y,w)}return S}var ju=ZI(!0),JI=ZI(!1),Bg=Xa(null),Hg=null,_u=null,mw=null;function gw(){mw=_u=Hg=null}function vw(n){var e=Bg.current;Nn(Bg),n._currentValue=e}function $x(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function Nu(n,e){Hg=n,mw=_u=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(vr=!0),n.firstContext=null)}function us(n){var e=n._currentValue;if(mw!==n)if(n={context:n,memoizedValue:e,next:null},_u===null){if(Hg===null)throw Error(Xe(308));_u=n,Hg.dependencies={lanes:0,firstContext:n}}else _u=_u.next=n;return e}var Ol=null;function yw(n){Ol===null?Ol=[n]:Ol.push(n)}function QI(n,e,t,i){var r=e.interleaved;return r===null?(t.next=t,yw(e)):(t.next=r.next,r.next=t),e.interleaved=t,Go(n,i)}function Go(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var va=!1;function _w(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function e2(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function zo(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Da(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,on&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Go(n,t)}return r=i.interleaved,r===null?(e.next=e,yw(i)):(e.next=r.next,r.next=e),i.interleaved=e,Go(n,t)}function hg(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,rw(n,t)}}function fT(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var r=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?r=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?r=s=e:s=s.next=e}else r=s=e;t={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Vg(n,e,t,i){var r=n.updateQueue;va=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var c=a,h=c.next;c.next=null,o===null?s=h:o.next=h,o=c;var f=n.alternate;f!==null&&(f=f.updateQueue,a=f.lastBaseUpdate,a!==o&&(a===null?f.firstBaseUpdate=h:a.next=h,f.lastBaseUpdate=c))}if(s!==null){var d=r.baseState;o=0,f=h=c=null,a=s;do{var m=a.lane,v=a.eventTime;if((i&m)===m){f!==null&&(f=f.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var _=n,E=a;switch(m=e,v=t,E.tag){case 1:if(_=E.payload,typeof _=="function"){d=_.call(v,d,m);break e}d=_;break e;case 3:_.flags=_.flags&-65537|128;case 0:if(_=E.payload,m=typeof _=="function"?_.call(v,d,m):_,m==null)break e;d=Vn({},d,m);break e;case 2:va=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,m=r.effects,m===null?r.effects=[a]:m.push(a))}else v={eventTime:v,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},f===null?(h=f=v,c=d):f=f.next=v,o|=m;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;m=a,a=m.next,m.next=null,r.lastBaseUpdate=m,r.shared.pending=null}}while(!0);if(f===null&&(c=d),r.baseState=c,r.firstBaseUpdate=h,r.lastBaseUpdate=f,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);ic|=o,n.lanes=o,n.memoizedState=d}}function dT(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],r=i.callback;if(r!==null){if(i.callback=null,i=t,typeof r!="function")throw Error(Xe(191,r));r.call(i)}}}var kd={},eo=Xa(kd),Qf=Xa(kd),ed=Xa(kd);function Ul(n){if(n===kd)throw Error(Xe(174));return n}function xw(n,e){switch(bn(ed,e),bn(Qf,n),bn(eo,kd),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Ix(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Ix(e,n)}Nn(eo),bn(eo,e)}function Xu(){Nn(eo),Nn(Qf),Nn(ed)}function t2(n){Ul(ed.current);var e=Ul(eo.current),t=Ix(e,n.type);e!==t&&(bn(Qf,n),bn(eo,t))}function Sw(n){Qf.current===n&&(Nn(eo),Nn(Qf))}var Un=Xa(0);function Gg(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var i_=[];function ww(){for(var n=0;n<i_.length;n++)i_[n]._workInProgressVersionPrimary=null;i_.length=0}var fg=$o.ReactCurrentDispatcher,r_=$o.ReactCurrentBatchConfig,nc=0,Hn=null,ui=null,yi=null,Wg=!1,wf=!1,td=0,Fk=0;function ki(){throw Error(Xe(321))}function Mw(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!ks(n[t],e[t]))return!1;return!0}function Ew(n,e,t,i,r,s){if(nc=s,Hn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,fg.current=n===null||n.memoizedState===null?Vk:Gk,n=t(i,r),wf){s=0;do{if(wf=!1,td=0,25<=s)throw Error(Xe(301));s+=1,yi=ui=null,e.updateQueue=null,fg.current=Wk,n=t(i,r)}while(wf)}if(fg.current=jg,e=ui!==null&&ui.next!==null,nc=0,yi=ui=Hn=null,Wg=!1,e)throw Error(Xe(300));return n}function Tw(){var n=td!==0;return td=0,n}function Ys(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yi===null?Hn.memoizedState=yi=n:yi=yi.next=n,yi}function hs(){if(ui===null){var n=Hn.alternate;n=n!==null?n.memoizedState:null}else n=ui.next;var e=yi===null?Hn.memoizedState:yi.next;if(e!==null)yi=e,ui=n;else{if(n===null)throw Error(Xe(310));ui=n,n={memoizedState:ui.memoizedState,baseState:ui.baseState,baseQueue:ui.baseQueue,queue:ui.queue,next:null},yi===null?Hn.memoizedState=yi=n:yi=yi.next=n}return yi}function nd(n,e){return typeof e=="function"?e(n):e}function s_(n){var e=hs(),t=e.queue;if(t===null)throw Error(Xe(311));t.lastRenderedReducer=n;var i=ui,r=i.baseQueue,s=t.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,t.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,c=null,h=s;do{var f=h.lane;if((nc&f)===f)c!==null&&(c=c.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),i=h.hasEagerState?h.eagerState:n(i,h.action);else{var d={lane:f,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};c===null?(a=c=d,o=i):c=c.next=d,Hn.lanes|=f,ic|=f}h=h.next}while(h!==null&&h!==s);c===null?o=i:c.next=a,ks(i,e.memoizedState)||(vr=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=c,t.lastRenderedState=i}if(n=t.interleaved,n!==null){r=n;do s=r.lane,Hn.lanes|=s,ic|=s,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function o_(n){var e=hs(),t=e.queue;if(t===null)throw Error(Xe(311));t.lastRenderedReducer=n;var i=t.dispatch,r=t.pending,s=e.memoizedState;if(r!==null){t.pending=null;var o=r=r.next;do s=n(s,o.action),o=o.next;while(o!==r);ks(s,e.memoizedState)||(vr=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,i]}function n2(){}function i2(n,e){var t=Hn,i=hs(),r=e(),s=!ks(i.memoizedState,r);if(s&&(i.memoizedState=r,vr=!0),i=i.queue,Aw(o2.bind(null,t,i,n),[n]),i.getSnapshot!==e||s||yi!==null&&yi.memoizedState.tag&1){if(t.flags|=2048,id(9,s2.bind(null,t,i,r,e),void 0,null),Si===null)throw Error(Xe(349));nc&30||r2(t,e,r)}return r}function r2(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Hn.updateQueue,e===null?(e={lastEffect:null,stores:null},Hn.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function s2(n,e,t,i){e.value=t,e.getSnapshot=i,a2(e)&&l2(n)}function o2(n,e,t){return t(function(){a2(e)&&l2(n)})}function a2(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!ks(n,t)}catch{return!0}}function l2(n){var e=Go(n,1);e!==null&&Ns(e,n,1,-1)}function pT(n){var e=Ys();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:nd,lastRenderedState:n},e.queue=n,n=n.dispatch=Hk.bind(null,Hn,n),[e.memoizedState,n]}function id(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=Hn.updateQueue,e===null?(e={lastEffect:null,stores:null},Hn.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function c2(){return hs().memoizedState}function dg(n,e,t,i){var r=Ys();Hn.flags|=n,r.memoizedState=id(1|e,t,void 0,i===void 0?null:i)}function Kv(n,e,t,i){var r=hs();i=i===void 0?null:i;var s=void 0;if(ui!==null){var o=ui.memoizedState;if(s=o.destroy,i!==null&&Mw(i,o.deps)){r.memoizedState=id(e,t,s,i);return}}Hn.flags|=n,r.memoizedState=id(1|e,t,s,i)}function mT(n,e){return dg(8390656,8,n,e)}function Aw(n,e){return Kv(2048,8,n,e)}function u2(n,e){return Kv(4,2,n,e)}function h2(n,e){return Kv(4,4,n,e)}function f2(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function d2(n,e,t){return t=t!=null?t.concat([n]):null,Kv(4,4,f2.bind(null,e,n),t)}function bw(){}function p2(n,e){var t=hs();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Mw(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function m2(n,e){var t=hs();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Mw(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function g2(n,e,t){return nc&21?(ks(t,e)||(t=SI(),Hn.lanes|=t,ic|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,vr=!0),n.memoizedState=t)}function zk(n,e){var t=vn;vn=t!==0&&4>t?t:4,n(!0);var i=r_.transition;r_.transition={};try{n(!1),e()}finally{vn=t,r_.transition=i}}function v2(){return hs().memoizedState}function Bk(n,e,t){var i=Oa(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},y2(n))_2(e,t);else if(t=QI(n,e,t,i),t!==null){var r=tr();Ns(t,n,i,r),x2(t,e,i)}}function Hk(n,e,t){var i=Oa(n),r={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(y2(n))_2(e,r);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(r.hasEagerState=!0,r.eagerState=a,ks(a,o)){var c=e.interleaved;c===null?(r.next=r,yw(e)):(r.next=c.next,c.next=r),e.interleaved=r;return}}catch{}finally{}t=QI(n,e,r,i),t!==null&&(r=tr(),Ns(t,n,i,r),x2(t,e,i))}}function y2(n){var e=n.alternate;return n===Hn||e!==null&&e===Hn}function _2(n,e){wf=Wg=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function x2(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,rw(n,t)}}var jg={readContext:us,useCallback:ki,useContext:ki,useEffect:ki,useImperativeHandle:ki,useInsertionEffect:ki,useLayoutEffect:ki,useMemo:ki,useReducer:ki,useRef:ki,useState:ki,useDebugValue:ki,useDeferredValue:ki,useTransition:ki,useMutableSource:ki,useSyncExternalStore:ki,useId:ki,unstable_isNewReconciler:!1},Vk={readContext:us,useCallback:function(n,e){return Ys().memoizedState=[n,e===void 0?null:e],n},useContext:us,useEffect:mT,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,dg(4194308,4,f2.bind(null,e,n),t)},useLayoutEffect:function(n,e){return dg(4194308,4,n,e)},useInsertionEffect:function(n,e){return dg(4,2,n,e)},useMemo:function(n,e){var t=Ys();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=Ys();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=Bk.bind(null,Hn,n),[i.memoizedState,n]},useRef:function(n){var e=Ys();return n={current:n},e.memoizedState=n},useState:pT,useDebugValue:bw,useDeferredValue:function(n){return Ys().memoizedState=n},useTransition:function(){var n=pT(!1),e=n[0];return n=zk.bind(null,n[1]),Ys().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=Hn,r=Ys();if(kn){if(t===void 0)throw Error(Xe(407));t=t()}else{if(t=e(),Si===null)throw Error(Xe(349));nc&30||r2(i,e,t)}r.memoizedState=t;var s={value:t,getSnapshot:e};return r.queue=s,mT(o2.bind(null,i,s,n),[n]),i.flags|=2048,id(9,s2.bind(null,i,s,t,e),void 0,null),t},useId:function(){var n=Ys(),e=Si.identifierPrefix;if(kn){var t=Do,i=No;t=(i&~(1<<32-Ls(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=td++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=Fk++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},Gk={readContext:us,useCallback:p2,useContext:us,useEffect:Aw,useImperativeHandle:d2,useInsertionEffect:u2,useLayoutEffect:h2,useMemo:m2,useReducer:s_,useRef:c2,useState:function(){return s_(nd)},useDebugValue:bw,useDeferredValue:function(n){var e=hs();return g2(e,ui.memoizedState,n)},useTransition:function(){var n=s_(nd)[0],e=hs().memoizedState;return[n,e]},useMutableSource:n2,useSyncExternalStore:i2,useId:v2,unstable_isNewReconciler:!1},Wk={readContext:us,useCallback:p2,useContext:us,useEffect:Aw,useImperativeHandle:d2,useInsertionEffect:u2,useLayoutEffect:h2,useMemo:m2,useReducer:o_,useRef:c2,useState:function(){return o_(nd)},useDebugValue:bw,useDeferredValue:function(n){var e=hs();return ui===null?e.memoizedState=n:g2(e,ui.memoizedState,n)},useTransition:function(){var n=o_(nd)[0],e=hs().memoizedState;return[n,e]},useMutableSource:n2,useSyncExternalStore:i2,useId:v2,unstable_isNewReconciler:!1};function Es(n,e){if(n&&n.defaultProps){e=Vn({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Kx(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:Vn({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Zv={isMounted:function(n){return(n=n._reactInternals)?dc(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=tr(),r=Oa(n),s=zo(i,r);s.payload=e,t!=null&&(s.callback=t),e=Da(n,s,r),e!==null&&(Ns(e,n,r,i),hg(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=tr(),r=Oa(n),s=zo(i,r);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=Da(n,s,r),e!==null&&(Ns(e,n,r,i),hg(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=tr(),i=Oa(n),r=zo(t,i);r.tag=2,e!=null&&(r.callback=e),e=Da(n,r,i),e!==null&&(Ns(e,n,i,t),hg(e,n,i))}};function gT(n,e,t,i,r,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!$f(t,i)||!$f(r,s):!0}function S2(n,e,t){var i=!1,r=Ha,s=e.contextType;return typeof s=="object"&&s!==null?s=us(s):(r=_r(e)?ec:Wi.current,i=e.contextTypes,s=(i=i!=null)?Gu(n,r):Ha),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Zv,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=s),e}function vT(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&Zv.enqueueReplaceState(e,e.state,null)}function Zx(n,e,t,i){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs={},_w(n);var s=e.contextType;typeof s=="object"&&s!==null?r.context=us(s):(s=_r(e)?ec:Wi.current,r.context=Gu(n,s)),r.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Kx(n,e,s,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Zv.enqueueReplaceState(r,r.state,null),Vg(n,t,r,i),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function qu(n,e){try{var t="",i=e;do t+=yD(i),i=i.return;while(i);var r=t}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:r,digest:null}}function a_(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Jx(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var jk=typeof WeakMap=="function"?WeakMap:Map;function w2(n,e,t){t=zo(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){qg||(qg=!0,lS=i),Jx(n,e)},t}function M2(n,e,t){t=zo(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;t.payload=function(){return i(r)},t.callback=function(){Jx(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){Jx(n,e),typeof i!="function"&&(ka===null?ka=new Set([this]):ka.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function yT(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new jk;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(t)||(r.add(t),n=sO.bind(null,n,e,t),e.then(n,n))}function _T(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function xT(n,e,t,i,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=zo(-1,1),e.tag=2,Da(t,e,1))),t.lanes|=1),n)}var Xk=$o.ReactCurrentOwner,vr=!1;function Ji(n,e,t,i){e.child=n===null?JI(e,null,t,i):ju(e,n.child,t,i)}function ST(n,e,t,i,r){t=t.render;var s=e.ref;return Nu(e,r),i=Ew(n,e,t,i,s,r),t=Tw(),n!==null&&!vr?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Wo(n,e,r)):(kn&&t&&fw(e),e.flags|=1,Ji(n,e,i,r),e.child)}function wT(n,e,t,i,r){if(n===null){var s=t.type;return typeof s=="function"&&!kw(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,E2(n,e,s,i,r)):(n=vg(t.type,null,i,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&r)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:$f,t(o,i)&&n.ref===e.ref)return Wo(n,e,r)}return e.flags|=1,n=Ua(s,i),n.ref=e.ref,n.return=e,e.child=n}function E2(n,e,t,i,r){if(n!==null){var s=n.memoizedProps;if($f(s,i)&&n.ref===e.ref)if(vr=!1,e.pendingProps=i=s,(n.lanes&r)!==0)n.flags&131072&&(vr=!0);else return e.lanes=n.lanes,Wo(n,e,r)}return Qx(n,e,t,i,r)}function T2(n,e,t){var i=e.pendingProps,r=i.children,s=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},bn(Su,kr),kr|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,bn(Su,kr),kr|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:t,bn(Su,kr),kr|=i}else s!==null?(i=s.baseLanes|t,e.memoizedState=null):i=t,bn(Su,kr),kr|=i;return Ji(n,e,r,t),e.child}function A2(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Qx(n,e,t,i,r){var s=_r(t)?ec:Wi.current;return s=Gu(e,s),Nu(e,r),t=Ew(n,e,t,i,s,r),i=Tw(),n!==null&&!vr?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Wo(n,e,r)):(kn&&i&&fw(e),e.flags|=1,Ji(n,e,t,r),e.child)}function MT(n,e,t,i,r){if(_r(t)){var s=!0;Ug(e)}else s=!1;if(Nu(e,r),e.stateNode===null)pg(n,e),S2(e,t,i),Zx(e,t,i,r),i=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,h=t.contextType;typeof h=="object"&&h!==null?h=us(h):(h=_r(t)?ec:Wi.current,h=Gu(e,h));var f=t.getDerivedStateFromProps,d=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||c!==h)&&vT(e,o,i,h),va=!1;var m=e.memoizedState;o.state=m,Vg(e,i,o,r),c=e.memoizedState,a!==i||m!==c||yr.current||va?(typeof f=="function"&&(Kx(e,t,f,i),c=e.memoizedState),(a=va||gT(e,t,a,i,m,c,h))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=c),o.props=i,o.state=c,o.context=h,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,e2(n,e),a=e.memoizedProps,h=e.type===e.elementType?a:Es(e.type,a),o.props=h,d=e.pendingProps,m=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=us(c):(c=_r(t)?ec:Wi.current,c=Gu(e,c));var v=t.getDerivedStateFromProps;(f=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==d||m!==c)&&vT(e,o,i,c),va=!1,m=e.memoizedState,o.state=m,Vg(e,i,o,r);var _=e.memoizedState;a!==d||m!==_||yr.current||va?(typeof v=="function"&&(Kx(e,t,v,i),_=e.memoizedState),(h=va||gT(e,t,h,i,m,_,c)||!1)?(f||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,_,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,_,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=_),o.props=i,o.state=_,o.context=c,i=h):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),i=!1)}return eS(n,e,t,i,s,r)}function eS(n,e,t,i,r,s){A2(n,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&lT(e,t,!1),Wo(n,e,s);i=e.stateNode,Xk.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&o?(e.child=ju(e,n.child,null,s),e.child=ju(e,null,a,s)):Ji(n,e,a,s),e.memoizedState=i.state,r&&lT(e,t,!0),e.child}function b2(n){var e=n.stateNode;e.pendingContext?aT(n,e.pendingContext,e.pendingContext!==e.context):e.context&&aT(n,e.context,!1),xw(n,e.containerInfo)}function ET(n,e,t,i,r){return Wu(),pw(r),e.flags|=256,Ji(n,e,t,i),e.child}var tS={dehydrated:null,treeContext:null,retryLane:0};function nS(n){return{baseLanes:n,cachePool:null,transitions:null}}function C2(n,e,t){var i=e.pendingProps,r=Un.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),bn(Un,r&1),n===null)return Yx(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,n=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=e0(o,i,0,null),n=ql(n,i,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=nS(t),e.memoizedState=tS,n):Cw(e,o));if(r=n.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return qk(n,e,o,i,a,r,t);if(s){s=i.fallback,o=e.mode,r=n.child,a=r.sibling;var c={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=c,e.deletions=null):(i=Ua(r,c),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=Ua(a,s):(s=ql(s,o,t,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=n.child.memoizedState,o=o===null?nS(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=tS,i}return s=n.child,n=s.sibling,i=Ua(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function Cw(n,e){return e=e0({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function nm(n,e,t,i){return i!==null&&pw(i),ju(e,n.child,null,t),n=Cw(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function qk(n,e,t,i,r,s,o){if(t)return e.flags&256?(e.flags&=-257,i=a_(Error(Xe(422))),nm(n,e,o,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=e0({mode:"visible",children:i.children},r,0,null),s=ql(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&ju(e,n.child,null,o),e.child.memoizedState=nS(o),e.memoizedState=tS,s);if(!(e.mode&1))return nm(n,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(Xe(419)),i=a_(s,i,void 0),nm(n,e,o,i)}if(a=(o&n.childLanes)!==0,vr||a){if(i=Si,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Go(n,r),Ns(i,n,r,-1))}return Dw(),i=a_(Error(Xe(421))),nm(n,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=oO.bind(null,n),r._reactRetry=e,null):(n=s.treeContext,zr=Na(r.nextSibling),Br=e,kn=!0,bs=null,n!==null&&(rs[ss++]=No,rs[ss++]=Do,rs[ss++]=tc,No=n.id,Do=n.overflow,tc=e),e=Cw(e,i.children),e.flags|=4096,e)}function TT(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),$x(n.return,e,t)}function l_(n,e,t,i,r){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=t,s.tailMode=r)}function I2(n,e,t){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(Ji(n,e,i.children,t),i=Un.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&TT(n,t,e);else if(n.tag===19)TT(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(bn(Un,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&Gg(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),l_(e,!1,r,t,s);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&Gg(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}l_(e,!0,t,null,s);break;case"together":l_(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function pg(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Wo(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),ic|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(Xe(153));if(e.child!==null){for(n=e.child,t=Ua(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Ua(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function Yk(n,e,t){switch(e.tag){case 3:b2(e),Wu();break;case 5:t2(e);break;case 1:_r(e.type)&&Ug(e);break;case 4:xw(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;bn(Bg,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(bn(Un,Un.current&1),e.flags|=128,null):t&e.child.childLanes?C2(n,e,t):(bn(Un,Un.current&1),n=Wo(n,e,t),n!==null?n.sibling:null);bn(Un,Un.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return I2(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),bn(Un,Un.current),i)break;return null;case 22:case 23:return e.lanes=0,T2(n,e,t)}return Wo(n,e,t)}var R2,iS,P2,L2;R2=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};iS=function(){};P2=function(n,e,t,i){var r=n.memoizedProps;if(r!==i){n=e.stateNode,Ul(eo.current);var s=null;switch(t){case"input":r=Tx(n,r),i=Tx(n,i),s=[];break;case"select":r=Vn({},r,{value:void 0}),i=Vn({},i,{value:void 0}),s=[];break;case"textarea":r=Cx(n,r),i=Cx(n,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=kg)}Rx(t,i);var o;t=null;for(h in r)if(!i.hasOwnProperty(h)&&r.hasOwnProperty(h)&&r[h]!=null)if(h==="style"){var a=r[h];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(Vf.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in i){var c=i[h];if(a=r!=null?r[h]:void 0,i.hasOwnProperty(h)&&c!==a&&(c!=null||a!=null))if(h==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(s||(s=[]),s.push(h,t)),t=c;else h==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(h,c)):h==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(h,""+c):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(Vf.hasOwnProperty(h)?(c!=null&&h==="onScroll"&&Pn("scroll",n),s||a===c||(s=[])):(s=s||[]).push(h,c))}t&&(s=s||[]).push("style",t);var h=s;(e.updateQueue=h)&&(e.flags|=4)}};L2=function(n,e,t,i){t!==i&&(e.flags|=4)};function jh(n,e){if(!kn)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function Oi(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function $k(n,e,t){var i=e.pendingProps;switch(dw(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Oi(e),null;case 1:return _r(e.type)&&Og(),Oi(e),null;case 3:return i=e.stateNode,Xu(),Nn(yr),Nn(Wi),ww(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(em(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,bs!==null&&(hS(bs),bs=null))),iS(n,e),Oi(e),null;case 5:Sw(e);var r=Ul(ed.current);if(t=e.type,n!==null&&e.stateNode!=null)P2(n,e,t,i,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(Xe(166));return Oi(e),null}if(n=Ul(eo.current),em(e)){i=e.stateNode,t=e.type;var s=e.memoizedProps;switch(i[Ks]=e,i[Jf]=s,n=(e.mode&1)!==0,t){case"dialog":Pn("cancel",i),Pn("close",i);break;case"iframe":case"object":case"embed":Pn("load",i);break;case"video":case"audio":for(r=0;r<pf.length;r++)Pn(pf[r],i);break;case"source":Pn("error",i);break;case"img":case"image":case"link":Pn("error",i),Pn("load",i);break;case"details":Pn("toggle",i);break;case"input":DE(i,s),Pn("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Pn("invalid",i);break;case"textarea":OE(i,s),Pn("invalid",i)}Rx(t,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Qp(i.textContent,a,n),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Qp(i.textContent,a,n),r=["children",""+a]):Vf.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Pn("scroll",i)}switch(t){case"input":jp(i),kE(i,s,!0);break;case"textarea":jp(i),UE(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=kg)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=oI(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=o.createElement(t,{is:i.is}):(n=o.createElement(t),t==="select"&&(o=n,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):n=o.createElementNS(n,t),n[Ks]=e,n[Jf]=i,R2(n,e,!1,!1),e.stateNode=n;e:{switch(o=Px(t,i),t){case"dialog":Pn("cancel",n),Pn("close",n),r=i;break;case"iframe":case"object":case"embed":Pn("load",n),r=i;break;case"video":case"audio":for(r=0;r<pf.length;r++)Pn(pf[r],n);r=i;break;case"source":Pn("error",n),r=i;break;case"img":case"image":case"link":Pn("error",n),Pn("load",n),r=i;break;case"details":Pn("toggle",n),r=i;break;case"input":DE(n,i),r=Tx(n,i),Pn("invalid",n);break;case"option":r=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},r=Vn({},i,{value:void 0}),Pn("invalid",n);break;case"textarea":OE(n,i),r=Cx(n,i),Pn("invalid",n);break;default:r=i}Rx(t,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?cI(n,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&aI(n,c)):s==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&Gf(n,c):typeof c=="number"&&Gf(n,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Vf.hasOwnProperty(s)?c!=null&&s==="onScroll"&&Pn("scroll",n):c!=null&&JS(n,s,c,o))}switch(t){case"input":jp(n),kE(n,i,!1);break;case"textarea":jp(n),UE(n);break;case"option":i.value!=null&&n.setAttribute("value",""+Ba(i.value));break;case"select":n.multiple=!!i.multiple,s=i.value,s!=null?Iu(n,!!i.multiple,s,!1):i.defaultValue!=null&&Iu(n,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=kg)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Oi(e),null;case 6:if(n&&e.stateNode!=null)L2(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(Xe(166));if(t=Ul(ed.current),Ul(eo.current),em(e)){if(i=e.stateNode,t=e.memoizedProps,i[Ks]=e,(s=i.nodeValue!==t)&&(n=Br,n!==null))switch(n.tag){case 3:Qp(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Qp(i.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[Ks]=e,e.stateNode=i}return Oi(e),null;case 13:if(Nn(Un),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(kn&&zr!==null&&e.mode&1&&!(e.flags&128))KI(),Wu(),e.flags|=98560,s=!1;else if(s=em(e),i!==null&&i.dehydrated!==null){if(n===null){if(!s)throw Error(Xe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Xe(317));s[Ks]=e}else Wu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Oi(e),s=!1}else bs!==null&&(hS(bs),bs=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||Un.current&1?hi===0&&(hi=3):Dw())),e.updateQueue!==null&&(e.flags|=4),Oi(e),null);case 4:return Xu(),iS(n,e),n===null&&Kf(e.stateNode.containerInfo),Oi(e),null;case 10:return vw(e.type._context),Oi(e),null;case 17:return _r(e.type)&&Og(),Oi(e),null;case 19:if(Nn(Un),s=e.memoizedState,s===null)return Oi(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)jh(s,!1);else{if(hi!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Gg(n),o!==null){for(e.flags|=128,jh(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)s=t,n=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return bn(Un,Un.current&1|2),e.child}n=n.sibling}s.tail!==null&&Zn()>Yu&&(e.flags|=128,i=!0,jh(s,!1),e.lanes=4194304)}else{if(!i)if(n=Gg(o),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),jh(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!kn)return Oi(e),null}else 2*Zn()-s.renderingStartTime>Yu&&t!==1073741824&&(e.flags|=128,i=!0,jh(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Zn(),e.sibling=null,t=Un.current,bn(Un,i?t&1|2:t&1),e):(Oi(e),null);case 22:case 23:return Nw(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?kr&1073741824&&(Oi(e),e.subtreeFlags&6&&(e.flags|=8192)):Oi(e),null;case 24:return null;case 25:return null}throw Error(Xe(156,e.tag))}function Kk(n,e){switch(dw(e),e.tag){case 1:return _r(e.type)&&Og(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Xu(),Nn(yr),Nn(Wi),ww(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Sw(e),null;case 13:if(Nn(Un),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(Xe(340));Wu()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Nn(Un),null;case 4:return Xu(),null;case 10:return vw(e.type._context),null;case 22:case 23:return Nw(),null;case 24:return null;default:return null}}var im=!1,Bi=!1,Zk=typeof WeakSet=="function"?WeakSet:Set,ht=null;function xu(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){jn(n,e,i)}else t.current=null}function rS(n,e,t){try{t()}catch(i){jn(n,e,i)}}var AT=!1;function Jk(n,e){if(Hx=Lg,n=UI(),hw(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,c=-1,h=0,f=0,d=n,m=null;t:for(;;){for(var v;d!==t||r!==0&&d.nodeType!==3||(a=o+r),d!==s||i!==0&&d.nodeType!==3||(c=o+i),d.nodeType===3&&(o+=d.nodeValue.length),(v=d.firstChild)!==null;)m=d,d=v;for(;;){if(d===n)break t;if(m===t&&++h===r&&(a=o),m===s&&++f===i&&(c=o),(v=d.nextSibling)!==null)break;d=m,m=d.parentNode}d=v}t=a===-1||c===-1?null:{start:a,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(Vx={focusedElem:n,selectionRange:t},Lg=!1,ht=e;ht!==null;)if(e=ht,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,ht=n;else for(;ht!==null;){e=ht;try{var _=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(_!==null){var E=_.memoizedProps,S=_.memoizedState,y=e.stateNode,w=y.getSnapshotBeforeUpdate(e.elementType===e.type?E:Es(e.type,E),S);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var M=e.stateNode.containerInfo;M.nodeType===1?M.textContent="":M.nodeType===9&&M.documentElement&&M.removeChild(M.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Xe(163))}}catch(R){jn(e,e.return,R)}if(n=e.sibling,n!==null){n.return=e.return,ht=n;break}ht=e.return}return _=AT,AT=!1,_}function Mf(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&n)===n){var s=r.destroy;r.destroy=void 0,s!==void 0&&rS(e,t,s)}r=r.next}while(r!==i)}}function Jv(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function sS(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function N2(n){var e=n.alternate;e!==null&&(n.alternate=null,N2(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Ks],delete e[Jf],delete e[jx],delete e[Dk],delete e[kk])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function D2(n){return n.tag===5||n.tag===3||n.tag===4}function bT(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||D2(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function oS(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=kg));else if(i!==4&&(n=n.child,n!==null))for(oS(n,e,t),n=n.sibling;n!==null;)oS(n,e,t),n=n.sibling}function aS(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(aS(n,e,t),n=n.sibling;n!==null;)aS(n,e,t),n=n.sibling}var Ei=null,As=!1;function sa(n,e,t){for(t=t.child;t!==null;)k2(n,e,t),t=t.sibling}function k2(n,e,t){if(Qs&&typeof Qs.onCommitFiberUnmount=="function")try{Qs.onCommitFiberUnmount(Wv,t)}catch{}switch(t.tag){case 5:Bi||xu(t,e);case 6:var i=Ei,r=As;Ei=null,sa(n,e,t),Ei=i,As=r,Ei!==null&&(As?(n=Ei,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Ei.removeChild(t.stateNode));break;case 18:Ei!==null&&(As?(n=Ei,t=t.stateNode,n.nodeType===8?t_(n.parentNode,t):n.nodeType===1&&t_(n,t),qf(n)):t_(Ei,t.stateNode));break;case 4:i=Ei,r=As,Ei=t.stateNode.containerInfo,As=!0,sa(n,e,t),Ei=i,As=r;break;case 0:case 11:case 14:case 15:if(!Bi&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&rS(t,e,o),r=r.next}while(r!==i)}sa(n,e,t);break;case 1:if(!Bi&&(xu(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){jn(t,e,a)}sa(n,e,t);break;case 21:sa(n,e,t);break;case 22:t.mode&1?(Bi=(i=Bi)||t.memoizedState!==null,sa(n,e,t),Bi=i):sa(n,e,t);break;default:sa(n,e,t)}}function CT(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new Zk),e.forEach(function(i){var r=aO.bind(null,n,i);t.has(i)||(t.add(i),i.then(r,r))})}}function _s(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var r=t[i];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ei=a.stateNode,As=!1;break e;case 3:Ei=a.stateNode.containerInfo,As=!0;break e;case 4:Ei=a.stateNode.containerInfo,As=!0;break e}a=a.return}if(Ei===null)throw Error(Xe(160));k2(s,o,r),Ei=null,As=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(h){jn(r,e,h)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)O2(e,n),e=e.sibling}function O2(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(_s(e,n),qs(n),i&4){try{Mf(3,n,n.return),Jv(3,n)}catch(E){jn(n,n.return,E)}try{Mf(5,n,n.return)}catch(E){jn(n,n.return,E)}}break;case 1:_s(e,n),qs(n),i&512&&t!==null&&xu(t,t.return);break;case 5:if(_s(e,n),qs(n),i&512&&t!==null&&xu(t,t.return),n.flags&32){var r=n.stateNode;try{Gf(r,"")}catch(E){jn(n,n.return,E)}}if(i&4&&(r=n.stateNode,r!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&rI(r,s),Px(a,o);var h=Px(a,s);for(o=0;o<c.length;o+=2){var f=c[o],d=c[o+1];f==="style"?cI(r,d):f==="dangerouslySetInnerHTML"?aI(r,d):f==="children"?Gf(r,d):JS(r,f,d,h)}switch(a){case"input":Ax(r,s);break;case"textarea":sI(r,s);break;case"select":var m=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?Iu(r,!!s.multiple,v,!1):m!==!!s.multiple&&(s.defaultValue!=null?Iu(r,!!s.multiple,s.defaultValue,!0):Iu(r,!!s.multiple,s.multiple?[]:"",!1))}r[Jf]=s}catch(E){jn(n,n.return,E)}}break;case 6:if(_s(e,n),qs(n),i&4){if(n.stateNode===null)throw Error(Xe(162));r=n.stateNode,s=n.memoizedProps;try{r.nodeValue=s}catch(E){jn(n,n.return,E)}}break;case 3:if(_s(e,n),qs(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{qf(e.containerInfo)}catch(E){jn(n,n.return,E)}break;case 4:_s(e,n),qs(n);break;case 13:_s(e,n),qs(n),r=n.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(Pw=Zn())),i&4&&CT(n);break;case 22:if(f=t!==null&&t.memoizedState!==null,n.mode&1?(Bi=(h=Bi)||f,_s(e,n),Bi=h):_s(e,n),qs(n),i&8192){if(h=n.memoizedState!==null,(n.stateNode.isHidden=h)&&!f&&n.mode&1)for(ht=n,f=n.child;f!==null;){for(d=ht=f;ht!==null;){switch(m=ht,v=m.child,m.tag){case 0:case 11:case 14:case 15:Mf(4,m,m.return);break;case 1:xu(m,m.return);var _=m.stateNode;if(typeof _.componentWillUnmount=="function"){i=m,t=m.return;try{e=i,_.props=e.memoizedProps,_.state=e.memoizedState,_.componentWillUnmount()}catch(E){jn(i,t,E)}}break;case 5:xu(m,m.return);break;case 22:if(m.memoizedState!==null){RT(d);continue}}v!==null?(v.return=m,ht=v):RT(d)}f=f.sibling}e:for(f=null,d=n;;){if(d.tag===5){if(f===null){f=d;try{r=d.stateNode,h?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=lI("display",o))}catch(E){jn(n,n.return,E)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=h?"":d.memoizedProps}catch(E){jn(n,n.return,E)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:_s(e,n),qs(n),i&4&&CT(n);break;case 21:break;default:_s(e,n),qs(n)}}function qs(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(D2(t)){var i=t;break e}t=t.return}throw Error(Xe(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Gf(r,""),i.flags&=-33);var s=bT(n);aS(n,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=bT(n);oS(n,a,o);break;default:throw Error(Xe(161))}}catch(c){jn(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function Qk(n,e,t){ht=n,U2(n)}function U2(n,e,t){for(var i=(n.mode&1)!==0;ht!==null;){var r=ht,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||im;if(!o){var a=r.alternate,c=a!==null&&a.memoizedState!==null||Bi;a=im;var h=Bi;if(im=o,(Bi=c)&&!h)for(ht=r;ht!==null;)o=ht,c=o.child,o.tag===22&&o.memoizedState!==null?PT(r):c!==null?(c.return=o,ht=c):PT(r);for(;s!==null;)ht=s,U2(s),s=s.sibling;ht=r,im=a,Bi=h}IT(n)}else r.subtreeFlags&8772&&s!==null?(s.return=r,ht=s):IT(n)}}function IT(n){for(;ht!==null;){var e=ht;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Bi||Jv(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Bi)if(t===null)i.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:Es(e.type,t.memoizedProps);i.componentDidUpdate(r,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&dT(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}dT(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var h=e.alternate;if(h!==null){var f=h.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&qf(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Xe(163))}Bi||e.flags&512&&sS(e)}catch(m){jn(e,e.return,m)}}if(e===n){ht=null;break}if(t=e.sibling,t!==null){t.return=e.return,ht=t;break}ht=e.return}}function RT(n){for(;ht!==null;){var e=ht;if(e===n){ht=null;break}var t=e.sibling;if(t!==null){t.return=e.return,ht=t;break}ht=e.return}}function PT(n){for(;ht!==null;){var e=ht;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Jv(4,e)}catch(c){jn(e,t,c)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(c){jn(e,r,c)}}var s=e.return;try{sS(e)}catch(c){jn(e,s,c)}break;case 5:var o=e.return;try{sS(e)}catch(c){jn(e,o,c)}}}catch(c){jn(e,e.return,c)}if(e===n){ht=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ht=a;break}ht=e.return}}var eO=Math.ceil,Xg=$o.ReactCurrentDispatcher,Iw=$o.ReactCurrentOwner,cs=$o.ReactCurrentBatchConfig,on=0,Si=null,ai=null,bi=0,kr=0,Su=Xa(0),hi=0,rd=null,ic=0,Qv=0,Rw=0,Ef=null,gr=null,Pw=0,Yu=1/0,Io=null,qg=!1,lS=null,ka=null,rm=!1,ba=null,Yg=0,Tf=0,cS=null,mg=-1,gg=0;function tr(){return on&6?Zn():mg!==-1?mg:mg=Zn()}function Oa(n){return n.mode&1?on&2&&bi!==0?bi&-bi:Uk.transition!==null?(gg===0&&(gg=SI()),gg):(n=vn,n!==0||(n=window.event,n=n===void 0?16:CI(n.type)),n):1}function Ns(n,e,t,i){if(50<Tf)throw Tf=0,cS=null,Error(Xe(185));Ld(n,t,i),(!(on&2)||n!==Si)&&(n===Si&&(!(on&2)&&(Qv|=t),hi===4&&xa(n,bi)),xr(n,i),t===1&&on===0&&!(e.mode&1)&&(Yu=Zn()+500,$v&&qa()))}function xr(n,e){var t=n.callbackNode;UD(n,e);var i=Pg(n,n===Si?bi:0);if(i===0)t!==null&&BE(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&BE(t),e===1)n.tag===0?Ok(LT.bind(null,n)):qI(LT.bind(null,n)),Lk(function(){!(on&6)&&qa()}),t=null;else{switch(wI(i)){case 1:t=iw;break;case 4:t=_I;break;case 16:t=Rg;break;case 536870912:t=xI;break;default:t=Rg}t=j2(t,F2.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function F2(n,e){if(mg=-1,gg=0,on&6)throw Error(Xe(327));var t=n.callbackNode;if(Du()&&n.callbackNode!==t)return null;var i=Pg(n,n===Si?bi:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=$g(n,i);else{e=i;var r=on;on|=2;var s=B2();(Si!==n||bi!==e)&&(Io=null,Yu=Zn()+500,Xl(n,e));do try{iO();break}catch(a){z2(n,a)}while(!0);gw(),Xg.current=s,on=r,ai!==null?e=0:(Si=null,bi=0,e=hi)}if(e!==0){if(e===2&&(r=Ox(n),r!==0&&(i=r,e=uS(n,r))),e===1)throw t=rd,Xl(n,0),xa(n,i),xr(n,Zn()),t;if(e===6)xa(n,i);else{if(r=n.current.alternate,!(i&30)&&!tO(r)&&(e=$g(n,i),e===2&&(s=Ox(n),s!==0&&(i=s,e=uS(n,s))),e===1))throw t=rd,Xl(n,0),xa(n,i),xr(n,Zn()),t;switch(n.finishedWork=r,n.finishedLanes=i,e){case 0:case 1:throw Error(Xe(345));case 2:Cl(n,gr,Io);break;case 3:if(xa(n,i),(i&130023424)===i&&(e=Pw+500-Zn(),10<e)){if(Pg(n,0)!==0)break;if(r=n.suspendedLanes,(r&i)!==i){tr(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=Wx(Cl.bind(null,n,gr,Io),e);break}Cl(n,gr,Io);break;case 4:if(xa(n,i),(i&4194240)===i)break;for(e=n.eventTimes,r=-1;0<i;){var o=31-Ls(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=Zn()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*eO(i/1960))-i,10<i){n.timeoutHandle=Wx(Cl.bind(null,n,gr,Io),i);break}Cl(n,gr,Io);break;case 5:Cl(n,gr,Io);break;default:throw Error(Xe(329))}}}return xr(n,Zn()),n.callbackNode===t?F2.bind(null,n):null}function uS(n,e){var t=Ef;return n.current.memoizedState.isDehydrated&&(Xl(n,e).flags|=256),n=$g(n,e),n!==2&&(e=gr,gr=t,e!==null&&hS(e)),n}function hS(n){gr===null?gr=n:gr.push.apply(gr,n)}function tO(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var r=t[i],s=r.getSnapshot;r=r.value;try{if(!ks(s(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function xa(n,e){for(e&=~Rw,e&=~Qv,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Ls(e),i=1<<t;n[t]=-1,e&=~i}}function LT(n){if(on&6)throw Error(Xe(327));Du();var e=Pg(n,0);if(!(e&1))return xr(n,Zn()),null;var t=$g(n,e);if(n.tag!==0&&t===2){var i=Ox(n);i!==0&&(e=i,t=uS(n,i))}if(t===1)throw t=rd,Xl(n,0),xa(n,e),xr(n,Zn()),t;if(t===6)throw Error(Xe(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Cl(n,gr,Io),xr(n,Zn()),null}function Lw(n,e){var t=on;on|=1;try{return n(e)}finally{on=t,on===0&&(Yu=Zn()+500,$v&&qa())}}function rc(n){ba!==null&&ba.tag===0&&!(on&6)&&Du();var e=on;on|=1;var t=cs.transition,i=vn;try{if(cs.transition=null,vn=1,n)return n()}finally{vn=i,cs.transition=t,on=e,!(on&6)&&qa()}}function Nw(){kr=Su.current,Nn(Su)}function Xl(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,Pk(t)),ai!==null)for(t=ai.return;t!==null;){var i=t;switch(dw(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Og();break;case 3:Xu(),Nn(yr),Nn(Wi),ww();break;case 5:Sw(i);break;case 4:Xu();break;case 13:Nn(Un);break;case 19:Nn(Un);break;case 10:vw(i.type._context);break;case 22:case 23:Nw()}t=t.return}if(Si=n,ai=n=Ua(n.current,null),bi=kr=e,hi=0,rd=null,Rw=Qv=ic=0,gr=Ef=null,Ol!==null){for(e=0;e<Ol.length;e++)if(t=Ol[e],i=t.interleaved,i!==null){t.interleaved=null;var r=i.next,s=t.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}t.pending=i}Ol=null}return n}function z2(n,e){do{var t=ai;try{if(gw(),fg.current=jg,Wg){for(var i=Hn.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}Wg=!1}if(nc=0,yi=ui=Hn=null,wf=!1,td=0,Iw.current=null,t===null||t.return===null){hi=1,rd=e,ai=null;break}e:{var s=n,o=t.return,a=t,c=e;if(e=bi,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var h=c,f=a,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var m=f.alternate;m?(f.updateQueue=m.updateQueue,f.memoizedState=m.memoizedState,f.lanes=m.lanes):(f.updateQueue=null,f.memoizedState=null)}var v=_T(o);if(v!==null){v.flags&=-257,xT(v,o,a,s,e),v.mode&1&&yT(s,h,e),e=v,c=h;var _=e.updateQueue;if(_===null){var E=new Set;E.add(c),e.updateQueue=E}else _.add(c);break e}else{if(!(e&1)){yT(s,h,e),Dw();break e}c=Error(Xe(426))}}else if(kn&&a.mode&1){var S=_T(o);if(S!==null){!(S.flags&65536)&&(S.flags|=256),xT(S,o,a,s,e),pw(qu(c,a));break e}}s=c=qu(c,a),hi!==4&&(hi=2),Ef===null?Ef=[s]:Ef.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=w2(s,c,e);fT(s,y);break e;case 1:a=c;var w=s.type,M=s.stateNode;if(!(s.flags&128)&&(typeof w.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(ka===null||!ka.has(M)))){s.flags|=65536,e&=-e,s.lanes|=e;var R=M2(s,a,e);fT(s,R);break e}}s=s.return}while(s!==null)}V2(t)}catch(z){e=z,ai===t&&t!==null&&(ai=t=t.return);continue}break}while(!0)}function B2(){var n=Xg.current;return Xg.current=jg,n===null?jg:n}function Dw(){(hi===0||hi===3||hi===2)&&(hi=4),Si===null||!(ic&268435455)&&!(Qv&268435455)||xa(Si,bi)}function $g(n,e){var t=on;on|=2;var i=B2();(Si!==n||bi!==e)&&(Io=null,Xl(n,e));do try{nO();break}catch(r){z2(n,r)}while(!0);if(gw(),on=t,Xg.current=i,ai!==null)throw Error(Xe(261));return Si=null,bi=0,hi}function nO(){for(;ai!==null;)H2(ai)}function iO(){for(;ai!==null&&!CD();)H2(ai)}function H2(n){var e=W2(n.alternate,n,kr);n.memoizedProps=n.pendingProps,e===null?V2(n):ai=e,Iw.current=null}function V2(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=Kk(t,e),t!==null){t.flags&=32767,ai=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{hi=6,ai=null;return}}else if(t=$k(t,e,kr),t!==null){ai=t;return}if(e=e.sibling,e!==null){ai=e;return}ai=e=n}while(e!==null);hi===0&&(hi=5)}function Cl(n,e,t){var i=vn,r=cs.transition;try{cs.transition=null,vn=1,rO(n,e,t,i)}finally{cs.transition=r,vn=i}return null}function rO(n,e,t,i){do Du();while(ba!==null);if(on&6)throw Error(Xe(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(Xe(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(FD(n,s),n===Si&&(ai=Si=null,bi=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||rm||(rm=!0,j2(Rg,function(){return Du(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=cs.transition,cs.transition=null;var o=vn;vn=1;var a=on;on|=4,Iw.current=null,Jk(n,t),O2(t,n),Ek(Vx),Lg=!!Hx,Vx=Hx=null,n.current=t,Qk(t),ID(),on=a,vn=o,cs.transition=s}else n.current=t;if(rm&&(rm=!1,ba=n,Yg=r),s=n.pendingLanes,s===0&&(ka=null),LD(t.stateNode),xr(n,Zn()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],i(r.value,{componentStack:r.stack,digest:r.digest});if(qg)throw qg=!1,n=lS,lS=null,n;return Yg&1&&n.tag!==0&&Du(),s=n.pendingLanes,s&1?n===cS?Tf++:(Tf=0,cS=n):Tf=0,qa(),null}function Du(){if(ba!==null){var n=wI(Yg),e=cs.transition,t=vn;try{if(cs.transition=null,vn=16>n?16:n,ba===null)var i=!1;else{if(n=ba,ba=null,Yg=0,on&6)throw Error(Xe(331));var r=on;for(on|=4,ht=n.current;ht!==null;){var s=ht,o=s.child;if(ht.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var h=a[c];for(ht=h;ht!==null;){var f=ht;switch(f.tag){case 0:case 11:case 15:Mf(8,f,s)}var d=f.child;if(d!==null)d.return=f,ht=d;else for(;ht!==null;){f=ht;var m=f.sibling,v=f.return;if(N2(f),f===h){ht=null;break}if(m!==null){m.return=v,ht=m;break}ht=v}}}var _=s.alternate;if(_!==null){var E=_.child;if(E!==null){_.child=null;do{var S=E.sibling;E.sibling=null,E=S}while(E!==null)}}ht=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ht=o;else e:for(;ht!==null;){if(s=ht,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Mf(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,ht=y;break e}ht=s.return}}var w=n.current;for(ht=w;ht!==null;){o=ht;var M=o.child;if(o.subtreeFlags&2064&&M!==null)M.return=o,ht=M;else e:for(o=w;ht!==null;){if(a=ht,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Jv(9,a)}}catch(z){jn(a,a.return,z)}if(a===o){ht=null;break e}var R=a.sibling;if(R!==null){R.return=a.return,ht=R;break e}ht=a.return}}if(on=r,qa(),Qs&&typeof Qs.onPostCommitFiberRoot=="function")try{Qs.onPostCommitFiberRoot(Wv,n)}catch{}i=!0}return i}finally{vn=t,cs.transition=e}}return!1}function NT(n,e,t){e=qu(t,e),e=w2(n,e,1),n=Da(n,e,1),e=tr(),n!==null&&(Ld(n,1,e),xr(n,e))}function jn(n,e,t){if(n.tag===3)NT(n,n,t);else for(;e!==null;){if(e.tag===3){NT(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(ka===null||!ka.has(i))){n=qu(t,n),n=M2(e,n,1),e=Da(e,n,1),n=tr(),e!==null&&(Ld(e,1,n),xr(e,n));break}}e=e.return}}function sO(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=tr(),n.pingedLanes|=n.suspendedLanes&t,Si===n&&(bi&t)===t&&(hi===4||hi===3&&(bi&130023424)===bi&&500>Zn()-Pw?Xl(n,0):Rw|=t),xr(n,e)}function G2(n,e){e===0&&(n.mode&1?(e=Yp,Yp<<=1,!(Yp&130023424)&&(Yp=4194304)):e=1);var t=tr();n=Go(n,e),n!==null&&(Ld(n,e,t),xr(n,t))}function oO(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),G2(n,t)}function aO(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(Xe(314))}i!==null&&i.delete(e),G2(n,t)}var W2;W2=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||yr.current)vr=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return vr=!1,Yk(n,e,t);vr=!!(n.flags&131072)}else vr=!1,kn&&e.flags&1048576&&YI(e,zg,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;pg(n,e),n=e.pendingProps;var r=Gu(e,Wi.current);Nu(e,t),r=Ew(null,e,i,n,r,t);var s=Tw();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_r(i)?(s=!0,Ug(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,_w(e),r.updater=Zv,e.stateNode=r,r._reactInternals=e,Zx(e,i,n,t),e=eS(null,e,i,!0,s,t)):(e.tag=0,kn&&s&&fw(e),Ji(null,e,r,t),e=e.child),e;case 16:i=e.elementType;e:{switch(pg(n,e),n=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=cO(i),n=Es(i,n),r){case 0:e=Qx(null,e,i,n,t);break e;case 1:e=MT(null,e,i,n,t);break e;case 11:e=ST(null,e,i,n,t);break e;case 14:e=wT(null,e,i,Es(i.type,n),t);break e}throw Error(Xe(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Es(i,r),Qx(n,e,i,r,t);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Es(i,r),MT(n,e,i,r,t);case 3:e:{if(b2(e),n===null)throw Error(Xe(387));i=e.pendingProps,s=e.memoizedState,r=s.element,e2(n,e),Vg(e,i,null,t);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=qu(Error(Xe(423)),e),e=ET(n,e,i,t,r);break e}else if(i!==r){r=qu(Error(Xe(424)),e),e=ET(n,e,i,t,r);break e}else for(zr=Na(e.stateNode.containerInfo.firstChild),Br=e,kn=!0,bs=null,t=JI(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Wu(),i===r){e=Wo(n,e,t);break e}Ji(n,e,i,t)}e=e.child}return e;case 5:return t2(e),n===null&&Yx(e),i=e.type,r=e.pendingProps,s=n!==null?n.memoizedProps:null,o=r.children,Gx(i,r)?o=null:s!==null&&Gx(i,s)&&(e.flags|=32),A2(n,e),Ji(n,e,o,t),e.child;case 6:return n===null&&Yx(e),null;case 13:return C2(n,e,t);case 4:return xw(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=ju(e,null,i,t):Ji(n,e,i,t),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Es(i,r),ST(n,e,i,r,t);case 7:return Ji(n,e,e.pendingProps,t),e.child;case 8:return Ji(n,e,e.pendingProps.children,t),e.child;case 12:return Ji(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,bn(Bg,i._currentValue),i._currentValue=o,s!==null)if(ks(s.value,o)){if(s.children===r.children&&!yr.current){e=Wo(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===i){if(s.tag===1){c=zo(-1,t&-t),c.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var f=h.pending;f===null?c.next=c:(c.next=f.next,f.next=c),h.pending=c}}s.lanes|=t,c=s.alternate,c!==null&&(c.lanes|=t),$x(s.return,t,e),a.lanes|=t;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Xe(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),$x(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Ji(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Nu(e,t),r=us(r),i=i(r),e.flags|=1,Ji(n,e,i,t),e.child;case 14:return i=e.type,r=Es(i,e.pendingProps),r=Es(i.type,r),wT(n,e,i,r,t);case 15:return E2(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Es(i,r),pg(n,e),e.tag=1,_r(i)?(n=!0,Ug(e)):n=!1,Nu(e,t),S2(e,i,r),Zx(e,i,r,t),eS(null,e,i,!0,n,t);case 19:return I2(n,e,t);case 22:return T2(n,e,t)}throw Error(Xe(156,e.tag))};function j2(n,e){return yI(n,e)}function lO(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ls(n,e,t,i){return new lO(n,e,t,i)}function kw(n){return n=n.prototype,!(!n||!n.isReactComponent)}function cO(n){if(typeof n=="function")return kw(n)?1:0;if(n!=null){if(n=n.$$typeof,n===ew)return 11;if(n===tw)return 14}return 2}function Ua(n,e){var t=n.alternate;return t===null?(t=ls(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function vg(n,e,t,i,r,s){var o=2;if(i=n,typeof n=="function")kw(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case hu:return ql(t.children,r,s,e);case QS:o=8,r|=8;break;case Sx:return n=ls(12,t,e,r|2),n.elementType=Sx,n.lanes=s,n;case wx:return n=ls(13,t,e,r),n.elementType=wx,n.lanes=s,n;case Mx:return n=ls(19,t,e,r),n.elementType=Mx,n.lanes=s,n;case tI:return e0(t,r,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case QC:o=10;break e;case eI:o=9;break e;case ew:o=11;break e;case tw:o=14;break e;case ga:o=16,i=null;break e}throw Error(Xe(130,n==null?n:typeof n,""))}return e=ls(o,t,e,r),e.elementType=n,e.type=i,e.lanes=s,e}function ql(n,e,t,i){return n=ls(7,n,i,e),n.lanes=t,n}function e0(n,e,t,i){return n=ls(22,n,i,e),n.elementType=tI,n.lanes=t,n.stateNode={isHidden:!1},n}function c_(n,e,t){return n=ls(6,n,null,e),n.lanes=t,n}function u_(n,e,t){return e=ls(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function uO(n,e,t,i,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wy(0),this.expirationTimes=Wy(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wy(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Ow(n,e,t,i,r,s,o,a,c){return n=new uO(n,e,t,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=ls(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},_w(s),n}function hO(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:uu,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function X2(n){if(!n)return Ha;n=n._reactInternals;e:{if(dc(n)!==n||n.tag!==1)throw Error(Xe(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_r(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Xe(171))}if(n.tag===1){var t=n.type;if(_r(t))return XI(n,t,e)}return e}function q2(n,e,t,i,r,s,o,a,c){return n=Ow(t,i,!0,n,r,s,o,a,c),n.context=X2(null),t=n.current,i=tr(),r=Oa(t),s=zo(i,r),s.callback=e??null,Da(t,s,r),n.current.lanes=r,Ld(n,r,i),xr(n,i),n}function t0(n,e,t,i){var r=e.current,s=tr(),o=Oa(r);return t=X2(t),e.context===null?e.context=t:e.pendingContext=t,e=zo(s,o),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=Da(r,e,o),n!==null&&(Ns(n,r,o,s),hg(n,r,o)),o}function Kg(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function DT(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Uw(n,e){DT(n,e),(n=n.alternate)&&DT(n,e)}function fO(){return null}var Y2=typeof reportError=="function"?reportError:function(n){console.error(n)};function Fw(n){this._internalRoot=n}n0.prototype.render=Fw.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(Xe(409));t0(n,e,null,null)};n0.prototype.unmount=Fw.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;rc(function(){t0(null,n,null,null)}),e[Vo]=null}};function n0(n){this._internalRoot=n}n0.prototype.unstable_scheduleHydration=function(n){if(n){var e=TI();n={blockedOn:null,target:n,priority:e};for(var t=0;t<_a.length&&e!==0&&e<_a[t].priority;t++);_a.splice(t,0,n),t===0&&bI(n)}};function zw(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function i0(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function kT(){}function dO(n,e,t,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var h=Kg(o);s.call(h)}}var o=q2(e,i,n,0,null,!1,!1,"",kT);return n._reactRootContainer=o,n[Vo]=o.current,Kf(n.nodeType===8?n.parentNode:n),rc(),o}for(;r=n.lastChild;)n.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var h=Kg(c);a.call(h)}}var c=Ow(n,0,!1,null,null,!1,!1,"",kT);return n._reactRootContainer=c,n[Vo]=c.current,Kf(n.nodeType===8?n.parentNode:n),rc(function(){t0(e,c,t,i)}),c}function r0(n,e,t,i,r){var s=t._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var c=Kg(o);a.call(c)}}t0(e,o,n,r)}else o=dO(t,e,n,r,i);return Kg(o)}MI=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=df(e.pendingLanes);t!==0&&(rw(e,t|1),xr(e,Zn()),!(on&6)&&(Yu=Zn()+500,qa()))}break;case 13:rc(function(){var i=Go(n,1);if(i!==null){var r=tr();Ns(i,n,1,r)}}),Uw(n,1)}};sw=function(n){if(n.tag===13){var e=Go(n,134217728);if(e!==null){var t=tr();Ns(e,n,134217728,t)}Uw(n,134217728)}};EI=function(n){if(n.tag===13){var e=Oa(n),t=Go(n,e);if(t!==null){var i=tr();Ns(t,n,e,i)}Uw(n,e)}};TI=function(){return vn};AI=function(n,e){var t=vn;try{return vn=n,e()}finally{vn=t}};Nx=function(n,e,t){switch(e){case"input":if(Ax(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var r=Yv(i);if(!r)throw Error(Xe(90));iI(i),Ax(i,r)}}}break;case"textarea":sI(n,t);break;case"select":e=t.value,e!=null&&Iu(n,!!t.multiple,e,!1)}};fI=Lw;dI=rc;var pO={usingClientEntryPoint:!1,Events:[Dd,mu,Yv,uI,hI,Lw]},Xh={findFiberByHostInstance:kl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},mO={bundleType:Xh.bundleType,version:Xh.version,rendererPackageName:Xh.rendererPackageName,rendererConfig:Xh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$o.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=gI(n),n===null?null:n.stateNode},findFiberByHostInstance:Xh.findFiberByHostInstance||fO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var sm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!sm.isDisabled&&sm.supportsFiber)try{Wv=sm.inject(mO),Qs=sm}catch{}}qr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pO;qr.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zw(e))throw Error(Xe(200));return hO(n,e,null,t)};qr.createRoot=function(n,e){if(!zw(n))throw Error(Xe(299));var t=!1,i="",r=Y2;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Ow(n,1,!1,null,null,t,!1,i,r),n[Vo]=e.current,Kf(n.nodeType===8?n.parentNode:n),new Fw(e)};qr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(Xe(188)):(n=Object.keys(n).join(","),Error(Xe(268,n)));return n=gI(e),n=n===null?null:n.stateNode,n};qr.flushSync=function(n){return rc(n)};qr.hydrate=function(n,e,t){if(!i0(e))throw Error(Xe(200));return r0(null,n,e,!0,t)};qr.hydrateRoot=function(n,e,t){if(!zw(n))throw Error(Xe(405));var i=t!=null&&t.hydratedSources||null,r=!1,s="",o=Y2;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=q2(e,null,n,1,t??null,r,!1,s,o),n[Vo]=e.current,Kf(n),i)for(n=0;n<i.length;n++)t=i[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new n0(e)};qr.render=function(n,e,t){if(!i0(e))throw Error(Xe(200));return r0(null,n,e,!1,t)};qr.unmountComponentAtNode=function(n){if(!i0(n))throw Error(Xe(40));return n._reactRootContainer?(rc(function(){r0(null,null,n,!1,function(){n._reactRootContainer=null,n[Vo]=null})}),!0):!1};qr.unstable_batchedUpdates=Lw;qr.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!i0(t))throw Error(Xe(200));if(n==null||n._reactInternals===void 0)throw Error(Xe(38));return r0(n,e,t,!1,i)};qr.version="18.3.1-next-f1338f8080-20240426";function $2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE($2)}catch(n){console.error(n)}}$2(),$C.exports=qr;var gO=$C.exports,K2,OT=gO;K2=OT.createRoot,OT.hydrateRoot;/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const ch="168",Il={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Rl={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Z2=0,fS=1,J2=2,vO=3,Q2=0,s0=1,Af=2,Ts=3,jo=0,Hi=1,Is=2,to=0,Yl=1,dS=2,pS=3,mS=4,eR=5,Sa=100,tR=101,nR=102,iR=103,rR=104,sR=200,oR=201,aR=202,lR=203,Zg=204,Jg=205,cR=206,uR=207,hR=208,fR=209,dR=210,pR=211,mR=212,gR=213,vR=214,yR=0,_R=1,xR=2,sd=3,SR=4,wR=5,MR=6,ER=7,Od=0,TR=1,AR=2,no=0,bR=1,CR=2,IR=3,Bw=4,RR=5,PR=6,LR=7,gS="attached",NR="detached",Va=300,oo=301,Ga=302,$u=303,od=304,uh=306,ad=1e3,li=1001,ld=1002,_i=1003,Hw=1004,yO=1004,wu=1005,_O=1005,mn=1006,bf=1007,xO=1007,Zs=1008,vS=1008,Mr=1009,o0=1010,a0=1011,Ku=1012,Ud=1013,ao=1014,zn=1015,xi=1016,l0=1017,c0=1018,sc=1020,Vw=35902,Gw=1021,Ww=1022,Qn=1023,jw=1024,Xw=1025,$l=1026,oc=1027,Fd=1028,zd=1029,qw=1030,u0=1031,SO=1032,h0=1033,Cf=33776,If=33777,Rf=33778,Pf=33779,Qg=35840,ev=35841,tv=35842,nv=35843,iv=36196,rv=37492,sv=37496,ov=37808,av=37809,lv=37810,cv=37811,uv=37812,hv=37813,fv=37814,dv=37815,pv=37816,mv=37817,gv=37818,vv=37819,yv=37820,_v=37821,Lf=36492,xv=36494,Sv=36495,Yw=36283,wv=36284,Mv=36285,Ev=36286,DR=2200,kR=2201,OR=2202,cd=2300,Tv=2301,yg=2302,Fl=2400,zl=2401,ud=2402,f0=2500,$w=2501,wO=0,MO=1,EO=2,UR=3200,FR=3201,TO=3202,AO=3203,Ya=0,zR=1,Po="",Ur="srgb",fs="srgb-linear",d0="display-p3",Bd="display-p3-linear",hd="linear",Tn="srgb",fd="rec709",dd="p3",bO=0,Pl=7680,CO=7681,IO=7682,RO=7683,PO=34055,LO=34056,NO=5386,DO=512,kO=513,OO=514,UO=515,FO=516,zO=517,BO=518,yS=519,BR=512,HR=513,VR=514,Kw=515,GR=516,WR=517,jR=518,XR=519,pd=35044,HO=35048,VO=35040,GO=35045,WO=35049,jO=35041,XO=35046,qO=35050,YO=35042,$O="100",_S="300 es",Js=2e3,md=2001;let co=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}};const Ui=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let UT=1234567;const Kl=Math.PI/180,Zu=180/Math.PI;function Hr(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Ui[n&255]+Ui[n>>8&255]+Ui[n>>16&255]+Ui[n>>24&255]+"-"+Ui[e&255]+Ui[e>>8&255]+"-"+Ui[e>>16&15|64]+Ui[e>>24&255]+"-"+Ui[t&63|128]+Ui[t>>8&255]+"-"+Ui[t>>16&255]+Ui[t>>24&255]+Ui[i&255]+Ui[i>>8&255]+Ui[i>>16&255]+Ui[i>>24&255]).toLowerCase()}function Xn(n,e,t){return Math.max(e,Math.min(t,n))}function Zw(n,e){return(n%e+e)%e}function KO(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function ZO(n,e,t){return n!==e?(t-n)/(e-n):0}function Nf(n,e,t){return(1-t)*n+t*e}function JO(n,e,t,i){return Nf(n,e,1-Math.exp(-t*i))}function QO(n,e=1){return e-Math.abs(Zw(n,e*2)-e)}function eU(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function tU(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function nU(n,e){return n+Math.floor(Math.random()*(e-n+1))}function iU(n,e){return n+Math.random()*(e-n)}function rU(n){return n*(.5-Math.random())}function sU(n){n!==void 0&&(UT=n);let e=UT+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function oU(n){return n*Kl}function aU(n){return n*Zu}function lU(n){return(n&n-1)===0&&n!==0}function cU(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function uU(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function hU(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),c=o(t/2),h=s((e+i)/2),f=o((e+i)/2),d=s((e-i)/2),m=o((e-i)/2),v=s((i-e)/2),_=o((i-e)/2);switch(r){case"XYX":n.set(a*f,c*d,c*m,a*h);break;case"YZY":n.set(c*m,a*f,c*d,a*h);break;case"ZXZ":n.set(c*d,c*m,a*f,a*h);break;case"XZX":n.set(a*f,c*_,c*v,a*h);break;case"YXY":n.set(c*v,a*f,c*_,a*h);break;case"ZYZ":n.set(c*_,c*v,a*f,a*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function er(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Gt(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const Av={DEG2RAD:Kl,RAD2DEG:Zu,generateUUID:Hr,clamp:Xn,euclideanModulo:Zw,mapLinear:KO,inverseLerp:ZO,lerp:Nf,damp:JO,pingpong:QO,smoothstep:eU,smootherstep:tU,randInt:nU,randFloat:iU,randFloatSpread:rU,seededRandom:sU,degToRad:oU,radToDeg:aU,isPowerOfTwo:lU,ceilPowerOfTwo:cU,floorPowerOfTwo:uU,setQuaternionFromProperEuler:hU,normalize:Gt,denormalize:er};class Ie{constructor(e=0,t=0){Ie.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Xn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Vt{constructor(e,t,i,r,s,o,a,c,h){Vt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,c,h)}set(e,t,i,r,s,o,a,c,h){const f=this.elements;return f[0]=e,f[1]=r,f[2]=a,f[3]=t,f[4]=s,f[5]=c,f[6]=i,f[7]=o,f[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],c=i[6],h=i[1],f=i[4],d=i[7],m=i[2],v=i[5],_=i[8],E=r[0],S=r[3],y=r[6],w=r[1],M=r[4],R=r[7],z=r[2],k=r[5],P=r[8];return s[0]=o*E+a*w+c*z,s[3]=o*S+a*M+c*k,s[6]=o*y+a*R+c*P,s[1]=h*E+f*w+d*z,s[4]=h*S+f*M+d*k,s[7]=h*y+f*R+d*P,s[2]=m*E+v*w+_*z,s[5]=m*S+v*M+_*k,s[8]=m*y+v*R+_*P,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],h=e[7],f=e[8];return t*o*f-t*a*h-i*s*f+i*a*c+r*s*h-r*o*c}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],h=e[7],f=e[8],d=f*o-a*h,m=a*c-f*s,v=h*s-o*c,_=t*d+i*m+r*v;if(_===0)return this.set(0,0,0,0,0,0,0,0,0);const E=1/_;return e[0]=d*E,e[1]=(r*h-f*i)*E,e[2]=(a*i-r*o)*E,e[3]=m*E,e[4]=(f*t-r*c)*E,e[5]=(r*s-a*t)*E,e[6]=v*E,e[7]=(i*c-h*t)*E,e[8]=(o*t-i*s)*E,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const c=Math.cos(s),h=Math.sin(s);return this.set(i*c,i*h,-i*(c*o+h*a)+o+e,-r*h,r*c,-r*(-h*o+c*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(h_.makeScale(e,t)),this}rotate(e){return this.premultiply(h_.makeRotation(-e)),this}translate(e,t){return this.premultiply(h_.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const h_=new Vt;function qR(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const fU={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Mu(n,e){return new fU[n](e)}function gd(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function YR(){const n=gd("canvas");return n.style.display="block",n}const FT={};function ku(n){n in FT||(FT[n]=!0,console.warn(n))}function dU(n,e,t){return new Promise(function(i,r){function s(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:r();break;case n.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:i()}}setTimeout(s,t)})}const zT=new Vt().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),BT=new Vt().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),qh={[fs]:{transfer:hd,primaries:fd,luminanceCoefficients:[.2126,.7152,.0722],toReference:n=>n,fromReference:n=>n},[Ur]:{transfer:Tn,primaries:fd,luminanceCoefficients:[.2126,.7152,.0722],toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[Bd]:{transfer:hd,primaries:dd,luminanceCoefficients:[.2289,.6917,.0793],toReference:n=>n.applyMatrix3(BT),fromReference:n=>n.applyMatrix3(zT)},[d0]:{transfer:Tn,primaries:dd,luminanceCoefficients:[.2289,.6917,.0793],toReference:n=>n.convertSRGBToLinear().applyMatrix3(BT),fromReference:n=>n.applyMatrix3(zT).convertLinearToSRGB()}},pU=new Set([fs,Bd]),hn={enabled:!0,_workingColorSpace:fs,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!pU.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const i=qh[e].toReference,r=qh[t].fromReference;return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return qh[n].primaries},getTransfer:function(n){return n===Po?hd:qh[n].transfer},getLuminanceCoefficients:function(n,e=this._workingColorSpace){return n.fromArray(qh[e].luminanceCoefficients)}};function Ou(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function f_(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Bc;class $R{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Bc===void 0&&(Bc=gd("canvas")),Bc.width=e.width,Bc.height=e.height;const i=Bc.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Bc}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=gd("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=Ou(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Ou(t[i]/255)*255):t[i]=Ou(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let mU=0;class Bl{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:mU++}),this.uuid=Hr(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(d_(r[o].image)):s.push(d_(r[o]))}else s=d_(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function d_(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?$R.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let gU=0;class yn extends co{constructor(e=yn.DEFAULT_IMAGE,t=yn.DEFAULT_MAPPING,i=li,r=li,s=mn,o=Zs,a=Qn,c=Mr,h=yn.DEFAULT_ANISOTROPY,f=Po){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:gU++}),this.uuid=Hr(),this.name="",this.source=new Bl(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=h,this.format=a,this.internalFormat=null,this.type=c,this.offset=new Ie(0,0),this.repeat=new Ie(1,1),this.center=new Ie(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Vt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=f,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Va)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ad:e.x=e.x-Math.floor(e.x);break;case li:e.x=e.x<0?0:1;break;case ld:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case ad:e.y=e.y-Math.floor(e.y);break;case li:e.y=e.y<0?0:1;break;case ld:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}yn.DEFAULT_IMAGE=null;yn.DEFAULT_MAPPING=Va;yn.DEFAULT_ANISOTROPY=1;class pn{constructor(e=0,t=0,i=0,r=1){pn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const c=e.elements,h=c[0],f=c[4],d=c[8],m=c[1],v=c[5],_=c[9],E=c[2],S=c[6],y=c[10];if(Math.abs(f-m)<.01&&Math.abs(d-E)<.01&&Math.abs(_-S)<.01){if(Math.abs(f+m)<.1&&Math.abs(d+E)<.1&&Math.abs(_+S)<.1&&Math.abs(h+v+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const M=(h+1)/2,R=(v+1)/2,z=(y+1)/2,k=(f+m)/4,P=(d+E)/4,b=(_+S)/4;return M>R&&M>z?M<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(M),r=k/i,s=P/i):R>z?R<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(R),i=k/r,s=b/r):z<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(z),i=P/s,r=b/s),this.set(i,r,s,t),this}let w=Math.sqrt((S-_)*(S-_)+(d-E)*(d-E)+(m-f)*(m-f));return Math.abs(w)<.001&&(w=1),this.x=(S-_)/w,this.y=(d-E)/w,this.z=(m-f)/w,this.w=Math.acos((h+v+y-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class KR extends co{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new pn(0,0,e,t),this.scissorTest=!1,this.viewport=new pn(0,0,e,t);const r={width:e,height:t,depth:1};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:mn,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},i);const s=new yn(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);s.flipY=!1,s.generateMipmaps=i.generateMipmaps,s.internalFormat=i.internalFormat,this.textures=[];const o=i.count;for(let a=0;a<o;a++)this.textures[a]=s.clone(),this.textures[a].isRenderTargetTexture=!0;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let i=0,r=e.textures.length;i<r;i++)this.textures[i]=e.textures[i].clone(),this.textures[i].isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new Bl(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class jr extends KR{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class p0 extends yn{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=_i,this.minFilter=_i,this.wrapR=li,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class vU extends jr{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new p0(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class Jw extends yn{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=_i,this.minFilter=_i,this.wrapR=li,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class yU extends jr{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new Jw(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class Vi{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let c=i[r+0],h=i[r+1],f=i[r+2],d=i[r+3];const m=s[o+0],v=s[o+1],_=s[o+2],E=s[o+3];if(a===0){e[t+0]=c,e[t+1]=h,e[t+2]=f,e[t+3]=d;return}if(a===1){e[t+0]=m,e[t+1]=v,e[t+2]=_,e[t+3]=E;return}if(d!==E||c!==m||h!==v||f!==_){let S=1-a;const y=c*m+h*v+f*_+d*E,w=y>=0?1:-1,M=1-y*y;if(M>Number.EPSILON){const z=Math.sqrt(M),k=Math.atan2(z,y*w);S=Math.sin(S*k)/z,a=Math.sin(a*k)/z}const R=a*w;if(c=c*S+m*R,h=h*S+v*R,f=f*S+_*R,d=d*S+E*R,S===1-a){const z=1/Math.sqrt(c*c+h*h+f*f+d*d);c*=z,h*=z,f*=z,d*=z}}e[t]=c,e[t+1]=h,e[t+2]=f,e[t+3]=d}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],c=i[r+1],h=i[r+2],f=i[r+3],d=s[o],m=s[o+1],v=s[o+2],_=s[o+3];return e[t]=a*_+f*d+c*v-h*m,e[t+1]=c*_+f*m+h*d-a*v,e[t+2]=h*_+f*v+a*m-c*d,e[t+3]=f*_-a*d-c*m-h*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,h=a(i/2),f=a(r/2),d=a(s/2),m=c(i/2),v=c(r/2),_=c(s/2);switch(o){case"XYZ":this._x=m*f*d+h*v*_,this._y=h*v*d-m*f*_,this._z=h*f*_+m*v*d,this._w=h*f*d-m*v*_;break;case"YXZ":this._x=m*f*d+h*v*_,this._y=h*v*d-m*f*_,this._z=h*f*_-m*v*d,this._w=h*f*d+m*v*_;break;case"ZXY":this._x=m*f*d-h*v*_,this._y=h*v*d+m*f*_,this._z=h*f*_+m*v*d,this._w=h*f*d-m*v*_;break;case"ZYX":this._x=m*f*d-h*v*_,this._y=h*v*d+m*f*_,this._z=h*f*_-m*v*d,this._w=h*f*d+m*v*_;break;case"YZX":this._x=m*f*d+h*v*_,this._y=h*v*d+m*f*_,this._z=h*f*_-m*v*d,this._w=h*f*d-m*v*_;break;case"XZY":this._x=m*f*d-h*v*_,this._y=h*v*d-m*f*_,this._z=h*f*_+m*v*d,this._w=h*f*d+m*v*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],c=t[9],h=t[2],f=t[6],d=t[10],m=i+a+d;if(m>0){const v=.5/Math.sqrt(m+1);this._w=.25/v,this._x=(f-c)*v,this._y=(s-h)*v,this._z=(o-r)*v}else if(i>a&&i>d){const v=2*Math.sqrt(1+i-a-d);this._w=(f-c)/v,this._x=.25*v,this._y=(r+o)/v,this._z=(s+h)/v}else if(a>d){const v=2*Math.sqrt(1+a-i-d);this._w=(s-h)/v,this._x=(r+o)/v,this._y=.25*v,this._z=(c+f)/v}else{const v=2*Math.sqrt(1+d-i-a);this._w=(o-r)/v,this._x=(s+h)/v,this._y=(c+f)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Xn(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,c=t._y,h=t._z,f=t._w;return this._x=i*f+o*a+r*h-s*c,this._y=r*f+o*c+s*a-i*h,this._z=s*f+o*h+i*c-r*a,this._w=o*f-i*a-r*c-s*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const c=1-a*a;if(c<=Number.EPSILON){const v=1-t;return this._w=v*o+t*this._w,this._x=v*i+t*this._x,this._y=v*r+t*this._y,this._z=v*s+t*this._z,this.normalize(),this}const h=Math.sqrt(c),f=Math.atan2(h,a),d=Math.sin((1-t)*f)/h,m=Math.sin(t*f)/h;return this._w=o*d+this._w*m,this._x=i*d+this._x*m,this._y=r*d+this._y*m,this._z=s*d+this._z*m,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class j{constructor(e=0,t=0,i=0){j.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(HT.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(HT.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,c=e.w,h=2*(o*r-a*i),f=2*(a*t-s*r),d=2*(s*i-o*t);return this.x=t+c*h+o*d-a*f,this.y=i+c*f+a*h-s*d,this.z=r+c*d+s*f-o*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=r*c-s*a,this.y=s*o-i*c,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return p_.copy(this).projectOnVector(e),this.sub(p_)}reflect(e){return this.sub(p_.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Xn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,i=Math.sqrt(1-t*t);return this.x=i*Math.cos(e),this.y=t,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const p_=new j,HT=new Vi;class nr{constructor(e=new j(1/0,1/0,1/0),t=new j(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(xs.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(xs.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=xs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,xs):xs.fromBufferAttribute(s,o),xs.applyMatrix4(e.matrixWorld),this.expandByPoint(xs);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),om.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),om.copy(i.boundingBox)),om.applyMatrix4(e.matrixWorld),this.union(om)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,xs),xs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Yh),am.subVectors(this.max,Yh),Hc.subVectors(e.a,Yh),Vc.subVectors(e.b,Yh),Gc.subVectors(e.c,Yh),oa.subVectors(Vc,Hc),aa.subVectors(Gc,Vc),ml.subVectors(Hc,Gc);let t=[0,-oa.z,oa.y,0,-aa.z,aa.y,0,-ml.z,ml.y,oa.z,0,-oa.x,aa.z,0,-aa.x,ml.z,0,-ml.x,-oa.y,oa.x,0,-aa.y,aa.x,0,-ml.y,ml.x,0];return!m_(t,Hc,Vc,Gc,am)||(t=[1,0,0,0,1,0,0,0,1],!m_(t,Hc,Vc,Gc,am))?!1:(lm.crossVectors(oa,aa),t=[lm.x,lm.y,lm.z],m_(t,Hc,Vc,Gc,am))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,xs).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(xs).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Mo[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Mo[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Mo[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Mo[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Mo[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Mo[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Mo[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Mo[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Mo),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Mo=[new j,new j,new j,new j,new j,new j,new j,new j],xs=new j,om=new nr,Hc=new j,Vc=new j,Gc=new j,oa=new j,aa=new j,ml=new j,Yh=new j,am=new j,lm=new j,gl=new j;function m_(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){gl.fromArray(n,s);const a=r.x*Math.abs(gl.x)+r.y*Math.abs(gl.y)+r.z*Math.abs(gl.z),c=e.dot(gl),h=t.dot(gl),f=i.dot(gl);if(Math.max(-Math.max(c,h,f),Math.min(c,h,f))>a)return!1}return!0}const _U=new nr,$h=new j,g_=new j;class Gi{constructor(e=new j,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):_U.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;$h.subVectors(e,this.center);const t=$h.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector($h,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(g_.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint($h.copy(e.center).add(g_)),this.expandByPoint($h.copy(e.center).sub(g_))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Eo=new j,v_=new j,cm=new j,la=new j,y_=new j,um=new j,__=new j;class pc{constructor(e=new j,t=new j(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Eo)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Eo.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Eo.copy(this.origin).addScaledVector(this.direction,t),Eo.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){v_.copy(e).add(t).multiplyScalar(.5),cm.copy(t).sub(e).normalize(),la.copy(this.origin).sub(v_);const s=e.distanceTo(t)*.5,o=-this.direction.dot(cm),a=la.dot(this.direction),c=-la.dot(cm),h=la.lengthSq(),f=Math.abs(1-o*o);let d,m,v,_;if(f>0)if(d=o*c-a,m=o*a-c,_=s*f,d>=0)if(m>=-_)if(m<=_){const E=1/f;d*=E,m*=E,v=d*(d+o*m+2*a)+m*(o*d+m+2*c)+h}else m=s,d=Math.max(0,-(o*m+a)),v=-d*d+m*(m+2*c)+h;else m=-s,d=Math.max(0,-(o*m+a)),v=-d*d+m*(m+2*c)+h;else m<=-_?(d=Math.max(0,-(-o*s+a)),m=d>0?-s:Math.min(Math.max(-s,-c),s),v=-d*d+m*(m+2*c)+h):m<=_?(d=0,m=Math.min(Math.max(-s,-c),s),v=m*(m+2*c)+h):(d=Math.max(0,-(o*s+a)),m=d>0?s:Math.min(Math.max(-s,-c),s),v=-d*d+m*(m+2*c)+h);else m=o>0?-s:s,d=Math.max(0,-(o*m+a)),v=-d*d+m*(m+2*c)+h;return i&&i.copy(this.origin).addScaledVector(this.direction,d),r&&r.copy(v_).addScaledVector(cm,m),v}intersectSphere(e,t){Eo.subVectors(e.center,this.origin);const i=Eo.dot(this.direction),r=Eo.dot(Eo)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,c=i+o;return c<0?null:a<0?this.at(c,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,c;const h=1/this.direction.x,f=1/this.direction.y,d=1/this.direction.z,m=this.origin;return h>=0?(i=(e.min.x-m.x)*h,r=(e.max.x-m.x)*h):(i=(e.max.x-m.x)*h,r=(e.min.x-m.x)*h),f>=0?(s=(e.min.y-m.y)*f,o=(e.max.y-m.y)*f):(s=(e.max.y-m.y)*f,o=(e.min.y-m.y)*f),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),d>=0?(a=(e.min.z-m.z)*d,c=(e.max.z-m.z)*d):(a=(e.max.z-m.z)*d,c=(e.min.z-m.z)*d),i>c||a>r)||((a>i||i!==i)&&(i=a),(c<r||r!==r)&&(r=c),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,Eo)!==null}intersectTriangle(e,t,i,r,s){y_.subVectors(t,e),um.subVectors(i,e),__.crossVectors(y_,um);let o=this.direction.dot(__),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;la.subVectors(this.origin,e);const c=a*this.direction.dot(um.crossVectors(la,um));if(c<0)return null;const h=a*this.direction.dot(y_.cross(la));if(h<0||c+h>o)return null;const f=-a*la.dot(__);return f<0?null:this.at(f/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Lt{constructor(e,t,i,r,s,o,a,c,h,f,d,m,v,_,E,S){Lt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,c,h,f,d,m,v,_,E,S)}set(e,t,i,r,s,o,a,c,h,f,d,m,v,_,E,S){const y=this.elements;return y[0]=e,y[4]=t,y[8]=i,y[12]=r,y[1]=s,y[5]=o,y[9]=a,y[13]=c,y[2]=h,y[6]=f,y[10]=d,y[14]=m,y[3]=v,y[7]=_,y[11]=E,y[15]=S,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Lt().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/Wc.setFromMatrixColumn(e,0).length(),s=1/Wc.setFromMatrixColumn(e,1).length(),o=1/Wc.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),c=Math.cos(r),h=Math.sin(r),f=Math.cos(s),d=Math.sin(s);if(e.order==="XYZ"){const m=o*f,v=o*d,_=a*f,E=a*d;t[0]=c*f,t[4]=-c*d,t[8]=h,t[1]=v+_*h,t[5]=m-E*h,t[9]=-a*c,t[2]=E-m*h,t[6]=_+v*h,t[10]=o*c}else if(e.order==="YXZ"){const m=c*f,v=c*d,_=h*f,E=h*d;t[0]=m+E*a,t[4]=_*a-v,t[8]=o*h,t[1]=o*d,t[5]=o*f,t[9]=-a,t[2]=v*a-_,t[6]=E+m*a,t[10]=o*c}else if(e.order==="ZXY"){const m=c*f,v=c*d,_=h*f,E=h*d;t[0]=m-E*a,t[4]=-o*d,t[8]=_+v*a,t[1]=v+_*a,t[5]=o*f,t[9]=E-m*a,t[2]=-o*h,t[6]=a,t[10]=o*c}else if(e.order==="ZYX"){const m=o*f,v=o*d,_=a*f,E=a*d;t[0]=c*f,t[4]=_*h-v,t[8]=m*h+E,t[1]=c*d,t[5]=E*h+m,t[9]=v*h-_,t[2]=-h,t[6]=a*c,t[10]=o*c}else if(e.order==="YZX"){const m=o*c,v=o*h,_=a*c,E=a*h;t[0]=c*f,t[4]=E-m*d,t[8]=_*d+v,t[1]=d,t[5]=o*f,t[9]=-a*f,t[2]=-h*f,t[6]=v*d+_,t[10]=m-E*d}else if(e.order==="XZY"){const m=o*c,v=o*h,_=a*c,E=a*h;t[0]=c*f,t[4]=-d,t[8]=h*f,t[1]=m*d+E,t[5]=o*f,t[9]=v*d-_,t[2]=_*d-v,t[6]=a*f,t[10]=E*d+m}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(xU,e,SU)}lookAt(e,t,i){const r=this.elements;return Nr.subVectors(e,t),Nr.lengthSq()===0&&(Nr.z=1),Nr.normalize(),ca.crossVectors(i,Nr),ca.lengthSq()===0&&(Math.abs(i.z)===1?Nr.x+=1e-4:Nr.z+=1e-4,Nr.normalize(),ca.crossVectors(i,Nr)),ca.normalize(),hm.crossVectors(Nr,ca),r[0]=ca.x,r[4]=hm.x,r[8]=Nr.x,r[1]=ca.y,r[5]=hm.y,r[9]=Nr.y,r[2]=ca.z,r[6]=hm.z,r[10]=Nr.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],c=i[8],h=i[12],f=i[1],d=i[5],m=i[9],v=i[13],_=i[2],E=i[6],S=i[10],y=i[14],w=i[3],M=i[7],R=i[11],z=i[15],k=r[0],P=r[4],b=r[8],A=r[12],T=r[1],L=r[5],H=r[9],U=r[13],se=r[2],fe=r[6],oe=r[10],Se=r[14],q=r[3],le=r[7],ie=r[11],ye=r[15];return s[0]=o*k+a*T+c*se+h*q,s[4]=o*P+a*L+c*fe+h*le,s[8]=o*b+a*H+c*oe+h*ie,s[12]=o*A+a*U+c*Se+h*ye,s[1]=f*k+d*T+m*se+v*q,s[5]=f*P+d*L+m*fe+v*le,s[9]=f*b+d*H+m*oe+v*ie,s[13]=f*A+d*U+m*Se+v*ye,s[2]=_*k+E*T+S*se+y*q,s[6]=_*P+E*L+S*fe+y*le,s[10]=_*b+E*H+S*oe+y*ie,s[14]=_*A+E*U+S*Se+y*ye,s[3]=w*k+M*T+R*se+z*q,s[7]=w*P+M*L+R*fe+z*le,s[11]=w*b+M*H+R*oe+z*ie,s[15]=w*A+M*U+R*Se+z*ye,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],c=e[9],h=e[13],f=e[2],d=e[6],m=e[10],v=e[14],_=e[3],E=e[7],S=e[11],y=e[15];return _*(+s*c*d-r*h*d-s*a*m+i*h*m+r*a*v-i*c*v)+E*(+t*c*v-t*h*m+s*o*m-r*o*v+r*h*f-s*c*f)+S*(+t*h*d-t*a*v-s*o*d+i*o*v+s*a*f-i*h*f)+y*(-r*a*f-t*c*d+t*a*m+r*o*d-i*o*m+i*c*f)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],h=e[7],f=e[8],d=e[9],m=e[10],v=e[11],_=e[12],E=e[13],S=e[14],y=e[15],w=d*S*h-E*m*h+E*c*v-a*S*v-d*c*y+a*m*y,M=_*m*h-f*S*h-_*c*v+o*S*v+f*c*y-o*m*y,R=f*E*h-_*d*h+_*a*v-o*E*v-f*a*y+o*d*y,z=_*d*c-f*E*c-_*a*m+o*E*m+f*a*S-o*d*S,k=t*w+i*M+r*R+s*z;if(k===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const P=1/k;return e[0]=w*P,e[1]=(E*m*s-d*S*s-E*r*v+i*S*v+d*r*y-i*m*y)*P,e[2]=(a*S*s-E*c*s+E*r*h-i*S*h-a*r*y+i*c*y)*P,e[3]=(d*c*s-a*m*s-d*r*h+i*m*h+a*r*v-i*c*v)*P,e[4]=M*P,e[5]=(f*S*s-_*m*s+_*r*v-t*S*v-f*r*y+t*m*y)*P,e[6]=(_*c*s-o*S*s-_*r*h+t*S*h+o*r*y-t*c*y)*P,e[7]=(o*m*s-f*c*s+f*r*h-t*m*h-o*r*v+t*c*v)*P,e[8]=R*P,e[9]=(_*d*s-f*E*s-_*i*v+t*E*v+f*i*y-t*d*y)*P,e[10]=(o*E*s-_*a*s+_*i*h-t*E*h-o*i*y+t*a*y)*P,e[11]=(f*a*s-o*d*s-f*i*h+t*d*h+o*i*v-t*a*v)*P,e[12]=z*P,e[13]=(f*E*r-_*d*r+_*i*m-t*E*m-f*i*S+t*d*S)*P,e[14]=(_*a*r-o*E*r-_*i*c+t*E*c+o*i*S-t*a*S)*P,e[15]=(o*d*r-f*a*r+f*i*c-t*d*c-o*i*m+t*a*m)*P,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,c=e.z,h=s*o,f=s*a;return this.set(h*o+i,h*a-r*c,h*c+r*a,0,h*a+r*c,f*a+i,f*c-r*o,0,h*c-r*a,f*c+r*o,s*c*c+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,h=s+s,f=o+o,d=a+a,m=s*h,v=s*f,_=s*d,E=o*f,S=o*d,y=a*d,w=c*h,M=c*f,R=c*d,z=i.x,k=i.y,P=i.z;return r[0]=(1-(E+y))*z,r[1]=(v+R)*z,r[2]=(_-M)*z,r[3]=0,r[4]=(v-R)*k,r[5]=(1-(m+y))*k,r[6]=(S+w)*k,r[7]=0,r[8]=(_+M)*P,r[9]=(S-w)*P,r[10]=(1-(m+E))*P,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=Wc.set(r[0],r[1],r[2]).length();const o=Wc.set(r[4],r[5],r[6]).length(),a=Wc.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Ss.copy(this);const h=1/s,f=1/o,d=1/a;return Ss.elements[0]*=h,Ss.elements[1]*=h,Ss.elements[2]*=h,Ss.elements[4]*=f,Ss.elements[5]*=f,Ss.elements[6]*=f,Ss.elements[8]*=d,Ss.elements[9]*=d,Ss.elements[10]*=d,t.setFromRotationMatrix(Ss),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=Js){const c=this.elements,h=2*s/(t-e),f=2*s/(i-r),d=(t+e)/(t-e),m=(i+r)/(i-r);let v,_;if(a===Js)v=-(o+s)/(o-s),_=-2*o*s/(o-s);else if(a===md)v=-o/(o-s),_=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return c[0]=h,c[4]=0,c[8]=d,c[12]=0,c[1]=0,c[5]=f,c[9]=m,c[13]=0,c[2]=0,c[6]=0,c[10]=v,c[14]=_,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=Js){const c=this.elements,h=1/(t-e),f=1/(i-r),d=1/(o-s),m=(t+e)*h,v=(i+r)*f;let _,E;if(a===Js)_=(o+s)*d,E=-2*d;else if(a===md)_=s*d,E=-1*d;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return c[0]=2*h,c[4]=0,c[8]=0,c[12]=-m,c[1]=0,c[5]=2*f,c[9]=0,c[13]=-v,c[2]=0,c[6]=0,c[10]=E,c[14]=-_,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Wc=new j,Ss=new Lt,xU=new j(0,0,0),SU=new j(1,1,1),ca=new j,hm=new j,Nr=new j,VT=new Lt,GT=new Vi;class Xr{constructor(e=0,t=0,i=0,r=Xr.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],c=r[1],h=r[5],f=r[9],d=r[2],m=r[6],v=r[10];switch(t){case"XYZ":this._y=Math.asin(Xn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-f,v),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(m,h),this._z=0);break;case"YXZ":this._x=Math.asin(-Xn(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(a,v),this._z=Math.atan2(c,h)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(Xn(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-d,v),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(c,s));break;case"ZYX":this._y=Math.asin(-Xn(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(m,v),this._z=Math.atan2(c,s)):(this._x=0,this._z=Math.atan2(-o,h));break;case"YZX":this._z=Math.asin(Xn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-f,h),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(a,v));break;case"XZY":this._z=Math.asin(-Xn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(m,h),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-f,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return VT.makeRotationFromQuaternion(e),this.setFromRotationMatrix(VT,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return GT.setFromEuler(this),this.setFromQuaternion(GT,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Xr.DEFAULT_ORDER="XYZ";class Zl{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let wU=0;const WT=new j,jc=new Vi,To=new Lt,fm=new j,Kh=new j,MU=new j,EU=new Vi,jT=new j(1,0,0),XT=new j(0,1,0),qT=new j(0,0,1),YT={type:"added"},TU={type:"removed"},Xc={type:"childadded",child:null},x_={type:"childremoved",child:null};class an extends co{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:wU++}),this.uuid=Hr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=an.DEFAULT_UP.clone();const e=new j,t=new Xr,i=new Vi,r=new j(1,1,1);function s(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Lt},normalMatrix:{value:new Vt}}),this.matrix=new Lt,this.matrixWorld=new Lt,this.matrixAutoUpdate=an.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=an.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Zl,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return jc.setFromAxisAngle(e,t),this.quaternion.multiply(jc),this}rotateOnWorldAxis(e,t){return jc.setFromAxisAngle(e,t),this.quaternion.premultiply(jc),this}rotateX(e){return this.rotateOnAxis(jT,e)}rotateY(e){return this.rotateOnAxis(XT,e)}rotateZ(e){return this.rotateOnAxis(qT,e)}translateOnAxis(e,t){return WT.copy(e).applyQuaternion(this.quaternion),this.position.add(WT.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(jT,e)}translateY(e){return this.translateOnAxis(XT,e)}translateZ(e){return this.translateOnAxis(qT,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(To.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?fm.copy(e):fm.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),Kh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?To.lookAt(Kh,fm,this.up):To.lookAt(fm,Kh,this.up),this.quaternion.setFromRotationMatrix(To),r&&(To.extractRotation(r.matrixWorld),jc.setFromRotationMatrix(To),this.quaternion.premultiply(jc.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(YT),Xc.child=e,this.dispatchEvent(Xc),Xc.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(TU),x_.child=e,this.dispatchEvent(x_),x_.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),To.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),To.multiply(e.parent.matrixWorld)),e.applyMatrix4(To),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(YT),Xc.child=e,this.dispatchEvent(Xc),Xc.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Kh,e,MU),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Kh,EU,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].updateMatrixWorld(e)}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function s(a,c){return a[c.uuid]===void 0&&(a[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const c=a.shapes;if(Array.isArray(c))for(let h=0,f=c.length;h<f;h++){const d=c[h];s(e.shapes,d)}else s(e.shapes,c)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let c=0,h=this.material.length;c<h;c++)a.push(s(e.materials,this.material[c]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const c=this.animations[a];r.animations.push(s(e.animations,c))}}if(t){const a=o(e.geometries),c=o(e.materials),h=o(e.textures),f=o(e.images),d=o(e.shapes),m=o(e.skeletons),v=o(e.animations),_=o(e.nodes);a.length>0&&(i.geometries=a),c.length>0&&(i.materials=c),h.length>0&&(i.textures=h),f.length>0&&(i.images=f),d.length>0&&(i.shapes=d),m.length>0&&(i.skeletons=m),v.length>0&&(i.animations=v),_.length>0&&(i.nodes=_)}return i.object=r,i;function o(a){const c=[];for(const h in a){const f=a[h];delete f.metadata,c.push(f)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}an.DEFAULT_UP=new j(0,1,0);an.DEFAULT_MATRIX_AUTO_UPDATE=!0;an.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const ws=new j,Ao=new j,S_=new j,bo=new j,qc=new j,Yc=new j,$T=new j,w_=new j,M_=new j,E_=new j;class Fr{constructor(e=new j,t=new j,i=new j){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),ws.subVectors(e,t),r.cross(ws);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){ws.subVectors(r,t),Ao.subVectors(i,t),S_.subVectors(e,t);const o=ws.dot(ws),a=ws.dot(Ao),c=ws.dot(S_),h=Ao.dot(Ao),f=Ao.dot(S_),d=o*h-a*a;if(d===0)return s.set(0,0,0),null;const m=1/d,v=(h*c-a*f)*m,_=(o*f-a*c)*m;return s.set(1-v-_,_,v)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,bo)===null?!1:bo.x>=0&&bo.y>=0&&bo.x+bo.y<=1}static getInterpolation(e,t,i,r,s,o,a,c){return this.getBarycoord(e,t,i,r,bo)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(s,bo.x),c.addScaledVector(o,bo.y),c.addScaledVector(a,bo.z),c)}static isFrontFacing(e,t,i,r){return ws.subVectors(i,t),Ao.subVectors(e,t),ws.cross(Ao).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ws.subVectors(this.c,this.b),Ao.subVectors(this.a,this.b),ws.cross(Ao).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Fr.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Fr.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,i,r,s){return Fr.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Fr.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Fr.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;qc.subVectors(r,i),Yc.subVectors(s,i),w_.subVectors(e,i);const c=qc.dot(w_),h=Yc.dot(w_);if(c<=0&&h<=0)return t.copy(i);M_.subVectors(e,r);const f=qc.dot(M_),d=Yc.dot(M_);if(f>=0&&d<=f)return t.copy(r);const m=c*d-f*h;if(m<=0&&c>=0&&f<=0)return o=c/(c-f),t.copy(i).addScaledVector(qc,o);E_.subVectors(e,s);const v=qc.dot(E_),_=Yc.dot(E_);if(_>=0&&v<=_)return t.copy(s);const E=v*h-c*_;if(E<=0&&h>=0&&_<=0)return a=h/(h-_),t.copy(i).addScaledVector(Yc,a);const S=f*_-v*d;if(S<=0&&d-f>=0&&v-_>=0)return $T.subVectors(s,r),a=(d-f)/(d-f+(v-_)),t.copy(r).addScaledVector($T,a);const y=1/(S+E+m);return o=E*y,a=m*y,t.copy(i).addScaledVector(qc,o).addScaledVector(Yc,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const ZR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ua={h:0,s:0,l:0},dm={h:0,s:0,l:0};function T_(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class lt{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ur){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,hn.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=hn.workingColorSpace){return this.r=e,this.g=t,this.b=i,hn.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=hn.workingColorSpace){if(e=Zw(e,1),t=Xn(t,0,1),i=Xn(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=T_(o,s,e+1/3),this.g=T_(o,s,e),this.b=T_(o,s,e-1/3)}return hn.toWorkingColorSpace(this,r),this}setStyle(e,t=Ur){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Ur){const i=ZR[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Ou(e.r),this.g=Ou(e.g),this.b=Ou(e.b),this}copyLinearToSRGB(e){return this.r=f_(e.r),this.g=f_(e.g),this.b=f_(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ur){return hn.fromWorkingColorSpace(Fi.copy(this),e),Math.round(Xn(Fi.r*255,0,255))*65536+Math.round(Xn(Fi.g*255,0,255))*256+Math.round(Xn(Fi.b*255,0,255))}getHexString(e=Ur){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=hn.workingColorSpace){hn.fromWorkingColorSpace(Fi.copy(this),t);const i=Fi.r,r=Fi.g,s=Fi.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let c,h;const f=(a+o)/2;if(a===o)c=0,h=0;else{const d=o-a;switch(h=f<=.5?d/(o+a):d/(2-o-a),o){case i:c=(r-s)/d+(r<s?6:0);break;case r:c=(s-i)/d+2;break;case s:c=(i-r)/d+4;break}c/=6}return e.h=c,e.s=h,e.l=f,e}getRGB(e,t=hn.workingColorSpace){return hn.fromWorkingColorSpace(Fi.copy(this),t),e.r=Fi.r,e.g=Fi.g,e.b=Fi.b,e}getStyle(e=Ur){hn.fromWorkingColorSpace(Fi.copy(this),e);const t=Fi.r,i=Fi.g,r=Fi.b;return e!==Ur?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,t,i){return this.getHSL(ua),this.setHSL(ua.h+e,ua.s+t,ua.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(ua),e.getHSL(dm);const i=Nf(ua.h,dm.h,t),r=Nf(ua.s,dm.s,t),s=Nf(ua.l,dm.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Fi=new lt;lt.NAMES=ZR;let AU=0;class ji extends co{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:AU++}),this.uuid=Hr(),this.name="",this.type="Material",this.blending=Yl,this.side=jo,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Zg,this.blendDst=Jg,this.blendEquation=Sa,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new lt(0,0,0),this.blendAlpha=0,this.depthFunc=sd,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=yS,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Pl,this.stencilZFail=Pl,this.stencilZPass=Pl,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Yl&&(i.blending=this.blending),this.side!==jo&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==Zg&&(i.blendSrc=this.blendSrc),this.blendDst!==Jg&&(i.blendDst=this.blendDst),this.blendEquation!==Sa&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==sd&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==yS&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Pl&&(i.stencilFail=this.stencilFail),this.stencilZFail!==Pl&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==Pl&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const c=s[a];delete c.metadata,o.push(c)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class Ko extends ji{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new lt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Xr,this.combine=Od,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Lo=bU();function bU(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),r=new Uint32Array(512);for(let c=0;c<256;++c){const h=c-127;h<-27?(i[c]=0,i[c|256]=32768,r[c]=24,r[c|256]=24):h<-14?(i[c]=1024>>-h-14,i[c|256]=1024>>-h-14|32768,r[c]=-h-1,r[c|256]=-h-1):h<=15?(i[c]=h+15<<10,i[c|256]=h+15<<10|32768,r[c]=13,r[c|256]=13):h<128?(i[c]=31744,i[c|256]=64512,r[c]=24,r[c|256]=24):(i[c]=31744,i[c|256]=64512,r[c]=13,r[c|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let c=1;c<1024;++c){let h=c<<13,f=0;for(;!(h&8388608);)h<<=1,f-=8388608;h&=-8388609,f+=947912704,s[c]=h|f}for(let c=1024;c<2048;++c)s[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)o[c]=c<<23;o[31]=1199570944,o[32]=2147483648;for(let c=33;c<63;++c)o[c]=2147483648+(c-32<<23);o[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(a[c]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function mr(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=Xn(n,-65504,65504),Lo.floatView[0]=n;const e=Lo.uint32View[0],t=e>>23&511;return Lo.baseTable[t]+((e&8388607)>>Lo.shiftTable[t])}function mf(n){const e=n>>10;return Lo.uint32View[0]=Lo.mantissaTable[Lo.offsetTable[e]+(n&1023)]+Lo.exponentTable[e],Lo.floatView[0]}const Hl={toHalfFloat:mr,fromHalfFloat:mf},oi=new j,pm=new Ie;class _n{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=pd,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=zn,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return ku("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)pm.fromBufferAttribute(this,t),pm.applyMatrix3(e),this.setXY(t,pm.x,pm.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)oi.fromBufferAttribute(this,t),oi.applyMatrix3(e),this.setXYZ(t,oi.x,oi.y,oi.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)oi.fromBufferAttribute(this,t),oi.applyMatrix4(e),this.setXYZ(t,oi.x,oi.y,oi.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)oi.fromBufferAttribute(this,t),oi.applyNormalMatrix(e),this.setXYZ(t,oi.x,oi.y,oi.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)oi.fromBufferAttribute(this,t),oi.transformDirection(e),this.setXYZ(t,oi.x,oi.y,oi.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=er(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Gt(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=er(t,this.array)),t}setX(e,t){return this.normalized&&(t=Gt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=er(t,this.array)),t}setY(e,t){return this.normalized&&(t=Gt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=er(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Gt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=er(t,this.array)),t}setW(e,t){return this.normalized&&(t=Gt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Gt(t,this.array),i=Gt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Gt(t,this.array),i=Gt(i,this.array),r=Gt(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Gt(t,this.array),i=Gt(i,this.array),r=Gt(r,this.array),s=Gt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==pd&&(e.usage=this.usage),e}}class CU extends _n{constructor(e,t,i){super(new Int8Array(e),t,i)}}class IU extends _n{constructor(e,t,i){super(new Uint8Array(e),t,i)}}class RU extends _n{constructor(e,t,i){super(new Uint8ClampedArray(e),t,i)}}class PU extends _n{constructor(e,t,i){super(new Int16Array(e),t,i)}}class Qw extends _n{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class LU extends _n{constructor(e,t,i){super(new Int32Array(e),t,i)}}class e1 extends _n{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class NU extends _n{constructor(e,t,i){super(new Uint16Array(e),t,i),this.isFloat16BufferAttribute=!0}getX(e){let t=mf(this.array[e*this.itemSize]);return this.normalized&&(t=er(t,this.array)),t}setX(e,t){return this.normalized&&(t=Gt(t,this.array)),this.array[e*this.itemSize]=mr(t),this}getY(e){let t=mf(this.array[e*this.itemSize+1]);return this.normalized&&(t=er(t,this.array)),t}setY(e,t){return this.normalized&&(t=Gt(t,this.array)),this.array[e*this.itemSize+1]=mr(t),this}getZ(e){let t=mf(this.array[e*this.itemSize+2]);return this.normalized&&(t=er(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Gt(t,this.array)),this.array[e*this.itemSize+2]=mr(t),this}getW(e){let t=mf(this.array[e*this.itemSize+3]);return this.normalized&&(t=er(t,this.array)),t}setW(e,t){return this.normalized&&(t=Gt(t,this.array)),this.array[e*this.itemSize+3]=mr(t),this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Gt(t,this.array),i=Gt(i,this.array)),this.array[e+0]=mr(t),this.array[e+1]=mr(i),this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Gt(t,this.array),i=Gt(i,this.array),r=Gt(r,this.array)),this.array[e+0]=mr(t),this.array[e+1]=mr(i),this.array[e+2]=mr(r),this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Gt(t,this.array),i=Gt(i,this.array),r=Gt(r,this.array),s=Gt(s,this.array)),this.array[e+0]=mr(t),this.array[e+1]=mr(i),this.array[e+2]=mr(r),this.array[e+3]=mr(s),this}}class pt extends _n{constructor(e,t,i){super(new Float32Array(e),t,i)}}let DU=0;const is=new Lt,A_=new an,$c=new j,Dr=new nr,Zh=new nr,vi=new j;class qt extends co{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:DU++}),this.uuid=Hr(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(qR(e)?e1:Qw)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new Vt().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return is.makeRotationFromQuaternion(e),this.applyMatrix4(is),this}rotateX(e){return is.makeRotationX(e),this.applyMatrix4(is),this}rotateY(e){return is.makeRotationY(e),this.applyMatrix4(is),this}rotateZ(e){return is.makeRotationZ(e),this.applyMatrix4(is),this}translate(e,t,i){return is.makeTranslation(e,t,i),this.applyMatrix4(is),this}scale(e,t,i){return is.makeScale(e,t,i),this.applyMatrix4(is),this}lookAt(e){return A_.lookAt(e),A_.updateMatrix(),this.applyMatrix4(A_.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter($c).negate(),this.translate($c.x,$c.y,$c.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new pt(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new nr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new j(-1/0,-1/0,-1/0),new j(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const s=t[i];Dr.setFromBufferAttribute(s),this.morphTargetsRelative?(vi.addVectors(this.boundingBox.min,Dr.min),this.boundingBox.expandByPoint(vi),vi.addVectors(this.boundingBox.max,Dr.max),this.boundingBox.expandByPoint(vi)):(this.boundingBox.expandByPoint(Dr.min),this.boundingBox.expandByPoint(Dr.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Gi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new j,1/0);return}if(e){const i=this.boundingSphere.center;if(Dr.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];Zh.setFromBufferAttribute(a),this.morphTargetsRelative?(vi.addVectors(Dr.min,Zh.min),Dr.expandByPoint(vi),vi.addVectors(Dr.max,Zh.max),Dr.expandByPoint(vi)):(Dr.expandByPoint(Zh.min),Dr.expandByPoint(Zh.max))}Dr.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)vi.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(vi));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],c=this.morphTargetsRelative;for(let h=0,f=a.count;h<f;h++)vi.fromBufferAttribute(a,h),c&&($c.fromBufferAttribute(e,h),vi.add($c)),r=Math.max(r,i.distanceToSquared(vi))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new _n(new Float32Array(4*i.count),4));const o=this.getAttribute("tangent"),a=[],c=[];for(let b=0;b<i.count;b++)a[b]=new j,c[b]=new j;const h=new j,f=new j,d=new j,m=new Ie,v=new Ie,_=new Ie,E=new j,S=new j;function y(b,A,T){h.fromBufferAttribute(i,b),f.fromBufferAttribute(i,A),d.fromBufferAttribute(i,T),m.fromBufferAttribute(s,b),v.fromBufferAttribute(s,A),_.fromBufferAttribute(s,T),f.sub(h),d.sub(h),v.sub(m),_.sub(m);const L=1/(v.x*_.y-_.x*v.y);isFinite(L)&&(E.copy(f).multiplyScalar(_.y).addScaledVector(d,-v.y).multiplyScalar(L),S.copy(d).multiplyScalar(v.x).addScaledVector(f,-_.x).multiplyScalar(L),a[b].add(E),a[A].add(E),a[T].add(E),c[b].add(S),c[A].add(S),c[T].add(S))}let w=this.groups;w.length===0&&(w=[{start:0,count:e.count}]);for(let b=0,A=w.length;b<A;++b){const T=w[b],L=T.start,H=T.count;for(let U=L,se=L+H;U<se;U+=3)y(e.getX(U+0),e.getX(U+1),e.getX(U+2))}const M=new j,R=new j,z=new j,k=new j;function P(b){z.fromBufferAttribute(r,b),k.copy(z);const A=a[b];M.copy(A),M.sub(z.multiplyScalar(z.dot(A))).normalize(),R.crossVectors(k,A);const L=R.dot(c[b])<0?-1:1;o.setXYZW(b,M.x,M.y,M.z,L)}for(let b=0,A=w.length;b<A;++b){const T=w[b],L=T.start,H=T.count;for(let U=L,se=L+H;U<se;U+=3)P(e.getX(U+0)),P(e.getX(U+1)),P(e.getX(U+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new _n(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let m=0,v=i.count;m<v;m++)i.setXYZ(m,0,0,0);const r=new j,s=new j,o=new j,a=new j,c=new j,h=new j,f=new j,d=new j;if(e)for(let m=0,v=e.count;m<v;m+=3){const _=e.getX(m+0),E=e.getX(m+1),S=e.getX(m+2);r.fromBufferAttribute(t,_),s.fromBufferAttribute(t,E),o.fromBufferAttribute(t,S),f.subVectors(o,s),d.subVectors(r,s),f.cross(d),a.fromBufferAttribute(i,_),c.fromBufferAttribute(i,E),h.fromBufferAttribute(i,S),a.add(f),c.add(f),h.add(f),i.setXYZ(_,a.x,a.y,a.z),i.setXYZ(E,c.x,c.y,c.z),i.setXYZ(S,h.x,h.y,h.z)}else for(let m=0,v=t.count;m<v;m+=3)r.fromBufferAttribute(t,m+0),s.fromBufferAttribute(t,m+1),o.fromBufferAttribute(t,m+2),f.subVectors(o,s),d.subVectors(r,s),f.cross(d),i.setXYZ(m+0,f.x,f.y,f.z),i.setXYZ(m+1,f.x,f.y,f.z),i.setXYZ(m+2,f.x,f.y,f.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)vi.fromBufferAttribute(e,t),vi.normalize(),e.setXYZ(t,vi.x,vi.y,vi.z)}toNonIndexed(){function e(a,c){const h=a.array,f=a.itemSize,d=a.normalized,m=new h.constructor(c.length*f);let v=0,_=0;for(let E=0,S=c.length;E<S;E++){a.isInterleavedBufferAttribute?v=c[E]*a.data.stride+a.offset:v=c[E]*f;for(let y=0;y<f;y++)m[_++]=h[v++]}return new _n(m,f,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new qt,i=this.index.array,r=this.attributes;for(const a in r){const c=r[a],h=e(c,i);t.setAttribute(a,h)}const s=this.morphAttributes;for(const a in s){const c=[],h=s[a];for(let f=0,d=h.length;f<d;f++){const m=h[f],v=e(m,i);c.push(v)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,c=o.length;a<c;a++){const h=o[a];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const h in c)c[h]!==void 0&&(e[h]=c[h]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const c in i){const h=i[c];e.data.attributes[c]=h.toJSON(e.data)}const r={};let s=!1;for(const c in this.morphAttributes){const h=this.morphAttributes[c],f=[];for(let d=0,m=h.length;d<m;d++){const v=h[d];f.push(v.toJSON(e.data))}f.length>0&&(r[c]=f,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const r=e.attributes;for(const h in r){const f=r[h];this.setAttribute(h,f.clone(t))}const s=e.morphAttributes;for(const h in s){const f=[],d=s[h];for(let m=0,v=d.length;m<v;m++)f.push(d[m].clone(t));this.morphAttributes[h]=f}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let h=0,f=o.length;h<f;h++){const d=o[h];this.addGroup(d.start,d.count,d.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const KT=new Lt,vl=new pc,mm=new Gi,ZT=new j,Kc=new j,Zc=new j,Jc=new j,b_=new j,gm=new j,vm=new Ie,ym=new Ie,_m=new Ie,JT=new j,QT=new j,eA=new j,xm=new j,Sm=new j;class Bn extends an{constructor(e=new qt,t=new Ko){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){gm.set(0,0,0);for(let c=0,h=s.length;c<h;c++){const f=a[c],d=s[c];f!==0&&(b_.fromBufferAttribute(d,e),o?gm.addScaledVector(b_,f):gm.addScaledVector(b_.sub(t),f))}t.add(gm)}return t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),mm.copy(i.boundingSphere),mm.applyMatrix4(s),vl.copy(e.ray).recast(e.near),!(mm.containsPoint(vl.origin)===!1&&(vl.intersectSphere(mm,ZT)===null||vl.origin.distanceToSquared(ZT)>(e.far-e.near)**2))&&(KT.copy(s).invert(),vl.copy(e.ray).applyMatrix4(KT),!(i.boundingBox!==null&&vl.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,vl)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,c=s.attributes.position,h=s.attributes.uv,f=s.attributes.uv1,d=s.attributes.normal,m=s.groups,v=s.drawRange;if(a!==null)if(Array.isArray(o))for(let _=0,E=m.length;_<E;_++){const S=m[_],y=o[S.materialIndex],w=Math.max(S.start,v.start),M=Math.min(a.count,Math.min(S.start+S.count,v.start+v.count));for(let R=w,z=M;R<z;R+=3){const k=a.getX(R),P=a.getX(R+1),b=a.getX(R+2);r=wm(this,y,e,i,h,f,d,k,P,b),r&&(r.faceIndex=Math.floor(R/3),r.face.materialIndex=S.materialIndex,t.push(r))}}else{const _=Math.max(0,v.start),E=Math.min(a.count,v.start+v.count);for(let S=_,y=E;S<y;S+=3){const w=a.getX(S),M=a.getX(S+1),R=a.getX(S+2);r=wm(this,o,e,i,h,f,d,w,M,R),r&&(r.faceIndex=Math.floor(S/3),t.push(r))}}else if(c!==void 0)if(Array.isArray(o))for(let _=0,E=m.length;_<E;_++){const S=m[_],y=o[S.materialIndex],w=Math.max(S.start,v.start),M=Math.min(c.count,Math.min(S.start+S.count,v.start+v.count));for(let R=w,z=M;R<z;R+=3){const k=R,P=R+1,b=R+2;r=wm(this,y,e,i,h,f,d,k,P,b),r&&(r.faceIndex=Math.floor(R/3),r.face.materialIndex=S.materialIndex,t.push(r))}}else{const _=Math.max(0,v.start),E=Math.min(c.count,v.start+v.count);for(let S=_,y=E;S<y;S+=3){const w=S,M=S+1,R=S+2;r=wm(this,o,e,i,h,f,d,w,M,R),r&&(r.faceIndex=Math.floor(S/3),t.push(r))}}}}function kU(n,e,t,i,r,s,o,a){let c;if(e.side===Hi?c=i.intersectTriangle(o,s,r,!0,a):c=i.intersectTriangle(r,s,o,e.side===jo,a),c===null)return null;Sm.copy(a),Sm.applyMatrix4(n.matrixWorld);const h=t.ray.origin.distanceTo(Sm);return h<t.near||h>t.far?null:{distance:h,point:Sm.clone(),object:n}}function wm(n,e,t,i,r,s,o,a,c,h){n.getVertexPosition(a,Kc),n.getVertexPosition(c,Zc),n.getVertexPosition(h,Jc);const f=kU(n,e,t,i,Kc,Zc,Jc,xm);if(f){r&&(vm.fromBufferAttribute(r,a),ym.fromBufferAttribute(r,c),_m.fromBufferAttribute(r,h),f.uv=Fr.getInterpolation(xm,Kc,Zc,Jc,vm,ym,_m,new Ie)),s&&(vm.fromBufferAttribute(s,a),ym.fromBufferAttribute(s,c),_m.fromBufferAttribute(s,h),f.uv1=Fr.getInterpolation(xm,Kc,Zc,Jc,vm,ym,_m,new Ie)),o&&(JT.fromBufferAttribute(o,a),QT.fromBufferAttribute(o,c),eA.fromBufferAttribute(o,h),f.normal=Fr.getInterpolation(xm,Kc,Zc,Jc,JT,QT,eA,new j),f.normal.dot(i.direction)>0&&f.normal.multiplyScalar(-1));const d={a,b:c,c:h,normal:new j,materialIndex:0};Fr.getNormal(Kc,Zc,Jc,d.normal),f.face=d}return f}class mc extends qt{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const c=[],h=[],f=[],d=[];let m=0,v=0;_("z","y","x",-1,-1,i,t,e,o,s,0),_("z","y","x",1,-1,i,t,-e,o,s,1),_("x","z","y",1,1,e,i,t,r,o,2),_("x","z","y",1,-1,e,i,-t,r,o,3),_("x","y","z",1,-1,e,t,i,r,s,4),_("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(c),this.setAttribute("position",new pt(h,3)),this.setAttribute("normal",new pt(f,3)),this.setAttribute("uv",new pt(d,2));function _(E,S,y,w,M,R,z,k,P,b,A){const T=R/P,L=z/b,H=R/2,U=z/2,se=k/2,fe=P+1,oe=b+1;let Se=0,q=0;const le=new j;for(let ie=0;ie<oe;ie++){const ye=ie*L-U;for(let Ae=0;Ae<fe;Ae++){const ze=Ae*T-H;le[E]=ze*w,le[S]=ye*M,le[y]=se,h.push(le.x,le.y,le.z),le[E]=0,le[S]=0,le[y]=k>0?1:-1,f.push(le.x,le.y,le.z),d.push(Ae/P),d.push(1-ie/b),Se+=1}}for(let ie=0;ie<b;ie++)for(let ye=0;ye<P;ye++){const Ae=m+ye+fe*ie,ze=m+ye+fe*(ie+1),pe=m+(ye+1)+fe*(ie+1),De=m+(ye+1)+fe*ie;c.push(Ae,ze,De),c.push(ze,pe,De),q+=6}a.addGroup(v,q,A),v+=q,m+=Se}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new mc(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Ju(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function Zi(n){const e={};for(let t=0;t<n.length;t++){const i=Ju(n[t]);for(const r in i)e[r]=i[r]}return e}function OU(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function JR(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:hn.workingColorSpace}const t1={clone:Ju,merge:Zi};var UU=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,FU=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ir extends ji{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=UU,this.fragmentShader=FU,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ju(e.uniforms),this.uniformsGroups=OU(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}let Hd=class extends an{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Lt,this.projectionMatrix=new Lt,this.projectionMatrixInverse=new Lt,this.coordinateSystem=Js}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}};const ha=new j,tA=new Ie,nA=new Ie;class Jn extends Hd{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Zu*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Kl*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Zu*2*Math.atan(Math.tan(Kl*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,i){ha.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(ha.x,ha.y).multiplyScalar(-e/ha.z),ha.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(ha.x,ha.y).multiplyScalar(-e/ha.z)}getViewSize(e,t){return this.getViewBounds(e,tA,nA),t.subVectors(nA,tA)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Kl*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const c=o.fullWidth,h=o.fullHeight;s+=o.offsetX*r/c,t-=o.offsetY*i/h,r*=o.width/c,i*=o.height/h}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Qc=-90,eu=1;class QR extends an{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Jn(Qc,eu,e,t);r.layers=this.layers,this.add(r);const s=new Jn(Qc,eu,e,t);s.layers=this.layers,this.add(s);const o=new Jn(Qc,eu,e,t);o.layers=this.layers,this.add(o);const a=new Jn(Qc,eu,e,t);a.layers=this.layers,this.add(a);const c=new Jn(Qc,eu,e,t);c.layers=this.layers,this.add(c);const h=new Jn(Qc,eu,e,t);h.layers=this.layers,this.add(h)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,c]=t;for(const h of t)this.remove(h);if(e===Js)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===md)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const h of t)this.add(h),h.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,c,h,f]=this.children,d=e.getRenderTarget(),m=e.getActiveCubeFace(),v=e.getActiveMipmapLevel(),_=e.xr.enabled;e.xr.enabled=!1;const E=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,c),e.setRenderTarget(i,4,r),e.render(t,h),i.texture.generateMipmaps=E,e.setRenderTarget(i,5,r),e.render(t,f),e.setRenderTarget(d,m,v),e.xr.enabled=_,i.texture.needsPMREMUpdate=!0}}class Vd extends yn{constructor(e,t,i,r,s,o,a,c,h,f){e=e!==void 0?e:[],t=t!==void 0?t:oo,super(e,t,i,r,s,o,a,c,h,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class n1 extends jr{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new Vd(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:mn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new mc(5,5,5),s=new ir({name:"CubemapFromEquirect",uniforms:Ju(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Hi,blending:to});s.uniforms.tEquirect.value=t;const o=new Bn(r,s),a=t.minFilter;return t.minFilter===Zs&&(t.minFilter=mn),new QR(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const C_=new j,zU=new j,BU=new Vt;class $s{constructor(e=new j(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=C_.subVectors(i,t).cross(zU.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(C_),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||BU.getNormalMatrix(e),r=this.coplanarPoint(C_).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const yl=new Gi,Mm=new j;class Gd{constructor(e=new $s,t=new $s,i=new $s,r=new $s,s=new $s,o=new $s){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Js){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],c=r[3],h=r[4],f=r[5],d=r[6],m=r[7],v=r[8],_=r[9],E=r[10],S=r[11],y=r[12],w=r[13],M=r[14],R=r[15];if(i[0].setComponents(c-s,m-h,S-v,R-y).normalize(),i[1].setComponents(c+s,m+h,S+v,R+y).normalize(),i[2].setComponents(c+o,m+f,S+_,R+w).normalize(),i[3].setComponents(c-o,m-f,S-_,R-w).normalize(),i[4].setComponents(c-a,m-d,S-E,R-M).normalize(),t===Js)i[5].setComponents(c+a,m+d,S+E,R+M).normalize();else if(t===md)i[5].setComponents(a,d,E,M).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),yl.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),yl.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(yl)}intersectsSprite(e){return yl.center.set(0,0,0),yl.radius=.7071067811865476,yl.applyMatrix4(e.matrixWorld),this.intersectsSphere(yl)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Mm.x=r.normal.x>0?e.max.x:e.min.x,Mm.y=r.normal.y>0?e.max.y:e.min.y,Mm.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Mm)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function eP(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function HU(n){const e=new WeakMap;function t(a,c){const h=a.array,f=a.usage,d=h.byteLength,m=n.createBuffer();n.bindBuffer(c,m),n.bufferData(c,h,f),a.onUploadCallback();let v;if(h instanceof Float32Array)v=n.FLOAT;else if(h instanceof Uint16Array)a.isFloat16BufferAttribute?v=n.HALF_FLOAT:v=n.UNSIGNED_SHORT;else if(h instanceof Int16Array)v=n.SHORT;else if(h instanceof Uint32Array)v=n.UNSIGNED_INT;else if(h instanceof Int32Array)v=n.INT;else if(h instanceof Int8Array)v=n.BYTE;else if(h instanceof Uint8Array)v=n.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)v=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:m,type:v,bytesPerElement:h.BYTES_PER_ELEMENT,version:a.version,size:d}}function i(a,c,h){const f=c.array,d=c._updateRange,m=c.updateRanges;if(n.bindBuffer(h,a),d.count===-1&&m.length===0&&n.bufferSubData(h,0,f),m.length!==0){for(let v=0,_=m.length;v<_;v++){const E=m[v];n.bufferSubData(h,E.start*f.BYTES_PER_ELEMENT,f,E.start,E.count)}c.clearUpdateRanges()}d.count!==-1&&(n.bufferSubData(h,d.offset*f.BYTES_PER_ELEMENT,f,d.offset,d.count),d.count=-1),c.onUploadCallback()}function r(a){return a.isInterleavedBufferAttribute&&(a=a.data),e.get(a)}function s(a){a.isInterleavedBufferAttribute&&(a=a.data);const c=e.get(a);c&&(n.deleteBuffer(c.buffer),e.delete(a))}function o(a,c){if(a.isInterleavedBufferAttribute&&(a=a.data),a.isGLBufferAttribute){const f=e.get(a);(!f||f.version<a.version)&&e.set(a,{buffer:a.buffer,type:a.type,bytesPerElement:a.elementSize,version:a.version});return}const h=e.get(a);if(h===void 0)e.set(a,t(a,c));else if(h.version<a.version){if(h.size!==a.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(h.buffer,a,c),h.version=a.version}}return{get:r,remove:s,update:o}}class $a extends qt{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),c=Math.floor(r),h=a+1,f=c+1,d=e/a,m=t/c,v=[],_=[],E=[],S=[];for(let y=0;y<f;y++){const w=y*m-o;for(let M=0;M<h;M++){const R=M*d-s;_.push(R,-w,0),E.push(0,0,1),S.push(M/a),S.push(1-y/c)}}for(let y=0;y<c;y++)for(let w=0;w<a;w++){const M=w+h*y,R=w+h*(y+1),z=w+1+h*(y+1),k=w+1+h*y;v.push(M,R,k),v.push(R,z,k)}this.setIndex(v),this.setAttribute("position",new pt(_,3)),this.setAttribute("normal",new pt(E,3)),this.setAttribute("uv",new pt(S,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $a(e.width,e.height,e.widthSegments,e.heightSegments)}}var VU=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,GU=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,WU=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,jU=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,XU=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,qU=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,YU=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,$U=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,KU=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,ZU=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,JU=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,QU=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,eF=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,tF=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,nF=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,iF=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,rF=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,sF=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,oF=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,aF=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,lF=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,cF=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,uF=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,hF=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,fF=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,dF=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,pF=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,mF=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,gF=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,vF=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,yF="gl_FragColor = linearToOutputTexel( gl_FragColor );",_F=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,xF=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,SF=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,wF=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,MF=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,EF=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,TF=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,AF=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,bF=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,CF=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,IF=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,RF=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,PF=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,LF=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,NF=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,DF=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,kF=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,OF=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,UF=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,FF=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,zF=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,BF=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,HF=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,VF=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,GF=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,WF=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,jF=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,XF=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,qF=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,YF=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,$F=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,KF=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,ZF=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,JF=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,QF=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,e4=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,t4=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,n4=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,i4=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,r4=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,s4=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,o4=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,a4=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,l4=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,c4=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,u4=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,h4=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,f4=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,d4=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,p4=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,m4=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,g4=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,v4=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,y4=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,_4=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,x4=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,S4=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,w4=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,M4=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,E4=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,T4=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,A4=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,b4=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,C4=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,I4=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,R4=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,P4=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,L4=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,N4=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,D4=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,k4=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,O4=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
		
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
		
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		
		#else
		
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,U4=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,F4=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,z4=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,B4=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const H4=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,V4=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,G4=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,W4=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,j4=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,X4=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,q4=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Y4=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,$4=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,K4=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Z4=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,J4=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Q4=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,ez=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,tz=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,nz=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,iz=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,rz=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sz=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,oz=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,az=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,lz=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,cz=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,uz=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,hz=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,fz=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,dz=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,pz=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,mz=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,gz=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,vz=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,yz=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,_z=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,xz=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,jt={alphahash_fragment:VU,alphahash_pars_fragment:GU,alphamap_fragment:WU,alphamap_pars_fragment:jU,alphatest_fragment:XU,alphatest_pars_fragment:qU,aomap_fragment:YU,aomap_pars_fragment:$U,batching_pars_vertex:KU,batching_vertex:ZU,begin_vertex:JU,beginnormal_vertex:QU,bsdfs:eF,iridescence_fragment:tF,bumpmap_pars_fragment:nF,clipping_planes_fragment:iF,clipping_planes_pars_fragment:rF,clipping_planes_pars_vertex:sF,clipping_planes_vertex:oF,color_fragment:aF,color_pars_fragment:lF,color_pars_vertex:cF,color_vertex:uF,common:hF,cube_uv_reflection_fragment:fF,defaultnormal_vertex:dF,displacementmap_pars_vertex:pF,displacementmap_vertex:mF,emissivemap_fragment:gF,emissivemap_pars_fragment:vF,colorspace_fragment:yF,colorspace_pars_fragment:_F,envmap_fragment:xF,envmap_common_pars_fragment:SF,envmap_pars_fragment:wF,envmap_pars_vertex:MF,envmap_physical_pars_fragment:DF,envmap_vertex:EF,fog_vertex:TF,fog_pars_vertex:AF,fog_fragment:bF,fog_pars_fragment:CF,gradientmap_pars_fragment:IF,lightmap_pars_fragment:RF,lights_lambert_fragment:PF,lights_lambert_pars_fragment:LF,lights_pars_begin:NF,lights_toon_fragment:kF,lights_toon_pars_fragment:OF,lights_phong_fragment:UF,lights_phong_pars_fragment:FF,lights_physical_fragment:zF,lights_physical_pars_fragment:BF,lights_fragment_begin:HF,lights_fragment_maps:VF,lights_fragment_end:GF,logdepthbuf_fragment:WF,logdepthbuf_pars_fragment:jF,logdepthbuf_pars_vertex:XF,logdepthbuf_vertex:qF,map_fragment:YF,map_pars_fragment:$F,map_particle_fragment:KF,map_particle_pars_fragment:ZF,metalnessmap_fragment:JF,metalnessmap_pars_fragment:QF,morphinstance_vertex:e4,morphcolor_vertex:t4,morphnormal_vertex:n4,morphtarget_pars_vertex:i4,morphtarget_vertex:r4,normal_fragment_begin:s4,normal_fragment_maps:o4,normal_pars_fragment:a4,normal_pars_vertex:l4,normal_vertex:c4,normalmap_pars_fragment:u4,clearcoat_normal_fragment_begin:h4,clearcoat_normal_fragment_maps:f4,clearcoat_pars_fragment:d4,iridescence_pars_fragment:p4,opaque_fragment:m4,packing:g4,premultiplied_alpha_fragment:v4,project_vertex:y4,dithering_fragment:_4,dithering_pars_fragment:x4,roughnessmap_fragment:S4,roughnessmap_pars_fragment:w4,shadowmap_pars_fragment:M4,shadowmap_pars_vertex:E4,shadowmap_vertex:T4,shadowmask_pars_fragment:A4,skinbase_vertex:b4,skinning_pars_vertex:C4,skinning_vertex:I4,skinnormal_vertex:R4,specularmap_fragment:P4,specularmap_pars_fragment:L4,tonemapping_fragment:N4,tonemapping_pars_fragment:D4,transmission_fragment:k4,transmission_pars_fragment:O4,uv_pars_fragment:U4,uv_pars_vertex:F4,uv_vertex:z4,worldpos_vertex:B4,background_vert:H4,background_frag:V4,backgroundCube_vert:G4,backgroundCube_frag:W4,cube_vert:j4,cube_frag:X4,depth_vert:q4,depth_frag:Y4,distanceRGBA_vert:$4,distanceRGBA_frag:K4,equirect_vert:Z4,equirect_frag:J4,linedashed_vert:Q4,linedashed_frag:ez,meshbasic_vert:tz,meshbasic_frag:nz,meshlambert_vert:iz,meshlambert_frag:rz,meshmatcap_vert:sz,meshmatcap_frag:oz,meshnormal_vert:az,meshnormal_frag:lz,meshphong_vert:cz,meshphong_frag:uz,meshphysical_vert:hz,meshphysical_frag:fz,meshtoon_vert:dz,meshtoon_frag:pz,points_vert:mz,points_frag:gz,shadow_vert:vz,shadow_frag:yz,sprite_vert:_z,sprite_frag:xz},rt={common:{diffuse:{value:new lt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Vt},alphaMap:{value:null},alphaMapTransform:{value:new Vt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Vt}},envmap:{envMap:{value:null},envMapRotation:{value:new Vt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Vt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Vt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Vt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Vt},normalScale:{value:new Ie(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Vt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Vt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Vt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Vt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new lt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new lt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Vt},alphaTest:{value:0},uvTransform:{value:new Vt}},sprite:{diffuse:{value:new lt(16777215)},opacity:{value:1},center:{value:new Ie(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Vt},alphaMap:{value:null},alphaMapTransform:{value:new Vt},alphaTest:{value:0}}},Cs={basic:{uniforms:Zi([rt.common,rt.specularmap,rt.envmap,rt.aomap,rt.lightmap,rt.fog]),vertexShader:jt.meshbasic_vert,fragmentShader:jt.meshbasic_frag},lambert:{uniforms:Zi([rt.common,rt.specularmap,rt.envmap,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.fog,rt.lights,{emissive:{value:new lt(0)}}]),vertexShader:jt.meshlambert_vert,fragmentShader:jt.meshlambert_frag},phong:{uniforms:Zi([rt.common,rt.specularmap,rt.envmap,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.fog,rt.lights,{emissive:{value:new lt(0)},specular:{value:new lt(1118481)},shininess:{value:30}}]),vertexShader:jt.meshphong_vert,fragmentShader:jt.meshphong_frag},standard:{uniforms:Zi([rt.common,rt.envmap,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.roughnessmap,rt.metalnessmap,rt.fog,rt.lights,{emissive:{value:new lt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:jt.meshphysical_vert,fragmentShader:jt.meshphysical_frag},toon:{uniforms:Zi([rt.common,rt.aomap,rt.lightmap,rt.emissivemap,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.gradientmap,rt.fog,rt.lights,{emissive:{value:new lt(0)}}]),vertexShader:jt.meshtoon_vert,fragmentShader:jt.meshtoon_frag},matcap:{uniforms:Zi([rt.common,rt.bumpmap,rt.normalmap,rt.displacementmap,rt.fog,{matcap:{value:null}}]),vertexShader:jt.meshmatcap_vert,fragmentShader:jt.meshmatcap_frag},points:{uniforms:Zi([rt.points,rt.fog]),vertexShader:jt.points_vert,fragmentShader:jt.points_frag},dashed:{uniforms:Zi([rt.common,rt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:jt.linedashed_vert,fragmentShader:jt.linedashed_frag},depth:{uniforms:Zi([rt.common,rt.displacementmap]),vertexShader:jt.depth_vert,fragmentShader:jt.depth_frag},normal:{uniforms:Zi([rt.common,rt.bumpmap,rt.normalmap,rt.displacementmap,{opacity:{value:1}}]),vertexShader:jt.meshnormal_vert,fragmentShader:jt.meshnormal_frag},sprite:{uniforms:Zi([rt.sprite,rt.fog]),vertexShader:jt.sprite_vert,fragmentShader:jt.sprite_frag},background:{uniforms:{uvTransform:{value:new Vt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:jt.background_vert,fragmentShader:jt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Vt}},vertexShader:jt.backgroundCube_vert,fragmentShader:jt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:jt.cube_vert,fragmentShader:jt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:jt.equirect_vert,fragmentShader:jt.equirect_frag},distanceRGBA:{uniforms:Zi([rt.common,rt.displacementmap,{referencePosition:{value:new j},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:jt.distanceRGBA_vert,fragmentShader:jt.distanceRGBA_frag},shadow:{uniforms:Zi([rt.lights,rt.fog,{color:{value:new lt(0)},opacity:{value:1}}]),vertexShader:jt.shadow_vert,fragmentShader:jt.shadow_frag}};Cs.physical={uniforms:Zi([Cs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Vt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Vt},clearcoatNormalScale:{value:new Ie(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Vt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Vt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Vt},sheen:{value:0},sheenColor:{value:new lt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Vt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Vt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Vt},transmissionSamplerSize:{value:new Ie},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Vt},attenuationDistance:{value:0},attenuationColor:{value:new lt(0)},specularColor:{value:new lt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Vt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Vt},anisotropyVector:{value:new Ie},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Vt}}]),vertexShader:jt.meshphysical_vert,fragmentShader:jt.meshphysical_frag};const Em={r:0,b:0,g:0},_l=new Xr,Sz=new Lt;function wz(n,e,t,i,r,s,o){const a=new lt(0);let c=s===!0?0:1,h,f,d=null,m=0,v=null;function _(w){let M=w.isScene===!0?w.background:null;return M&&M.isTexture&&(M=(w.backgroundBlurriness>0?t:e).get(M)),M}function E(w){let M=!1;const R=_(w);R===null?y(a,c):R&&R.isColor&&(y(R,1),M=!0);const z=n.xr.getEnvironmentBlendMode();z==="additive"?i.buffers.color.setClear(0,0,0,1,o):z==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||M)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function S(w,M){const R=_(M);R&&(R.isCubeTexture||R.mapping===uh)?(f===void 0&&(f=new Bn(new mc(1,1,1),new ir({name:"BackgroundCubeMaterial",uniforms:Ju(Cs.backgroundCube.uniforms),vertexShader:Cs.backgroundCube.vertexShader,fragmentShader:Cs.backgroundCube.fragmentShader,side:Hi,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(z,k,P){this.matrixWorld.copyPosition(P.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(f)),_l.copy(M.backgroundRotation),_l.x*=-1,_l.y*=-1,_l.z*=-1,R.isCubeTexture&&R.isRenderTargetTexture===!1&&(_l.y*=-1,_l.z*=-1),f.material.uniforms.envMap.value=R,f.material.uniforms.flipEnvMap.value=R.isCubeTexture&&R.isRenderTargetTexture===!1?-1:1,f.material.uniforms.backgroundBlurriness.value=M.backgroundBlurriness,f.material.uniforms.backgroundIntensity.value=M.backgroundIntensity,f.material.uniforms.backgroundRotation.value.setFromMatrix4(Sz.makeRotationFromEuler(_l)),f.material.toneMapped=hn.getTransfer(R.colorSpace)!==Tn,(d!==R||m!==R.version||v!==n.toneMapping)&&(f.material.needsUpdate=!0,d=R,m=R.version,v=n.toneMapping),f.layers.enableAll(),w.unshift(f,f.geometry,f.material,0,0,null)):R&&R.isTexture&&(h===void 0&&(h=new Bn(new $a(2,2),new ir({name:"BackgroundMaterial",uniforms:Ju(Cs.background.uniforms),vertexShader:Cs.background.vertexShader,fragmentShader:Cs.background.fragmentShader,side:jo,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(h)),h.material.uniforms.t2D.value=R,h.material.uniforms.backgroundIntensity.value=M.backgroundIntensity,h.material.toneMapped=hn.getTransfer(R.colorSpace)!==Tn,R.matrixAutoUpdate===!0&&R.updateMatrix(),h.material.uniforms.uvTransform.value.copy(R.matrix),(d!==R||m!==R.version||v!==n.toneMapping)&&(h.material.needsUpdate=!0,d=R,m=R.version,v=n.toneMapping),h.layers.enableAll(),w.unshift(h,h.geometry,h.material,0,0,null))}function y(w,M){w.getRGB(Em,JR(n)),i.buffers.color.setClear(Em.r,Em.g,Em.b,M,o)}return{getClearColor:function(){return a},setClearColor:function(w,M=1){a.set(w),c=M,y(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(w){c=w,y(a,c)},render:E,addToRenderList:S}}function Mz(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),i={},r=m(null);let s=r,o=!1;function a(T,L,H,U,se){let fe=!1;const oe=d(U,H,L);s!==oe&&(s=oe,h(s.object)),fe=v(T,U,H,se),fe&&_(T,U,H,se),se!==null&&e.update(se,n.ELEMENT_ARRAY_BUFFER),(fe||o)&&(o=!1,R(T,L,H,U),se!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(se).buffer))}function c(){return n.createVertexArray()}function h(T){return n.bindVertexArray(T)}function f(T){return n.deleteVertexArray(T)}function d(T,L,H){const U=H.wireframe===!0;let se=i[T.id];se===void 0&&(se={},i[T.id]=se);let fe=se[L.id];fe===void 0&&(fe={},se[L.id]=fe);let oe=fe[U];return oe===void 0&&(oe=m(c()),fe[U]=oe),oe}function m(T){const L=[],H=[],U=[];for(let se=0;se<t;se++)L[se]=0,H[se]=0,U[se]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:L,enabledAttributes:H,attributeDivisors:U,object:T,attributes:{},index:null}}function v(T,L,H,U){const se=s.attributes,fe=L.attributes;let oe=0;const Se=H.getAttributes();for(const q in Se)if(Se[q].location>=0){const ie=se[q];let ye=fe[q];if(ye===void 0&&(q==="instanceMatrix"&&T.instanceMatrix&&(ye=T.instanceMatrix),q==="instanceColor"&&T.instanceColor&&(ye=T.instanceColor)),ie===void 0||ie.attribute!==ye||ye&&ie.data!==ye.data)return!0;oe++}return s.attributesNum!==oe||s.index!==U}function _(T,L,H,U){const se={},fe=L.attributes;let oe=0;const Se=H.getAttributes();for(const q in Se)if(Se[q].location>=0){let ie=fe[q];ie===void 0&&(q==="instanceMatrix"&&T.instanceMatrix&&(ie=T.instanceMatrix),q==="instanceColor"&&T.instanceColor&&(ie=T.instanceColor));const ye={};ye.attribute=ie,ie&&ie.data&&(ye.data=ie.data),se[q]=ye,oe++}s.attributes=se,s.attributesNum=oe,s.index=U}function E(){const T=s.newAttributes;for(let L=0,H=T.length;L<H;L++)T[L]=0}function S(T){y(T,0)}function y(T,L){const H=s.newAttributes,U=s.enabledAttributes,se=s.attributeDivisors;H[T]=1,U[T]===0&&(n.enableVertexAttribArray(T),U[T]=1),se[T]!==L&&(n.vertexAttribDivisor(T,L),se[T]=L)}function w(){const T=s.newAttributes,L=s.enabledAttributes;for(let H=0,U=L.length;H<U;H++)L[H]!==T[H]&&(n.disableVertexAttribArray(H),L[H]=0)}function M(T,L,H,U,se,fe,oe){oe===!0?n.vertexAttribIPointer(T,L,H,se,fe):n.vertexAttribPointer(T,L,H,U,se,fe)}function R(T,L,H,U){E();const se=U.attributes,fe=H.getAttributes(),oe=L.defaultAttributeValues;for(const Se in fe){const q=fe[Se];if(q.location>=0){let le=se[Se];if(le===void 0&&(Se==="instanceMatrix"&&T.instanceMatrix&&(le=T.instanceMatrix),Se==="instanceColor"&&T.instanceColor&&(le=T.instanceColor)),le!==void 0){const ie=le.normalized,ye=le.itemSize,Ae=e.get(le);if(Ae===void 0)continue;const ze=Ae.buffer,pe=Ae.type,De=Ae.bytesPerElement,Oe=pe===n.INT||pe===n.UNSIGNED_INT||le.gpuType===Ud;if(le.isInterleavedBufferAttribute){const He=le.data,ut=He.stride,Tt=le.offset;if(He.isInstancedInterleavedBuffer){for(let mt=0;mt<q.locationSize;mt++)y(q.location+mt,He.meshPerAttribute);T.isInstancedMesh!==!0&&U._maxInstanceCount===void 0&&(U._maxInstanceCount=He.meshPerAttribute*He.count)}else for(let mt=0;mt<q.locationSize;mt++)S(q.location+mt);n.bindBuffer(n.ARRAY_BUFFER,ze);for(let mt=0;mt<q.locationSize;mt++)M(q.location+mt,ye/q.locationSize,pe,ie,ut*De,(Tt+ye/q.locationSize*mt)*De,Oe)}else{if(le.isInstancedBufferAttribute){for(let He=0;He<q.locationSize;He++)y(q.location+He,le.meshPerAttribute);T.isInstancedMesh!==!0&&U._maxInstanceCount===void 0&&(U._maxInstanceCount=le.meshPerAttribute*le.count)}else for(let He=0;He<q.locationSize;He++)S(q.location+He);n.bindBuffer(n.ARRAY_BUFFER,ze);for(let He=0;He<q.locationSize;He++)M(q.location+He,ye/q.locationSize,pe,ie,ye*De,ye/q.locationSize*He*De,Oe)}}else if(oe!==void 0){const ie=oe[Se];if(ie!==void 0)switch(ie.length){case 2:n.vertexAttrib2fv(q.location,ie);break;case 3:n.vertexAttrib3fv(q.location,ie);break;case 4:n.vertexAttrib4fv(q.location,ie);break;default:n.vertexAttrib1fv(q.location,ie)}}}}w()}function z(){b();for(const T in i){const L=i[T];for(const H in L){const U=L[H];for(const se in U)f(U[se].object),delete U[se];delete L[H]}delete i[T]}}function k(T){if(i[T.id]===void 0)return;const L=i[T.id];for(const H in L){const U=L[H];for(const se in U)f(U[se].object),delete U[se];delete L[H]}delete i[T.id]}function P(T){for(const L in i){const H=i[L];if(H[T.id]===void 0)continue;const U=H[T.id];for(const se in U)f(U[se].object),delete U[se];delete H[T.id]}}function b(){A(),o=!0,s!==r&&(s=r,h(s.object))}function A(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:a,reset:b,resetDefaultState:A,dispose:z,releaseStatesOfGeometry:k,releaseStatesOfProgram:P,initAttributes:E,enableAttribute:S,disableUnusedAttributes:w}}function Ez(n,e,t){let i;function r(h){i=h}function s(h,f){n.drawArrays(i,h,f),t.update(f,i,1)}function o(h,f,d){d!==0&&(n.drawArraysInstanced(i,h,f,d),t.update(f,i,d))}function a(h,f,d){if(d===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,h,0,f,0,d);let v=0;for(let _=0;_<d;_++)v+=f[_];t.update(v,i,1)}function c(h,f,d,m){if(d===0)return;const v=e.get("WEBGL_multi_draw");if(v===null)for(let _=0;_<h.length;_++)o(h[_],f[_],m[_]);else{v.multiDrawArraysInstancedWEBGL(i,h,0,f,0,m,0,d);let _=0;for(let E=0;E<d;E++)_+=f[E];for(let E=0;E<m.length;E++)t.update(_,i,m[E])}}this.setMode=r,this.render=s,this.renderInstances=o,this.renderMultiDraw=a,this.renderMultiDrawInstances=c}function Tz(n,e,t,i){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const k=e.get("EXT_texture_filter_anisotropic");r=n.getParameter(k.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function o(k){return!(k!==Qn&&i.convert(k)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function a(k){const P=k===xi&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(k!==Mr&&i.convert(k)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&k!==zn&&!P)}function c(k){if(k==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";k="mediump"}return k==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let h=t.precision!==void 0?t.precision:"highp";const f=c(h);f!==h&&(console.warn("THREE.WebGLRenderer:",h,"not supported, using",f,"instead."),h=f);const d=t.logarithmicDepthBuffer===!0,m=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),v=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),_=n.getParameter(n.MAX_TEXTURE_SIZE),E=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),S=n.getParameter(n.MAX_VERTEX_ATTRIBS),y=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),w=n.getParameter(n.MAX_VARYING_VECTORS),M=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),R=v>0,z=n.getParameter(n.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:c,textureFormatReadable:o,textureTypeReadable:a,precision:h,logarithmicDepthBuffer:d,maxTextures:m,maxVertexTextures:v,maxTextureSize:_,maxCubemapSize:E,maxAttributes:S,maxVertexUniforms:y,maxVaryings:w,maxFragmentUniforms:M,vertexTextures:R,maxSamples:z}}function Az(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new $s,a=new Vt,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(d,m){const v=d.length!==0||m||i!==0||r;return r=m,i=d.length,v},this.beginShadows=function(){s=!0,f(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,m){t=f(d,m,0)},this.setState=function(d,m,v){const _=d.clippingPlanes,E=d.clipIntersection,S=d.clipShadows,y=n.get(d);if(!r||_===null||_.length===0||s&&!S)s?f(null):h();else{const w=s?0:i,M=w*4;let R=y.clippingState||null;c.value=R,R=f(_,m,M,v);for(let z=0;z!==M;++z)R[z]=t[z];y.clippingState=R,this.numIntersection=E?this.numPlanes:0,this.numPlanes+=w}};function h(){c.value!==t&&(c.value=t,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function f(d,m,v,_){const E=d!==null?d.length:0;let S=null;if(E!==0){if(S=c.value,_!==!0||S===null){const y=v+E*4,w=m.matrixWorldInverse;a.getNormalMatrix(w),(S===null||S.length<y)&&(S=new Float32Array(y));for(let M=0,R=v;M!==E;++M,R+=4)o.copy(d[M]).applyMatrix4(w,a),o.normal.toArray(S,R),S[R+3]=o.constant}c.value=S,c.needsUpdate=!0}return e.numPlanes=E,e.numIntersection=0,S}}function bz(n){let e=new WeakMap;function t(o,a){return a===$u?o.mapping=oo:a===od&&(o.mapping=Ga),o}function i(o){if(o&&o.isTexture){const a=o.mapping;if(a===$u||a===od)if(e.has(o)){const c=e.get(o).texture;return t(c,o.mapping)}else{const c=o.image;if(c&&c.height>0){const h=new n1(c.height);return h.fromEquirectangularTexture(n,o),e.set(o,h),o.addEventListener("dispose",r),t(h.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}class Bo extends Hd{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,c=r-t;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=h*this.view.offsetX,o=s+h*this.view.width,a-=f*this.view.offsetY,c=a-f*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const Eu=4,iA=[.125,.215,.35,.446,.526,.582],Dl=20,I_=new Bo,rA=new lt;let R_=null,P_=0,L_=0,N_=!1;const Ll=(1+Math.sqrt(5))/2,tu=1/Ll,sA=[new j(-Ll,tu,0),new j(Ll,tu,0),new j(-tu,0,Ll),new j(tu,0,Ll),new j(0,Ll,-tu),new j(0,Ll,tu),new j(-1,1,-1),new j(1,1,-1),new j(-1,1,1),new j(1,1,1)];class xS{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){R_=this._renderer.getRenderTarget(),P_=this._renderer.getActiveCubeFace(),L_=this._renderer.getActiveMipmapLevel(),N_=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=lA(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=aA(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(R_,P_,L_),this._renderer.xr.enabled=N_,e.scissorTest=!1,Tm(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===oo||e.mapping===Ga?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),R_=this._renderer.getRenderTarget(),P_=this._renderer.getActiveCubeFace(),L_=this._renderer.getActiveMipmapLevel(),N_=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:mn,minFilter:mn,generateMipmaps:!1,type:xi,format:Qn,colorSpace:fs,depthBuffer:!1},r=oA(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=oA(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Cz(s)),this._blurMaterial=Iz(s,e,t)}return r}_compileMaterial(e){const t=new Bn(this._lodPlanes[0],e);this._renderer.compile(t,I_)}_sceneToCubeUV(e,t,i,r){const a=new Jn(90,1,t,i),c=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],f=this._renderer,d=f.autoClear,m=f.toneMapping;f.getClearColor(rA),f.toneMapping=no,f.autoClear=!1;const v=new Ko({name:"PMREM.Background",side:Hi,depthWrite:!1,depthTest:!1}),_=new Bn(new mc,v);let E=!1;const S=e.background;S?S.isColor&&(v.color.copy(S),e.background=null,E=!0):(v.color.copy(rA),E=!0);for(let y=0;y<6;y++){const w=y%3;w===0?(a.up.set(0,c[y],0),a.lookAt(h[y],0,0)):w===1?(a.up.set(0,0,c[y]),a.lookAt(0,h[y],0)):(a.up.set(0,c[y],0),a.lookAt(0,0,h[y]));const M=this._cubeSize;Tm(r,w*M,y>2?M:0,M,M),f.setRenderTarget(r),E&&f.render(_,a),f.render(e,a)}_.geometry.dispose(),_.material.dispose(),f.toneMapping=m,f.autoClear=d,e.background=S}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===oo||e.mapping===Ga;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=lA()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=aA());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new Bn(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const c=this._cubeSize;Tm(t,0,0,3*c,2*c),i.setRenderTarget(t),i.render(o,I_)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const o=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),a=sA[(r-s-1)%sA.length];this._blur(e,s-1,s,o,a)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const c=this._renderer,h=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const f=3,d=new Bn(this._lodPlanes[r],h),m=h.uniforms,v=this._sizeLods[i]-1,_=isFinite(s)?Math.PI/(2*v):2*Math.PI/(2*Dl-1),E=s/_,S=isFinite(s)?1+Math.floor(f*E):Dl;S>Dl&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${S} samples when the maximum is set to ${Dl}`);const y=[];let w=0;for(let P=0;P<Dl;++P){const b=P/E,A=Math.exp(-b*b/2);y.push(A),P===0?w+=A:P<S&&(w+=2*A)}for(let P=0;P<y.length;P++)y[P]=y[P]/w;m.envMap.value=e.texture,m.samples.value=S,m.weights.value=y,m.latitudinal.value=o==="latitudinal",a&&(m.poleAxis.value=a);const{_lodMax:M}=this;m.dTheta.value=_,m.mipInt.value=M-i;const R=this._sizeLods[r],z=3*R*(r>M-Eu?r-M+Eu:0),k=4*(this._cubeSize-R);Tm(t,z,k,3*R,2*R),c.setRenderTarget(t),c.render(d,I_)}}function Cz(n){const e=[],t=[],i=[];let r=n;const s=n-Eu+1+iA.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let c=1/a;o>n-Eu?c=iA[o-n+Eu-1]:o===0&&(c=0),i.push(c);const h=1/(a-2),f=-h,d=1+h,m=[f,f,d,f,d,d,f,f,d,d,f,d],v=6,_=6,E=3,S=2,y=1,w=new Float32Array(E*_*v),M=new Float32Array(S*_*v),R=new Float32Array(y*_*v);for(let k=0;k<v;k++){const P=k%3*2/3-1,b=k>2?0:-1,A=[P,b,0,P+2/3,b,0,P+2/3,b+1,0,P,b,0,P+2/3,b+1,0,P,b+1,0];w.set(A,E*_*k),M.set(m,S*_*k);const T=[k,k,k,k,k,k];R.set(T,y*_*k)}const z=new qt;z.setAttribute("position",new _n(w,E)),z.setAttribute("uv",new _n(M,S)),z.setAttribute("faceIndex",new _n(R,y)),e.push(z),r>Eu&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function oA(n,e,t){const i=new jr(n,e,t);return i.texture.mapping=uh,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Tm(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function Iz(n,e,t){const i=new Float32Array(Dl),r=new j(0,1,0);return new ir({name:"SphericalGaussianBlur",defines:{n:Dl,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:i1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:to,depthTest:!1,depthWrite:!1})}function aA(){return new ir({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:i1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:to,depthTest:!1,depthWrite:!1})}function lA(){return new ir({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:i1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:to,depthTest:!1,depthWrite:!1})}function i1(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Rz(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){const c=a.mapping,h=c===$u||c===od,f=c===oo||c===Ga;if(h||f){let d=e.get(a);const m=d!==void 0?d.texture.pmremVersion:0;if(a.isRenderTargetTexture&&a.pmremVersion!==m)return t===null&&(t=new xS(n)),d=h?t.fromEquirectangular(a,d):t.fromCubemap(a,d),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),d.texture;if(d!==void 0)return d.texture;{const v=a.image;return h&&v&&v.height>0||f&&v&&r(v)?(t===null&&(t=new xS(n)),d=h?t.fromEquirectangular(a):t.fromCubemap(a),d.texture.pmremVersion=a.pmremVersion,e.set(a,d),a.addEventListener("dispose",s),d.texture):null}}}return a}function r(a){let c=0;const h=6;for(let f=0;f<h;f++)a[f]!==void 0&&c++;return c===h}function s(a){const c=a.target;c.removeEventListener("dispose",s);const h=e.get(c);h!==void 0&&(e.delete(c),h.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function Pz(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(i){const r=t(i);return r===null&&ku("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function Lz(n,e,t,i){const r={},s=new WeakMap;function o(d){const m=d.target;m.index!==null&&e.remove(m.index);for(const _ in m.attributes)e.remove(m.attributes[_]);for(const _ in m.morphAttributes){const E=m.morphAttributes[_];for(let S=0,y=E.length;S<y;S++)e.remove(E[S])}m.removeEventListener("dispose",o),delete r[m.id];const v=s.get(m);v&&(e.remove(v),s.delete(m)),i.releaseStatesOfGeometry(m),m.isInstancedBufferGeometry===!0&&delete m._maxInstanceCount,t.memory.geometries--}function a(d,m){return r[m.id]===!0||(m.addEventListener("dispose",o),r[m.id]=!0,t.memory.geometries++),m}function c(d){const m=d.attributes;for(const _ in m)e.update(m[_],n.ARRAY_BUFFER);const v=d.morphAttributes;for(const _ in v){const E=v[_];for(let S=0,y=E.length;S<y;S++)e.update(E[S],n.ARRAY_BUFFER)}}function h(d){const m=[],v=d.index,_=d.attributes.position;let E=0;if(v!==null){const w=v.array;E=v.version;for(let M=0,R=w.length;M<R;M+=3){const z=w[M+0],k=w[M+1],P=w[M+2];m.push(z,k,k,P,P,z)}}else if(_!==void 0){const w=_.array;E=_.version;for(let M=0,R=w.length/3-1;M<R;M+=3){const z=M+0,k=M+1,P=M+2;m.push(z,k,k,P,P,z)}}else return;const S=new(qR(m)?e1:Qw)(m,1);S.version=E;const y=s.get(d);y&&e.remove(y),s.set(d,S)}function f(d){const m=s.get(d);if(m){const v=d.index;v!==null&&m.version<v.version&&h(d)}else h(d);return s.get(d)}return{get:a,update:c,getWireframeAttribute:f}}function Nz(n,e,t){let i;function r(m){i=m}let s,o;function a(m){s=m.type,o=m.bytesPerElement}function c(m,v){n.drawElements(i,v,s,m*o),t.update(v,i,1)}function h(m,v,_){_!==0&&(n.drawElementsInstanced(i,v,s,m*o,_),t.update(v,i,_))}function f(m,v,_){if(_===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,v,0,s,m,0,_);let S=0;for(let y=0;y<_;y++)S+=v[y];t.update(S,i,1)}function d(m,v,_,E){if(_===0)return;const S=e.get("WEBGL_multi_draw");if(S===null)for(let y=0;y<m.length;y++)h(m[y]/o,v[y],E[y]);else{S.multiDrawElementsInstancedWEBGL(i,v,0,s,m,0,E,0,_);let y=0;for(let w=0;w<_;w++)y+=v[w];for(let w=0;w<E.length;w++)t.update(y,i,E[w])}}this.setMode=r,this.setIndex=a,this.render=c,this.renderInstances=h,this.renderMultiDraw=f,this.renderMultiDrawInstances=d}function Dz(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function kz(n,e,t){const i=new WeakMap,r=new pn;function s(o,a,c){const h=o.morphTargetInfluences,f=a.morphAttributes.position||a.morphAttributes.normal||a.morphAttributes.color,d=f!==void 0?f.length:0;let m=i.get(a);if(m===void 0||m.count!==d){let T=function(){b.dispose(),i.delete(a),a.removeEventListener("dispose",T)};var v=T;m!==void 0&&m.texture.dispose();const _=a.morphAttributes.position!==void 0,E=a.morphAttributes.normal!==void 0,S=a.morphAttributes.color!==void 0,y=a.morphAttributes.position||[],w=a.morphAttributes.normal||[],M=a.morphAttributes.color||[];let R=0;_===!0&&(R=1),E===!0&&(R=2),S===!0&&(R=3);let z=a.attributes.position.count*R,k=1;z>e.maxTextureSize&&(k=Math.ceil(z/e.maxTextureSize),z=e.maxTextureSize);const P=new Float32Array(z*k*4*d),b=new p0(P,z,k,d);b.type=zn,b.needsUpdate=!0;const A=R*4;for(let L=0;L<d;L++){const H=y[L],U=w[L],se=M[L],fe=z*k*4*L;for(let oe=0;oe<H.count;oe++){const Se=oe*A;_===!0&&(r.fromBufferAttribute(H,oe),P[fe+Se+0]=r.x,P[fe+Se+1]=r.y,P[fe+Se+2]=r.z,P[fe+Se+3]=0),E===!0&&(r.fromBufferAttribute(U,oe),P[fe+Se+4]=r.x,P[fe+Se+5]=r.y,P[fe+Se+6]=r.z,P[fe+Se+7]=0),S===!0&&(r.fromBufferAttribute(se,oe),P[fe+Se+8]=r.x,P[fe+Se+9]=r.y,P[fe+Se+10]=r.z,P[fe+Se+11]=se.itemSize===4?r.w:1)}}m={count:d,texture:b,size:new Ie(z,k)},i.set(a,m),a.addEventListener("dispose",T)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)c.getUniforms().setValue(n,"morphTexture",o.morphTexture,t);else{let _=0;for(let S=0;S<h.length;S++)_+=h[S];const E=a.morphTargetsRelative?1:1-_;c.getUniforms().setValue(n,"morphTargetBaseInfluence",E),c.getUniforms().setValue(n,"morphTargetInfluences",h)}c.getUniforms().setValue(n,"morphTargetsTexture",m.texture,t),c.getUniforms().setValue(n,"morphTargetsTextureSize",m.size)}return{update:s}}function Oz(n,e,t,i){let r=new WeakMap;function s(c){const h=i.render.frame,f=c.geometry,d=e.get(c,f);if(r.get(d)!==h&&(e.update(d),r.set(d,h)),c.isInstancedMesh&&(c.hasEventListener("dispose",a)===!1&&c.addEventListener("dispose",a),r.get(c)!==h&&(t.update(c.instanceMatrix,n.ARRAY_BUFFER),c.instanceColor!==null&&t.update(c.instanceColor,n.ARRAY_BUFFER),r.set(c,h))),c.isSkinnedMesh){const m=c.skeleton;r.get(m)!==h&&(m.update(),r.set(m,h))}return d}function o(){r=new WeakMap}function a(c){const h=c.target;h.removeEventListener("dispose",a),t.remove(h.instanceMatrix),h.instanceColor!==null&&t.remove(h.instanceColor)}return{update:s,dispose:o}}class r1 extends yn{constructor(e,t,i,r,s,o,a,c,h,f=$l){if(f!==$l&&f!==oc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&f===$l&&(i=ao),i===void 0&&f===oc&&(i=sc),super(null,r,s,o,a,c,f,i,h),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:_i,this.minFilter=c!==void 0?c:_i,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const tP=new yn,cA=new r1(1,1),nP=new p0,iP=new Jw,rP=new Vd,uA=[],hA=[],fA=new Float32Array(16),dA=new Float32Array(9),pA=new Float32Array(4);function hh(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=uA[r];if(s===void 0&&(s=new Float32Array(r),uA[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function fi(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function di(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function m0(n,e){let t=hA[e];t===void 0&&(t=new Int32Array(e),hA[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function Uz(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Fz(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(fi(t,e))return;n.uniform2fv(this.addr,e),di(t,e)}}function zz(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(fi(t,e))return;n.uniform3fv(this.addr,e),di(t,e)}}function Bz(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(fi(t,e))return;n.uniform4fv(this.addr,e),di(t,e)}}function Hz(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(fi(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),di(t,e)}else{if(fi(t,i))return;pA.set(i),n.uniformMatrix2fv(this.addr,!1,pA),di(t,i)}}function Vz(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(fi(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),di(t,e)}else{if(fi(t,i))return;dA.set(i),n.uniformMatrix3fv(this.addr,!1,dA),di(t,i)}}function Gz(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(fi(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),di(t,e)}else{if(fi(t,i))return;fA.set(i),n.uniformMatrix4fv(this.addr,!1,fA),di(t,i)}}function Wz(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function jz(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(fi(t,e))return;n.uniform2iv(this.addr,e),di(t,e)}}function Xz(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(fi(t,e))return;n.uniform3iv(this.addr,e),di(t,e)}}function qz(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(fi(t,e))return;n.uniform4iv(this.addr,e),di(t,e)}}function Yz(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function $z(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(fi(t,e))return;n.uniform2uiv(this.addr,e),di(t,e)}}function Kz(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(fi(t,e))return;n.uniform3uiv(this.addr,e),di(t,e)}}function Zz(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(fi(t,e))return;n.uniform4uiv(this.addr,e),di(t,e)}}function Jz(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r);let s;this.type===n.SAMPLER_2D_SHADOW?(cA.compareFunction=Kw,s=cA):s=tP,t.setTexture2D(e||s,r)}function Qz(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||iP,r)}function eB(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||rP,r)}function tB(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||nP,r)}function nB(n){switch(n){case 5126:return Uz;case 35664:return Fz;case 35665:return zz;case 35666:return Bz;case 35674:return Hz;case 35675:return Vz;case 35676:return Gz;case 5124:case 35670:return Wz;case 35667:case 35671:return jz;case 35668:case 35672:return Xz;case 35669:case 35673:return qz;case 5125:return Yz;case 36294:return $z;case 36295:return Kz;case 36296:return Zz;case 35678:case 36198:case 36298:case 36306:case 35682:return Jz;case 35679:case 36299:case 36307:return Qz;case 35680:case 36300:case 36308:case 36293:return eB;case 36289:case 36303:case 36311:case 36292:return tB}}function iB(n,e){n.uniform1fv(this.addr,e)}function rB(n,e){const t=hh(e,this.size,2);n.uniform2fv(this.addr,t)}function sB(n,e){const t=hh(e,this.size,3);n.uniform3fv(this.addr,t)}function oB(n,e){const t=hh(e,this.size,4);n.uniform4fv(this.addr,t)}function aB(n,e){const t=hh(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function lB(n,e){const t=hh(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function cB(n,e){const t=hh(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function uB(n,e){n.uniform1iv(this.addr,e)}function hB(n,e){n.uniform2iv(this.addr,e)}function fB(n,e){n.uniform3iv(this.addr,e)}function dB(n,e){n.uniform4iv(this.addr,e)}function pB(n,e){n.uniform1uiv(this.addr,e)}function mB(n,e){n.uniform2uiv(this.addr,e)}function gB(n,e){n.uniform3uiv(this.addr,e)}function vB(n,e){n.uniform4uiv(this.addr,e)}function yB(n,e,t){const i=this.cache,r=e.length,s=m0(t,r);fi(i,s)||(n.uniform1iv(this.addr,s),di(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||tP,s[o])}function _B(n,e,t){const i=this.cache,r=e.length,s=m0(t,r);fi(i,s)||(n.uniform1iv(this.addr,s),di(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||iP,s[o])}function xB(n,e,t){const i=this.cache,r=e.length,s=m0(t,r);fi(i,s)||(n.uniform1iv(this.addr,s),di(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||rP,s[o])}function SB(n,e,t){const i=this.cache,r=e.length,s=m0(t,r);fi(i,s)||(n.uniform1iv(this.addr,s),di(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||nP,s[o])}function wB(n){switch(n){case 5126:return iB;case 35664:return rB;case 35665:return sB;case 35666:return oB;case 35674:return aB;case 35675:return lB;case 35676:return cB;case 5124:case 35670:return uB;case 35667:case 35671:return hB;case 35668:case 35672:return fB;case 35669:case 35673:return dB;case 5125:return pB;case 36294:return mB;case 36295:return gB;case 36296:return vB;case 35678:case 36198:case 36298:case 36306:case 35682:return yB;case 35679:case 36299:case 36307:return _B;case 35680:case 36300:case 36308:case 36293:return xB;case 36289:case 36303:case 36311:case 36292:return SB}}class MB{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=nB(t.type)}}class EB{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=wB(t.type)}}class TB{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const D_=/(\w+)(\])?(\[|\.)?/g;function mA(n,e){n.seq.push(e),n.map[e.id]=e}function AB(n,e,t){const i=n.name,r=i.length;for(D_.lastIndex=0;;){const s=D_.exec(i),o=D_.lastIndex;let a=s[1];const c=s[2]==="]",h=s[3];if(c&&(a=a|0),h===void 0||h==="["&&o+2===r){mA(t,h===void 0?new MB(a,n,e):new EB(a,n,e));break}else{let d=t.map[a];d===void 0&&(d=new TB(a),mA(t,d)),t=d}}}class _g{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);AB(s,o,this)}}setValue(e,t,i,r){const s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],c=i[a.id];c.needsUpdate!==!1&&a.setValue(e,c.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function gA(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const bB=37297;let CB=0;function IB(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join(`
`)}function RB(n){const e=hn.getPrimaries(hn.workingColorSpace),t=hn.getPrimaries(n);let i;switch(e===t?i="":e===dd&&t===fd?i="LinearDisplayP3ToLinearSRGB":e===fd&&t===dd&&(i="LinearSRGBToLinearDisplayP3"),n){case fs:case Bd:return[i,"LinearTransferOETF"];case Ur:case d0:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}function vA(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+IB(n.getShaderSource(e),o)}else return r}function PB(n,e){const t=RB(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function LB(n,e){let t;switch(e){case bR:t="Linear";break;case CR:t="Reinhard";break;case IR:t="Cineon";break;case Bw:t="ACESFilmic";break;case PR:t="AgX";break;case LR:t="Neutral";break;case RR:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Am=new j;function NB(){hn.getLuminanceCoefficients(Am);const n=Am.x.toFixed(4),e=Am.y.toFixed(4),t=Am.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function DB(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(gf).join(`
`)}function kB(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function OB(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function gf(n){return n!==""}function yA(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function _A(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const UB=/^[ \t]*#include +<([\w\d./]+)>/gm;function SS(n){return n.replace(UB,zB)}const FB=new Map;function zB(n,e){let t=jt[e];if(t===void 0){const i=FB.get(e);if(i!==void 0)t=jt[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return SS(t)}const BB=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function xA(n){return n.replace(BB,HB)}function HB(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function SA(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function VB(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===s0?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===Af?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Ts&&(e="SHADOWMAP_TYPE_VSM"),e}function GB(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case oo:case Ga:e="ENVMAP_TYPE_CUBE";break;case uh:e="ENVMAP_TYPE_CUBE_UV";break}return e}function WB(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Ga:e="ENVMAP_MODE_REFRACTION";break}return e}function jB(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Od:e="ENVMAP_BLENDING_MULTIPLY";break;case TR:e="ENVMAP_BLENDING_MIX";break;case AR:e="ENVMAP_BLENDING_ADD";break}return e}function XB(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function qB(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const c=VB(t),h=GB(t),f=WB(t),d=jB(t),m=XB(t),v=DB(t),_=kB(s),E=r.createProgram();let S,y,w=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(S=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_].filter(gf).join(`
`),S.length>0&&(S+=`
`),y=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_].filter(gf).join(`
`),y.length>0&&(y+=`
`)):(S=[SA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(gf).join(`
`),y=[SA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,_,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+f:"",t.envMap?"#define "+d:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==no?"#define TONE_MAPPING":"",t.toneMapping!==no?jt.tonemapping_pars_fragment:"",t.toneMapping!==no?LB("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",jt.colorspace_pars_fragment,PB("linearToOutputTexel",t.outputColorSpace),NB(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(gf).join(`
`)),o=SS(o),o=yA(o,t),o=_A(o,t),a=SS(a),a=yA(a,t),a=_A(a,t),o=xA(o),a=xA(a),t.isRawShaderMaterial!==!0&&(w=`#version 300 es
`,S=[v,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+S,y=["#define varying in",t.glslVersion===_S?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===_S?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+y);const M=w+S+o,R=w+y+a,z=gA(r,r.VERTEX_SHADER,M),k=gA(r,r.FRAGMENT_SHADER,R);r.attachShader(E,z),r.attachShader(E,k),t.index0AttributeName!==void 0?r.bindAttribLocation(E,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(E,0,"position"),r.linkProgram(E);function P(L){if(n.debug.checkShaderErrors){const H=r.getProgramInfoLog(E).trim(),U=r.getShaderInfoLog(z).trim(),se=r.getShaderInfoLog(k).trim();let fe=!0,oe=!0;if(r.getProgramParameter(E,r.LINK_STATUS)===!1)if(fe=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,E,z,k);else{const Se=vA(r,z,"vertex"),q=vA(r,k,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(E,r.VALIDATE_STATUS)+`

Material Name: `+L.name+`
Material Type: `+L.type+`

Program Info Log: `+H+`
`+Se+`
`+q)}else H!==""?console.warn("THREE.WebGLProgram: Program Info Log:",H):(U===""||se==="")&&(oe=!1);oe&&(L.diagnostics={runnable:fe,programLog:H,vertexShader:{log:U,prefix:S},fragmentShader:{log:se,prefix:y}})}r.deleteShader(z),r.deleteShader(k),b=new _g(r,E),A=OB(r,E)}let b;this.getUniforms=function(){return b===void 0&&P(this),b};let A;this.getAttributes=function(){return A===void 0&&P(this),A};let T=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return T===!1&&(T=r.getProgramParameter(E,bB)),T},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(E),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=CB++,this.cacheKey=e,this.usedTimes=1,this.program=E,this.vertexShader=z,this.fragmentShader=k,this}let YB=0;class $B{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new KB(e),t.set(e,i)),i}}class KB{constructor(e){this.id=YB++,this.code=e,this.usedTimes=0}}function ZB(n,e,t,i,r,s,o){const a=new Zl,c=new $B,h=new Set,f=[],d=r.logarithmicDepthBuffer,m=r.vertexTextures;let v=r.precision;const _={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function E(A){return h.add(A),A===0?"uv":`uv${A}`}function S(A,T,L,H,U){const se=H.fog,fe=U.geometry,oe=A.isMeshStandardMaterial?H.environment:null,Se=(A.isMeshStandardMaterial?t:e).get(A.envMap||oe),q=Se&&Se.mapping===uh?Se.image.height:null,le=_[A.type];A.precision!==null&&(v=r.getMaxPrecision(A.precision),v!==A.precision&&console.warn("THREE.WebGLProgram.getParameters:",A.precision,"not supported, using",v,"instead."));const ie=fe.morphAttributes.position||fe.morphAttributes.normal||fe.morphAttributes.color,ye=ie!==void 0?ie.length:0;let Ae=0;fe.morphAttributes.position!==void 0&&(Ae=1),fe.morphAttributes.normal!==void 0&&(Ae=2),fe.morphAttributes.color!==void 0&&(Ae=3);let ze,pe,De,Oe;if(le){const Ut=Cs[le];ze=Ut.vertexShader,pe=Ut.fragmentShader}else ze=A.vertexShader,pe=A.fragmentShader,c.update(A),De=c.getVertexShaderID(A),Oe=c.getFragmentShaderID(A);const He=n.getRenderTarget(),ut=U.isInstancedMesh===!0,Tt=U.isBatchedMesh===!0,mt=!!A.map,At=!!A.matcap,X=!!Se,Fe=!!A.aoMap,Be=!!A.lightMap,Ke=!!A.bumpMap,Pe=!!A.normalMap,gt=!!A.displacementMap,Ze=!!A.emissiveMap,st=!!A.metalnessMap,Z=!!A.roughnessMap,B=A.anisotropy>0,me=A.clearcoat>0,Re=A.dispersion>0,Te=A.iridescence>0,ke=A.sheen>0,it=A.transmission>0,Ge=B&&!!A.anisotropyMap,Qe=me&&!!A.clearcoatMap,bt=me&&!!A.clearcoatNormalMap,We=me&&!!A.clearcoatRoughnessMap,nt=Te&&!!A.iridescenceMap,Dt=Te&&!!A.iridescenceThicknessMap,yt=ke&&!!A.sheenColorMap,$e=ke&&!!A.sheenRoughnessMap,wt=!!A.specularMap,te=!!A.specularColorMap,Le=!!A.specularIntensityMap,Q=it&&!!A.transmissionMap,Ce=it&&!!A.thicknessMap,re=!!A.gradientMap,Me=!!A.alphaMap,je=A.alphaTest>0,Mt=!!A.alphaHash,Nt=!!A.extensions;let $t=no;A.toneMapped&&(He===null||He.isXRRenderTarget===!0)&&($t=n.toneMapping);const en={shaderID:le,shaderType:A.type,shaderName:A.name,vertexShader:ze,fragmentShader:pe,defines:A.defines,customVertexShaderID:De,customFragmentShaderID:Oe,isRawShaderMaterial:A.isRawShaderMaterial===!0,glslVersion:A.glslVersion,precision:v,batching:Tt,batchingColor:Tt&&U._colorsTexture!==null,instancing:ut,instancingColor:ut&&U.instanceColor!==null,instancingMorph:ut&&U.morphTexture!==null,supportsVertexTextures:m,outputColorSpace:He===null?n.outputColorSpace:He.isXRRenderTarget===!0?He.texture.colorSpace:fs,alphaToCoverage:!!A.alphaToCoverage,map:mt,matcap:At,envMap:X,envMapMode:X&&Se.mapping,envMapCubeUVHeight:q,aoMap:Fe,lightMap:Be,bumpMap:Ke,normalMap:Pe,displacementMap:m&&gt,emissiveMap:Ze,normalMapObjectSpace:Pe&&A.normalMapType===zR,normalMapTangentSpace:Pe&&A.normalMapType===Ya,metalnessMap:st,roughnessMap:Z,anisotropy:B,anisotropyMap:Ge,clearcoat:me,clearcoatMap:Qe,clearcoatNormalMap:bt,clearcoatRoughnessMap:We,dispersion:Re,iridescence:Te,iridescenceMap:nt,iridescenceThicknessMap:Dt,sheen:ke,sheenColorMap:yt,sheenRoughnessMap:$e,specularMap:wt,specularColorMap:te,specularIntensityMap:Le,transmission:it,transmissionMap:Q,thicknessMap:Ce,gradientMap:re,opaque:A.transparent===!1&&A.blending===Yl&&A.alphaToCoverage===!1,alphaMap:Me,alphaTest:je,alphaHash:Mt,combine:A.combine,mapUv:mt&&E(A.map.channel),aoMapUv:Fe&&E(A.aoMap.channel),lightMapUv:Be&&E(A.lightMap.channel),bumpMapUv:Ke&&E(A.bumpMap.channel),normalMapUv:Pe&&E(A.normalMap.channel),displacementMapUv:gt&&E(A.displacementMap.channel),emissiveMapUv:Ze&&E(A.emissiveMap.channel),metalnessMapUv:st&&E(A.metalnessMap.channel),roughnessMapUv:Z&&E(A.roughnessMap.channel),anisotropyMapUv:Ge&&E(A.anisotropyMap.channel),clearcoatMapUv:Qe&&E(A.clearcoatMap.channel),clearcoatNormalMapUv:bt&&E(A.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:We&&E(A.clearcoatRoughnessMap.channel),iridescenceMapUv:nt&&E(A.iridescenceMap.channel),iridescenceThicknessMapUv:Dt&&E(A.iridescenceThicknessMap.channel),sheenColorMapUv:yt&&E(A.sheenColorMap.channel),sheenRoughnessMapUv:$e&&E(A.sheenRoughnessMap.channel),specularMapUv:wt&&E(A.specularMap.channel),specularColorMapUv:te&&E(A.specularColorMap.channel),specularIntensityMapUv:Le&&E(A.specularIntensityMap.channel),transmissionMapUv:Q&&E(A.transmissionMap.channel),thicknessMapUv:Ce&&E(A.thicknessMap.channel),alphaMapUv:Me&&E(A.alphaMap.channel),vertexTangents:!!fe.attributes.tangent&&(Pe||B),vertexColors:A.vertexColors,vertexAlphas:A.vertexColors===!0&&!!fe.attributes.color&&fe.attributes.color.itemSize===4,pointsUvs:U.isPoints===!0&&!!fe.attributes.uv&&(mt||Me),fog:!!se,useFog:A.fog===!0,fogExp2:!!se&&se.isFogExp2,flatShading:A.flatShading===!0,sizeAttenuation:A.sizeAttenuation===!0,logarithmicDepthBuffer:d,skinning:U.isSkinnedMesh===!0,morphTargets:fe.morphAttributes.position!==void 0,morphNormals:fe.morphAttributes.normal!==void 0,morphColors:fe.morphAttributes.color!==void 0,morphTargetsCount:ye,morphTextureStride:Ae,numDirLights:T.directional.length,numPointLights:T.point.length,numSpotLights:T.spot.length,numSpotLightMaps:T.spotLightMap.length,numRectAreaLights:T.rectArea.length,numHemiLights:T.hemi.length,numDirLightShadows:T.directionalShadowMap.length,numPointLightShadows:T.pointShadowMap.length,numSpotLightShadows:T.spotShadowMap.length,numSpotLightShadowsWithMaps:T.numSpotLightShadowsWithMaps,numLightProbes:T.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:A.dithering,shadowMapEnabled:n.shadowMap.enabled&&L.length>0,shadowMapType:n.shadowMap.type,toneMapping:$t,decodeVideoTexture:mt&&A.map.isVideoTexture===!0&&hn.getTransfer(A.map.colorSpace)===Tn,premultipliedAlpha:A.premultipliedAlpha,doubleSided:A.side===Is,flipSided:A.side===Hi,useDepthPacking:A.depthPacking>=0,depthPacking:A.depthPacking||0,index0AttributeName:A.index0AttributeName,extensionClipCullDistance:Nt&&A.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Nt&&A.extensions.multiDraw===!0||Tt)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:A.customProgramCacheKey()};return en.vertexUv1s=h.has(1),en.vertexUv2s=h.has(2),en.vertexUv3s=h.has(3),h.clear(),en}function y(A){const T=[];if(A.shaderID?T.push(A.shaderID):(T.push(A.customVertexShaderID),T.push(A.customFragmentShaderID)),A.defines!==void 0)for(const L in A.defines)T.push(L),T.push(A.defines[L]);return A.isRawShaderMaterial===!1&&(w(T,A),M(T,A),T.push(n.outputColorSpace)),T.push(A.customProgramCacheKey),T.join()}function w(A,T){A.push(T.precision),A.push(T.outputColorSpace),A.push(T.envMapMode),A.push(T.envMapCubeUVHeight),A.push(T.mapUv),A.push(T.alphaMapUv),A.push(T.lightMapUv),A.push(T.aoMapUv),A.push(T.bumpMapUv),A.push(T.normalMapUv),A.push(T.displacementMapUv),A.push(T.emissiveMapUv),A.push(T.metalnessMapUv),A.push(T.roughnessMapUv),A.push(T.anisotropyMapUv),A.push(T.clearcoatMapUv),A.push(T.clearcoatNormalMapUv),A.push(T.clearcoatRoughnessMapUv),A.push(T.iridescenceMapUv),A.push(T.iridescenceThicknessMapUv),A.push(T.sheenColorMapUv),A.push(T.sheenRoughnessMapUv),A.push(T.specularMapUv),A.push(T.specularColorMapUv),A.push(T.specularIntensityMapUv),A.push(T.transmissionMapUv),A.push(T.thicknessMapUv),A.push(T.combine),A.push(T.fogExp2),A.push(T.sizeAttenuation),A.push(T.morphTargetsCount),A.push(T.morphAttributeCount),A.push(T.numDirLights),A.push(T.numPointLights),A.push(T.numSpotLights),A.push(T.numSpotLightMaps),A.push(T.numHemiLights),A.push(T.numRectAreaLights),A.push(T.numDirLightShadows),A.push(T.numPointLightShadows),A.push(T.numSpotLightShadows),A.push(T.numSpotLightShadowsWithMaps),A.push(T.numLightProbes),A.push(T.shadowMapType),A.push(T.toneMapping),A.push(T.numClippingPlanes),A.push(T.numClipIntersection),A.push(T.depthPacking)}function M(A,T){a.disableAll(),T.supportsVertexTextures&&a.enable(0),T.instancing&&a.enable(1),T.instancingColor&&a.enable(2),T.instancingMorph&&a.enable(3),T.matcap&&a.enable(4),T.envMap&&a.enable(5),T.normalMapObjectSpace&&a.enable(6),T.normalMapTangentSpace&&a.enable(7),T.clearcoat&&a.enable(8),T.iridescence&&a.enable(9),T.alphaTest&&a.enable(10),T.vertexColors&&a.enable(11),T.vertexAlphas&&a.enable(12),T.vertexUv1s&&a.enable(13),T.vertexUv2s&&a.enable(14),T.vertexUv3s&&a.enable(15),T.vertexTangents&&a.enable(16),T.anisotropy&&a.enable(17),T.alphaHash&&a.enable(18),T.batching&&a.enable(19),T.dispersion&&a.enable(20),T.batchingColor&&a.enable(21),A.push(a.mask),a.disableAll(),T.fog&&a.enable(0),T.useFog&&a.enable(1),T.flatShading&&a.enable(2),T.logarithmicDepthBuffer&&a.enable(3),T.skinning&&a.enable(4),T.morphTargets&&a.enable(5),T.morphNormals&&a.enable(6),T.morphColors&&a.enable(7),T.premultipliedAlpha&&a.enable(8),T.shadowMapEnabled&&a.enable(9),T.doubleSided&&a.enable(10),T.flipSided&&a.enable(11),T.useDepthPacking&&a.enable(12),T.dithering&&a.enable(13),T.transmission&&a.enable(14),T.sheen&&a.enable(15),T.opaque&&a.enable(16),T.pointsUvs&&a.enable(17),T.decodeVideoTexture&&a.enable(18),T.alphaToCoverage&&a.enable(19),A.push(a.mask)}function R(A){const T=_[A.type];let L;if(T){const H=Cs[T];L=t1.clone(H.uniforms)}else L=A.uniforms;return L}function z(A,T){let L;for(let H=0,U=f.length;H<U;H++){const se=f[H];if(se.cacheKey===T){L=se,++L.usedTimes;break}}return L===void 0&&(L=new qB(n,T,A,s),f.push(L)),L}function k(A){if(--A.usedTimes===0){const T=f.indexOf(A);f[T]=f[f.length-1],f.pop(),A.destroy()}}function P(A){c.remove(A)}function b(){c.dispose()}return{getParameters:S,getProgramCacheKey:y,getUniforms:R,acquireProgram:z,releaseProgram:k,releaseShaderCache:P,programs:f,dispose:b}}function JB(){let n=new WeakMap;function e(o){return n.has(o)}function t(o){let a=n.get(o);return a===void 0&&(a={},n.set(o,a)),a}function i(o){n.delete(o)}function r(o,a,c){n.get(o)[a]=c}function s(){n=new WeakMap}return{has:e,get:t,remove:i,update:r,dispose:s}}function QB(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function wA(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function MA(){const n=[];let e=0;const t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function o(d,m,v,_,E,S){let y=n[e];return y===void 0?(y={id:d.id,object:d,geometry:m,material:v,groupOrder:_,renderOrder:d.renderOrder,z:E,group:S},n[e]=y):(y.id=d.id,y.object=d,y.geometry=m,y.material=v,y.groupOrder=_,y.renderOrder=d.renderOrder,y.z=E,y.group=S),e++,y}function a(d,m,v,_,E,S){const y=o(d,m,v,_,E,S);v.transmission>0?i.push(y):v.transparent===!0?r.push(y):t.push(y)}function c(d,m,v,_,E,S){const y=o(d,m,v,_,E,S);v.transmission>0?i.unshift(y):v.transparent===!0?r.unshift(y):t.unshift(y)}function h(d,m){t.length>1&&t.sort(d||QB),i.length>1&&i.sort(m||wA),r.length>1&&r.sort(m||wA)}function f(){for(let d=e,m=n.length;d<m;d++){const v=n[d];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:a,unshift:c,finish:f,sort:h}}function e5(){let n=new WeakMap;function e(i,r){const s=n.get(i);let o;return s===void 0?(o=new MA,n.set(i,[o])):r>=s.length?(o=new MA,s.push(o)):o=s[r],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function t5(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new j,color:new lt};break;case"SpotLight":t={position:new j,direction:new j,color:new lt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new j,color:new lt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new j,skyColor:new lt,groundColor:new lt};break;case"RectAreaLight":t={color:new lt,position:new j,halfWidth:new j,halfHeight:new j};break}return n[e.id]=t,t}}}function n5(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ie};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ie};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ie,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let i5=0;function r5(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function s5(n){const e=new t5,t=n5(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let h=0;h<9;h++)i.probe.push(new j);const r=new j,s=new Lt,o=new Lt;function a(h){let f=0,d=0,m=0;for(let A=0;A<9;A++)i.probe[A].set(0,0,0);let v=0,_=0,E=0,S=0,y=0,w=0,M=0,R=0,z=0,k=0,P=0;h.sort(r5);for(let A=0,T=h.length;A<T;A++){const L=h[A],H=L.color,U=L.intensity,se=L.distance,fe=L.shadow&&L.shadow.map?L.shadow.map.texture:null;if(L.isAmbientLight)f+=H.r*U,d+=H.g*U,m+=H.b*U;else if(L.isLightProbe){for(let oe=0;oe<9;oe++)i.probe[oe].addScaledVector(L.sh.coefficients[oe],U);P++}else if(L.isDirectionalLight){const oe=e.get(L);if(oe.color.copy(L.color).multiplyScalar(L.intensity),L.castShadow){const Se=L.shadow,q=t.get(L);q.shadowIntensity=Se.intensity,q.shadowBias=Se.bias,q.shadowNormalBias=Se.normalBias,q.shadowRadius=Se.radius,q.shadowMapSize=Se.mapSize,i.directionalShadow[v]=q,i.directionalShadowMap[v]=fe,i.directionalShadowMatrix[v]=L.shadow.matrix,w++}i.directional[v]=oe,v++}else if(L.isSpotLight){const oe=e.get(L);oe.position.setFromMatrixPosition(L.matrixWorld),oe.color.copy(H).multiplyScalar(U),oe.distance=se,oe.coneCos=Math.cos(L.angle),oe.penumbraCos=Math.cos(L.angle*(1-L.penumbra)),oe.decay=L.decay,i.spot[E]=oe;const Se=L.shadow;if(L.map&&(i.spotLightMap[z]=L.map,z++,Se.updateMatrices(L),L.castShadow&&k++),i.spotLightMatrix[E]=Se.matrix,L.castShadow){const q=t.get(L);q.shadowIntensity=Se.intensity,q.shadowBias=Se.bias,q.shadowNormalBias=Se.normalBias,q.shadowRadius=Se.radius,q.shadowMapSize=Se.mapSize,i.spotShadow[E]=q,i.spotShadowMap[E]=fe,R++}E++}else if(L.isRectAreaLight){const oe=e.get(L);oe.color.copy(H).multiplyScalar(U),oe.halfWidth.set(L.width*.5,0,0),oe.halfHeight.set(0,L.height*.5,0),i.rectArea[S]=oe,S++}else if(L.isPointLight){const oe=e.get(L);if(oe.color.copy(L.color).multiplyScalar(L.intensity),oe.distance=L.distance,oe.decay=L.decay,L.castShadow){const Se=L.shadow,q=t.get(L);q.shadowIntensity=Se.intensity,q.shadowBias=Se.bias,q.shadowNormalBias=Se.normalBias,q.shadowRadius=Se.radius,q.shadowMapSize=Se.mapSize,q.shadowCameraNear=Se.camera.near,q.shadowCameraFar=Se.camera.far,i.pointShadow[_]=q,i.pointShadowMap[_]=fe,i.pointShadowMatrix[_]=L.shadow.matrix,M++}i.point[_]=oe,_++}else if(L.isHemisphereLight){const oe=e.get(L);oe.skyColor.copy(L.color).multiplyScalar(U),oe.groundColor.copy(L.groundColor).multiplyScalar(U),i.hemi[y]=oe,y++}}S>0&&(n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=rt.LTC_FLOAT_1,i.rectAreaLTC2=rt.LTC_FLOAT_2):(i.rectAreaLTC1=rt.LTC_HALF_1,i.rectAreaLTC2=rt.LTC_HALF_2)),i.ambient[0]=f,i.ambient[1]=d,i.ambient[2]=m;const b=i.hash;(b.directionalLength!==v||b.pointLength!==_||b.spotLength!==E||b.rectAreaLength!==S||b.hemiLength!==y||b.numDirectionalShadows!==w||b.numPointShadows!==M||b.numSpotShadows!==R||b.numSpotMaps!==z||b.numLightProbes!==P)&&(i.directional.length=v,i.spot.length=E,i.rectArea.length=S,i.point.length=_,i.hemi.length=y,i.directionalShadow.length=w,i.directionalShadowMap.length=w,i.pointShadow.length=M,i.pointShadowMap.length=M,i.spotShadow.length=R,i.spotShadowMap.length=R,i.directionalShadowMatrix.length=w,i.pointShadowMatrix.length=M,i.spotLightMatrix.length=R+z-k,i.spotLightMap.length=z,i.numSpotLightShadowsWithMaps=k,i.numLightProbes=P,b.directionalLength=v,b.pointLength=_,b.spotLength=E,b.rectAreaLength=S,b.hemiLength=y,b.numDirectionalShadows=w,b.numPointShadows=M,b.numSpotShadows=R,b.numSpotMaps=z,b.numLightProbes=P,i.version=i5++)}function c(h,f){let d=0,m=0,v=0,_=0,E=0;const S=f.matrixWorldInverse;for(let y=0,w=h.length;y<w;y++){const M=h[y];if(M.isDirectionalLight){const R=i.directional[d];R.direction.setFromMatrixPosition(M.matrixWorld),r.setFromMatrixPosition(M.target.matrixWorld),R.direction.sub(r),R.direction.transformDirection(S),d++}else if(M.isSpotLight){const R=i.spot[v];R.position.setFromMatrixPosition(M.matrixWorld),R.position.applyMatrix4(S),R.direction.setFromMatrixPosition(M.matrixWorld),r.setFromMatrixPosition(M.target.matrixWorld),R.direction.sub(r),R.direction.transformDirection(S),v++}else if(M.isRectAreaLight){const R=i.rectArea[_];R.position.setFromMatrixPosition(M.matrixWorld),R.position.applyMatrix4(S),o.identity(),s.copy(M.matrixWorld),s.premultiply(S),o.extractRotation(s),R.halfWidth.set(M.width*.5,0,0),R.halfHeight.set(0,M.height*.5,0),R.halfWidth.applyMatrix4(o),R.halfHeight.applyMatrix4(o),_++}else if(M.isPointLight){const R=i.point[m];R.position.setFromMatrixPosition(M.matrixWorld),R.position.applyMatrix4(S),m++}else if(M.isHemisphereLight){const R=i.hemi[E];R.direction.setFromMatrixPosition(M.matrixWorld),R.direction.transformDirection(S),E++}}}return{setup:a,setupView:c,state:i}}function EA(n){const e=new s5(n),t=[],i=[];function r(f){h.camera=f,t.length=0,i.length=0}function s(f){t.push(f)}function o(f){i.push(f)}function a(){e.setup(t)}function c(f){e.setupView(t,f)}const h={lightsArray:t,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:h,setupLights:a,setupLightsView:c,pushLight:s,pushShadow:o}}function o5(n){let e=new WeakMap;function t(r,s=0){const o=e.get(r);let a;return o===void 0?(a=new EA(n),e.set(r,[a])):s>=o.length?(a=new EA(n),o.push(a)):a=o[s],a}function i(){e=new WeakMap}return{get:t,dispose:i}}class s1 extends ji{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=UR,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class o1 extends ji{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const a5=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,l5=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function c5(n,e,t){let i=new Gd;const r=new Ie,s=new Ie,o=new pn,a=new s1({depthPacking:FR}),c=new o1,h={},f=t.maxTextureSize,d={[jo]:Hi,[Hi]:jo,[Is]:Is},m=new ir({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ie},radius:{value:4}},vertexShader:a5,fragmentShader:l5}),v=m.clone();v.defines.HORIZONTAL_PASS=1;const _=new qt;_.setAttribute("position",new _n(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const E=new Bn(_,m),S=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=s0;let y=this.type;this.render=function(k,P,b){if(S.enabled===!1||S.autoUpdate===!1&&S.needsUpdate===!1||k.length===0)return;const A=n.getRenderTarget(),T=n.getActiveCubeFace(),L=n.getActiveMipmapLevel(),H=n.state;H.setBlending(to),H.buffers.color.setClear(1,1,1,1),H.buffers.depth.setTest(!0),H.setScissorTest(!1);const U=y!==Ts&&this.type===Ts,se=y===Ts&&this.type!==Ts;for(let fe=0,oe=k.length;fe<oe;fe++){const Se=k[fe],q=Se.shadow;if(q===void 0){console.warn("THREE.WebGLShadowMap:",Se,"has no shadow.");continue}if(q.autoUpdate===!1&&q.needsUpdate===!1)continue;r.copy(q.mapSize);const le=q.getFrameExtents();if(r.multiply(le),s.copy(q.mapSize),(r.x>f||r.y>f)&&(r.x>f&&(s.x=Math.floor(f/le.x),r.x=s.x*le.x,q.mapSize.x=s.x),r.y>f&&(s.y=Math.floor(f/le.y),r.y=s.y*le.y,q.mapSize.y=s.y)),q.map===null||U===!0||se===!0){const ye=this.type!==Ts?{minFilter:_i,magFilter:_i}:{};q.map!==null&&q.map.dispose(),q.map=new jr(r.x,r.y,ye),q.map.texture.name=Se.name+".shadowMap",q.camera.updateProjectionMatrix()}n.setRenderTarget(q.map),n.clear();const ie=q.getViewportCount();for(let ye=0;ye<ie;ye++){const Ae=q.getViewport(ye);o.set(s.x*Ae.x,s.y*Ae.y,s.x*Ae.z,s.y*Ae.w),H.viewport(o),q.updateMatrices(Se,ye),i=q.getFrustum(),R(P,b,q.camera,Se,this.type)}q.isPointLightShadow!==!0&&this.type===Ts&&w(q,b),q.needsUpdate=!1}y=this.type,S.needsUpdate=!1,n.setRenderTarget(A,T,L)};function w(k,P){const b=e.update(E);m.defines.VSM_SAMPLES!==k.blurSamples&&(m.defines.VSM_SAMPLES=k.blurSamples,v.defines.VSM_SAMPLES=k.blurSamples,m.needsUpdate=!0,v.needsUpdate=!0),k.mapPass===null&&(k.mapPass=new jr(r.x,r.y)),m.uniforms.shadow_pass.value=k.map.texture,m.uniforms.resolution.value=k.mapSize,m.uniforms.radius.value=k.radius,n.setRenderTarget(k.mapPass),n.clear(),n.renderBufferDirect(P,null,b,m,E,null),v.uniforms.shadow_pass.value=k.mapPass.texture,v.uniforms.resolution.value=k.mapSize,v.uniforms.radius.value=k.radius,n.setRenderTarget(k.map),n.clear(),n.renderBufferDirect(P,null,b,v,E,null)}function M(k,P,b,A){let T=null;const L=b.isPointLight===!0?k.customDistanceMaterial:k.customDepthMaterial;if(L!==void 0)T=L;else if(T=b.isPointLight===!0?c:a,n.localClippingEnabled&&P.clipShadows===!0&&Array.isArray(P.clippingPlanes)&&P.clippingPlanes.length!==0||P.displacementMap&&P.displacementScale!==0||P.alphaMap&&P.alphaTest>0||P.map&&P.alphaTest>0){const H=T.uuid,U=P.uuid;let se=h[H];se===void 0&&(se={},h[H]=se);let fe=se[U];fe===void 0&&(fe=T.clone(),se[U]=fe,P.addEventListener("dispose",z)),T=fe}if(T.visible=P.visible,T.wireframe=P.wireframe,A===Ts?T.side=P.shadowSide!==null?P.shadowSide:P.side:T.side=P.shadowSide!==null?P.shadowSide:d[P.side],T.alphaMap=P.alphaMap,T.alphaTest=P.alphaTest,T.map=P.map,T.clipShadows=P.clipShadows,T.clippingPlanes=P.clippingPlanes,T.clipIntersection=P.clipIntersection,T.displacementMap=P.displacementMap,T.displacementScale=P.displacementScale,T.displacementBias=P.displacementBias,T.wireframeLinewidth=P.wireframeLinewidth,T.linewidth=P.linewidth,b.isPointLight===!0&&T.isMeshDistanceMaterial===!0){const H=n.properties.get(T);H.light=b}return T}function R(k,P,b,A,T){if(k.visible===!1)return;if(k.layers.test(P.layers)&&(k.isMesh||k.isLine||k.isPoints)&&(k.castShadow||k.receiveShadow&&T===Ts)&&(!k.frustumCulled||i.intersectsObject(k))){k.modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,k.matrixWorld);const U=e.update(k),se=k.material;if(Array.isArray(se)){const fe=U.groups;for(let oe=0,Se=fe.length;oe<Se;oe++){const q=fe[oe],le=se[q.materialIndex];if(le&&le.visible){const ie=M(k,le,A,T);k.onBeforeShadow(n,k,P,b,U,ie,q),n.renderBufferDirect(b,null,U,ie,k,q),k.onAfterShadow(n,k,P,b,U,ie,q)}}}else if(se.visible){const fe=M(k,se,A,T);k.onBeforeShadow(n,k,P,b,U,fe,null),n.renderBufferDirect(b,null,U,fe,k,null),k.onAfterShadow(n,k,P,b,U,fe,null)}}const H=k.children;for(let U=0,se=H.length;U<se;U++)R(H[U],P,b,A,T)}function z(k){k.target.removeEventListener("dispose",z);for(const b in h){const A=h[b],T=k.target.uuid;T in A&&(A[T].dispose(),delete A[T])}}}function u5(n){function e(){let Q=!1;const Ce=new pn;let re=null;const Me=new pn(0,0,0,0);return{setMask:function(je){re!==je&&!Q&&(n.colorMask(je,je,je,je),re=je)},setLocked:function(je){Q=je},setClear:function(je,Mt,Nt,$t,en){en===!0&&(je*=$t,Mt*=$t,Nt*=$t),Ce.set(je,Mt,Nt,$t),Me.equals(Ce)===!1&&(n.clearColor(je,Mt,Nt,$t),Me.copy(Ce))},reset:function(){Q=!1,re=null,Me.set(-1,0,0,0)}}}function t(){let Q=!1,Ce=null,re=null,Me=null;return{setTest:function(je){je?Oe(n.DEPTH_TEST):He(n.DEPTH_TEST)},setMask:function(je){Ce!==je&&!Q&&(n.depthMask(je),Ce=je)},setFunc:function(je){if(re!==je){switch(je){case yR:n.depthFunc(n.NEVER);break;case _R:n.depthFunc(n.ALWAYS);break;case xR:n.depthFunc(n.LESS);break;case sd:n.depthFunc(n.LEQUAL);break;case SR:n.depthFunc(n.EQUAL);break;case wR:n.depthFunc(n.GEQUAL);break;case MR:n.depthFunc(n.GREATER);break;case ER:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}re=je}},setLocked:function(je){Q=je},setClear:function(je){Me!==je&&(n.clearDepth(je),Me=je)},reset:function(){Q=!1,Ce=null,re=null,Me=null}}}function i(){let Q=!1,Ce=null,re=null,Me=null,je=null,Mt=null,Nt=null,$t=null,en=null;return{setTest:function(Ut){Q||(Ut?Oe(n.STENCIL_TEST):He(n.STENCIL_TEST))},setMask:function(Ut){Ce!==Ut&&!Q&&(n.stencilMask(Ut),Ce=Ut)},setFunc:function(Ut,wn,Dn){(re!==Ut||Me!==wn||je!==Dn)&&(n.stencilFunc(Ut,wn,Dn),re=Ut,Me=wn,je=Dn)},setOp:function(Ut,wn,Dn){(Mt!==Ut||Nt!==wn||$t!==Dn)&&(n.stencilOp(Ut,wn,Dn),Mt=Ut,Nt=wn,$t=Dn)},setLocked:function(Ut){Q=Ut},setClear:function(Ut){en!==Ut&&(n.clearStencil(Ut),en=Ut)},reset:function(){Q=!1,Ce=null,re=null,Me=null,je=null,Mt=null,Nt=null,$t=null,en=null}}}const r=new e,s=new t,o=new i,a=new WeakMap,c=new WeakMap;let h={},f={},d=new WeakMap,m=[],v=null,_=!1,E=null,S=null,y=null,w=null,M=null,R=null,z=null,k=new lt(0,0,0),P=0,b=!1,A=null,T=null,L=null,H=null,U=null;const se=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let fe=!1,oe=0;const Se=n.getParameter(n.VERSION);Se.indexOf("WebGL")!==-1?(oe=parseFloat(/^WebGL (\d)/.exec(Se)[1]),fe=oe>=1):Se.indexOf("OpenGL ES")!==-1&&(oe=parseFloat(/^OpenGL ES (\d)/.exec(Se)[1]),fe=oe>=2);let q=null,le={};const ie=n.getParameter(n.SCISSOR_BOX),ye=n.getParameter(n.VIEWPORT),Ae=new pn().fromArray(ie),ze=new pn().fromArray(ye);function pe(Q,Ce,re,Me){const je=new Uint8Array(4),Mt=n.createTexture();n.bindTexture(Q,Mt),n.texParameteri(Q,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(Q,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Nt=0;Nt<re;Nt++)Q===n.TEXTURE_3D||Q===n.TEXTURE_2D_ARRAY?n.texImage3D(Ce,0,n.RGBA,1,1,Me,0,n.RGBA,n.UNSIGNED_BYTE,je):n.texImage2D(Ce+Nt,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,je);return Mt}const De={};De[n.TEXTURE_2D]=pe(n.TEXTURE_2D,n.TEXTURE_2D,1),De[n.TEXTURE_CUBE_MAP]=pe(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),De[n.TEXTURE_2D_ARRAY]=pe(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),De[n.TEXTURE_3D]=pe(n.TEXTURE_3D,n.TEXTURE_3D,1,1),r.setClear(0,0,0,1),s.setClear(1),o.setClear(0),Oe(n.DEPTH_TEST),s.setFunc(sd),Ke(!1),Pe(fS),Oe(n.CULL_FACE),Fe(to);function Oe(Q){h[Q]!==!0&&(n.enable(Q),h[Q]=!0)}function He(Q){h[Q]!==!1&&(n.disable(Q),h[Q]=!1)}function ut(Q,Ce){return f[Q]!==Ce?(n.bindFramebuffer(Q,Ce),f[Q]=Ce,Q===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=Ce),Q===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=Ce),!0):!1}function Tt(Q,Ce){let re=m,Me=!1;if(Q){re=d.get(Ce),re===void 0&&(re=[],d.set(Ce,re));const je=Q.textures;if(re.length!==je.length||re[0]!==n.COLOR_ATTACHMENT0){for(let Mt=0,Nt=je.length;Mt<Nt;Mt++)re[Mt]=n.COLOR_ATTACHMENT0+Mt;re.length=je.length,Me=!0}}else re[0]!==n.BACK&&(re[0]=n.BACK,Me=!0);Me&&n.drawBuffers(re)}function mt(Q){return v!==Q?(n.useProgram(Q),v=Q,!0):!1}const At={[Sa]:n.FUNC_ADD,[tR]:n.FUNC_SUBTRACT,[nR]:n.FUNC_REVERSE_SUBTRACT};At[iR]=n.MIN,At[rR]=n.MAX;const X={[sR]:n.ZERO,[oR]:n.ONE,[aR]:n.SRC_COLOR,[Zg]:n.SRC_ALPHA,[dR]:n.SRC_ALPHA_SATURATE,[hR]:n.DST_COLOR,[cR]:n.DST_ALPHA,[lR]:n.ONE_MINUS_SRC_COLOR,[Jg]:n.ONE_MINUS_SRC_ALPHA,[fR]:n.ONE_MINUS_DST_COLOR,[uR]:n.ONE_MINUS_DST_ALPHA,[pR]:n.CONSTANT_COLOR,[mR]:n.ONE_MINUS_CONSTANT_COLOR,[gR]:n.CONSTANT_ALPHA,[vR]:n.ONE_MINUS_CONSTANT_ALPHA};function Fe(Q,Ce,re,Me,je,Mt,Nt,$t,en,Ut){if(Q===to){_===!0&&(He(n.BLEND),_=!1);return}if(_===!1&&(Oe(n.BLEND),_=!0),Q!==eR){if(Q!==E||Ut!==b){if((S!==Sa||M!==Sa)&&(n.blendEquation(n.FUNC_ADD),S=Sa,M=Sa),Ut)switch(Q){case Yl:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case dS:n.blendFunc(n.ONE,n.ONE);break;case pS:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case mS:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Q);break}else switch(Q){case Yl:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case dS:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case pS:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case mS:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Q);break}y=null,w=null,R=null,z=null,k.set(0,0,0),P=0,E=Q,b=Ut}return}je=je||Ce,Mt=Mt||re,Nt=Nt||Me,(Ce!==S||je!==M)&&(n.blendEquationSeparate(At[Ce],At[je]),S=Ce,M=je),(re!==y||Me!==w||Mt!==R||Nt!==z)&&(n.blendFuncSeparate(X[re],X[Me],X[Mt],X[Nt]),y=re,w=Me,R=Mt,z=Nt),($t.equals(k)===!1||en!==P)&&(n.blendColor($t.r,$t.g,$t.b,en),k.copy($t),P=en),E=Q,b=!1}function Be(Q,Ce){Q.side===Is?He(n.CULL_FACE):Oe(n.CULL_FACE);let re=Q.side===Hi;Ce&&(re=!re),Ke(re),Q.blending===Yl&&Q.transparent===!1?Fe(to):Fe(Q.blending,Q.blendEquation,Q.blendSrc,Q.blendDst,Q.blendEquationAlpha,Q.blendSrcAlpha,Q.blendDstAlpha,Q.blendColor,Q.blendAlpha,Q.premultipliedAlpha),s.setFunc(Q.depthFunc),s.setTest(Q.depthTest),s.setMask(Q.depthWrite),r.setMask(Q.colorWrite);const Me=Q.stencilWrite;o.setTest(Me),Me&&(o.setMask(Q.stencilWriteMask),o.setFunc(Q.stencilFunc,Q.stencilRef,Q.stencilFuncMask),o.setOp(Q.stencilFail,Q.stencilZFail,Q.stencilZPass)),Ze(Q.polygonOffset,Q.polygonOffsetFactor,Q.polygonOffsetUnits),Q.alphaToCoverage===!0?Oe(n.SAMPLE_ALPHA_TO_COVERAGE):He(n.SAMPLE_ALPHA_TO_COVERAGE)}function Ke(Q){A!==Q&&(Q?n.frontFace(n.CW):n.frontFace(n.CCW),A=Q)}function Pe(Q){Q!==Z2?(Oe(n.CULL_FACE),Q!==T&&(Q===fS?n.cullFace(n.BACK):Q===J2?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):He(n.CULL_FACE),T=Q}function gt(Q){Q!==L&&(fe&&n.lineWidth(Q),L=Q)}function Ze(Q,Ce,re){Q?(Oe(n.POLYGON_OFFSET_FILL),(H!==Ce||U!==re)&&(n.polygonOffset(Ce,re),H=Ce,U=re)):He(n.POLYGON_OFFSET_FILL)}function st(Q){Q?Oe(n.SCISSOR_TEST):He(n.SCISSOR_TEST)}function Z(Q){Q===void 0&&(Q=n.TEXTURE0+se-1),q!==Q&&(n.activeTexture(Q),q=Q)}function B(Q,Ce,re){re===void 0&&(q===null?re=n.TEXTURE0+se-1:re=q);let Me=le[re];Me===void 0&&(Me={type:void 0,texture:void 0},le[re]=Me),(Me.type!==Q||Me.texture!==Ce)&&(q!==re&&(n.activeTexture(re),q=re),n.bindTexture(Q,Ce||De[Q]),Me.type=Q,Me.texture=Ce)}function me(){const Q=le[q];Q!==void 0&&Q.type!==void 0&&(n.bindTexture(Q.type,null),Q.type=void 0,Q.texture=void 0)}function Re(){try{n.compressedTexImage2D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function Te(){try{n.compressedTexImage3D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function ke(){try{n.texSubImage2D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function it(){try{n.texSubImage3D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function Ge(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function Qe(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function bt(){try{n.texStorage2D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function We(){try{n.texStorage3D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function nt(){try{n.texImage2D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function Dt(){try{n.texImage3D.apply(n,arguments)}catch(Q){console.error("THREE.WebGLState:",Q)}}function yt(Q){Ae.equals(Q)===!1&&(n.scissor(Q.x,Q.y,Q.z,Q.w),Ae.copy(Q))}function $e(Q){ze.equals(Q)===!1&&(n.viewport(Q.x,Q.y,Q.z,Q.w),ze.copy(Q))}function wt(Q,Ce){let re=c.get(Ce);re===void 0&&(re=new WeakMap,c.set(Ce,re));let Me=re.get(Q);Me===void 0&&(Me=n.getUniformBlockIndex(Ce,Q.name),re.set(Q,Me))}function te(Q,Ce){const Me=c.get(Ce).get(Q);a.get(Ce)!==Me&&(n.uniformBlockBinding(Ce,Me,Q.__bindingPointIndex),a.set(Ce,Me))}function Le(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),h={},q=null,le={},f={},d=new WeakMap,m=[],v=null,_=!1,E=null,S=null,y=null,w=null,M=null,R=null,z=null,k=new lt(0,0,0),P=0,b=!1,A=null,T=null,L=null,H=null,U=null,Ae.set(0,0,n.canvas.width,n.canvas.height),ze.set(0,0,n.canvas.width,n.canvas.height),r.reset(),s.reset(),o.reset()}return{buffers:{color:r,depth:s,stencil:o},enable:Oe,disable:He,bindFramebuffer:ut,drawBuffers:Tt,useProgram:mt,setBlending:Fe,setMaterial:Be,setFlipSided:Ke,setCullFace:Pe,setLineWidth:gt,setPolygonOffset:Ze,setScissorTest:st,activeTexture:Z,bindTexture:B,unbindTexture:me,compressedTexImage2D:Re,compressedTexImage3D:Te,texImage2D:nt,texImage3D:Dt,updateUBOMapping:wt,uniformBlockBinding:te,texStorage2D:bt,texStorage3D:We,texSubImage2D:ke,texSubImage3D:it,compressedTexSubImage2D:Ge,compressedTexSubImage3D:Qe,scissor:yt,viewport:$e,reset:Le}}function h5(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2):(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0),n}function f5(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0):(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2),n}function d5(n){return n.repeat.x=1,n.repeat.y=1,n.offset.x=0,n.offset.y=0,n}function wS(n,e,t,i){const r=p5(i);switch(t){case Gw:return n*e;case jw:return n*e;case Xw:return n*e*2;case Fd:return n*e/r.components*r.byteLength;case zd:return n*e/r.components*r.byteLength;case qw:return n*e*2/r.components*r.byteLength;case u0:return n*e*2/r.components*r.byteLength;case Ww:return n*e*3/r.components*r.byteLength;case Qn:return n*e*4/r.components*r.byteLength;case h0:return n*e*4/r.components*r.byteLength;case Cf:case If:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case Rf:case Pf:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case ev:case nv:return Math.max(n,16)*Math.max(e,8)/4;case Qg:case tv:return Math.max(n,8)*Math.max(e,8)/2;case iv:case rv:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case sv:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case ov:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case av:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case lv:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case cv:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case uv:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case hv:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case fv:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case dv:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case pv:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case mv:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case gv:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case vv:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case yv:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case _v:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case Lf:case xv:case Sv:return Math.ceil(n/4)*Math.ceil(e/4)*16;case Yw:case wv:return Math.ceil(n/4)*Math.ceil(e/4)*8;case Mv:case Ev:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function p5(n){switch(n){case Mr:case o0:return{byteLength:1,components:1};case Ku:case a0:case xi:return{byteLength:2,components:1};case l0:case c0:return{byteLength:2,components:4};case ao:case Ud:case zn:return{byteLength:4,components:1};case Vw:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}const m5={contain:h5,cover:f5,fill:d5,getByteLength:wS};function g5(n,e,t,i,r,s,o){const a=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),h=new Ie,f=new WeakMap;let d;const m=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function _(Z,B){return v?new OffscreenCanvas(Z,B):gd("canvas")}function E(Z,B,me){let Re=1;const Te=st(Z);if((Te.width>me||Te.height>me)&&(Re=me/Math.max(Te.width,Te.height)),Re<1)if(typeof HTMLImageElement<"u"&&Z instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Z instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Z instanceof ImageBitmap||typeof VideoFrame<"u"&&Z instanceof VideoFrame){const ke=Math.floor(Re*Te.width),it=Math.floor(Re*Te.height);d===void 0&&(d=_(ke,it));const Ge=B?_(ke,it):d;return Ge.width=ke,Ge.height=it,Ge.getContext("2d").drawImage(Z,0,0,ke,it),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Te.width+"x"+Te.height+") to ("+ke+"x"+it+")."),Ge}else return"data"in Z&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Te.width+"x"+Te.height+")."),Z;return Z}function S(Z){return Z.generateMipmaps&&Z.minFilter!==_i&&Z.minFilter!==mn}function y(Z){n.generateMipmap(Z)}function w(Z,B,me,Re,Te=!1){if(Z!==null){if(n[Z]!==void 0)return n[Z];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Z+"'")}let ke=B;if(B===n.RED&&(me===n.FLOAT&&(ke=n.R32F),me===n.HALF_FLOAT&&(ke=n.R16F),me===n.UNSIGNED_BYTE&&(ke=n.R8)),B===n.RED_INTEGER&&(me===n.UNSIGNED_BYTE&&(ke=n.R8UI),me===n.UNSIGNED_SHORT&&(ke=n.R16UI),me===n.UNSIGNED_INT&&(ke=n.R32UI),me===n.BYTE&&(ke=n.R8I),me===n.SHORT&&(ke=n.R16I),me===n.INT&&(ke=n.R32I)),B===n.RG&&(me===n.FLOAT&&(ke=n.RG32F),me===n.HALF_FLOAT&&(ke=n.RG16F),me===n.UNSIGNED_BYTE&&(ke=n.RG8)),B===n.RG_INTEGER&&(me===n.UNSIGNED_BYTE&&(ke=n.RG8UI),me===n.UNSIGNED_SHORT&&(ke=n.RG16UI),me===n.UNSIGNED_INT&&(ke=n.RG32UI),me===n.BYTE&&(ke=n.RG8I),me===n.SHORT&&(ke=n.RG16I),me===n.INT&&(ke=n.RG32I)),B===n.RGB&&me===n.UNSIGNED_INT_5_9_9_9_REV&&(ke=n.RGB9_E5),B===n.RGBA){const it=Te?hd:hn.getTransfer(Re);me===n.FLOAT&&(ke=n.RGBA32F),me===n.HALF_FLOAT&&(ke=n.RGBA16F),me===n.UNSIGNED_BYTE&&(ke=it===Tn?n.SRGB8_ALPHA8:n.RGBA8),me===n.UNSIGNED_SHORT_4_4_4_4&&(ke=n.RGBA4),me===n.UNSIGNED_SHORT_5_5_5_1&&(ke=n.RGB5_A1)}return(ke===n.R16F||ke===n.R32F||ke===n.RG16F||ke===n.RG32F||ke===n.RGBA16F||ke===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ke}function M(Z,B){let me;return Z?B===null||B===ao||B===sc?me=n.DEPTH24_STENCIL8:B===zn?me=n.DEPTH32F_STENCIL8:B===Ku&&(me=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):B===null||B===ao||B===sc?me=n.DEPTH_COMPONENT24:B===zn?me=n.DEPTH_COMPONENT32F:B===Ku&&(me=n.DEPTH_COMPONENT16),me}function R(Z,B){return S(Z)===!0||Z.isFramebufferTexture&&Z.minFilter!==_i&&Z.minFilter!==mn?Math.log2(Math.max(B.width,B.height))+1:Z.mipmaps!==void 0&&Z.mipmaps.length>0?Z.mipmaps.length:Z.isCompressedTexture&&Array.isArray(Z.image)?B.mipmaps.length:1}function z(Z){const B=Z.target;B.removeEventListener("dispose",z),P(B),B.isVideoTexture&&f.delete(B)}function k(Z){const B=Z.target;B.removeEventListener("dispose",k),A(B)}function P(Z){const B=i.get(Z);if(B.__webglInit===void 0)return;const me=Z.source,Re=m.get(me);if(Re){const Te=Re[B.__cacheKey];Te.usedTimes--,Te.usedTimes===0&&b(Z),Object.keys(Re).length===0&&m.delete(me)}i.remove(Z)}function b(Z){const B=i.get(Z);n.deleteTexture(B.__webglTexture);const me=Z.source,Re=m.get(me);delete Re[B.__cacheKey],o.memory.textures--}function A(Z){const B=i.get(Z);if(Z.depthTexture&&Z.depthTexture.dispose(),Z.isWebGLCubeRenderTarget)for(let Re=0;Re<6;Re++){if(Array.isArray(B.__webglFramebuffer[Re]))for(let Te=0;Te<B.__webglFramebuffer[Re].length;Te++)n.deleteFramebuffer(B.__webglFramebuffer[Re][Te]);else n.deleteFramebuffer(B.__webglFramebuffer[Re]);B.__webglDepthbuffer&&n.deleteRenderbuffer(B.__webglDepthbuffer[Re])}else{if(Array.isArray(B.__webglFramebuffer))for(let Re=0;Re<B.__webglFramebuffer.length;Re++)n.deleteFramebuffer(B.__webglFramebuffer[Re]);else n.deleteFramebuffer(B.__webglFramebuffer);if(B.__webglDepthbuffer&&n.deleteRenderbuffer(B.__webglDepthbuffer),B.__webglMultisampledFramebuffer&&n.deleteFramebuffer(B.__webglMultisampledFramebuffer),B.__webglColorRenderbuffer)for(let Re=0;Re<B.__webglColorRenderbuffer.length;Re++)B.__webglColorRenderbuffer[Re]&&n.deleteRenderbuffer(B.__webglColorRenderbuffer[Re]);B.__webglDepthRenderbuffer&&n.deleteRenderbuffer(B.__webglDepthRenderbuffer)}const me=Z.textures;for(let Re=0,Te=me.length;Re<Te;Re++){const ke=i.get(me[Re]);ke.__webglTexture&&(n.deleteTexture(ke.__webglTexture),o.memory.textures--),i.remove(me[Re])}i.remove(Z)}let T=0;function L(){T=0}function H(){const Z=T;return Z>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Z+" texture units while this GPU supports only "+r.maxTextures),T+=1,Z}function U(Z){const B=[];return B.push(Z.wrapS),B.push(Z.wrapT),B.push(Z.wrapR||0),B.push(Z.magFilter),B.push(Z.minFilter),B.push(Z.anisotropy),B.push(Z.internalFormat),B.push(Z.format),B.push(Z.type),B.push(Z.generateMipmaps),B.push(Z.premultiplyAlpha),B.push(Z.flipY),B.push(Z.unpackAlignment),B.push(Z.colorSpace),B.join()}function se(Z,B){const me=i.get(Z);if(Z.isVideoTexture&&gt(Z),Z.isRenderTargetTexture===!1&&Z.version>0&&me.__version!==Z.version){const Re=Z.image;if(Re===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Re.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ze(me,Z,B);return}}t.bindTexture(n.TEXTURE_2D,me.__webglTexture,n.TEXTURE0+B)}function fe(Z,B){const me=i.get(Z);if(Z.version>0&&me.__version!==Z.version){ze(me,Z,B);return}t.bindTexture(n.TEXTURE_2D_ARRAY,me.__webglTexture,n.TEXTURE0+B)}function oe(Z,B){const me=i.get(Z);if(Z.version>0&&me.__version!==Z.version){ze(me,Z,B);return}t.bindTexture(n.TEXTURE_3D,me.__webglTexture,n.TEXTURE0+B)}function Se(Z,B){const me=i.get(Z);if(Z.version>0&&me.__version!==Z.version){pe(me,Z,B);return}t.bindTexture(n.TEXTURE_CUBE_MAP,me.__webglTexture,n.TEXTURE0+B)}const q={[ad]:n.REPEAT,[li]:n.CLAMP_TO_EDGE,[ld]:n.MIRRORED_REPEAT},le={[_i]:n.NEAREST,[Hw]:n.NEAREST_MIPMAP_NEAREST,[wu]:n.NEAREST_MIPMAP_LINEAR,[mn]:n.LINEAR,[bf]:n.LINEAR_MIPMAP_NEAREST,[Zs]:n.LINEAR_MIPMAP_LINEAR},ie={[BR]:n.NEVER,[XR]:n.ALWAYS,[HR]:n.LESS,[Kw]:n.LEQUAL,[VR]:n.EQUAL,[jR]:n.GEQUAL,[GR]:n.GREATER,[WR]:n.NOTEQUAL};function ye(Z,B){if(B.type===zn&&e.has("OES_texture_float_linear")===!1&&(B.magFilter===mn||B.magFilter===bf||B.magFilter===wu||B.magFilter===Zs||B.minFilter===mn||B.minFilter===bf||B.minFilter===wu||B.minFilter===Zs)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(Z,n.TEXTURE_WRAP_S,q[B.wrapS]),n.texParameteri(Z,n.TEXTURE_WRAP_T,q[B.wrapT]),(Z===n.TEXTURE_3D||Z===n.TEXTURE_2D_ARRAY)&&n.texParameteri(Z,n.TEXTURE_WRAP_R,q[B.wrapR]),n.texParameteri(Z,n.TEXTURE_MAG_FILTER,le[B.magFilter]),n.texParameteri(Z,n.TEXTURE_MIN_FILTER,le[B.minFilter]),B.compareFunction&&(n.texParameteri(Z,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(Z,n.TEXTURE_COMPARE_FUNC,ie[B.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(B.magFilter===_i||B.minFilter!==wu&&B.minFilter!==Zs||B.type===zn&&e.has("OES_texture_float_linear")===!1)return;if(B.anisotropy>1||i.get(B).__currentAnisotropy){const me=e.get("EXT_texture_filter_anisotropic");n.texParameterf(Z,me.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(B.anisotropy,r.getMaxAnisotropy())),i.get(B).__currentAnisotropy=B.anisotropy}}}function Ae(Z,B){let me=!1;Z.__webglInit===void 0&&(Z.__webglInit=!0,B.addEventListener("dispose",z));const Re=B.source;let Te=m.get(Re);Te===void 0&&(Te={},m.set(Re,Te));const ke=U(B);if(ke!==Z.__cacheKey){Te[ke]===void 0&&(Te[ke]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,me=!0),Te[ke].usedTimes++;const it=Te[Z.__cacheKey];it!==void 0&&(Te[Z.__cacheKey].usedTimes--,it.usedTimes===0&&b(B)),Z.__cacheKey=ke,Z.__webglTexture=Te[ke].texture}return me}function ze(Z,B,me){let Re=n.TEXTURE_2D;(B.isDataArrayTexture||B.isCompressedArrayTexture)&&(Re=n.TEXTURE_2D_ARRAY),B.isData3DTexture&&(Re=n.TEXTURE_3D);const Te=Ae(Z,B),ke=B.source;t.bindTexture(Re,Z.__webglTexture,n.TEXTURE0+me);const it=i.get(ke);if(ke.version!==it.__version||Te===!0){t.activeTexture(n.TEXTURE0+me);const Ge=hn.getPrimaries(hn.workingColorSpace),Qe=B.colorSpace===Po?null:hn.getPrimaries(B.colorSpace),bt=B.colorSpace===Po||Ge===Qe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,B.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,B.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,B.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,bt);let We=E(B.image,!1,r.maxTextureSize);We=Ze(B,We);const nt=s.convert(B.format,B.colorSpace),Dt=s.convert(B.type);let yt=w(B.internalFormat,nt,Dt,B.colorSpace,B.isVideoTexture);ye(Re,B);let $e;const wt=B.mipmaps,te=B.isVideoTexture!==!0,Le=it.__version===void 0||Te===!0,Q=ke.dataReady,Ce=R(B,We);if(B.isDepthTexture)yt=M(B.format===oc,B.type),Le&&(te?t.texStorage2D(n.TEXTURE_2D,1,yt,We.width,We.height):t.texImage2D(n.TEXTURE_2D,0,yt,We.width,We.height,0,nt,Dt,null));else if(B.isDataTexture)if(wt.length>0){te&&Le&&t.texStorage2D(n.TEXTURE_2D,Ce,yt,wt[0].width,wt[0].height);for(let re=0,Me=wt.length;re<Me;re++)$e=wt[re],te?Q&&t.texSubImage2D(n.TEXTURE_2D,re,0,0,$e.width,$e.height,nt,Dt,$e.data):t.texImage2D(n.TEXTURE_2D,re,yt,$e.width,$e.height,0,nt,Dt,$e.data);B.generateMipmaps=!1}else te?(Le&&t.texStorage2D(n.TEXTURE_2D,Ce,yt,We.width,We.height),Q&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,We.width,We.height,nt,Dt,We.data)):t.texImage2D(n.TEXTURE_2D,0,yt,We.width,We.height,0,nt,Dt,We.data);else if(B.isCompressedTexture)if(B.isCompressedArrayTexture){te&&Le&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Ce,yt,wt[0].width,wt[0].height,We.depth);for(let re=0,Me=wt.length;re<Me;re++)if($e=wt[re],B.format!==Qn)if(nt!==null)if(te){if(Q)if(B.layerUpdates.size>0){const je=wS($e.width,$e.height,B.format,B.type);for(const Mt of B.layerUpdates){const Nt=$e.data.subarray(Mt*je/$e.data.BYTES_PER_ELEMENT,(Mt+1)*je/$e.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,re,0,0,Mt,$e.width,$e.height,1,nt,Nt,0,0)}B.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,re,0,0,0,$e.width,$e.height,We.depth,nt,$e.data,0,0)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,re,yt,$e.width,$e.height,We.depth,0,$e.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else te?Q&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,re,0,0,0,$e.width,$e.height,We.depth,nt,Dt,$e.data):t.texImage3D(n.TEXTURE_2D_ARRAY,re,yt,$e.width,$e.height,We.depth,0,nt,Dt,$e.data)}else{te&&Le&&t.texStorage2D(n.TEXTURE_2D,Ce,yt,wt[0].width,wt[0].height);for(let re=0,Me=wt.length;re<Me;re++)$e=wt[re],B.format!==Qn?nt!==null?te?Q&&t.compressedTexSubImage2D(n.TEXTURE_2D,re,0,0,$e.width,$e.height,nt,$e.data):t.compressedTexImage2D(n.TEXTURE_2D,re,yt,$e.width,$e.height,0,$e.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):te?Q&&t.texSubImage2D(n.TEXTURE_2D,re,0,0,$e.width,$e.height,nt,Dt,$e.data):t.texImage2D(n.TEXTURE_2D,re,yt,$e.width,$e.height,0,nt,Dt,$e.data)}else if(B.isDataArrayTexture)if(te){if(Le&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Ce,yt,We.width,We.height,We.depth),Q)if(B.layerUpdates.size>0){const re=wS(We.width,We.height,B.format,B.type);for(const Me of B.layerUpdates){const je=We.data.subarray(Me*re/We.data.BYTES_PER_ELEMENT,(Me+1)*re/We.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,Me,We.width,We.height,1,nt,Dt,je)}B.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,We.width,We.height,We.depth,nt,Dt,We.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,yt,We.width,We.height,We.depth,0,nt,Dt,We.data);else if(B.isData3DTexture)te?(Le&&t.texStorage3D(n.TEXTURE_3D,Ce,yt,We.width,We.height,We.depth),Q&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,We.width,We.height,We.depth,nt,Dt,We.data)):t.texImage3D(n.TEXTURE_3D,0,yt,We.width,We.height,We.depth,0,nt,Dt,We.data);else if(B.isFramebufferTexture){if(Le)if(te)t.texStorage2D(n.TEXTURE_2D,Ce,yt,We.width,We.height);else{let re=We.width,Me=We.height;for(let je=0;je<Ce;je++)t.texImage2D(n.TEXTURE_2D,je,yt,re,Me,0,nt,Dt,null),re>>=1,Me>>=1}}else if(wt.length>0){if(te&&Le){const re=st(wt[0]);t.texStorage2D(n.TEXTURE_2D,Ce,yt,re.width,re.height)}for(let re=0,Me=wt.length;re<Me;re++)$e=wt[re],te?Q&&t.texSubImage2D(n.TEXTURE_2D,re,0,0,nt,Dt,$e):t.texImage2D(n.TEXTURE_2D,re,yt,nt,Dt,$e);B.generateMipmaps=!1}else if(te){if(Le){const re=st(We);t.texStorage2D(n.TEXTURE_2D,Ce,yt,re.width,re.height)}Q&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,nt,Dt,We)}else t.texImage2D(n.TEXTURE_2D,0,yt,nt,Dt,We);S(B)&&y(Re),it.__version=ke.version,B.onUpdate&&B.onUpdate(B)}Z.__version=B.version}function pe(Z,B,me){if(B.image.length!==6)return;const Re=Ae(Z,B),Te=B.source;t.bindTexture(n.TEXTURE_CUBE_MAP,Z.__webglTexture,n.TEXTURE0+me);const ke=i.get(Te);if(Te.version!==ke.__version||Re===!0){t.activeTexture(n.TEXTURE0+me);const it=hn.getPrimaries(hn.workingColorSpace),Ge=B.colorSpace===Po?null:hn.getPrimaries(B.colorSpace),Qe=B.colorSpace===Po||it===Ge?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,B.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,B.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,B.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Qe);const bt=B.isCompressedTexture||B.image[0].isCompressedTexture,We=B.image[0]&&B.image[0].isDataTexture,nt=[];for(let Me=0;Me<6;Me++)!bt&&!We?nt[Me]=E(B.image[Me],!0,r.maxCubemapSize):nt[Me]=We?B.image[Me].image:B.image[Me],nt[Me]=Ze(B,nt[Me]);const Dt=nt[0],yt=s.convert(B.format,B.colorSpace),$e=s.convert(B.type),wt=w(B.internalFormat,yt,$e,B.colorSpace),te=B.isVideoTexture!==!0,Le=ke.__version===void 0||Re===!0,Q=Te.dataReady;let Ce=R(B,Dt);ye(n.TEXTURE_CUBE_MAP,B);let re;if(bt){te&&Le&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Ce,wt,Dt.width,Dt.height);for(let Me=0;Me<6;Me++){re=nt[Me].mipmaps;for(let je=0;je<re.length;je++){const Mt=re[je];B.format!==Qn?yt!==null?te?Q&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,je,0,0,Mt.width,Mt.height,yt,Mt.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,je,wt,Mt.width,Mt.height,0,Mt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):te?Q&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,je,0,0,Mt.width,Mt.height,yt,$e,Mt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,je,wt,Mt.width,Mt.height,0,yt,$e,Mt.data)}}}else{if(re=B.mipmaps,te&&Le){re.length>0&&Ce++;const Me=st(nt[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,Ce,wt,Me.width,Me.height)}for(let Me=0;Me<6;Me++)if(We){te?Q&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,0,0,nt[Me].width,nt[Me].height,yt,$e,nt[Me].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,wt,nt[Me].width,nt[Me].height,0,yt,$e,nt[Me].data);for(let je=0;je<re.length;je++){const Nt=re[je].image[Me].image;te?Q&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,je+1,0,0,Nt.width,Nt.height,yt,$e,Nt.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,je+1,wt,Nt.width,Nt.height,0,yt,$e,Nt.data)}}else{te?Q&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,0,0,yt,$e,nt[Me]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,0,wt,yt,$e,nt[Me]);for(let je=0;je<re.length;je++){const Mt=re[je];te?Q&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,je+1,0,0,yt,$e,Mt.image[Me]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Me,je+1,wt,yt,$e,Mt.image[Me])}}}S(B)&&y(n.TEXTURE_CUBE_MAP),ke.__version=Te.version,B.onUpdate&&B.onUpdate(B)}Z.__version=B.version}function De(Z,B,me,Re,Te,ke){const it=s.convert(me.format,me.colorSpace),Ge=s.convert(me.type),Qe=w(me.internalFormat,it,Ge,me.colorSpace);if(!i.get(B).__hasExternalTextures){const We=Math.max(1,B.width>>ke),nt=Math.max(1,B.height>>ke);Te===n.TEXTURE_3D||Te===n.TEXTURE_2D_ARRAY?t.texImage3D(Te,ke,Qe,We,nt,B.depth,0,it,Ge,null):t.texImage2D(Te,ke,Qe,We,nt,0,it,Ge,null)}t.bindFramebuffer(n.FRAMEBUFFER,Z),Pe(B)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Re,Te,i.get(me).__webglTexture,0,Ke(B)):(Te===n.TEXTURE_2D||Te>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Te<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Re,Te,i.get(me).__webglTexture,ke),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Oe(Z,B,me){if(n.bindRenderbuffer(n.RENDERBUFFER,Z),B.depthBuffer){const Re=B.depthTexture,Te=Re&&Re.isDepthTexture?Re.type:null,ke=M(B.stencilBuffer,Te),it=B.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Ge=Ke(B);Pe(B)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ge,ke,B.width,B.height):me?n.renderbufferStorageMultisample(n.RENDERBUFFER,Ge,ke,B.width,B.height):n.renderbufferStorage(n.RENDERBUFFER,ke,B.width,B.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,it,n.RENDERBUFFER,Z)}else{const Re=B.textures;for(let Te=0;Te<Re.length;Te++){const ke=Re[Te],it=s.convert(ke.format,ke.colorSpace),Ge=s.convert(ke.type),Qe=w(ke.internalFormat,it,Ge,ke.colorSpace),bt=Ke(B);me&&Pe(B)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,bt,Qe,B.width,B.height):Pe(B)?a.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,bt,Qe,B.width,B.height):n.renderbufferStorage(n.RENDERBUFFER,Qe,B.width,B.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function He(Z,B){if(B&&B.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,Z),!(B.depthTexture&&B.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(B.depthTexture).__webglTexture||B.depthTexture.image.width!==B.width||B.depthTexture.image.height!==B.height)&&(B.depthTexture.image.width=B.width,B.depthTexture.image.height=B.height,B.depthTexture.needsUpdate=!0),se(B.depthTexture,0);const Re=i.get(B.depthTexture).__webglTexture,Te=Ke(B);if(B.depthTexture.format===$l)Pe(B)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Re,0,Te):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Re,0);else if(B.depthTexture.format===oc)Pe(B)?a.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Re,0,Te):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Re,0);else throw new Error("Unknown depthTexture format")}function ut(Z){const B=i.get(Z),me=Z.isWebGLCubeRenderTarget===!0;if(B.__boundDepthTexture!==Z.depthTexture){const Re=Z.depthTexture;if(B.__depthDisposeCallback&&B.__depthDisposeCallback(),Re){const Te=()=>{delete B.__boundDepthTexture,delete B.__depthDisposeCallback,Re.removeEventListener("dispose",Te)};Re.addEventListener("dispose",Te),B.__depthDisposeCallback=Te}B.__boundDepthTexture=Re}if(Z.depthTexture&&!B.__autoAllocateDepthBuffer){if(me)throw new Error("target.depthTexture not supported in Cube render targets");He(B.__webglFramebuffer,Z)}else if(me){B.__webglDepthbuffer=[];for(let Re=0;Re<6;Re++)if(t.bindFramebuffer(n.FRAMEBUFFER,B.__webglFramebuffer[Re]),B.__webglDepthbuffer[Re]===void 0)B.__webglDepthbuffer[Re]=n.createRenderbuffer(),Oe(B.__webglDepthbuffer[Re],Z,!1);else{const Te=Z.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ke=B.__webglDepthbuffer[Re];n.bindRenderbuffer(n.RENDERBUFFER,ke),n.framebufferRenderbuffer(n.FRAMEBUFFER,Te,n.RENDERBUFFER,ke)}}else if(t.bindFramebuffer(n.FRAMEBUFFER,B.__webglFramebuffer),B.__webglDepthbuffer===void 0)B.__webglDepthbuffer=n.createRenderbuffer(),Oe(B.__webglDepthbuffer,Z,!1);else{const Re=Z.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Te=B.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,Te),n.framebufferRenderbuffer(n.FRAMEBUFFER,Re,n.RENDERBUFFER,Te)}t.bindFramebuffer(n.FRAMEBUFFER,null)}function Tt(Z,B,me){const Re=i.get(Z);B!==void 0&&De(Re.__webglFramebuffer,Z,Z.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),me!==void 0&&ut(Z)}function mt(Z){const B=Z.texture,me=i.get(Z),Re=i.get(B);Z.addEventListener("dispose",k);const Te=Z.textures,ke=Z.isWebGLCubeRenderTarget===!0,it=Te.length>1;if(it||(Re.__webglTexture===void 0&&(Re.__webglTexture=n.createTexture()),Re.__version=B.version,o.memory.textures++),ke){me.__webglFramebuffer=[];for(let Ge=0;Ge<6;Ge++)if(B.mipmaps&&B.mipmaps.length>0){me.__webglFramebuffer[Ge]=[];for(let Qe=0;Qe<B.mipmaps.length;Qe++)me.__webglFramebuffer[Ge][Qe]=n.createFramebuffer()}else me.__webglFramebuffer[Ge]=n.createFramebuffer()}else{if(B.mipmaps&&B.mipmaps.length>0){me.__webglFramebuffer=[];for(let Ge=0;Ge<B.mipmaps.length;Ge++)me.__webglFramebuffer[Ge]=n.createFramebuffer()}else me.__webglFramebuffer=n.createFramebuffer();if(it)for(let Ge=0,Qe=Te.length;Ge<Qe;Ge++){const bt=i.get(Te[Ge]);bt.__webglTexture===void 0&&(bt.__webglTexture=n.createTexture(),o.memory.textures++)}if(Z.samples>0&&Pe(Z)===!1){me.__webglMultisampledFramebuffer=n.createFramebuffer(),me.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,me.__webglMultisampledFramebuffer);for(let Ge=0;Ge<Te.length;Ge++){const Qe=Te[Ge];me.__webglColorRenderbuffer[Ge]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,me.__webglColorRenderbuffer[Ge]);const bt=s.convert(Qe.format,Qe.colorSpace),We=s.convert(Qe.type),nt=w(Qe.internalFormat,bt,We,Qe.colorSpace,Z.isXRRenderTarget===!0),Dt=Ke(Z);n.renderbufferStorageMultisample(n.RENDERBUFFER,Dt,nt,Z.width,Z.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ge,n.RENDERBUFFER,me.__webglColorRenderbuffer[Ge])}n.bindRenderbuffer(n.RENDERBUFFER,null),Z.depthBuffer&&(me.__webglDepthRenderbuffer=n.createRenderbuffer(),Oe(me.__webglDepthRenderbuffer,Z,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ke){t.bindTexture(n.TEXTURE_CUBE_MAP,Re.__webglTexture),ye(n.TEXTURE_CUBE_MAP,B);for(let Ge=0;Ge<6;Ge++)if(B.mipmaps&&B.mipmaps.length>0)for(let Qe=0;Qe<B.mipmaps.length;Qe++)De(me.__webglFramebuffer[Ge][Qe],Z,B,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,Qe);else De(me.__webglFramebuffer[Ge],Z,B,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Ge,0);S(B)&&y(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(it){for(let Ge=0,Qe=Te.length;Ge<Qe;Ge++){const bt=Te[Ge],We=i.get(bt);t.bindTexture(n.TEXTURE_2D,We.__webglTexture),ye(n.TEXTURE_2D,bt),De(me.__webglFramebuffer,Z,bt,n.COLOR_ATTACHMENT0+Ge,n.TEXTURE_2D,0),S(bt)&&y(n.TEXTURE_2D)}t.unbindTexture()}else{let Ge=n.TEXTURE_2D;if((Z.isWebGL3DRenderTarget||Z.isWebGLArrayRenderTarget)&&(Ge=Z.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(Ge,Re.__webglTexture),ye(Ge,B),B.mipmaps&&B.mipmaps.length>0)for(let Qe=0;Qe<B.mipmaps.length;Qe++)De(me.__webglFramebuffer[Qe],Z,B,n.COLOR_ATTACHMENT0,Ge,Qe);else De(me.__webglFramebuffer,Z,B,n.COLOR_ATTACHMENT0,Ge,0);S(B)&&y(Ge),t.unbindTexture()}Z.depthBuffer&&ut(Z)}function At(Z){const B=Z.textures;for(let me=0,Re=B.length;me<Re;me++){const Te=B[me];if(S(Te)){const ke=Z.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,it=i.get(Te).__webglTexture;t.bindTexture(ke,it),y(ke),t.unbindTexture()}}}const X=[],Fe=[];function Be(Z){if(Z.samples>0){if(Pe(Z)===!1){const B=Z.textures,me=Z.width,Re=Z.height;let Te=n.COLOR_BUFFER_BIT;const ke=Z.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,it=i.get(Z),Ge=B.length>1;if(Ge)for(let Qe=0;Qe<B.length;Qe++)t.bindFramebuffer(n.FRAMEBUFFER,it.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Qe,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,it.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Qe,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,it.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,it.__webglFramebuffer);for(let Qe=0;Qe<B.length;Qe++){if(Z.resolveDepthBuffer&&(Z.depthBuffer&&(Te|=n.DEPTH_BUFFER_BIT),Z.stencilBuffer&&Z.resolveStencilBuffer&&(Te|=n.STENCIL_BUFFER_BIT)),Ge){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,it.__webglColorRenderbuffer[Qe]);const bt=i.get(B[Qe]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,bt,0)}n.blitFramebuffer(0,0,me,Re,0,0,me,Re,Te,n.NEAREST),c===!0&&(X.length=0,Fe.length=0,X.push(n.COLOR_ATTACHMENT0+Qe),Z.depthBuffer&&Z.resolveDepthBuffer===!1&&(X.push(ke),Fe.push(ke),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,Fe)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,X))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Ge)for(let Qe=0;Qe<B.length;Qe++){t.bindFramebuffer(n.FRAMEBUFFER,it.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Qe,n.RENDERBUFFER,it.__webglColorRenderbuffer[Qe]);const bt=i.get(B[Qe]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,it.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+Qe,n.TEXTURE_2D,bt,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,it.__webglMultisampledFramebuffer)}else if(Z.depthBuffer&&Z.resolveDepthBuffer===!1&&c){const B=Z.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[B])}}}function Ke(Z){return Math.min(r.maxSamples,Z.samples)}function Pe(Z){const B=i.get(Z);return Z.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&B.__useRenderToTexture!==!1}function gt(Z){const B=o.render.frame;f.get(Z)!==B&&(f.set(Z,B),Z.update())}function Ze(Z,B){const me=Z.colorSpace,Re=Z.format,Te=Z.type;return Z.isCompressedTexture===!0||Z.isVideoTexture===!0||me!==fs&&me!==Po&&(hn.getTransfer(me)===Tn?(Re!==Qn||Te!==Mr)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",me)),B}function st(Z){return typeof HTMLImageElement<"u"&&Z instanceof HTMLImageElement?(h.width=Z.naturalWidth||Z.width,h.height=Z.naturalHeight||Z.height):typeof VideoFrame<"u"&&Z instanceof VideoFrame?(h.width=Z.displayWidth,h.height=Z.displayHeight):(h.width=Z.width,h.height=Z.height),h}this.allocateTextureUnit=H,this.resetTextureUnits=L,this.setTexture2D=se,this.setTexture2DArray=fe,this.setTexture3D=oe,this.setTextureCube=Se,this.rebindTextures=Tt,this.setupRenderTarget=mt,this.updateRenderTargetMipmap=At,this.updateMultisampleRenderTarget=Be,this.setupDepthRenderbuffer=ut,this.setupFrameBufferTexture=De,this.useMultisampledRTT=Pe}function sP(n,e){function t(i,r=Po){let s;const o=hn.getTransfer(r);if(i===Mr)return n.UNSIGNED_BYTE;if(i===l0)return n.UNSIGNED_SHORT_4_4_4_4;if(i===c0)return n.UNSIGNED_SHORT_5_5_5_1;if(i===Vw)return n.UNSIGNED_INT_5_9_9_9_REV;if(i===o0)return n.BYTE;if(i===a0)return n.SHORT;if(i===Ku)return n.UNSIGNED_SHORT;if(i===Ud)return n.INT;if(i===ao)return n.UNSIGNED_INT;if(i===zn)return n.FLOAT;if(i===xi)return n.HALF_FLOAT;if(i===Gw)return n.ALPHA;if(i===Ww)return n.RGB;if(i===Qn)return n.RGBA;if(i===jw)return n.LUMINANCE;if(i===Xw)return n.LUMINANCE_ALPHA;if(i===$l)return n.DEPTH_COMPONENT;if(i===oc)return n.DEPTH_STENCIL;if(i===Fd)return n.RED;if(i===zd)return n.RED_INTEGER;if(i===qw)return n.RG;if(i===u0)return n.RG_INTEGER;if(i===h0)return n.RGBA_INTEGER;if(i===Cf||i===If||i===Rf||i===Pf)if(o===Tn)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(i===Cf)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===If)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===Rf)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===Pf)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(i===Cf)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===If)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===Rf)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===Pf)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===Qg||i===ev||i===tv||i===nv)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(i===Qg)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===ev)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===tv)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===nv)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===iv||i===rv||i===sv)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(i===iv||i===rv)return o===Tn?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(i===sv)return o===Tn?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===ov||i===av||i===lv||i===cv||i===uv||i===hv||i===fv||i===dv||i===pv||i===mv||i===gv||i===vv||i===yv||i===_v)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(i===ov)return o===Tn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===av)return o===Tn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===lv)return o===Tn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===cv)return o===Tn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===uv)return o===Tn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===hv)return o===Tn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===fv)return o===Tn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===dv)return o===Tn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===pv)return o===Tn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===mv)return o===Tn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===gv)return o===Tn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===vv)return o===Tn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===yv)return o===Tn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===_v)return o===Tn?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===Lf||i===xv||i===Sv)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(i===Lf)return o===Tn?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===xv)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===Sv)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===Yw||i===wv||i===Mv||i===Ev)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(i===Lf)return s.COMPRESSED_RED_RGTC1_EXT;if(i===wv)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===Mv)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===Ev)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===sc?n.UNSIGNED_INT_24_8:n[i]!==void 0?n[i]:null}return{convert:t}}class oP extends Jn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Tu extends an{constructor(){super(),this.isGroup=!0,this.type="Group"}}const v5={type:"move"};class k_{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Tu,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Tu,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new j,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new j),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Tu,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new j,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new j),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,c=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(h&&e.hand){o=!0;for(const E of e.hand.values()){const S=t.getJointPose(E,i),y=this._getHandJoint(h,E);S!==null&&(y.matrix.fromArray(S.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,y.jointRadius=S.radius),y.visible=S!==null}const f=h.joints["index-finger-tip"],d=h.joints["thumb-tip"],m=f.position.distanceTo(d.position),v=.02,_=.005;h.inputState.pinching&&m>v+_?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&m<=v-_&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(v5)))}return a!==null&&(a.visible=r!==null),c!==null&&(c.visible=s!==null),h!==null&&(h.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new Tu;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}const y5=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,_5=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class x5{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,i){if(this.texture===null){const r=new yn,s=e.properties.get(r);s.__webglTexture=t.texture,(t.depthNear!=i.depthNear||t.depthFar!=i.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,i=new ir({vertexShader:y5,fragmentShader:_5,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Bn(new $a(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class S5 extends co{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",c=1,h=null,f=null,d=null,m=null,v=null,_=null;const E=new x5,S=t.getContextAttributes();let y=null,w=null;const M=[],R=[],z=new Ie;let k=null;const P=new Jn;P.layers.enable(1),P.viewport=new pn;const b=new Jn;b.layers.enable(2),b.viewport=new pn;const A=[P,b],T=new oP;T.layers.enable(1),T.layers.enable(2);let L=null,H=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(pe){let De=M[pe];return De===void 0&&(De=new k_,M[pe]=De),De.getTargetRaySpace()},this.getControllerGrip=function(pe){let De=M[pe];return De===void 0&&(De=new k_,M[pe]=De),De.getGripSpace()},this.getHand=function(pe){let De=M[pe];return De===void 0&&(De=new k_,M[pe]=De),De.getHandSpace()};function U(pe){const De=R.indexOf(pe.inputSource);if(De===-1)return;const Oe=M[De];Oe!==void 0&&(Oe.update(pe.inputSource,pe.frame,h||o),Oe.dispatchEvent({type:pe.type,data:pe.inputSource}))}function se(){r.removeEventListener("select",U),r.removeEventListener("selectstart",U),r.removeEventListener("selectend",U),r.removeEventListener("squeeze",U),r.removeEventListener("squeezestart",U),r.removeEventListener("squeezeend",U),r.removeEventListener("end",se),r.removeEventListener("inputsourceschange",fe);for(let pe=0;pe<M.length;pe++){const De=R[pe];De!==null&&(R[pe]=null,M[pe].disconnect(De))}L=null,H=null,E.reset(),e.setRenderTarget(y),v=null,m=null,d=null,r=null,w=null,ze.stop(),i.isPresenting=!1,e.setPixelRatio(k),e.setSize(z.width,z.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(pe){s=pe,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(pe){a=pe,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||o},this.setReferenceSpace=function(pe){h=pe},this.getBaseLayer=function(){return m!==null?m:v},this.getBinding=function(){return d},this.getFrame=function(){return _},this.getSession=function(){return r},this.setSession=async function(pe){if(r=pe,r!==null){if(y=e.getRenderTarget(),r.addEventListener("select",U),r.addEventListener("selectstart",U),r.addEventListener("selectend",U),r.addEventListener("squeeze",U),r.addEventListener("squeezestart",U),r.addEventListener("squeezeend",U),r.addEventListener("end",se),r.addEventListener("inputsourceschange",fe),S.xrCompatible!==!0&&await t.makeXRCompatible(),k=e.getPixelRatio(),e.getSize(z),r.renderState.layers===void 0){const De={antialias:S.antialias,alpha:!0,depth:S.depth,stencil:S.stencil,framebufferScaleFactor:s};v=new XRWebGLLayer(r,t,De),r.updateRenderState({baseLayer:v}),e.setPixelRatio(1),e.setSize(v.framebufferWidth,v.framebufferHeight,!1),w=new jr(v.framebufferWidth,v.framebufferHeight,{format:Qn,type:Mr,colorSpace:e.outputColorSpace,stencilBuffer:S.stencil})}else{let De=null,Oe=null,He=null;S.depth&&(He=S.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,De=S.stencil?oc:$l,Oe=S.stencil?sc:ao);const ut={colorFormat:t.RGBA8,depthFormat:He,scaleFactor:s};d=new XRWebGLBinding(r,t),m=d.createProjectionLayer(ut),r.updateRenderState({layers:[m]}),e.setPixelRatio(1),e.setSize(m.textureWidth,m.textureHeight,!1),w=new jr(m.textureWidth,m.textureHeight,{format:Qn,type:Mr,depthTexture:new r1(m.textureWidth,m.textureHeight,Oe,void 0,void 0,void 0,void 0,void 0,void 0,De),stencilBuffer:S.stencil,colorSpace:e.outputColorSpace,samples:S.antialias?4:0,resolveDepthBuffer:m.ignoreDepthValues===!1})}w.isXRRenderTarget=!0,this.setFoveation(c),h=null,o=await r.requestReferenceSpace(a),ze.setContext(r),ze.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return E.getDepthTexture()};function fe(pe){for(let De=0;De<pe.removed.length;De++){const Oe=pe.removed[De],He=R.indexOf(Oe);He>=0&&(R[He]=null,M[He].disconnect(Oe))}for(let De=0;De<pe.added.length;De++){const Oe=pe.added[De];let He=R.indexOf(Oe);if(He===-1){for(let Tt=0;Tt<M.length;Tt++)if(Tt>=R.length){R.push(Oe),He=Tt;break}else if(R[Tt]===null){R[Tt]=Oe,He=Tt;break}if(He===-1)break}const ut=M[He];ut&&ut.connect(Oe)}}const oe=new j,Se=new j;function q(pe,De,Oe){oe.setFromMatrixPosition(De.matrixWorld),Se.setFromMatrixPosition(Oe.matrixWorld);const He=oe.distanceTo(Se),ut=De.projectionMatrix.elements,Tt=Oe.projectionMatrix.elements,mt=ut[14]/(ut[10]-1),At=ut[14]/(ut[10]+1),X=(ut[9]+1)/ut[5],Fe=(ut[9]-1)/ut[5],Be=(ut[8]-1)/ut[0],Ke=(Tt[8]+1)/Tt[0],Pe=mt*Be,gt=mt*Ke,Ze=He/(-Be+Ke),st=Ze*-Be;if(De.matrixWorld.decompose(pe.position,pe.quaternion,pe.scale),pe.translateX(st),pe.translateZ(Ze),pe.matrixWorld.compose(pe.position,pe.quaternion,pe.scale),pe.matrixWorldInverse.copy(pe.matrixWorld).invert(),ut[10]===-1)pe.projectionMatrix.copy(De.projectionMatrix),pe.projectionMatrixInverse.copy(De.projectionMatrixInverse);else{const Z=mt+Ze,B=At+Ze,me=Pe-st,Re=gt+(He-st),Te=X*At/B*Z,ke=Fe*At/B*Z;pe.projectionMatrix.makePerspective(me,Re,Te,ke,Z,B),pe.projectionMatrixInverse.copy(pe.projectionMatrix).invert()}}function le(pe,De){De===null?pe.matrixWorld.copy(pe.matrix):pe.matrixWorld.multiplyMatrices(De.matrixWorld,pe.matrix),pe.matrixWorldInverse.copy(pe.matrixWorld).invert()}this.updateCamera=function(pe){if(r===null)return;let De=pe.near,Oe=pe.far;E.texture!==null&&(E.depthNear>0&&(De=E.depthNear),E.depthFar>0&&(Oe=E.depthFar)),T.near=b.near=P.near=De,T.far=b.far=P.far=Oe,(L!==T.near||H!==T.far)&&(r.updateRenderState({depthNear:T.near,depthFar:T.far}),L=T.near,H=T.far);const He=pe.parent,ut=T.cameras;le(T,He);for(let Tt=0;Tt<ut.length;Tt++)le(ut[Tt],He);ut.length===2?q(T,P,b):T.projectionMatrix.copy(P.projectionMatrix),ie(pe,T,He)};function ie(pe,De,Oe){Oe===null?pe.matrix.copy(De.matrixWorld):(pe.matrix.copy(Oe.matrixWorld),pe.matrix.invert(),pe.matrix.multiply(De.matrixWorld)),pe.matrix.decompose(pe.position,pe.quaternion,pe.scale),pe.updateMatrixWorld(!0),pe.projectionMatrix.copy(De.projectionMatrix),pe.projectionMatrixInverse.copy(De.projectionMatrixInverse),pe.isPerspectiveCamera&&(pe.fov=Zu*2*Math.atan(1/pe.projectionMatrix.elements[5]),pe.zoom=1)}this.getCamera=function(){return T},this.getFoveation=function(){if(!(m===null&&v===null))return c},this.setFoveation=function(pe){c=pe,m!==null&&(m.fixedFoveation=pe),v!==null&&v.fixedFoveation!==void 0&&(v.fixedFoveation=pe)},this.hasDepthSensing=function(){return E.texture!==null},this.getDepthSensingMesh=function(){return E.getMesh(T)};let ye=null;function Ae(pe,De){if(f=De.getViewerPose(h||o),_=De,f!==null){const Oe=f.views;v!==null&&(e.setRenderTargetFramebuffer(w,v.framebuffer),e.setRenderTarget(w));let He=!1;Oe.length!==T.cameras.length&&(T.cameras.length=0,He=!0);for(let Tt=0;Tt<Oe.length;Tt++){const mt=Oe[Tt];let At=null;if(v!==null)At=v.getViewport(mt);else{const Fe=d.getViewSubImage(m,mt);At=Fe.viewport,Tt===0&&(e.setRenderTargetTextures(w,Fe.colorTexture,m.ignoreDepthValues?void 0:Fe.depthStencilTexture),e.setRenderTarget(w))}let X=A[Tt];X===void 0&&(X=new Jn,X.layers.enable(Tt),X.viewport=new pn,A[Tt]=X),X.matrix.fromArray(mt.transform.matrix),X.matrix.decompose(X.position,X.quaternion,X.scale),X.projectionMatrix.fromArray(mt.projectionMatrix),X.projectionMatrixInverse.copy(X.projectionMatrix).invert(),X.viewport.set(At.x,At.y,At.width,At.height),Tt===0&&(T.matrix.copy(X.matrix),T.matrix.decompose(T.position,T.quaternion,T.scale)),He===!0&&T.cameras.push(X)}const ut=r.enabledFeatures;if(ut&&ut.includes("depth-sensing")){const Tt=d.getDepthInformation(Oe[0]);Tt&&Tt.isValid&&Tt.texture&&E.init(e,Tt,r.renderState)}}for(let Oe=0;Oe<M.length;Oe++){const He=R[Oe],ut=M[Oe];He!==null&&ut!==void 0&&ut.update(He,De,h||o)}ye&&ye(pe,De),De.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:De}),_=null}const ze=new eP;ze.setAnimationLoop(Ae),this.setAnimationLoop=function(pe){ye=pe},this.dispose=function(){}}}const xl=new Xr,w5=new Lt;function M5(n,e){function t(S,y){S.matrixAutoUpdate===!0&&S.updateMatrix(),y.value.copy(S.matrix)}function i(S,y){y.color.getRGB(S.fogColor.value,JR(n)),y.isFog?(S.fogNear.value=y.near,S.fogFar.value=y.far):y.isFogExp2&&(S.fogDensity.value=y.density)}function r(S,y,w,M,R){y.isMeshBasicMaterial||y.isMeshLambertMaterial?s(S,y):y.isMeshToonMaterial?(s(S,y),d(S,y)):y.isMeshPhongMaterial?(s(S,y),f(S,y)):y.isMeshStandardMaterial?(s(S,y),m(S,y),y.isMeshPhysicalMaterial&&v(S,y,R)):y.isMeshMatcapMaterial?(s(S,y),_(S,y)):y.isMeshDepthMaterial?s(S,y):y.isMeshDistanceMaterial?(s(S,y),E(S,y)):y.isMeshNormalMaterial?s(S,y):y.isLineBasicMaterial?(o(S,y),y.isLineDashedMaterial&&a(S,y)):y.isPointsMaterial?c(S,y,w,M):y.isSpriteMaterial?h(S,y):y.isShadowMaterial?(S.color.value.copy(y.color),S.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}function s(S,y){S.opacity.value=y.opacity,y.color&&S.diffuse.value.copy(y.color),y.emissive&&S.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(S.map.value=y.map,t(y.map,S.mapTransform)),y.alphaMap&&(S.alphaMap.value=y.alphaMap,t(y.alphaMap,S.alphaMapTransform)),y.bumpMap&&(S.bumpMap.value=y.bumpMap,t(y.bumpMap,S.bumpMapTransform),S.bumpScale.value=y.bumpScale,y.side===Hi&&(S.bumpScale.value*=-1)),y.normalMap&&(S.normalMap.value=y.normalMap,t(y.normalMap,S.normalMapTransform),S.normalScale.value.copy(y.normalScale),y.side===Hi&&S.normalScale.value.negate()),y.displacementMap&&(S.displacementMap.value=y.displacementMap,t(y.displacementMap,S.displacementMapTransform),S.displacementScale.value=y.displacementScale,S.displacementBias.value=y.displacementBias),y.emissiveMap&&(S.emissiveMap.value=y.emissiveMap,t(y.emissiveMap,S.emissiveMapTransform)),y.specularMap&&(S.specularMap.value=y.specularMap,t(y.specularMap,S.specularMapTransform)),y.alphaTest>0&&(S.alphaTest.value=y.alphaTest);const w=e.get(y),M=w.envMap,R=w.envMapRotation;M&&(S.envMap.value=M,xl.copy(R),xl.x*=-1,xl.y*=-1,xl.z*=-1,M.isCubeTexture&&M.isRenderTargetTexture===!1&&(xl.y*=-1,xl.z*=-1),S.envMapRotation.value.setFromMatrix4(w5.makeRotationFromEuler(xl)),S.flipEnvMap.value=M.isCubeTexture&&M.isRenderTargetTexture===!1?-1:1,S.reflectivity.value=y.reflectivity,S.ior.value=y.ior,S.refractionRatio.value=y.refractionRatio),y.lightMap&&(S.lightMap.value=y.lightMap,S.lightMapIntensity.value=y.lightMapIntensity,t(y.lightMap,S.lightMapTransform)),y.aoMap&&(S.aoMap.value=y.aoMap,S.aoMapIntensity.value=y.aoMapIntensity,t(y.aoMap,S.aoMapTransform))}function o(S,y){S.diffuse.value.copy(y.color),S.opacity.value=y.opacity,y.map&&(S.map.value=y.map,t(y.map,S.mapTransform))}function a(S,y){S.dashSize.value=y.dashSize,S.totalSize.value=y.dashSize+y.gapSize,S.scale.value=y.scale}function c(S,y,w,M){S.diffuse.value.copy(y.color),S.opacity.value=y.opacity,S.size.value=y.size*w,S.scale.value=M*.5,y.map&&(S.map.value=y.map,t(y.map,S.uvTransform)),y.alphaMap&&(S.alphaMap.value=y.alphaMap,t(y.alphaMap,S.alphaMapTransform)),y.alphaTest>0&&(S.alphaTest.value=y.alphaTest)}function h(S,y){S.diffuse.value.copy(y.color),S.opacity.value=y.opacity,S.rotation.value=y.rotation,y.map&&(S.map.value=y.map,t(y.map,S.mapTransform)),y.alphaMap&&(S.alphaMap.value=y.alphaMap,t(y.alphaMap,S.alphaMapTransform)),y.alphaTest>0&&(S.alphaTest.value=y.alphaTest)}function f(S,y){S.specular.value.copy(y.specular),S.shininess.value=Math.max(y.shininess,1e-4)}function d(S,y){y.gradientMap&&(S.gradientMap.value=y.gradientMap)}function m(S,y){S.metalness.value=y.metalness,y.metalnessMap&&(S.metalnessMap.value=y.metalnessMap,t(y.metalnessMap,S.metalnessMapTransform)),S.roughness.value=y.roughness,y.roughnessMap&&(S.roughnessMap.value=y.roughnessMap,t(y.roughnessMap,S.roughnessMapTransform)),y.envMap&&(S.envMapIntensity.value=y.envMapIntensity)}function v(S,y,w){S.ior.value=y.ior,y.sheen>0&&(S.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),S.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(S.sheenColorMap.value=y.sheenColorMap,t(y.sheenColorMap,S.sheenColorMapTransform)),y.sheenRoughnessMap&&(S.sheenRoughnessMap.value=y.sheenRoughnessMap,t(y.sheenRoughnessMap,S.sheenRoughnessMapTransform))),y.clearcoat>0&&(S.clearcoat.value=y.clearcoat,S.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(S.clearcoatMap.value=y.clearcoatMap,t(y.clearcoatMap,S.clearcoatMapTransform)),y.clearcoatRoughnessMap&&(S.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap,t(y.clearcoatRoughnessMap,S.clearcoatRoughnessMapTransform)),y.clearcoatNormalMap&&(S.clearcoatNormalMap.value=y.clearcoatNormalMap,t(y.clearcoatNormalMap,S.clearcoatNormalMapTransform),S.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),y.side===Hi&&S.clearcoatNormalScale.value.negate())),y.dispersion>0&&(S.dispersion.value=y.dispersion),y.iridescence>0&&(S.iridescence.value=y.iridescence,S.iridescenceIOR.value=y.iridescenceIOR,S.iridescenceThicknessMinimum.value=y.iridescenceThicknessRange[0],S.iridescenceThicknessMaximum.value=y.iridescenceThicknessRange[1],y.iridescenceMap&&(S.iridescenceMap.value=y.iridescenceMap,t(y.iridescenceMap,S.iridescenceMapTransform)),y.iridescenceThicknessMap&&(S.iridescenceThicknessMap.value=y.iridescenceThicknessMap,t(y.iridescenceThicknessMap,S.iridescenceThicknessMapTransform))),y.transmission>0&&(S.transmission.value=y.transmission,S.transmissionSamplerMap.value=w.texture,S.transmissionSamplerSize.value.set(w.width,w.height),y.transmissionMap&&(S.transmissionMap.value=y.transmissionMap,t(y.transmissionMap,S.transmissionMapTransform)),S.thickness.value=y.thickness,y.thicknessMap&&(S.thicknessMap.value=y.thicknessMap,t(y.thicknessMap,S.thicknessMapTransform)),S.attenuationDistance.value=y.attenuationDistance,S.attenuationColor.value.copy(y.attenuationColor)),y.anisotropy>0&&(S.anisotropyVector.value.set(y.anisotropy*Math.cos(y.anisotropyRotation),y.anisotropy*Math.sin(y.anisotropyRotation)),y.anisotropyMap&&(S.anisotropyMap.value=y.anisotropyMap,t(y.anisotropyMap,S.anisotropyMapTransform))),S.specularIntensity.value=y.specularIntensity,S.specularColor.value.copy(y.specularColor),y.specularColorMap&&(S.specularColorMap.value=y.specularColorMap,t(y.specularColorMap,S.specularColorMapTransform)),y.specularIntensityMap&&(S.specularIntensityMap.value=y.specularIntensityMap,t(y.specularIntensityMap,S.specularIntensityMapTransform))}function _(S,y){y.matcap&&(S.matcap.value=y.matcap)}function E(S,y){const w=e.get(y).light;S.referencePosition.value.setFromMatrixPosition(w.matrixWorld),S.nearDistance.value=w.shadow.camera.near,S.farDistance.value=w.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function E5(n,e,t,i){let r={},s={},o=[];const a=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function c(w,M){const R=M.program;i.uniformBlockBinding(w,R)}function h(w,M){let R=r[w.id];R===void 0&&(_(w),R=f(w),r[w.id]=R,w.addEventListener("dispose",S));const z=M.program;i.updateUBOMapping(w,z);const k=e.render.frame;s[w.id]!==k&&(m(w),s[w.id]=k)}function f(w){const M=d();w.__bindingPointIndex=M;const R=n.createBuffer(),z=w.__size,k=w.usage;return n.bindBuffer(n.UNIFORM_BUFFER,R),n.bufferData(n.UNIFORM_BUFFER,z,k),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,M,R),R}function d(){for(let w=0;w<a;w++)if(o.indexOf(w)===-1)return o.push(w),w;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function m(w){const M=r[w.id],R=w.uniforms,z=w.__cache;n.bindBuffer(n.UNIFORM_BUFFER,M);for(let k=0,P=R.length;k<P;k++){const b=Array.isArray(R[k])?R[k]:[R[k]];for(let A=0,T=b.length;A<T;A++){const L=b[A];if(v(L,k,A,z)===!0){const H=L.__offset,U=Array.isArray(L.value)?L.value:[L.value];let se=0;for(let fe=0;fe<U.length;fe++){const oe=U[fe],Se=E(oe);typeof oe=="number"||typeof oe=="boolean"?(L.__data[0]=oe,n.bufferSubData(n.UNIFORM_BUFFER,H+se,L.__data)):oe.isMatrix3?(L.__data[0]=oe.elements[0],L.__data[1]=oe.elements[1],L.__data[2]=oe.elements[2],L.__data[3]=0,L.__data[4]=oe.elements[3],L.__data[5]=oe.elements[4],L.__data[6]=oe.elements[5],L.__data[7]=0,L.__data[8]=oe.elements[6],L.__data[9]=oe.elements[7],L.__data[10]=oe.elements[8],L.__data[11]=0):(oe.toArray(L.__data,se),se+=Se.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,H,L.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function v(w,M,R,z){const k=w.value,P=M+"_"+R;if(z[P]===void 0)return typeof k=="number"||typeof k=="boolean"?z[P]=k:z[P]=k.clone(),!0;{const b=z[P];if(typeof k=="number"||typeof k=="boolean"){if(b!==k)return z[P]=k,!0}else if(b.equals(k)===!1)return b.copy(k),!0}return!1}function _(w){const M=w.uniforms;let R=0;const z=16;for(let P=0,b=M.length;P<b;P++){const A=Array.isArray(M[P])?M[P]:[M[P]];for(let T=0,L=A.length;T<L;T++){const H=A[T],U=Array.isArray(H.value)?H.value:[H.value];for(let se=0,fe=U.length;se<fe;se++){const oe=U[se],Se=E(oe),q=R%z,le=q%Se.boundary,ie=q+le;R+=le,ie!==0&&z-ie<Se.storage&&(R+=z-ie),H.__data=new Float32Array(Se.storage/Float32Array.BYTES_PER_ELEMENT),H.__offset=R,R+=Se.storage}}}const k=R%z;return k>0&&(R+=z-k),w.__size=R,w.__cache={},this}function E(w){const M={boundary:0,storage:0};return typeof w=="number"||typeof w=="boolean"?(M.boundary=4,M.storage=4):w.isVector2?(M.boundary=8,M.storage=8):w.isVector3||w.isColor?(M.boundary=16,M.storage=12):w.isVector4?(M.boundary=16,M.storage=16):w.isMatrix3?(M.boundary=48,M.storage=48):w.isMatrix4?(M.boundary=64,M.storage=64):w.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",w),M}function S(w){const M=w.target;M.removeEventListener("dispose",S);const R=o.indexOf(M.__bindingPointIndex);o.splice(R,1),n.deleteBuffer(r[M.id]),delete r[M.id],delete s[M.id]}function y(){for(const w in r)n.deleteBuffer(r[w]);o=[],r={},s={}}return{bind:c,update:h,dispose:y}}class a1{constructor(e={}){const{canvas:t=YR(),context:i=null,depth:r=!0,stencil:s=!1,alpha:o=!1,antialias:a=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:h=!1,powerPreference:f="default",failIfMajorPerformanceCaveat:d=!1}=e;this.isWebGLRenderer=!0;let m;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");m=i.getContextAttributes().alpha}else m=o;const v=new Uint32Array(4),_=new Int32Array(4);let E=null,S=null;const y=[],w=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Ur,this.toneMapping=no,this.toneMappingExposure=1;const M=this;let R=!1,z=0,k=0,P=null,b=-1,A=null;const T=new pn,L=new pn;let H=null;const U=new lt(0);let se=0,fe=t.width,oe=t.height,Se=1,q=null,le=null;const ie=new pn(0,0,fe,oe),ye=new pn(0,0,fe,oe);let Ae=!1;const ze=new Gd;let pe=!1,De=!1;const Oe=new Lt,He=new j,ut=new pn,Tt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let mt=!1;function At(){return P===null?Se:1}let X=i;function Fe(O,W){return t.getContext(O,W)}try{const O={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:c,preserveDrawingBuffer:h,powerPreference:f,failIfMajorPerformanceCaveat:d};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${ch}`),t.addEventListener("webglcontextlost",re,!1),t.addEventListener("webglcontextrestored",Me,!1),t.addEventListener("webglcontextcreationerror",je,!1),X===null){const W="webgl2";if(X=Fe(W,O),X===null)throw Fe(W)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(O){throw console.error("THREE.WebGLRenderer: "+O.message),O}let Be,Ke,Pe,gt,Ze,st,Z,B,me,Re,Te,ke,it,Ge,Qe,bt,We,nt,Dt,yt,$e,wt,te,Le;function Q(){Be=new Pz(X),Be.init(),wt=new sP(X,Be),Ke=new Tz(X,Be,e,wt),Pe=new u5(X),gt=new Dz(X),Ze=new JB,st=new g5(X,Be,Pe,Ze,Ke,wt,gt),Z=new bz(M),B=new Rz(M),me=new HU(X),te=new Mz(X,me),Re=new Lz(X,me,gt,te),Te=new Oz(X,Re,me,gt),Dt=new kz(X,Ke,st),bt=new Az(Ze),ke=new ZB(M,Z,B,Be,Ke,te,bt),it=new M5(M,Ze),Ge=new e5,Qe=new o5(Be),nt=new wz(M,Z,B,Pe,Te,m,c),We=new c5(M,Te,Ke),Le=new E5(X,gt,Ke,Pe),yt=new Ez(X,Be,gt),$e=new Nz(X,Be,gt),gt.programs=ke.programs,M.capabilities=Ke,M.extensions=Be,M.properties=Ze,M.renderLists=Ge,M.shadowMap=We,M.state=Pe,M.info=gt}Q();const Ce=new S5(M,X);this.xr=Ce,this.getContext=function(){return X},this.getContextAttributes=function(){return X.getContextAttributes()},this.forceContextLoss=function(){const O=Be.get("WEBGL_lose_context");O&&O.loseContext()},this.forceContextRestore=function(){const O=Be.get("WEBGL_lose_context");O&&O.restoreContext()},this.getPixelRatio=function(){return Se},this.setPixelRatio=function(O){O!==void 0&&(Se=O,this.setSize(fe,oe,!1))},this.getSize=function(O){return O.set(fe,oe)},this.setSize=function(O,W,Y=!0){if(Ce.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}fe=O,oe=W,t.width=Math.floor(O*Se),t.height=Math.floor(W*Se),Y===!0&&(t.style.width=O+"px",t.style.height=W+"px"),this.setViewport(0,0,O,W)},this.getDrawingBufferSize=function(O){return O.set(fe*Se,oe*Se).floor()},this.setDrawingBufferSize=function(O,W,Y){fe=O,oe=W,Se=Y,t.width=Math.floor(O*Y),t.height=Math.floor(W*Y),this.setViewport(0,0,O,W)},this.getCurrentViewport=function(O){return O.copy(T)},this.getViewport=function(O){return O.copy(ie)},this.setViewport=function(O,W,Y,ee){O.isVector4?ie.set(O.x,O.y,O.z,O.w):ie.set(O,W,Y,ee),Pe.viewport(T.copy(ie).multiplyScalar(Se).round())},this.getScissor=function(O){return O.copy(ye)},this.setScissor=function(O,W,Y,ee){O.isVector4?ye.set(O.x,O.y,O.z,O.w):ye.set(O,W,Y,ee),Pe.scissor(L.copy(ye).multiplyScalar(Se).round())},this.getScissorTest=function(){return Ae},this.setScissorTest=function(O){Pe.setScissorTest(Ae=O)},this.setOpaqueSort=function(O){q=O},this.setTransparentSort=function(O){le=O},this.getClearColor=function(O){return O.copy(nt.getClearColor())},this.setClearColor=function(){nt.setClearColor.apply(nt,arguments)},this.getClearAlpha=function(){return nt.getClearAlpha()},this.setClearAlpha=function(){nt.setClearAlpha.apply(nt,arguments)},this.clear=function(O=!0,W=!0,Y=!0){let ee=0;if(O){let $=!1;if(P!==null){const he=P.texture.format;$=he===h0||he===u0||he===zd}if($){const he=P.texture.type,de=he===Mr||he===ao||he===Ku||he===sc||he===l0||he===c0,_e=nt.getClearColor(),ge=nt.getClearAlpha(),et=_e.r,Ue=_e.g,Ne=_e.b;de?(v[0]=et,v[1]=Ue,v[2]=Ne,v[3]=ge,X.clearBufferuiv(X.COLOR,0,v)):(_[0]=et,_[1]=Ue,_[2]=Ne,_[3]=ge,X.clearBufferiv(X.COLOR,0,_))}else ee|=X.COLOR_BUFFER_BIT}W&&(ee|=X.DEPTH_BUFFER_BIT),Y&&(ee|=X.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),X.clear(ee)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",re,!1),t.removeEventListener("webglcontextrestored",Me,!1),t.removeEventListener("webglcontextcreationerror",je,!1),Ge.dispose(),Qe.dispose(),Ze.dispose(),Z.dispose(),B.dispose(),Te.dispose(),te.dispose(),Le.dispose(),ke.dispose(),Ce.dispose(),Ce.removeEventListener("sessionstart",Dn),Ce.removeEventListener("sessionend",xn),ur.stop()};function re(O){O.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),R=!0}function Me(){console.log("THREE.WebGLRenderer: Context Restored."),R=!1;const O=gt.autoReset,W=We.enabled,Y=We.autoUpdate,ee=We.needsUpdate,$=We.type;Q(),gt.autoReset=O,We.enabled=W,We.autoUpdate=Y,We.needsUpdate=ee,We.type=$}function je(O){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",O.statusMessage)}function Mt(O){const W=O.target;W.removeEventListener("dispose",Mt),Nt(W)}function Nt(O){$t(O),Ze.remove(O)}function $t(O){const W=Ze.get(O).programs;W!==void 0&&(W.forEach(function(Y){ke.releaseProgram(Y)}),O.isShaderMaterial&&ke.releaseShaderCache(O))}this.renderBufferDirect=function(O,W,Y,ee,$,he){W===null&&(W=Tt);const de=$.isMesh&&$.matrixWorld.determinant()<0,_e=F(O,W,Y,ee,$);Pe.setMaterial(ee,de);let ge=Y.index,et=1;if(ee.wireframe===!0){if(ge=Re.getWireframeAttribute(Y),ge===void 0)return;et=2}const Ue=Y.drawRange,Ne=Y.attributes.position;let Je=Ue.start*et,ct=(Ue.start+Ue.count)*et;he!==null&&(Je=Math.max(Je,he.start*et),ct=Math.min(ct,(he.start+he.count)*et)),ge!==null?(Je=Math.max(Je,0),ct=Math.min(ct,ge.count)):Ne!=null&&(Je=Math.max(Je,0),ct=Math.min(ct,Ne.count));const vt=ct-Je;if(vt<0||vt===1/0)return;te.setup($,ee,_e,Y,ge);let Ct,tt=yt;if(ge!==null&&(Ct=me.get(ge),tt=$e,tt.setIndex(Ct)),$.isMesh)ee.wireframe===!0?(Pe.setLineWidth(ee.wireframeLinewidth*At()),tt.setMode(X.LINES)):tt.setMode(X.TRIANGLES);else if($.isLine){let Ve=ee.linewidth;Ve===void 0&&(Ve=1),Pe.setLineWidth(Ve*At()),$.isLineSegments?tt.setMode(X.LINES):$.isLineLoop?tt.setMode(X.LINE_LOOP):tt.setMode(X.LINE_STRIP)}else $.isPoints?tt.setMode(X.POINTS):$.isSprite&&tt.setMode(X.TRIANGLES);if($.isBatchedMesh)if($._multiDrawInstances!==null)tt.renderMultiDrawInstances($._multiDrawStarts,$._multiDrawCounts,$._multiDrawCount,$._multiDrawInstances);else if(Be.get("WEBGL_multi_draw"))tt.renderMultiDraw($._multiDrawStarts,$._multiDrawCounts,$._multiDrawCount);else{const Ve=$._multiDrawStarts,xt=$._multiDrawCounts,dt=$._multiDrawCount,Et=ge?me.get(ge).bytesPerElement:1,Jt=Ze.get(ee).currentProgram.getUniforms();for(let ln=0;ln<dt;ln++)Jt.setValue(X,"_gl_DrawID",ln),tt.render(Ve[ln]/Et,xt[ln])}else if($.isInstancedMesh)tt.renderInstances(Je,vt,$.count);else if(Y.isInstancedBufferGeometry){const Ve=Y._maxInstanceCount!==void 0?Y._maxInstanceCount:1/0,xt=Math.min(Y.instanceCount,Ve);tt.renderInstances(Je,vt,xt)}else tt.render(Je,vt)};function en(O,W,Y){O.transparent===!0&&O.side===Is&&O.forceSinglePass===!1?(O.side=Hi,O.needsUpdate=!0,Ft(O,W,Y),O.side=jo,O.needsUpdate=!0,Ft(O,W,Y),O.side=Is):Ft(O,W,Y)}this.compile=function(O,W,Y=null){Y===null&&(Y=O),S=Qe.get(Y),S.init(W),w.push(S),Y.traverseVisible(function($){$.isLight&&$.layers.test(W.layers)&&(S.pushLight($),$.castShadow&&S.pushShadow($))}),O!==Y&&O.traverseVisible(function($){$.isLight&&$.layers.test(W.layers)&&(S.pushLight($),$.castShadow&&S.pushShadow($))}),S.setupLights();const ee=new Set;return O.traverse(function($){const he=$.material;if(he)if(Array.isArray(he))for(let de=0;de<he.length;de++){const _e=he[de];en(_e,Y,$),ee.add(_e)}else en(he,Y,$),ee.add(he)}),w.pop(),S=null,ee},this.compileAsync=function(O,W,Y=null){const ee=this.compile(O,W,Y);return new Promise($=>{function he(){if(ee.forEach(function(de){Ze.get(de).currentProgram.isReady()&&ee.delete(de)}),ee.size===0){$(O);return}setTimeout(he,10)}Be.get("KHR_parallel_shader_compile")!==null?he():setTimeout(he,10)})};let Ut=null;function wn(O){Ut&&Ut(O)}function Dn(){ur.stop()}function xn(){ur.start()}const ur=new eP;ur.setAnimationLoop(wn),typeof self<"u"&&ur.setContext(self),this.setAnimationLoop=function(O){Ut=O,Ce.setAnimationLoop(O),O===null?ur.stop():ur.start()},Ce.addEventListener("sessionstart",Dn),Ce.addEventListener("sessionend",xn),this.render=function(O,W){if(W!==void 0&&W.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(R===!0)return;if(O.matrixWorldAutoUpdate===!0&&O.updateMatrixWorld(),W.parent===null&&W.matrixWorldAutoUpdate===!0&&W.updateMatrixWorld(),Ce.enabled===!0&&Ce.isPresenting===!0&&(Ce.cameraAutoUpdate===!0&&Ce.updateCamera(W),W=Ce.getCamera()),O.isScene===!0&&O.onBeforeRender(M,O,W,P),S=Qe.get(O,w.length),S.init(W),w.push(S),Oe.multiplyMatrices(W.projectionMatrix,W.matrixWorldInverse),ze.setFromProjectionMatrix(Oe),De=this.localClippingEnabled,pe=bt.init(this.clippingPlanes,De),E=Ge.get(O,y.length),E.init(),y.push(E),Ce.enabled===!0&&Ce.isPresenting===!0){const he=M.xr.getDepthSensingMesh();he!==null&&Er(he,W,-1/0,M.sortObjects)}Er(O,W,0,M.sortObjects),E.finish(),M.sortObjects===!0&&E.sort(q,le),mt=Ce.enabled===!1||Ce.isPresenting===!1||Ce.hasDepthSensing()===!1,mt&&nt.addToRenderList(E,O),this.info.render.frame++,pe===!0&&bt.beginShadows();const Y=S.state.shadowsArray;We.render(Y,O,W),pe===!0&&bt.endShadows(),this.info.autoReset===!0&&this.info.reset();const ee=E.opaque,$=E.transmissive;if(S.setupLights(),W.isArrayCamera){const he=W.cameras;if($.length>0)for(let de=0,_e=he.length;de<_e;de++){const ge=he[de];Bs(ee,$,O,ge)}mt&&nt.render(O);for(let de=0,_e=he.length;de<_e;de++){const ge=he[de];Ii(E,O,ge,ge.viewport)}}else $.length>0&&Bs(ee,$,O,W),mt&&nt.render(O),Ii(E,O,W);P!==null&&(st.updateMultisampleRenderTarget(P),st.updateRenderTargetMipmap(P)),O.isScene===!0&&O.onAfterRender(M,O,W),te.resetDefaultState(),b=-1,A=null,w.pop(),w.length>0?(S=w[w.length-1],pe===!0&&bt.setGlobalState(M.clippingPlanes,S.state.camera)):S=null,y.pop(),y.length>0?E=y[y.length-1]:E=null};function Er(O,W,Y,ee){if(O.visible===!1)return;if(O.layers.test(W.layers)){if(O.isGroup)Y=O.renderOrder;else if(O.isLOD)O.autoUpdate===!0&&O.update(W);else if(O.isLight)S.pushLight(O),O.castShadow&&S.pushShadow(O);else if(O.isSprite){if(!O.frustumCulled||ze.intersectsSprite(O)){ee&&ut.setFromMatrixPosition(O.matrixWorld).applyMatrix4(Oe);const de=Te.update(O),_e=O.material;_e.visible&&E.push(O,de,_e,Y,ut.z,null)}}else if((O.isMesh||O.isLine||O.isPoints)&&(!O.frustumCulled||ze.intersectsObject(O))){const de=Te.update(O),_e=O.material;if(ee&&(O.boundingSphere!==void 0?(O.boundingSphere===null&&O.computeBoundingSphere(),ut.copy(O.boundingSphere.center)):(de.boundingSphere===null&&de.computeBoundingSphere(),ut.copy(de.boundingSphere.center)),ut.applyMatrix4(O.matrixWorld).applyMatrix4(Oe)),Array.isArray(_e)){const ge=de.groups;for(let et=0,Ue=ge.length;et<Ue;et++){const Ne=ge[et],Je=_e[Ne.materialIndex];Je&&Je.visible&&E.push(O,de,Je,Y,ut.z,Ne)}}else _e.visible&&E.push(O,de,_e,Y,ut.z,null)}}const he=O.children;for(let de=0,_e=he.length;de<_e;de++)Er(he[de],W,Y,ee)}function Ii(O,W,Y,ee){const $=O.opaque,he=O.transmissive,de=O.transparent;S.setupLightsView(Y),pe===!0&&bt.setGlobalState(M.clippingPlanes,Y),ee&&Pe.viewport(T.copy(ee)),$.length>0&&hr($,W,Y),he.length>0&&hr(he,W,Y),de.length>0&&hr(de,W,Y),Pe.buffers.depth.setTest(!0),Pe.buffers.depth.setMask(!0),Pe.buffers.color.setMask(!0),Pe.setPolygonOffset(!1)}function Bs(O,W,Y,ee){if((Y.isScene===!0?Y.overrideMaterial:null)!==null)return;S.state.transmissionRenderTarget[ee.id]===void 0&&(S.state.transmissionRenderTarget[ee.id]=new jr(1,1,{generateMipmaps:!0,type:Be.has("EXT_color_buffer_half_float")||Be.has("EXT_color_buffer_float")?xi:Mr,minFilter:Zs,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:hn.workingColorSpace}));const he=S.state.transmissionRenderTarget[ee.id],de=ee.viewport||T;he.setSize(de.z,de.w);const _e=M.getRenderTarget();M.setRenderTarget(he),M.getClearColor(U),se=M.getClearAlpha(),se<1&&M.setClearColor(16777215,.5),M.clear(),mt&&nt.render(Y);const ge=M.toneMapping;M.toneMapping=no;const et=ee.viewport;if(ee.viewport!==void 0&&(ee.viewport=void 0),S.setupLightsView(ee),pe===!0&&bt.setGlobalState(M.clippingPlanes,ee),hr(O,Y,ee),st.updateMultisampleRenderTarget(he),st.updateRenderTargetMipmap(he),Be.has("WEBGL_multisampled_render_to_texture")===!1){let Ue=!1;for(let Ne=0,Je=W.length;Ne<Je;Ne++){const ct=W[Ne],vt=ct.object,Ct=ct.geometry,tt=ct.material,Ve=ct.group;if(tt.side===Is&&vt.layers.test(ee.layers)){const xt=tt.side;tt.side=Hi,tt.needsUpdate=!0,qn(vt,Y,ee,Ct,tt,Ve),tt.side=xt,tt.needsUpdate=!0,Ue=!0}}Ue===!0&&(st.updateMultisampleRenderTarget(he),st.updateRenderTargetMipmap(he))}M.setRenderTarget(_e),M.setClearColor(U,se),et!==void 0&&(ee.viewport=et),M.toneMapping=ge}function hr(O,W,Y){const ee=W.isScene===!0?W.overrideMaterial:null;for(let $=0,he=O.length;$<he;$++){const de=O[$],_e=de.object,ge=de.geometry,et=ee===null?de.material:ee,Ue=de.group;_e.layers.test(Y.layers)&&qn(_e,W,Y,ge,et,Ue)}}function qn(O,W,Y,ee,$,he){O.onBeforeRender(M,W,Y,ee,$,he),O.modelViewMatrix.multiplyMatrices(Y.matrixWorldInverse,O.matrixWorld),O.normalMatrix.getNormalMatrix(O.modelViewMatrix),$.onBeforeRender(M,W,Y,ee,O,he),$.transparent===!0&&$.side===Is&&$.forceSinglePass===!1?($.side=Hi,$.needsUpdate=!0,M.renderBufferDirect(Y,W,ee,$,O,he),$.side=jo,$.needsUpdate=!0,M.renderBufferDirect(Y,W,ee,$,O,he),$.side=Is):M.renderBufferDirect(Y,W,ee,$,O,he),O.onAfterRender(M,W,Y,ee,$,he)}function Ft(O,W,Y){W.isScene!==!0&&(W=Tt);const ee=Ze.get(O),$=S.state.lights,he=S.state.shadowsArray,de=$.state.version,_e=ke.getParameters(O,$.state,he,W,Y),ge=ke.getProgramCacheKey(_e);let et=ee.programs;ee.environment=O.isMeshStandardMaterial?W.environment:null,ee.fog=W.fog,ee.envMap=(O.isMeshStandardMaterial?B:Z).get(O.envMap||ee.environment),ee.envMapRotation=ee.environment!==null&&O.envMap===null?W.environmentRotation:O.envMapRotation,et===void 0&&(O.addEventListener("dispose",Mt),et=new Map,ee.programs=et);let Ue=et.get(ge);if(Ue!==void 0){if(ee.currentProgram===Ue&&ee.lightsStateVersion===de)return Hs(O,_e),Ue}else _e.uniforms=ke.getUniforms(O),O.onBeforeCompile(_e,M),Ue=ke.acquireProgram(_e,ge),et.set(ge,Ue),ee.uniforms=_e.uniforms;const Ne=ee.uniforms;return(!O.isShaderMaterial&&!O.isRawShaderMaterial||O.clipping===!0)&&(Ne.clippingPlanes=bt.uniform),Hs(O,_e),ee.needsLights=ne(O),ee.lightsStateVersion=de,ee.needsLights&&(Ne.ambientLightColor.value=$.state.ambient,Ne.lightProbe.value=$.state.probe,Ne.directionalLights.value=$.state.directional,Ne.directionalLightShadows.value=$.state.directionalShadow,Ne.spotLights.value=$.state.spot,Ne.spotLightShadows.value=$.state.spotShadow,Ne.rectAreaLights.value=$.state.rectArea,Ne.ltc_1.value=$.state.rectAreaLTC1,Ne.ltc_2.value=$.state.rectAreaLTC2,Ne.pointLights.value=$.state.point,Ne.pointLightShadows.value=$.state.pointShadow,Ne.hemisphereLights.value=$.state.hemi,Ne.directionalShadowMap.value=$.state.directionalShadowMap,Ne.directionalShadowMatrix.value=$.state.directionalShadowMatrix,Ne.spotShadowMap.value=$.state.spotShadowMap,Ne.spotLightMatrix.value=$.state.spotLightMatrix,Ne.spotLightMap.value=$.state.spotLightMap,Ne.pointShadowMap.value=$.state.pointShadowMap,Ne.pointShadowMatrix.value=$.state.pointShadowMatrix),ee.currentProgram=Ue,ee.uniformsList=null,Ue}function po(O){if(O.uniformsList===null){const W=O.currentProgram.getUniforms();O.uniformsList=_g.seqWithValue(W.seq,O.uniforms)}return O.uniformsList}function Hs(O,W){const Y=Ze.get(O);Y.outputColorSpace=W.outputColorSpace,Y.batching=W.batching,Y.batchingColor=W.batchingColor,Y.instancing=W.instancing,Y.instancingColor=W.instancingColor,Y.instancingMorph=W.instancingMorph,Y.skinning=W.skinning,Y.morphTargets=W.morphTargets,Y.morphNormals=W.morphNormals,Y.morphColors=W.morphColors,Y.morphTargetsCount=W.morphTargetsCount,Y.numClippingPlanes=W.numClippingPlanes,Y.numIntersection=W.numClipIntersection,Y.vertexAlphas=W.vertexAlphas,Y.vertexTangents=W.vertexTangents,Y.toneMapping=W.toneMapping}function F(O,W,Y,ee,$){W.isScene!==!0&&(W=Tt),st.resetTextureUnits();const he=W.fog,de=ee.isMeshStandardMaterial?W.environment:null,_e=P===null?M.outputColorSpace:P.isXRRenderTarget===!0?P.texture.colorSpace:fs,ge=(ee.isMeshStandardMaterial?B:Z).get(ee.envMap||de),et=ee.vertexColors===!0&&!!Y.attributes.color&&Y.attributes.color.itemSize===4,Ue=!!Y.attributes.tangent&&(!!ee.normalMap||ee.anisotropy>0),Ne=!!Y.morphAttributes.position,Je=!!Y.morphAttributes.normal,ct=!!Y.morphAttributes.color;let vt=no;ee.toneMapped&&(P===null||P.isXRRenderTarget===!0)&&(vt=M.toneMapping);const Ct=Y.morphAttributes.position||Y.morphAttributes.normal||Y.morphAttributes.color,tt=Ct!==void 0?Ct.length:0,Ve=Ze.get(ee),xt=S.state.lights;if(pe===!0&&(De===!0||O!==A)){const Pt=O===A&&ee.id===b;bt.setState(ee,O,Pt)}let dt=!1;ee.version===Ve.__version?(Ve.needsLights&&Ve.lightsStateVersion!==xt.state.version||Ve.outputColorSpace!==_e||$.isBatchedMesh&&Ve.batching===!1||!$.isBatchedMesh&&Ve.batching===!0||$.isBatchedMesh&&Ve.batchingColor===!0&&$.colorTexture===null||$.isBatchedMesh&&Ve.batchingColor===!1&&$.colorTexture!==null||$.isInstancedMesh&&Ve.instancing===!1||!$.isInstancedMesh&&Ve.instancing===!0||$.isSkinnedMesh&&Ve.skinning===!1||!$.isSkinnedMesh&&Ve.skinning===!0||$.isInstancedMesh&&Ve.instancingColor===!0&&$.instanceColor===null||$.isInstancedMesh&&Ve.instancingColor===!1&&$.instanceColor!==null||$.isInstancedMesh&&Ve.instancingMorph===!0&&$.morphTexture===null||$.isInstancedMesh&&Ve.instancingMorph===!1&&$.morphTexture!==null||Ve.envMap!==ge||ee.fog===!0&&Ve.fog!==he||Ve.numClippingPlanes!==void 0&&(Ve.numClippingPlanes!==bt.numPlanes||Ve.numIntersection!==bt.numIntersection)||Ve.vertexAlphas!==et||Ve.vertexTangents!==Ue||Ve.morphTargets!==Ne||Ve.morphNormals!==Je||Ve.morphColors!==ct||Ve.toneMapping!==vt||Ve.morphTargetsCount!==tt)&&(dt=!0):(dt=!0,Ve.__version=ee.version);let Et=Ve.currentProgram;dt===!0&&(Et=Ft(ee,W,$));let Jt=!1,ln=!1,Mn=!1;const Wt=Et.getUniforms(),Ht=Ve.uniforms;if(Pe.useProgram(Et.program)&&(Jt=!0,ln=!0,Mn=!0),ee.id!==b&&(b=ee.id,ln=!0),Jt||A!==O){Wt.setValue(X,"projectionMatrix",O.projectionMatrix),Wt.setValue(X,"viewMatrix",O.matrixWorldInverse);const Pt=Wt.map.cameraPosition;Pt!==void 0&&Pt.setValue(X,He.setFromMatrixPosition(O.matrixWorld)),Ke.logarithmicDepthBuffer&&Wt.setValue(X,"logDepthBufFC",2/(Math.log(O.far+1)/Math.LN2)),(ee.isMeshPhongMaterial||ee.isMeshToonMaterial||ee.isMeshLambertMaterial||ee.isMeshBasicMaterial||ee.isMeshStandardMaterial||ee.isShaderMaterial)&&Wt.setValue(X,"isOrthographic",O.isOrthographicCamera===!0),A!==O&&(A=O,ln=!0,Mn=!0)}if($.isSkinnedMesh){Wt.setOptional(X,$,"bindMatrix"),Wt.setOptional(X,$,"bindMatrixInverse");const Pt=$.skeleton;Pt&&(Pt.boneTexture===null&&Pt.computeBoneTexture(),Wt.setValue(X,"boneTexture",Pt.boneTexture,st))}$.isBatchedMesh&&(Wt.setOptional(X,$,"batchingTexture"),Wt.setValue(X,"batchingTexture",$._matricesTexture,st),Wt.setOptional(X,$,"batchingIdTexture"),Wt.setValue(X,"batchingIdTexture",$._indirectTexture,st),Wt.setOptional(X,$,"batchingColorTexture"),$._colorsTexture!==null&&Wt.setValue(X,"batchingColorTexture",$._colorsTexture,st));const Cn=Y.morphAttributes;if((Cn.position!==void 0||Cn.normal!==void 0||Cn.color!==void 0)&&Dt.update($,Y,Et),(ln||Ve.receiveShadow!==$.receiveShadow)&&(Ve.receiveShadow=$.receiveShadow,Wt.setValue(X,"receiveShadow",$.receiveShadow)),ee.isMeshGouraudMaterial&&ee.envMap!==null&&(Ht.envMap.value=ge,Ht.flipEnvMap.value=ge.isCubeTexture&&ge.isRenderTargetTexture===!1?-1:1),ee.isMeshStandardMaterial&&ee.envMap===null&&W.environment!==null&&(Ht.envMapIntensity.value=W.environmentIntensity),ln&&(Wt.setValue(X,"toneMappingExposure",M.toneMappingExposure),Ve.needsLights&&G(Ht,Mn),he&&ee.fog===!0&&it.refreshFogUniforms(Ht,he),it.refreshMaterialUniforms(Ht,ee,Se,oe,S.state.transmissionRenderTarget[O.id]),_g.upload(X,po(Ve),Ht,st)),ee.isShaderMaterial&&ee.uniformsNeedUpdate===!0&&(_g.upload(X,po(Ve),Ht,st),ee.uniformsNeedUpdate=!1),ee.isSpriteMaterial&&Wt.setValue(X,"center",$.center),Wt.setValue(X,"modelViewMatrix",$.modelViewMatrix),Wt.setValue(X,"normalMatrix",$.normalMatrix),Wt.setValue(X,"modelMatrix",$.matrixWorld),ee.isShaderMaterial||ee.isRawShaderMaterial){const Pt=ee.uniformsGroups;for(let kt=0,fn=Pt.length;kt<fn;kt++){const wi=Pt[kt];Le.update(wi,Et),Le.bind(wi,Et)}}return Et}function G(O,W){O.ambientLightColor.needsUpdate=W,O.lightProbe.needsUpdate=W,O.directionalLights.needsUpdate=W,O.directionalLightShadows.needsUpdate=W,O.pointLights.needsUpdate=W,O.pointLightShadows.needsUpdate=W,O.spotLights.needsUpdate=W,O.spotLightShadows.needsUpdate=W,O.rectAreaLights.needsUpdate=W,O.hemisphereLights.needsUpdate=W}function ne(O){return O.isMeshLambertMaterial||O.isMeshToonMaterial||O.isMeshPhongMaterial||O.isMeshStandardMaterial||O.isShadowMaterial||O.isShaderMaterial&&O.lights===!0}this.getActiveCubeFace=function(){return z},this.getActiveMipmapLevel=function(){return k},this.getRenderTarget=function(){return P},this.setRenderTargetTextures=function(O,W,Y){Ze.get(O.texture).__webglTexture=W,Ze.get(O.depthTexture).__webglTexture=Y;const ee=Ze.get(O);ee.__hasExternalTextures=!0,ee.__autoAllocateDepthBuffer=Y===void 0,ee.__autoAllocateDepthBuffer||Be.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ee.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(O,W){const Y=Ze.get(O);Y.__webglFramebuffer=W,Y.__useDefaultFramebuffer=W===void 0},this.setRenderTarget=function(O,W=0,Y=0){P=O,z=W,k=Y;let ee=!0,$=null,he=!1,de=!1;if(O){const ge=Ze.get(O);if(ge.__useDefaultFramebuffer!==void 0)Pe.bindFramebuffer(X.FRAMEBUFFER,null),ee=!1;else if(ge.__webglFramebuffer===void 0)st.setupRenderTarget(O);else if(ge.__hasExternalTextures)st.rebindTextures(O,Ze.get(O.texture).__webglTexture,Ze.get(O.depthTexture).__webglTexture);else if(O.depthBuffer){const Ne=O.depthTexture;if(ge.__boundDepthTexture!==Ne){if(Ne!==null&&Ze.has(Ne)&&(O.width!==Ne.image.width||O.height!==Ne.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");st.setupDepthRenderbuffer(O)}}const et=O.texture;(et.isData3DTexture||et.isDataArrayTexture||et.isCompressedArrayTexture)&&(de=!0);const Ue=Ze.get(O).__webglFramebuffer;O.isWebGLCubeRenderTarget?(Array.isArray(Ue[W])?$=Ue[W][Y]:$=Ue[W],he=!0):O.samples>0&&st.useMultisampledRTT(O)===!1?$=Ze.get(O).__webglMultisampledFramebuffer:Array.isArray(Ue)?$=Ue[Y]:$=Ue,T.copy(O.viewport),L.copy(O.scissor),H=O.scissorTest}else T.copy(ie).multiplyScalar(Se).floor(),L.copy(ye).multiplyScalar(Se).floor(),H=Ae;if(Pe.bindFramebuffer(X.FRAMEBUFFER,$)&&ee&&Pe.drawBuffers(O,$),Pe.viewport(T),Pe.scissor(L),Pe.setScissorTest(H),he){const ge=Ze.get(O.texture);X.framebufferTexture2D(X.FRAMEBUFFER,X.COLOR_ATTACHMENT0,X.TEXTURE_CUBE_MAP_POSITIVE_X+W,ge.__webglTexture,Y)}else if(de){const ge=Ze.get(O.texture),et=W||0;X.framebufferTextureLayer(X.FRAMEBUFFER,X.COLOR_ATTACHMENT0,ge.__webglTexture,Y||0,et)}b=-1},this.readRenderTargetPixels=function(O,W,Y,ee,$,he,de){if(!(O&&O.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let _e=Ze.get(O).__webglFramebuffer;if(O.isWebGLCubeRenderTarget&&de!==void 0&&(_e=_e[de]),_e){Pe.bindFramebuffer(X.FRAMEBUFFER,_e);try{const ge=O.texture,et=ge.format,Ue=ge.type;if(!Ke.textureFormatReadable(et)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Ke.textureTypeReadable(Ue)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}W>=0&&W<=O.width-ee&&Y>=0&&Y<=O.height-$&&X.readPixels(W,Y,ee,$,wt.convert(et),wt.convert(Ue),he)}finally{const ge=P!==null?Ze.get(P).__webglFramebuffer:null;Pe.bindFramebuffer(X.FRAMEBUFFER,ge)}}},this.readRenderTargetPixelsAsync=async function(O,W,Y,ee,$,he,de){if(!(O&&O.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let _e=Ze.get(O).__webglFramebuffer;if(O.isWebGLCubeRenderTarget&&de!==void 0&&(_e=_e[de]),_e){Pe.bindFramebuffer(X.FRAMEBUFFER,_e);try{const ge=O.texture,et=ge.format,Ue=ge.type;if(!Ke.textureFormatReadable(et))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Ke.textureTypeReadable(Ue))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(W>=0&&W<=O.width-ee&&Y>=0&&Y<=O.height-$){const Ne=X.createBuffer();X.bindBuffer(X.PIXEL_PACK_BUFFER,Ne),X.bufferData(X.PIXEL_PACK_BUFFER,he.byteLength,X.STREAM_READ),X.readPixels(W,Y,ee,$,wt.convert(et),wt.convert(Ue),0),X.flush();const Je=X.fenceSync(X.SYNC_GPU_COMMANDS_COMPLETE,0);await dU(X,Je,4);try{X.bindBuffer(X.PIXEL_PACK_BUFFER,Ne),X.getBufferSubData(X.PIXEL_PACK_BUFFER,0,he)}finally{X.deleteBuffer(Ne),X.deleteSync(Je)}return he}}finally{const ge=P!==null?Ze.get(P).__webglFramebuffer:null;Pe.bindFramebuffer(X.FRAMEBUFFER,ge)}}},this.copyFramebufferToTexture=function(O,W=null,Y=0){O.isTexture!==!0&&(ku("WebGLRenderer: copyFramebufferToTexture function signature has changed."),W=arguments[0]||null,O=arguments[1]);const ee=Math.pow(2,-Y),$=Math.floor(O.image.width*ee),he=Math.floor(O.image.height*ee),de=W!==null?W.x:0,_e=W!==null?W.y:0;st.setTexture2D(O,0),X.copyTexSubImage2D(X.TEXTURE_2D,Y,0,0,de,_e,$,he),Pe.unbindTexture()},this.copyTextureToTexture=function(O,W,Y=null,ee=null,$=0){O.isTexture!==!0&&(ku("WebGLRenderer: copyTextureToTexture function signature has changed."),ee=arguments[0]||null,O=arguments[1],W=arguments[2],$=arguments[3]||0,Y=null);let he,de,_e,ge,et,Ue;Y!==null?(he=Y.max.x-Y.min.x,de=Y.max.y-Y.min.y,_e=Y.min.x,ge=Y.min.y):(he=O.image.width,de=O.image.height,_e=0,ge=0),ee!==null?(et=ee.x,Ue=ee.y):(et=0,Ue=0);const Ne=wt.convert(W.format),Je=wt.convert(W.type);st.setTexture2D(W,0),X.pixelStorei(X.UNPACK_FLIP_Y_WEBGL,W.flipY),X.pixelStorei(X.UNPACK_PREMULTIPLY_ALPHA_WEBGL,W.premultiplyAlpha),X.pixelStorei(X.UNPACK_ALIGNMENT,W.unpackAlignment);const ct=X.getParameter(X.UNPACK_ROW_LENGTH),vt=X.getParameter(X.UNPACK_IMAGE_HEIGHT),Ct=X.getParameter(X.UNPACK_SKIP_PIXELS),tt=X.getParameter(X.UNPACK_SKIP_ROWS),Ve=X.getParameter(X.UNPACK_SKIP_IMAGES),xt=O.isCompressedTexture?O.mipmaps[$]:O.image;X.pixelStorei(X.UNPACK_ROW_LENGTH,xt.width),X.pixelStorei(X.UNPACK_IMAGE_HEIGHT,xt.height),X.pixelStorei(X.UNPACK_SKIP_PIXELS,_e),X.pixelStorei(X.UNPACK_SKIP_ROWS,ge),O.isDataTexture?X.texSubImage2D(X.TEXTURE_2D,$,et,Ue,he,de,Ne,Je,xt.data):O.isCompressedTexture?X.compressedTexSubImage2D(X.TEXTURE_2D,$,et,Ue,xt.width,xt.height,Ne,xt.data):X.texSubImage2D(X.TEXTURE_2D,$,et,Ue,he,de,Ne,Je,xt),X.pixelStorei(X.UNPACK_ROW_LENGTH,ct),X.pixelStorei(X.UNPACK_IMAGE_HEIGHT,vt),X.pixelStorei(X.UNPACK_SKIP_PIXELS,Ct),X.pixelStorei(X.UNPACK_SKIP_ROWS,tt),X.pixelStorei(X.UNPACK_SKIP_IMAGES,Ve),$===0&&W.generateMipmaps&&X.generateMipmap(X.TEXTURE_2D),Pe.unbindTexture()},this.copyTextureToTexture3D=function(O,W,Y=null,ee=null,$=0){O.isTexture!==!0&&(ku("WebGLRenderer: copyTextureToTexture3D function signature has changed."),Y=arguments[0]||null,ee=arguments[1]||null,O=arguments[2],W=arguments[3],$=arguments[4]||0);let he,de,_e,ge,et,Ue,Ne,Je,ct;const vt=O.isCompressedTexture?O.mipmaps[$]:O.image;Y!==null?(he=Y.max.x-Y.min.x,de=Y.max.y-Y.min.y,_e=Y.max.z-Y.min.z,ge=Y.min.x,et=Y.min.y,Ue=Y.min.z):(he=vt.width,de=vt.height,_e=vt.depth,ge=0,et=0,Ue=0),ee!==null?(Ne=ee.x,Je=ee.y,ct=ee.z):(Ne=0,Je=0,ct=0);const Ct=wt.convert(W.format),tt=wt.convert(W.type);let Ve;if(W.isData3DTexture)st.setTexture3D(W,0),Ve=X.TEXTURE_3D;else if(W.isDataArrayTexture||W.isCompressedArrayTexture)st.setTexture2DArray(W,0),Ve=X.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}X.pixelStorei(X.UNPACK_FLIP_Y_WEBGL,W.flipY),X.pixelStorei(X.UNPACK_PREMULTIPLY_ALPHA_WEBGL,W.premultiplyAlpha),X.pixelStorei(X.UNPACK_ALIGNMENT,W.unpackAlignment);const xt=X.getParameter(X.UNPACK_ROW_LENGTH),dt=X.getParameter(X.UNPACK_IMAGE_HEIGHT),Et=X.getParameter(X.UNPACK_SKIP_PIXELS),Jt=X.getParameter(X.UNPACK_SKIP_ROWS),ln=X.getParameter(X.UNPACK_SKIP_IMAGES);X.pixelStorei(X.UNPACK_ROW_LENGTH,vt.width),X.pixelStorei(X.UNPACK_IMAGE_HEIGHT,vt.height),X.pixelStorei(X.UNPACK_SKIP_PIXELS,ge),X.pixelStorei(X.UNPACK_SKIP_ROWS,et),X.pixelStorei(X.UNPACK_SKIP_IMAGES,Ue),O.isDataTexture||O.isData3DTexture?X.texSubImage3D(Ve,$,Ne,Je,ct,he,de,_e,Ct,tt,vt.data):W.isCompressedArrayTexture?X.compressedTexSubImage3D(Ve,$,Ne,Je,ct,he,de,_e,Ct,vt.data):X.texSubImage3D(Ve,$,Ne,Je,ct,he,de,_e,Ct,tt,vt),X.pixelStorei(X.UNPACK_ROW_LENGTH,xt),X.pixelStorei(X.UNPACK_IMAGE_HEIGHT,dt),X.pixelStorei(X.UNPACK_SKIP_PIXELS,Et),X.pixelStorei(X.UNPACK_SKIP_ROWS,Jt),X.pixelStorei(X.UNPACK_SKIP_IMAGES,ln),$===0&&W.generateMipmaps&&X.generateMipmap(Ve),Pe.unbindTexture()},this.initRenderTarget=function(O){Ze.get(O).__webglFramebuffer===void 0&&st.setupRenderTarget(O)},this.initTexture=function(O){O.isCubeTexture?st.setTextureCube(O,0):O.isData3DTexture?st.setTexture3D(O,0):O.isDataArrayTexture||O.isCompressedArrayTexture?st.setTexture2DArray(O,0):st.setTexture2D(O,0),Pe.unbindTexture()},this.resetState=function(){z=0,k=0,P=null,Pe.reset(),te.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Js}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===d0?"display-p3":"srgb",t.unpackColorSpace=hn.workingColorSpace===Bd?"display-p3":"srgb"}}class g0{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new lt(e),this.density=t}clone(){return new g0(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class v0{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new lt(e),this.near=t,this.far=i}clone(){return new v0(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}let Wd=class extends an{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Xr,this.environmentIntensity=1,this.environmentRotation=new Xr,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}};class y0{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=pd,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Hr()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return ku("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Hr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Hr()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Ki=new j;class ac{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Ki.fromBufferAttribute(this,t),Ki.applyMatrix4(e),this.setXYZ(t,Ki.x,Ki.y,Ki.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Ki.fromBufferAttribute(this,t),Ki.applyNormalMatrix(e),this.setXYZ(t,Ki.x,Ki.y,Ki.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Ki.fromBufferAttribute(this,t),Ki.transformDirection(e),this.setXYZ(t,Ki.x,Ki.y,Ki.z);return this}getComponent(e,t){let i=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(i=er(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Gt(i,this.array)),this.data.array[e*this.data.stride+this.offset+t]=i,this}setX(e,t){return this.normalized&&(t=Gt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Gt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Gt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Gt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=er(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=er(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=er(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=er(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Gt(t,this.array),i=Gt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Gt(t,this.array),i=Gt(i,this.array),r=Gt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Gt(t,this.array),i=Gt(i,this.array),r=Gt(r,this.array),s=Gt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new _n(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new ac(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class l1 extends ji{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new lt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let nu;const Jh=new j,iu=new j,ru=new j,su=new Ie,Qh=new Ie,aP=new Lt,bm=new j,ef=new j,Cm=new j,TA=new Ie,O_=new Ie,AA=new Ie;class lP extends an{constructor(e=new l1){if(super(),this.isSprite=!0,this.type="Sprite",nu===void 0){nu=new qt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new y0(t,5);nu.setIndex([0,1,2,0,2,3]),nu.setAttribute("position",new ac(i,3,0,!1)),nu.setAttribute("uv",new ac(i,2,3,!1))}this.geometry=nu,this.material=e,this.center=new Ie(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),iu.setFromMatrixScale(this.matrixWorld),aP.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ru.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&iu.multiplyScalar(-ru.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;Im(bm.set(-.5,-.5,0),ru,o,iu,r,s),Im(ef.set(.5,-.5,0),ru,o,iu,r,s),Im(Cm.set(.5,.5,0),ru,o,iu,r,s),TA.set(0,0),O_.set(1,0),AA.set(1,1);let a=e.ray.intersectTriangle(bm,ef,Cm,!1,Jh);if(a===null&&(Im(ef.set(-.5,.5,0),ru,o,iu,r,s),O_.set(0,1),a=e.ray.intersectTriangle(bm,Cm,ef,!1,Jh),a===null))return;const c=e.ray.origin.distanceTo(Jh);c<e.near||c>e.far||t.push({distance:c,point:Jh.clone(),uv:Fr.getInterpolation(Jh,bm,ef,Cm,TA,O_,AA,new Ie),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Im(n,e,t,i,r,s){su.subVectors(n,t).addScalar(.5).multiply(i),r!==void 0?(Qh.x=s*su.x-r*su.y,Qh.y=r*su.x+s*su.y):Qh.copy(su),n.copy(e),n.x+=Qh.x,n.y+=Qh.y,n.applyMatrix4(aP)}const Rm=new j,bA=new j;class cP extends an{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,r=t.length;i<r;i++){const s=t[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,i=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,r;for(i=1,r=t.length;i<r;i++){let s=t[i].distance;if(t[i].object.visible&&(s-=s*t[i].hysteresis),e<s)break}return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){Rm.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(Rm);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){Rm.setFromMatrixPosition(e.matrixWorld),bA.setFromMatrixPosition(this.matrixWorld);const i=Rm.distanceTo(bA)/e.zoom;t[0].object.visible=!0;let r,s;for(r=1,s=t.length;r<s;r++){let o=t[r].distance;if(t[r].object.visible&&(o-=o*t[r].hysteresis),i>=o)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const o=i[r];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const CA=new j,IA=new pn,RA=new pn,T5=new j,PA=new Lt,Pm=new j,U_=new Gi,LA=new Lt,F_=new pc;class uP extends Bn{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=gS,this.bindMatrix=new Lt,this.bindMatrixInverse=new Lt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new nr),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,Pm),this.boundingBox.expandByPoint(Pm)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Gi),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,Pm),this.boundingSphere.expandByPoint(Pm)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),U_.copy(this.boundingSphere),U_.applyMatrix4(r),e.ray.intersectsSphere(U_)!==!1&&(LA.copy(r).invert(),F_.copy(e.ray).applyMatrix4(LA),!(this.boundingBox!==null&&F_.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,F_)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new pn,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===gS?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===NR?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;IA.fromBufferAttribute(r.attributes.skinIndex,e),RA.fromBufferAttribute(r.attributes.skinWeight,e),CA.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=RA.getComponent(s);if(o!==0){const a=IA.getComponent(s);PA.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(T5.copy(CA).applyMatrix4(PA),o)}}return t.applyMatrix4(this.bindMatrixInverse)}}class c1 extends an{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Ds extends yn{constructor(e=null,t=1,i=1,r,s,o,a,c,h=_i,f=_i,d,m){super(null,o,a,c,h,f,r,s,d,m),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const NA=new Lt,A5=new Lt;class _0{constructor(e=[],t=[]){this.uuid=Hr(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Lt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Lt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:A5;NA.multiplyMatrices(a,t[s]),NA.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new _0(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new Ds(t,e,e,Qn,zn);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new c1),this.bones.push(o),this.boneInverses.push(new Lt().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const o=t[r];e.bones.push(o.uuid);const a=i[r];e.boneInverses.push(a.toArray())}return e}}class Qu extends _n{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const ou=new Lt,DA=new Lt,Lm=[],kA=new nr,b5=new Lt,tf=new Bn,nf=new Gi;class hP extends Bn{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Qu(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,b5)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new nr),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,ou),kA.copy(e.boundingBox).applyMatrix4(ou),this.boundingBox.union(kA)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Gi),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,ou),nf.copy(e.boundingSphere).applyMatrix4(ou),this.boundingSphere.union(nf)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const i=t.morphTargetInfluences,r=this.morphTexture.source.data.data,s=i.length+1,o=e*s+1;for(let a=0;a<i.length;a++)i[a]=r[o+a]}raycast(e,t){const i=this.matrixWorld,r=this.count;if(tf.geometry=this.geometry,tf.material=this.material,tf.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),nf.copy(this.boundingSphere),nf.applyMatrix4(i),e.ray.intersectsSphere(nf)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,ou),DA.multiplyMatrices(i,ou),tf.matrixWorld=DA,tf.raycast(e,Lm);for(let o=0,a=Lm.length;o<a;o++){const c=Lm[o];c.instanceId=s,c.object=this,t.push(c)}Lm.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Qu(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const i=t.morphTargetInfluences,r=i.length+1;this.morphTexture===null&&(this.morphTexture=new Ds(new Float32Array(r*this.count),r,this.count,Fd,zn));const s=this.morphTexture.source.data.data;let o=0;for(let h=0;h<i.length;h++)o+=i[h];const a=this.geometry.morphTargetsRelative?1:1-o,c=r*e;s[c]=a,s.set(i,c+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null),this}}function C5(n,e){return n.z-e.z}function I5(n,e){return e.z-n.z}class R5{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,i){const r=this.pool,s=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1,index:-1});const o=r[this.index];s.push(o),this.index++,o.start=e.start,o.count=e.count,o.z=t,o.index=i}reset(){this.list.length=0,this.index=0}}const fa=new Lt,z_=new Lt,P5=new Lt,L5=new lt(1,1,1),OA=new Lt,B_=new Gd,Nm=new nr,Sl=new Gi,rf=new j,UA=new j,N5=new j,H_=new R5,zi=new Bn,Dm=[];function D5(n,e,t=0){const i=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const r=n.count;for(let s=0;s<r;s++)for(let o=0;o<i;o++)e.setComponent(s+t,o,n.getComponent(s,o))}else e.array.set(n.array,t*i);e.needsUpdate=!0}class fP extends Bn{get maxInstanceCount(){return this._maxInstanceCount}constructor(e,t,i=t*2,r){super(new qt,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawInfo=[],this._drawRanges=[],this._reservedRanges=[],this._bounds=[],this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=i,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._visibilityChanged=!0,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),i=new Ds(t,e,e,Qn,zn);this._matricesTexture=i}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),i=new Ds(t,e,e,zd,ao);this._indirectTexture=i}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),i=new Ds(t,e,e,Qn,zn);i.colorSpace=hn.workingColorSpace,this._colorsTexture=i}_initializeGeometry(e){const t=this.geometry,i=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const o=e.getAttribute(s),{array:a,itemSize:c,normalized:h}=o,f=new a.constructor(i*c),d=new _n(f,c,h);t.setAttribute(s,d)}if(e.getIndex()!==null){const s=i>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new _n(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const i in t.attributes){if(!e.hasAttribute(i))throw new Error(`BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const r=e.getAttribute(i),s=t.getAttribute(i);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new nr);const e=this.boundingBox,t=this._drawInfo;e.makeEmpty();for(let i=0,r=t.length;i<r;i++){if(t[i].active===!1)continue;const s=t[i].geometryIndex;this.getMatrixAt(i,fa),this.getBoundingBoxAt(s,Nm).applyMatrix4(fa),e.union(Nm)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Gi);const e=this.boundingSphere,t=this._drawInfo;e.makeEmpty();for(let i=0,r=t.length;i<r;i++){if(t[i].active===!1)continue;const s=t[i].geometryIndex;this.getMatrixAt(i,fa),this.getBoundingSphereAt(s,Sl).applyMatrix4(fa),e.union(Sl)}}addInstance(e){if(this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");this._drawInfo.push({visible:!0,active:!0,geometryIndex:e});const t=this._drawInfo.length-1,i=this._matricesTexture,r=i.image.data;P5.toArray(r,t*16),i.needsUpdate=!0;const s=this._colorsTexture;return s&&(L5.toArray(s.image.data,t*4),s.needsUpdate=!0),t}addGeometry(e,t=-1,i=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._drawInfo.length>=this._maxInstanceCount)throw new Error("BatchedMesh: Maximum item count reached.");const r={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const o=this._reservedRanges,a=this._drawRanges,c=this._bounds;this._geometryCount!==0&&(s=o[o.length-1]),t===-1?r.vertexCount=e.getAttribute("position").count:r.vertexCount=t,s===null?r.vertexStart=0:r.vertexStart=s.vertexStart+s.vertexCount;const h=e.getIndex(),f=h!==null;if(f&&(i===-1?r.indexCount=h.count:r.indexCount=i,s===null?r.indexStart=0:r.indexStart=s.indexStart+s.indexCount),r.indexStart!==-1&&r.indexStart+r.indexCount>this._maxIndexCount||r.vertexStart+r.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const d=this._geometryCount;return this._geometryCount++,o.push(r),a.push({start:f?r.indexStart:r.vertexStart,count:-1}),c.push({boxInitialized:!1,box:new nr,sphereInitialized:!1,sphere:new Gi}),this.setGeometryAt(d,e),d}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const i=this.geometry,r=i.getIndex()!==null,s=i.getIndex(),o=t.getIndex(),a=this._reservedRanges[e];if(r&&o.count>a.indexCount||t.attributes.position.count>a.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const c=a.vertexStart,h=a.vertexCount;for(const v in i.attributes){const _=t.getAttribute(v),E=i.getAttribute(v);D5(_,E,c);const S=_.itemSize;for(let y=_.count,w=h;y<w;y++){const M=c+y;for(let R=0;R<S;R++)E.setComponent(M,R,0)}E.needsUpdate=!0,E.addUpdateRange(c*S,h*S)}if(r){const v=a.indexStart;for(let _=0;_<o.count;_++)s.setX(v+_,c+o.getX(_));for(let _=o.count,E=a.indexCount;_<E;_++)s.setX(v+_,c);s.needsUpdate=!0,s.addUpdateRange(v,a.indexCount)}const f=this._bounds[e];t.boundingBox!==null?(f.box.copy(t.boundingBox),f.boxInitialized=!0):f.boxInitialized=!1,t.boundingSphere!==null?(f.sphere.copy(t.boundingSphere),f.sphereInitialized=!0):f.sphereInitialized=!1;const d=this._drawRanges[e],m=t.getAttribute("position");return d.count=r?o.count:m.count,this._visibilityChanged=!0,e}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const i=this._bounds[e],r=i.box,s=this.geometry;if(i.boxInitialized===!1){r.makeEmpty();const o=s.index,a=s.attributes.position,c=this._drawRanges[e];for(let h=c.start,f=c.start+c.count;h<f;h++){let d=h;o&&(d=o.getX(d)),r.expandByPoint(rf.fromBufferAttribute(a,d))}i.boxInitialized=!0}return t.copy(r),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const i=this._bounds[e],r=i.sphere,s=this.geometry;if(i.sphereInitialized===!1){r.makeEmpty(),this.getBoundingBoxAt(e,Nm),Nm.getCenter(r.center);const o=s.index,a=s.attributes.position,c=this._drawRanges[e];let h=0;for(let f=c.start,d=c.start+c.count;f<d;f++){let m=f;o&&(m=o.getX(m)),rf.fromBufferAttribute(a,m),h=Math.max(h,r.center.distanceToSquared(rf))}r.radius=Math.sqrt(h),i.sphereInitialized=!0}return t.copy(r),t}setMatrixAt(e,t){const i=this._drawInfo,r=this._matricesTexture,s=this._matricesTexture.image.data;return e>=i.length||i[e].active===!1?this:(t.toArray(s,e*16),r.needsUpdate=!0,this)}getMatrixAt(e,t){const i=this._drawInfo,r=this._matricesTexture.image.data;return e>=i.length||i[e].active===!1?null:t.fromArray(r,e*16)}setColorAt(e,t){this._colorsTexture===null&&this._initColorsTexture();const i=this._colorsTexture,r=this._colorsTexture.image.data,s=this._drawInfo;return e>=s.length||s[e].active===!1?this:(t.toArray(r,e*4),i.needsUpdate=!0,this)}getColorAt(e,t){const i=this._colorsTexture.image.data,r=this._drawInfo;return e>=r.length||r[e].active===!1?null:t.fromArray(i,e*4)}setVisibleAt(e,t){const i=this._drawInfo;return e>=i.length||i[e].active===!1||i[e].visible===t?this:(i[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){const t=this._drawInfo;return e>=t.length||t[e].active===!1?!1:t[e].visible}raycast(e,t){const i=this._drawInfo,r=this._drawRanges,s=this.matrixWorld,o=this.geometry;zi.material=this.material,zi.geometry.index=o.index,zi.geometry.attributes=o.attributes,zi.geometry.boundingBox===null&&(zi.geometry.boundingBox=new nr),zi.geometry.boundingSphere===null&&(zi.geometry.boundingSphere=new Gi);for(let a=0,c=i.length;a<c;a++){if(!i[a].visible||!i[a].active)continue;const h=i[a].geometryIndex,f=r[h];zi.geometry.setDrawRange(f.start,f.count),this.getMatrixAt(a,zi.matrixWorld).premultiply(s),this.getBoundingBoxAt(h,zi.geometry.boundingBox),this.getBoundingSphereAt(h,zi.geometry.boundingSphere),zi.raycast(e,Dm);for(let d=0,m=Dm.length;d<m;d++){const v=Dm[d];v.object=this,v.batchId=a,t.push(v)}Dm.length=0}zi.material=null,zi.geometry.index=null,zi.geometry.attributes={},zi.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._drawInfo=e._drawInfo.map(t=>({...t})),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null),this}onBeforeRender(e,t,i,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=r.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,c=this._drawInfo,h=this._multiDrawStarts,f=this._multiDrawCounts,d=this._drawRanges,m=this.perObjectFrustumCulled,v=this._indirectTexture,_=v.image.data;m&&(OA.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),B_.setFromProjectionMatrix(OA,e.coordinateSystem));let E=0;if(this.sortObjects){z_.copy(this.matrixWorld).invert(),rf.setFromMatrixPosition(i.matrixWorld).applyMatrix4(z_),UA.set(0,0,-1).transformDirection(i.matrixWorld).transformDirection(z_);for(let w=0,M=c.length;w<M;w++)if(c[w].visible&&c[w].active){const R=c[w].geometryIndex;this.getMatrixAt(w,fa),this.getBoundingSphereAt(R,Sl).applyMatrix4(fa);let z=!1;if(m&&(z=!B_.intersectsSphere(Sl)),!z){const k=N5.subVectors(Sl.center,rf).dot(UA);H_.push(d[R],k,w)}}const S=H_.list,y=this.customSort;y===null?S.sort(s.transparent?I5:C5):y.call(this,S,i);for(let w=0,M=S.length;w<M;w++){const R=S[w];h[E]=R.start*a,f[E]=R.count,_[E]=R.index,E++}H_.reset()}else for(let S=0,y=c.length;S<y;S++)if(c[S].visible&&c[S].active){const w=c[S].geometryIndex;let M=!1;if(m&&(this.getMatrixAt(S,fa),this.getBoundingSphereAt(w,Sl).applyMatrix4(fa),M=!B_.intersectsSphere(Sl)),!M){const R=d[w];h[E]=R.start*a,f[E]=R.count,_[E]=S,E++}}v.needsUpdate=!0,this._multiDrawCount=E,this._visibilityChanged=!1}onBeforeShadow(e,t,i,r,s,o){this.onBeforeRender(e,null,r,s,o)}}class ar extends ji{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new lt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const bv=new j,Cv=new j,FA=new Lt,sf=new pc,km=new Gi,V_=new j,zA=new j;class Wa extends an{constructor(e=new qt,t=new ar){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)bv.fromBufferAttribute(t,r-1),Cv.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=bv.distanceTo(Cv);e.setAttribute("lineDistance",new pt(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),km.copy(i.boundingSphere),km.applyMatrix4(r),km.radius+=s,e.ray.intersectsSphere(km)===!1)return;FA.copy(r).invert(),sf.copy(e.ray).applyMatrix4(FA);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,h=this.isLineSegments?2:1,f=i.index,m=i.attributes.position;if(f!==null){const v=Math.max(0,o.start),_=Math.min(f.count,o.start+o.count);for(let E=v,S=_-1;E<S;E+=h){const y=f.getX(E),w=f.getX(E+1),M=Om(this,e,sf,c,y,w);M&&t.push(M)}if(this.isLineLoop){const E=f.getX(_-1),S=f.getX(v),y=Om(this,e,sf,c,E,S);y&&t.push(y)}}else{const v=Math.max(0,o.start),_=Math.min(m.count,o.start+o.count);for(let E=v,S=_-1;E<S;E+=h){const y=Om(this,e,sf,c,E,E+1);y&&t.push(y)}if(this.isLineLoop){const E=Om(this,e,sf,c,_-1,v);E&&t.push(E)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function Om(n,e,t,i,r,s){const o=n.geometry.attributes.position;if(bv.fromBufferAttribute(o,r),Cv.fromBufferAttribute(o,s),t.distanceSqToSegment(bv,Cv,V_,zA)>i)return;V_.applyMatrix4(n.matrixWorld);const c=e.ray.origin.distanceTo(V_);if(!(c<e.near||c>e.far))return{distance:c,point:zA.clone().applyMatrix4(n.matrixWorld),index:r,face:null,faceIndex:null,object:n}}const BA=new j,HA=new j;class uo extends Wa{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)BA.fromBufferAttribute(t,r),HA.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+BA.distanceTo(HA);e.setAttribute("lineDistance",new pt(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class dP extends Wa{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class u1 extends ji{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new lt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const VA=new Lt,MS=new pc,Um=new Gi,Fm=new j;class pP extends an{constructor(e=new qt,t=new u1){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Um.copy(i.boundingSphere),Um.applyMatrix4(r),Um.radius+=s,e.ray.intersectsSphere(Um)===!1)return;VA.copy(r).invert(),MS.copy(e.ray).applyMatrix4(VA);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,h=i.index,d=i.attributes.position;if(h!==null){const m=Math.max(0,o.start),v=Math.min(h.count,o.start+o.count);for(let _=m,E=v;_<E;_++){const S=h.getX(_);Fm.fromBufferAttribute(d,S),GA(Fm,S,c,r,e,t,this)}}else{const m=Math.max(0,o.start),v=Math.min(d.count,o.start+o.count);for(let _=m,E=v;_<E;_++)Fm.fromBufferAttribute(d,_),GA(Fm,_,c,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function GA(n,e,t,i,r,s,o){const a=MS.distanceSqToPoint(n);if(a<t){const c=new j;MS.closestPointToPoint(n,c),c.applyMatrix4(i);const h=r.ray.origin.distanceTo(c);if(h<r.near||h>r.far)return;s.push({distance:h,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,object:o})}}class k5 extends yn{constructor(e,t,i,r,s,o,a,c,h){super(e,t,i,r,s,o,a,c,h),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:mn,this.magFilter=s!==void 0?s:mn,this.generateMipmaps=!1;const f=this;function d(){f.needsUpdate=!0,e.requestVideoFrameCallback(d)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(d)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class O5 extends yn{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=_i,this.minFilter=_i,this.generateMipmaps=!1,this.needsUpdate=!0}}class x0 extends yn{constructor(e,t,i,r,s,o,a,c,h,f,d,m){super(null,o,a,c,h,f,r,s,d,m),this.isCompressedTexture=!0,this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class U5 extends x0{constructor(e,t,i,r,s,o){super(e,t,i,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=li,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class F5 extends x0{constructor(e,t,i){super(void 0,e[0].width,e[0].height,t,i,oo),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class z5 extends yn{constructor(e,t,i,r,s,o,a,c,h){super(e,t,i,r,s,o,a,c,h),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Us{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;t?o=t:o=e*i[s-1];let a=0,c=s-1,h;for(;a<=c;)if(r=Math.floor(a+(c-a)/2),h=i[r]-o,h<0)a=r+1;else if(h>0)c=r-1;else{c=r;break}if(r=c,i[r]===o)return r/(s-1);const f=i[r],m=i[r+1]-f,v=(o-f)/m;return(r+v)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),c=t||(o.isVector2?new Ie:new j);return c.copy(a).sub(o).normalize(),c}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new j,r=[],s=[],o=[],a=new j,c=new Lt;for(let v=0;v<=e;v++){const _=v/e;r[v]=this.getTangentAt(_,new j)}s[0]=new j,o[0]=new j;let h=Number.MAX_VALUE;const f=Math.abs(r[0].x),d=Math.abs(r[0].y),m=Math.abs(r[0].z);f<=h&&(h=f,i.set(1,0,0)),d<=h&&(h=d,i.set(0,1,0)),m<=h&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let v=1;v<=e;v++){if(s[v]=s[v-1].clone(),o[v]=o[v-1].clone(),a.crossVectors(r[v-1],r[v]),a.length()>Number.EPSILON){a.normalize();const _=Math.acos(Xn(r[v-1].dot(r[v]),-1,1));s[v].applyMatrix4(c.makeRotationAxis(a,_))}o[v].crossVectors(r[v],s[v])}if(t===!0){let v=Math.acos(Xn(s[0].dot(s[e]),-1,1));v/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(v=-v);for(let _=1;_<=e;_++)s[_].applyMatrix4(c.makeRotationAxis(r[_],v*_)),o[_].crossVectors(r[_],s[_])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class S0 extends Us{constructor(e=0,t=0,i=1,r=1,s=0,o=Math.PI*2,a=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=c}getPoint(e,t=new Ie){const i=t,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let c=this.aX+this.xRadius*Math.cos(a),h=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const f=Math.cos(this.aRotation),d=Math.sin(this.aRotation),m=c-this.aX,v=h-this.aY;c=m*f-v*d+this.aX,h=m*d+v*f+this.aY}return i.set(c,h)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class mP extends S0{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function h1(){let n=0,e=0,t=0,i=0;function r(s,o,a,c){n=s,e=a,t=-3*s+3*o-2*a-c,i=2*s-2*o+a+c}return{initCatmullRom:function(s,o,a,c,h){r(o,a,h*(a-s),h*(c-o))},initNonuniformCatmullRom:function(s,o,a,c,h,f,d){let m=(o-s)/h-(a-s)/(h+f)+(a-o)/f,v=(a-o)/f-(c-o)/(f+d)+(c-a)/d;m*=f,v*=f,r(o,a,m,v)},calc:function(s){const o=s*s,a=o*s;return n+e*s+t*o+i*a}}}const zm=new j,G_=new h1,W_=new h1,j_=new h1;class gP extends Us{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new j){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),c=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:c===0&&a===s-1&&(a=s-2,c=1);let h,f;this.closed||a>0?h=r[(a-1)%s]:(zm.subVectors(r[0],r[1]).add(r[0]),h=zm);const d=r[a%s],m=r[(a+1)%s];if(this.closed||a+2<s?f=r[(a+2)%s]:(zm.subVectors(r[s-1],r[s-2]).add(r[s-1]),f=zm),this.curveType==="centripetal"||this.curveType==="chordal"){const v=this.curveType==="chordal"?.5:.25;let _=Math.pow(h.distanceToSquared(d),v),E=Math.pow(d.distanceToSquared(m),v),S=Math.pow(m.distanceToSquared(f),v);E<1e-4&&(E=1),_<1e-4&&(_=E),S<1e-4&&(S=E),G_.initNonuniformCatmullRom(h.x,d.x,m.x,f.x,_,E,S),W_.initNonuniformCatmullRom(h.y,d.y,m.y,f.y,_,E,S),j_.initNonuniformCatmullRom(h.z,d.z,m.z,f.z,_,E,S)}else this.curveType==="catmullrom"&&(G_.initCatmullRom(h.x,d.x,m.x,f.x,this.tension),W_.initCatmullRom(h.y,d.y,m.y,f.y,this.tension),j_.initCatmullRom(h.z,d.z,m.z,f.z,this.tension));return i.set(G_.calc(c),W_.calc(c),j_.calc(c)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new j().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function WA(n,e,t,i,r){const s=(i-e)*.5,o=(r-t)*.5,a=n*n,c=n*a;return(2*t-2*i+s+o)*c+(-3*t+3*i-2*s-o)*a+s*n+t}function B5(n,e){const t=1-n;return t*t*e}function H5(n,e){return 2*(1-n)*n*e}function V5(n,e){return n*n*e}function Df(n,e,t,i){return B5(n,e)+H5(n,t)+V5(n,i)}function G5(n,e){const t=1-n;return t*t*t*e}function W5(n,e){const t=1-n;return 3*t*t*n*e}function j5(n,e){return 3*(1-n)*n*n*e}function X5(n,e){return n*n*n*e}function kf(n,e,t,i,r){return G5(n,e)+W5(n,t)+j5(n,i)+X5(n,r)}class f1 extends Us{constructor(e=new Ie,t=new Ie,i=new Ie,r=new Ie){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new Ie){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(kf(e,r.x,s.x,o.x,a.x),kf(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class vP extends Us{constructor(e=new j,t=new j,i=new j,r=new j){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new j){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(kf(e,r.x,s.x,o.x,a.x),kf(e,r.y,s.y,o.y,a.y),kf(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class d1 extends Us{constructor(e=new Ie,t=new Ie){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Ie){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Ie){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class yP extends Us{constructor(e=new j,t=new j){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new j){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new j){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class p1 extends Us{constructor(e=new Ie,t=new Ie,i=new Ie){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Ie){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(Df(e,r.x,s.x,o.x),Df(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class m1 extends Us{constructor(e=new j,t=new j,i=new j){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new j){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(Df(e,r.x,s.x,o.x),Df(e,r.y,s.y,o.y),Df(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class g1 extends Us{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Ie){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,c=r[o===0?o:o-1],h=r[o],f=r[o>r.length-2?r.length-1:o+1],d=r[o>r.length-3?r.length-1:o+2];return i.set(WA(a,c.x,h.x,f.x,d.x),WA(a,c.y,h.y,f.y,d.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new Ie().fromArray(r))}return this}}var Iv=Object.freeze({__proto__:null,ArcCurve:mP,CatmullRomCurve3:gP,CubicBezierCurve:f1,CubicBezierCurve3:vP,EllipseCurve:S0,LineCurve:d1,LineCurve3:yP,QuadraticBezierCurve:p1,QuadraticBezierCurve3:m1,SplineCurve:g1});class _P extends Us{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Iv[i](t,e))}return this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],c=a.getLength(),h=c===0?0:1-o/c;return a.getPointAt(h,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,c=o.getPoints(a);for(let h=0;h<c.length;h++){const f=c[h];i&&i.equals(f)||(t.push(f),i=f)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(new Iv[r.type]().fromJSON(r))}return this}}class vd extends _P{constructor(e){super(),this.type="Path",this.currentPoint=new Ie,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new d1(this.currentPoint.clone(),new Ie(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new p1(this.currentPoint.clone(),new Ie(e,t),new Ie(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new f1(this.currentPoint.clone(),new Ie(e,t),new Ie(i,r),new Ie(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new g1(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){const a=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+a,t+c,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,c){const h=this.currentPoint.x,f=this.currentPoint.y;return this.absellipse(e+h,t+f,i,r,s,o,a,c),this}absellipse(e,t,i,r,s,o,a,c){const h=new S0(e,t,i,r,s,o,a,c);if(this.curves.length>0){const d=h.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(h);const f=h.getPoint(1);return this.currentPoint.copy(f),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class jd extends qt{constructor(e=[new Ie(0,-.5),new Ie(.5,0),new Ie(0,.5)],t=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t),r=Xn(r,0,Math.PI*2);const s=[],o=[],a=[],c=[],h=[],f=1/t,d=new j,m=new Ie,v=new j,_=new j,E=new j;let S=0,y=0;for(let w=0;w<=e.length-1;w++)switch(w){case 0:S=e[w+1].x-e[w].x,y=e[w+1].y-e[w].y,v.x=y*1,v.y=-S,v.z=y*0,E.copy(v),v.normalize(),c.push(v.x,v.y,v.z);break;case e.length-1:c.push(E.x,E.y,E.z);break;default:S=e[w+1].x-e[w].x,y=e[w+1].y-e[w].y,v.x=y*1,v.y=-S,v.z=y*0,_.copy(v),v.x+=E.x,v.y+=E.y,v.z+=E.z,v.normalize(),c.push(v.x,v.y,v.z),E.copy(_)}for(let w=0;w<=t;w++){const M=i+w*f*r,R=Math.sin(M),z=Math.cos(M);for(let k=0;k<=e.length-1;k++){d.x=e[k].x*R,d.y=e[k].y,d.z=e[k].x*z,o.push(d.x,d.y,d.z),m.x=w/t,m.y=k/(e.length-1),a.push(m.x,m.y);const P=c[3*k+0]*R,b=c[3*k+1],A=c[3*k+0]*z;h.push(P,b,A)}}for(let w=0;w<t;w++)for(let M=0;M<e.length-1;M++){const R=M+w*e.length,z=R,k=R+e.length,P=R+e.length+1,b=R+1;s.push(z,k,b),s.push(P,b,k)}this.setIndex(s),this.setAttribute("position",new pt(o,3)),this.setAttribute("uv",new pt(a,2)),this.setAttribute("normal",new pt(h,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new jd(e.points,e.segments,e.phiStart,e.phiLength)}}class w0 extends jd{constructor(e=1,t=1,i=4,r=8){const s=new vd;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:i,radialSegments:r}}static fromJSON(e){return new w0(e.radius,e.length,e.capSegments,e.radialSegments)}}class M0 extends qt{constructor(e=1,t=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],c=[],h=new j,f=new Ie;o.push(0,0,0),a.push(0,0,1),c.push(.5,.5);for(let d=0,m=3;d<=t;d++,m+=3){const v=i+d/t*r;h.x=e*Math.cos(v),h.y=e*Math.sin(v),o.push(h.x,h.y,h.z),a.push(0,0,1),f.x=(o[m]/e+1)/2,f.y=(o[m+1]/e+1)/2,c.push(f.x,f.y)}for(let d=1;d<=t;d++)s.push(d,d+1,0);this.setIndex(s),this.setAttribute("position",new pt(o,3)),this.setAttribute("normal",new pt(a,3)),this.setAttribute("uv",new pt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new M0(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class fh extends qt{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,a=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:c};const h=this;r=Math.floor(r),s=Math.floor(s);const f=[],d=[],m=[],v=[];let _=0;const E=[],S=i/2;let y=0;w(),o===!1&&(e>0&&M(!0),t>0&&M(!1)),this.setIndex(f),this.setAttribute("position",new pt(d,3)),this.setAttribute("normal",new pt(m,3)),this.setAttribute("uv",new pt(v,2));function w(){const R=new j,z=new j;let k=0;const P=(t-e)/i;for(let b=0;b<=s;b++){const A=[],T=b/s,L=T*(t-e)+e;for(let H=0;H<=r;H++){const U=H/r,se=U*c+a,fe=Math.sin(se),oe=Math.cos(se);z.x=L*fe,z.y=-T*i+S,z.z=L*oe,d.push(z.x,z.y,z.z),R.set(fe,P,oe).normalize(),m.push(R.x,R.y,R.z),v.push(U,1-T),A.push(_++)}E.push(A)}for(let b=0;b<r;b++)for(let A=0;A<s;A++){const T=E[A][b],L=E[A+1][b],H=E[A+1][b+1],U=E[A][b+1];f.push(T,L,U),f.push(L,H,U),k+=6}h.addGroup(y,k,0),y+=k}function M(R){const z=_,k=new Ie,P=new j;let b=0;const A=R===!0?e:t,T=R===!0?1:-1;for(let H=1;H<=r;H++)d.push(0,S*T,0),m.push(0,T,0),v.push(.5,.5),_++;const L=_;for(let H=0;H<=r;H++){const se=H/r*c+a,fe=Math.cos(se),oe=Math.sin(se);P.x=A*oe,P.y=S*T,P.z=A*fe,d.push(P.x,P.y,P.z),m.push(0,T,0),k.x=fe*.5+.5,k.y=oe*.5*T+.5,v.push(k.x,k.y),_++}for(let H=0;H<r;H++){const U=z+H,se=L+H;R===!0?f.push(se,se+1,U):f.push(se+1,se,U),b+=3}h.addGroup(y,b,R===!0?1:2),y+=b}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new fh(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class E0 extends fh{constructor(e=1,t=1,i=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,i,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new E0(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Ka extends qt{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],o=[];a(r),h(i),f(),this.setAttribute("position",new pt(s,3)),this.setAttribute("normal",new pt(s.slice(),3)),this.setAttribute("uv",new pt(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(w){const M=new j,R=new j,z=new j;for(let k=0;k<t.length;k+=3)v(t[k+0],M),v(t[k+1],R),v(t[k+2],z),c(M,R,z,w)}function c(w,M,R,z){const k=z+1,P=[];for(let b=0;b<=k;b++){P[b]=[];const A=w.clone().lerp(R,b/k),T=M.clone().lerp(R,b/k),L=k-b;for(let H=0;H<=L;H++)H===0&&b===k?P[b][H]=A:P[b][H]=A.clone().lerp(T,H/L)}for(let b=0;b<k;b++)for(let A=0;A<2*(k-b)-1;A++){const T=Math.floor(A/2);A%2===0?(m(P[b][T+1]),m(P[b+1][T]),m(P[b][T])):(m(P[b][T+1]),m(P[b+1][T+1]),m(P[b+1][T]))}}function h(w){const M=new j;for(let R=0;R<s.length;R+=3)M.x=s[R+0],M.y=s[R+1],M.z=s[R+2],M.normalize().multiplyScalar(w),s[R+0]=M.x,s[R+1]=M.y,s[R+2]=M.z}function f(){const w=new j;for(let M=0;M<s.length;M+=3){w.x=s[M+0],w.y=s[M+1],w.z=s[M+2];const R=S(w)/2/Math.PI+.5,z=y(w)/Math.PI+.5;o.push(R,1-z)}_(),d()}function d(){for(let w=0;w<o.length;w+=6){const M=o[w+0],R=o[w+2],z=o[w+4],k=Math.max(M,R,z),P=Math.min(M,R,z);k>.9&&P<.1&&(M<.2&&(o[w+0]+=1),R<.2&&(o[w+2]+=1),z<.2&&(o[w+4]+=1))}}function m(w){s.push(w.x,w.y,w.z)}function v(w,M){const R=w*3;M.x=e[R+0],M.y=e[R+1],M.z=e[R+2]}function _(){const w=new j,M=new j,R=new j,z=new j,k=new Ie,P=new Ie,b=new Ie;for(let A=0,T=0;A<s.length;A+=9,T+=6){w.set(s[A+0],s[A+1],s[A+2]),M.set(s[A+3],s[A+4],s[A+5]),R.set(s[A+6],s[A+7],s[A+8]),k.set(o[T+0],o[T+1]),P.set(o[T+2],o[T+3]),b.set(o[T+4],o[T+5]),z.copy(w).add(M).add(R).divideScalar(3);const L=S(z);E(k,T+0,w,L),E(P,T+2,M,L),E(b,T+4,R,L)}}function E(w,M,R,z){z<0&&w.x===1&&(o[M]=w.x-1),R.x===0&&R.z===0&&(o[M]=z/2/Math.PI+.5)}function S(w){return Math.atan2(w.z,-w.x)}function y(w){return Math.atan2(-w.y,Math.sqrt(w.x*w.x+w.z*w.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ka(e.vertices,e.indices,e.radius,e.details)}}class T0 extends Ka{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new T0(e.radius,e.detail)}}const Bm=new j,Hm=new j,X_=new j,Vm=new Fr;class xP extends qt{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),s=Math.cos(Kl*t),o=e.getIndex(),a=e.getAttribute("position"),c=o?o.count:a.count,h=[0,0,0],f=["a","b","c"],d=new Array(3),m={},v=[];for(let _=0;_<c;_+=3){o?(h[0]=o.getX(_),h[1]=o.getX(_+1),h[2]=o.getX(_+2)):(h[0]=_,h[1]=_+1,h[2]=_+2);const{a:E,b:S,c:y}=Vm;if(E.fromBufferAttribute(a,h[0]),S.fromBufferAttribute(a,h[1]),y.fromBufferAttribute(a,h[2]),Vm.getNormal(X_),d[0]=`${Math.round(E.x*r)},${Math.round(E.y*r)},${Math.round(E.z*r)}`,d[1]=`${Math.round(S.x*r)},${Math.round(S.y*r)},${Math.round(S.z*r)}`,d[2]=`${Math.round(y.x*r)},${Math.round(y.y*r)},${Math.round(y.z*r)}`,!(d[0]===d[1]||d[1]===d[2]||d[2]===d[0]))for(let w=0;w<3;w++){const M=(w+1)%3,R=d[w],z=d[M],k=Vm[f[w]],P=Vm[f[M]],b=`${R}_${z}`,A=`${z}_${R}`;A in m&&m[A]?(X_.dot(m[A].normal)<=s&&(v.push(k.x,k.y,k.z),v.push(P.x,P.y,P.z)),m[A]=null):b in m||(m[b]={index0:h[w],index1:h[M],normal:X_.clone()})}}for(const _ in m)if(m[_]){const{index0:E,index1:S}=m[_];Bm.fromBufferAttribute(a,E),Hm.fromBufferAttribute(a,S),v.push(Bm.x,Bm.y,Bm.z),v.push(Hm.x,Hm.y,Hm.z)}this.setAttribute("position",new pt(v,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class Jl extends vd{constructor(e){super(e),this.uuid=Hr(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(new vd().fromJSON(r))}return this}}const q5={triangulate:function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=SP(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,c,h,f,d,m,v;if(i&&(s=J5(n,e,s,t)),n.length>80*t){a=h=n[0],c=f=n[1];for(let _=t;_<r;_+=t)d=n[_],m=n[_+1],d<a&&(a=d),m<c&&(c=m),d>h&&(h=d),m>f&&(f=m);v=Math.max(h-a,f-c),v=v!==0?32767/v:0}return yd(s,o,t,a,c,v,0),o}};function SP(n,e,t,i,r){let s,o;if(r===c6(n,e,t,i)>0)for(s=e;s<t;s+=i)o=jA(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=jA(s,n[s],n[s+1],o);return o&&A0(o,o.next)&&(xd(o),o=o.next),o}function lc(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(A0(t,t.next)||Fn(t.prev,t,t.next)===0)){if(xd(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function yd(n,e,t,i,r,s,o){if(!n)return;!o&&s&&i6(n,i,r,s);let a=n,c,h;for(;n.prev!==n.next;){if(c=n.prev,h=n.next,s?$5(n,i,r,s):Y5(n)){e.push(c.i/t|0),e.push(n.i/t|0),e.push(h.i/t|0),xd(n),n=h.next,a=h.next;continue}if(n=h,n===a){o?o===1?(n=K5(lc(n),e,t),yd(n,e,t,i,r,s,2)):o===2&&Z5(n,e,t,i,r,s):yd(lc(n),e,t,i,r,s,1);break}}}function Y5(n){const e=n.prev,t=n,i=n.next;if(Fn(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,c=t.y,h=i.y,f=r<s?r<o?r:o:s<o?s:o,d=a<c?a<h?a:h:c<h?c:h,m=r>s?r>o?r:o:s>o?s:o,v=a>c?a>h?a:h:c>h?c:h;let _=i.next;for(;_!==e;){if(_.x>=f&&_.x<=m&&_.y>=d&&_.y<=v&&Au(r,a,s,c,o,h,_.x,_.y)&&Fn(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function $5(n,e,t,i){const r=n.prev,s=n,o=n.next;if(Fn(r,s,o)>=0)return!1;const a=r.x,c=s.x,h=o.x,f=r.y,d=s.y,m=o.y,v=a<c?a<h?a:h:c<h?c:h,_=f<d?f<m?f:m:d<m?d:m,E=a>c?a>h?a:h:c>h?c:h,S=f>d?f>m?f:m:d>m?d:m,y=ES(v,_,e,t,i),w=ES(E,S,e,t,i);let M=n.prevZ,R=n.nextZ;for(;M&&M.z>=y&&R&&R.z<=w;){if(M.x>=v&&M.x<=E&&M.y>=_&&M.y<=S&&M!==r&&M!==o&&Au(a,f,c,d,h,m,M.x,M.y)&&Fn(M.prev,M,M.next)>=0||(M=M.prevZ,R.x>=v&&R.x<=E&&R.y>=_&&R.y<=S&&R!==r&&R!==o&&Au(a,f,c,d,h,m,R.x,R.y)&&Fn(R.prev,R,R.next)>=0))return!1;R=R.nextZ}for(;M&&M.z>=y;){if(M.x>=v&&M.x<=E&&M.y>=_&&M.y<=S&&M!==r&&M!==o&&Au(a,f,c,d,h,m,M.x,M.y)&&Fn(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;R&&R.z<=w;){if(R.x>=v&&R.x<=E&&R.y>=_&&R.y<=S&&R!==r&&R!==o&&Au(a,f,c,d,h,m,R.x,R.y)&&Fn(R.prev,R,R.next)>=0)return!1;R=R.nextZ}return!0}function K5(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!A0(r,s)&&wP(r,i,i.next,s)&&_d(r,s)&&_d(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),xd(i),xd(i.next),i=n=s),i=i.next}while(i!==n);return lc(i)}function Z5(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&o6(o,a)){let c=MP(o,a);o=lc(o,o.next),c=lc(c,c.next),yd(o,e,t,i,r,s,0),yd(c,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function J5(n,e,t,i){const r=[];let s,o,a,c,h;for(s=0,o=e.length;s<o;s++)a=e[s]*i,c=s<o-1?e[s+1]*i:n.length,h=SP(n,a,c,i,!1),h===h.next&&(h.steiner=!0),r.push(s6(h));for(r.sort(Q5),s=0;s<r.length;s++)t=e6(r[s],t);return t}function Q5(n,e){return n.x-e.x}function e6(n,e){const t=t6(n,e);if(!t)return e;const i=MP(t,n);return lc(i,i.next),lc(t,t.next)}function t6(n,e){let t=e,i=-1/0,r;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const m=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(m<=s&&m>i&&(i=m,r=t.x<t.next.x?t:t.next,m===s))return r}t=t.next}while(t!==e);if(!r)return null;const a=r,c=r.x,h=r.y;let f=1/0,d;t=r;do s>=t.x&&t.x>=c&&s!==t.x&&Au(o<h?s:i,o,c,h,o<h?i:s,o,t.x,t.y)&&(d=Math.abs(o-t.y)/(s-t.x),_d(t,n)&&(d<f||d===f&&(t.x>r.x||t.x===r.x&&n6(r,t)))&&(r=t,f=d)),t=t.next;while(t!==a);return r}function n6(n,e){return Fn(n.prev,n,e.prev)<0&&Fn(e.next,n,n.next)<0}function i6(n,e,t,i){let r=n;do r.z===0&&(r.z=ES(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,r6(r)}function r6(n){let e,t,i,r,s,o,a,c,h=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<h&&(a++,i=i.nextZ,!!i);e++);for(c=h;a>0||c>0&&i;)a!==0&&(c===0||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,c--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,h*=2}while(o>1);return n}function ES(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function s6(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Au(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function o6(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!a6(n,e)&&(_d(n,e)&&_d(e,n)&&l6(n,e)&&(Fn(n.prev,n,e.prev)||Fn(n,e.prev,e))||A0(n,e)&&Fn(n.prev,n,n.next)>0&&Fn(e.prev,e,e.next)>0)}function Fn(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function A0(n,e){return n.x===e.x&&n.y===e.y}function wP(n,e,t,i){const r=Wm(Fn(n,e,t)),s=Wm(Fn(n,e,i)),o=Wm(Fn(t,i,n)),a=Wm(Fn(t,i,e));return!!(r!==s&&o!==a||r===0&&Gm(n,t,e)||s===0&&Gm(n,i,e)||o===0&&Gm(t,n,i)||a===0&&Gm(t,e,i))}function Gm(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function Wm(n){return n>0?1:n<0?-1:0}function a6(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&wP(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function _d(n,e){return Fn(n.prev,n,n.next)<0?Fn(n,e,n.next)>=0&&Fn(n,n.prev,e)>=0:Fn(n,e,n.prev)<0||Fn(n,n.next,e)<0}function l6(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function MP(n,e){const t=new TS(n.i,n.x,n.y),i=new TS(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function jA(n,e,t,i){const r=new TS(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function xd(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function TS(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function c6(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}class io{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return io.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];XA(e),qA(i,e);let o=e.length;t.forEach(XA);for(let c=0;c<t.length;c++)r.push(o),o+=t[c].length,qA(i,t[c]);const a=q5.triangulate(i,r);for(let c=0;c<a.length;c+=3)s.push(a.slice(c,c+3));return s}}function XA(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function qA(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class b0 extends qt{constructor(e=new Jl([new Ie(.5,.5),new Ie(-.5,.5),new Ie(-.5,-.5),new Ie(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,c=e.length;a<c;a++){const h=e[a];o(h)}this.setAttribute("position",new pt(r,3)),this.setAttribute("uv",new pt(s,2)),this.computeVertexNormals();function o(a){const c=[],h=t.curveSegments!==void 0?t.curveSegments:12,f=t.steps!==void 0?t.steps:1,d=t.depth!==void 0?t.depth:1;let m=t.bevelEnabled!==void 0?t.bevelEnabled:!0,v=t.bevelThickness!==void 0?t.bevelThickness:.2,_=t.bevelSize!==void 0?t.bevelSize:v-.1,E=t.bevelOffset!==void 0?t.bevelOffset:0,S=t.bevelSegments!==void 0?t.bevelSegments:3;const y=t.extrudePath,w=t.UVGenerator!==void 0?t.UVGenerator:u6;let M,R=!1,z,k,P,b;y&&(M=y.getSpacedPoints(f),R=!0,m=!1,z=y.computeFrenetFrames(f,!1),k=new j,P=new j,b=new j),m||(S=0,v=0,_=0,E=0);const A=a.extractPoints(h);let T=A.shape;const L=A.holes;if(!io.isClockWise(T)){T=T.reverse();for(let X=0,Fe=L.length;X<Fe;X++){const Be=L[X];io.isClockWise(Be)&&(L[X]=Be.reverse())}}const U=io.triangulateShape(T,L),se=T;for(let X=0,Fe=L.length;X<Fe;X++){const Be=L[X];T=T.concat(Be)}function fe(X,Fe,Be){return Fe||console.error("THREE.ExtrudeGeometry: vec does not exist"),X.clone().addScaledVector(Fe,Be)}const oe=T.length,Se=U.length;function q(X,Fe,Be){let Ke,Pe,gt;const Ze=X.x-Fe.x,st=X.y-Fe.y,Z=Be.x-X.x,B=Be.y-X.y,me=Ze*Ze+st*st,Re=Ze*B-st*Z;if(Math.abs(Re)>Number.EPSILON){const Te=Math.sqrt(me),ke=Math.sqrt(Z*Z+B*B),it=Fe.x-st/Te,Ge=Fe.y+Ze/Te,Qe=Be.x-B/ke,bt=Be.y+Z/ke,We=((Qe-it)*B-(bt-Ge)*Z)/(Ze*B-st*Z);Ke=it+Ze*We-X.x,Pe=Ge+st*We-X.y;const nt=Ke*Ke+Pe*Pe;if(nt<=2)return new Ie(Ke,Pe);gt=Math.sqrt(nt/2)}else{let Te=!1;Ze>Number.EPSILON?Z>Number.EPSILON&&(Te=!0):Ze<-Number.EPSILON?Z<-Number.EPSILON&&(Te=!0):Math.sign(st)===Math.sign(B)&&(Te=!0),Te?(Ke=-st,Pe=Ze,gt=Math.sqrt(me)):(Ke=Ze,Pe=st,gt=Math.sqrt(me/2))}return new Ie(Ke/gt,Pe/gt)}const le=[];for(let X=0,Fe=se.length,Be=Fe-1,Ke=X+1;X<Fe;X++,Be++,Ke++)Be===Fe&&(Be=0),Ke===Fe&&(Ke=0),le[X]=q(se[X],se[Be],se[Ke]);const ie=[];let ye,Ae=le.concat();for(let X=0,Fe=L.length;X<Fe;X++){const Be=L[X];ye=[];for(let Ke=0,Pe=Be.length,gt=Pe-1,Ze=Ke+1;Ke<Pe;Ke++,gt++,Ze++)gt===Pe&&(gt=0),Ze===Pe&&(Ze=0),ye[Ke]=q(Be[Ke],Be[gt],Be[Ze]);ie.push(ye),Ae=Ae.concat(ye)}for(let X=0;X<S;X++){const Fe=X/S,Be=v*Math.cos(Fe*Math.PI/2),Ke=_*Math.sin(Fe*Math.PI/2)+E;for(let Pe=0,gt=se.length;Pe<gt;Pe++){const Ze=fe(se[Pe],le[Pe],Ke);He(Ze.x,Ze.y,-Be)}for(let Pe=0,gt=L.length;Pe<gt;Pe++){const Ze=L[Pe];ye=ie[Pe];for(let st=0,Z=Ze.length;st<Z;st++){const B=fe(Ze[st],ye[st],Ke);He(B.x,B.y,-Be)}}}const ze=_+E;for(let X=0;X<oe;X++){const Fe=m?fe(T[X],Ae[X],ze):T[X];R?(P.copy(z.normals[0]).multiplyScalar(Fe.x),k.copy(z.binormals[0]).multiplyScalar(Fe.y),b.copy(M[0]).add(P).add(k),He(b.x,b.y,b.z)):He(Fe.x,Fe.y,0)}for(let X=1;X<=f;X++)for(let Fe=0;Fe<oe;Fe++){const Be=m?fe(T[Fe],Ae[Fe],ze):T[Fe];R?(P.copy(z.normals[X]).multiplyScalar(Be.x),k.copy(z.binormals[X]).multiplyScalar(Be.y),b.copy(M[X]).add(P).add(k),He(b.x,b.y,b.z)):He(Be.x,Be.y,d/f*X)}for(let X=S-1;X>=0;X--){const Fe=X/S,Be=v*Math.cos(Fe*Math.PI/2),Ke=_*Math.sin(Fe*Math.PI/2)+E;for(let Pe=0,gt=se.length;Pe<gt;Pe++){const Ze=fe(se[Pe],le[Pe],Ke);He(Ze.x,Ze.y,d+Be)}for(let Pe=0,gt=L.length;Pe<gt;Pe++){const Ze=L[Pe];ye=ie[Pe];for(let st=0,Z=Ze.length;st<Z;st++){const B=fe(Ze[st],ye[st],Ke);R?He(B.x,B.y+M[f-1].y,M[f-1].x+Be):He(B.x,B.y,d+Be)}}}pe(),De();function pe(){const X=r.length/3;if(m){let Fe=0,Be=oe*Fe;for(let Ke=0;Ke<Se;Ke++){const Pe=U[Ke];ut(Pe[2]+Be,Pe[1]+Be,Pe[0]+Be)}Fe=f+S*2,Be=oe*Fe;for(let Ke=0;Ke<Se;Ke++){const Pe=U[Ke];ut(Pe[0]+Be,Pe[1]+Be,Pe[2]+Be)}}else{for(let Fe=0;Fe<Se;Fe++){const Be=U[Fe];ut(Be[2],Be[1],Be[0])}for(let Fe=0;Fe<Se;Fe++){const Be=U[Fe];ut(Be[0]+oe*f,Be[1]+oe*f,Be[2]+oe*f)}}i.addGroup(X,r.length/3-X,0)}function De(){const X=r.length/3;let Fe=0;Oe(se,Fe),Fe+=se.length;for(let Be=0,Ke=L.length;Be<Ke;Be++){const Pe=L[Be];Oe(Pe,Fe),Fe+=Pe.length}i.addGroup(X,r.length/3-X,1)}function Oe(X,Fe){let Be=X.length;for(;--Be>=0;){const Ke=Be;let Pe=Be-1;Pe<0&&(Pe=X.length-1);for(let gt=0,Ze=f+S*2;gt<Ze;gt++){const st=oe*gt,Z=oe*(gt+1),B=Fe+Ke+st,me=Fe+Pe+st,Re=Fe+Pe+Z,Te=Fe+Ke+Z;Tt(B,me,Re,Te)}}}function He(X,Fe,Be){c.push(X),c.push(Fe),c.push(Be)}function ut(X,Fe,Be){mt(X),mt(Fe),mt(Be);const Ke=r.length/3,Pe=w.generateTopUV(i,r,Ke-3,Ke-2,Ke-1);At(Pe[0]),At(Pe[1]),At(Pe[2])}function Tt(X,Fe,Be,Ke){mt(X),mt(Fe),mt(Ke),mt(Fe),mt(Be),mt(Ke);const Pe=r.length/3,gt=w.generateSideWallUV(i,r,Pe-6,Pe-3,Pe-2,Pe-1);At(gt[0]),At(gt[1]),At(gt[3]),At(gt[1]),At(gt[2]),At(gt[3])}function mt(X){r.push(c[X*3+0]),r.push(c[X*3+1]),r.push(c[X*3+2])}function At(X){s.push(X.x),s.push(X.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,i=this.parameters.options;return h6(t,i,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];i.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new Iv[r.type]().fromJSON(r)),new b0(i,e.options)}}const u6={generateTopUV:function(n,e,t,i,r){const s=e[t*3],o=e[t*3+1],a=e[i*3],c=e[i*3+1],h=e[r*3],f=e[r*3+1];return[new Ie(s,o),new Ie(a,c),new Ie(h,f)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[t*3],a=e[t*3+1],c=e[t*3+2],h=e[i*3],f=e[i*3+1],d=e[i*3+2],m=e[r*3],v=e[r*3+1],_=e[r*3+2],E=e[s*3],S=e[s*3+1],y=e[s*3+2];return Math.abs(a-f)<Math.abs(o-h)?[new Ie(o,1-c),new Ie(h,1-d),new Ie(m,1-_),new Ie(E,1-y)]:[new Ie(a,1-c),new Ie(f,1-d),new Ie(v,1-_),new Ie(S,1-y)]}};function h6(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++){const s=n[i];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Xd extends Ka{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Xd(e.radius,e.detail)}}class qd extends Ka{constructor(e=1,t=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new qd(e.radius,e.detail)}}class C0 extends qt{constructor(e=.5,t=1,i=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i),r=Math.max(1,r);const a=[],c=[],h=[],f=[];let d=e;const m=(t-e)/r,v=new j,_=new Ie;for(let E=0;E<=r;E++){for(let S=0;S<=i;S++){const y=s+S/i*o;v.x=d*Math.cos(y),v.y=d*Math.sin(y),c.push(v.x,v.y,v.z),h.push(0,0,1),_.x=(v.x/t+1)/2,_.y=(v.y/t+1)/2,f.push(_.x,_.y)}d+=m}for(let E=0;E<r;E++){const S=E*(i+1);for(let y=0;y<i;y++){const w=y+S,M=w,R=w+i+1,z=w+i+2,k=w+1;a.push(M,R,k),a.push(R,z,k)}}this.setIndex(a),this.setAttribute("position",new pt(c,3)),this.setAttribute("normal",new pt(h,3)),this.setAttribute("uv",new pt(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new C0(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class I0 extends qt{constructor(e=new Jl([new Ie(0,.5),new Ie(-.5,-.5),new Ie(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],s=[],o=[];let a=0,c=0;if(Array.isArray(e)===!1)h(e);else for(let f=0;f<e.length;f++)h(e[f]),this.addGroup(a,c,f),a+=c,c=0;this.setIndex(i),this.setAttribute("position",new pt(r,3)),this.setAttribute("normal",new pt(s,3)),this.setAttribute("uv",new pt(o,2));function h(f){const d=r.length/3,m=f.extractPoints(t);let v=m.shape;const _=m.holes;io.isClockWise(v)===!1&&(v=v.reverse());for(let S=0,y=_.length;S<y;S++){const w=_[S];io.isClockWise(w)===!0&&(_[S]=w.reverse())}const E=io.triangulateShape(v,_);for(let S=0,y=_.length;S<y;S++){const w=_[S];v=v.concat(w)}for(let S=0,y=v.length;S<y;S++){const w=v[S];r.push(w.x,w.y,0),s.push(0,0,1),o.push(w.x,w.y)}for(let S=0,y=E.length;S<y;S++){const w=E[S],M=w[0]+d,R=w[1]+d,z=w[2]+d;i.push(M,R,z),c+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return f6(t,e)}static fromJSON(e,t){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=t[e.shapes[r]];i.push(o)}return new I0(i,e.curveSegments)}}function f6(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const r=n[t];e.shapes.push(r.uuid)}else e.shapes.push(n.uuid);return e}class Yd extends qt{constructor(e=1,t=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const c=Math.min(o+a,Math.PI);let h=0;const f=[],d=new j,m=new j,v=[],_=[],E=[],S=[];for(let y=0;y<=i;y++){const w=[],M=y/i;let R=0;y===0&&o===0?R=.5/t:y===i&&c===Math.PI&&(R=-.5/t);for(let z=0;z<=t;z++){const k=z/t;d.x=-e*Math.cos(r+k*s)*Math.sin(o+M*a),d.y=e*Math.cos(o+M*a),d.z=e*Math.sin(r+k*s)*Math.sin(o+M*a),_.push(d.x,d.y,d.z),m.copy(d).normalize(),E.push(m.x,m.y,m.z),S.push(k+R,1-M),w.push(h++)}f.push(w)}for(let y=0;y<i;y++)for(let w=0;w<t;w++){const M=f[y][w+1],R=f[y][w],z=f[y+1][w],k=f[y+1][w+1];(y!==0||o>0)&&v.push(M,R,k),(y!==i-1||c<Math.PI)&&v.push(R,z,k)}this.setIndex(v),this.setAttribute("position",new pt(_,3)),this.setAttribute("normal",new pt(E,3)),this.setAttribute("uv",new pt(S,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Yd(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class R0 extends Ka{constructor(e=1,t=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new R0(e.radius,e.detail)}}class P0 extends qt{constructor(e=1,t=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],c=[],h=[],f=new j,d=new j,m=new j;for(let v=0;v<=i;v++)for(let _=0;_<=r;_++){const E=_/r*s,S=v/i*Math.PI*2;d.x=(e+t*Math.cos(S))*Math.cos(E),d.y=(e+t*Math.cos(S))*Math.sin(E),d.z=t*Math.sin(S),a.push(d.x,d.y,d.z),f.x=e*Math.cos(E),f.y=e*Math.sin(E),m.subVectors(d,f).normalize(),c.push(m.x,m.y,m.z),h.push(_/r),h.push(v/i)}for(let v=1;v<=i;v++)for(let _=1;_<=r;_++){const E=(r+1)*v+_-1,S=(r+1)*(v-1)+_-1,y=(r+1)*(v-1)+_,w=(r+1)*v+_;o.push(E,S,w),o.push(S,y,w)}this.setIndex(o),this.setAttribute("position",new pt(a,3)),this.setAttribute("normal",new pt(c,3)),this.setAttribute("uv",new pt(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new P0(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class L0 extends qt{constructor(e=1,t=.4,i=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:s,q:o},i=Math.floor(i),r=Math.floor(r);const a=[],c=[],h=[],f=[],d=new j,m=new j,v=new j,_=new j,E=new j,S=new j,y=new j;for(let M=0;M<=i;++M){const R=M/i*s*Math.PI*2;w(R,s,o,e,v),w(R+.01,s,o,e,_),S.subVectors(_,v),y.addVectors(_,v),E.crossVectors(S,y),y.crossVectors(E,S),E.normalize(),y.normalize();for(let z=0;z<=r;++z){const k=z/r*Math.PI*2,P=-t*Math.cos(k),b=t*Math.sin(k);d.x=v.x+(P*y.x+b*E.x),d.y=v.y+(P*y.y+b*E.y),d.z=v.z+(P*y.z+b*E.z),c.push(d.x,d.y,d.z),m.subVectors(d,v).normalize(),h.push(m.x,m.y,m.z),f.push(M/i),f.push(z/r)}}for(let M=1;M<=i;M++)for(let R=1;R<=r;R++){const z=(r+1)*(M-1)+(R-1),k=(r+1)*M+(R-1),P=(r+1)*M+R,b=(r+1)*(M-1)+R;a.push(z,k,b),a.push(k,P,b)}this.setIndex(a),this.setAttribute("position",new pt(c,3)),this.setAttribute("normal",new pt(h,3)),this.setAttribute("uv",new pt(f,2));function w(M,R,z,k,P){const b=Math.cos(M),A=Math.sin(M),T=z/R*M,L=Math.cos(T);P.x=k*(2+L)*.5*b,P.y=k*(2+L)*A*.5,P.z=k*Math.sin(T)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new L0(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class N0 extends qt{constructor(e=new m1(new j(-1,-1,0),new j(-1,1,0),new j(1,1,0)),t=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new j,c=new j,h=new Ie;let f=new j;const d=[],m=[],v=[],_=[];E(),this.setIndex(_),this.setAttribute("position",new pt(d,3)),this.setAttribute("normal",new pt(m,3)),this.setAttribute("uv",new pt(v,2));function E(){for(let M=0;M<t;M++)S(M);S(s===!1?t:0),w(),y()}function S(M){f=e.getPointAt(M/t,f);const R=o.normals[M],z=o.binormals[M];for(let k=0;k<=r;k++){const P=k/r*Math.PI*2,b=Math.sin(P),A=-Math.cos(P);c.x=A*R.x+b*z.x,c.y=A*R.y+b*z.y,c.z=A*R.z+b*z.z,c.normalize(),m.push(c.x,c.y,c.z),a.x=f.x+i*c.x,a.y=f.y+i*c.y,a.z=f.z+i*c.z,d.push(a.x,a.y,a.z)}}function y(){for(let M=1;M<=t;M++)for(let R=1;R<=r;R++){const z=(r+1)*(M-1)+(R-1),k=(r+1)*M+(R-1),P=(r+1)*M+R,b=(r+1)*(M-1)+R;_.push(z,k,b),_.push(k,P,b)}}function w(){for(let M=0;M<=t;M++)for(let R=0;R<=r;R++)h.x=M/t,h.y=R/r,v.push(h.x,h.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new N0(new Iv[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class EP extends qt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],i=new Set,r=new j,s=new j;if(e.index!==null){const o=e.attributes.position,a=e.index;let c=e.groups;c.length===0&&(c=[{start:0,count:a.count,materialIndex:0}]);for(let h=0,f=c.length;h<f;++h){const d=c[h],m=d.start,v=d.count;for(let _=m,E=m+v;_<E;_+=3)for(let S=0;S<3;S++){const y=a.getX(_+S),w=a.getX(_+(S+1)%3);r.fromBufferAttribute(o,y),s.fromBufferAttribute(o,w),YA(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,c=o.count/3;a<c;a++)for(let h=0;h<3;h++){const f=3*a+h,d=3*a+(h+1)%3;r.fromBufferAttribute(o,f),s.fromBufferAttribute(o,d),YA(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new pt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function YA(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(i)===!0||t.has(r)===!0?!1:(t.add(i),t.add(r),!0)}var $A=Object.freeze({__proto__:null,BoxGeometry:mc,CapsuleGeometry:w0,CircleGeometry:M0,ConeGeometry:E0,CylinderGeometry:fh,DodecahedronGeometry:T0,EdgesGeometry:xP,ExtrudeGeometry:b0,IcosahedronGeometry:Xd,LatheGeometry:jd,OctahedronGeometry:qd,PlaneGeometry:$a,PolyhedronGeometry:Ka,RingGeometry:C0,ShapeGeometry:I0,SphereGeometry:Yd,TetrahedronGeometry:R0,TorusGeometry:P0,TorusKnotGeometry:L0,TubeGeometry:N0,WireframeGeometry:EP});class TP extends ji{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new lt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class AP extends ir{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class v1 extends ji{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new lt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new lt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ya,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Xr,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class bP extends v1{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ie(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Xn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new lt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new lt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new lt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class CP extends ji{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new lt(16777215),this.specular=new lt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new lt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ya,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Xr,this.combine=Od,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class IP extends ji{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new lt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new lt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ya,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class RP extends ji{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ya,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class PP extends ji{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new lt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new lt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ya,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Xr,this.combine=Od,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class LP extends ji{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new lt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ya,this.normalScale=new Ie(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class NP extends ar{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Vl(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function DP(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function kP(n){function e(r,s){return n[r]-n[s]}const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(e),i}function AS(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let c=0;c!==e;++c)r[o++]=n[a+c]}return r}function y1(n,e,t,i){let r=1,s=n[0];for(;s!==void 0&&s[i]===void 0;)s=n[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),t.push(o)),s=n[r++];while(s!==void 0)}function d6(n,e,t,i,r=30){const s=n.clone();s.name=e;const o=[];for(let c=0;c<s.tracks.length;++c){const h=s.tracks[c],f=h.getValueSize(),d=[],m=[];for(let v=0;v<h.times.length;++v){const _=h.times[v]*r;if(!(_<t||_>=i)){d.push(h.times[v]);for(let E=0;E<f;++E)m.push(h.values[v*f+E])}}d.length!==0&&(h.times=Vl(d,h.times.constructor),h.values=Vl(m,h.values.constructor),o.push(h))}s.tracks=o;let a=1/0;for(let c=0;c<s.tracks.length;++c)a>s.tracks[c].times[0]&&(a=s.tracks[c].times[0]);for(let c=0;c<s.tracks.length;++c)s.tracks[c].shift(-1*a);return s.resetDuration(),s}function p6(n,e=0,t=n,i=30){i<=0&&(i=30);const r=t.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=t.tracks[o],c=a.ValueTypeName;if(c==="bool"||c==="string")continue;const h=n.tracks.find(function(y){return y.name===a.name&&y.ValueTypeName===c});if(h===void 0)continue;let f=0;const d=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=d/3);let m=0;const v=h.getValueSize();h.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=v/3);const _=a.times.length-1;let E;if(s<=a.times[0]){const y=f,w=d-f;E=a.values.slice(y,w)}else if(s>=a.times[_]){const y=_*d+f,w=y+d-f;E=a.values.slice(y,w)}else{const y=a.createInterpolant(),w=f,M=d-f;y.evaluate(s),E=y.resultBuffer.slice(w,M)}c==="quaternion"&&new Vi().fromArray(E).normalize().conjugate().toArray(E);const S=h.times.length;for(let y=0;y<S;++y){const w=y*v+m;if(c==="quaternion")Vi.multiplyQuaternionsFlat(h.values,w,E,0,h.values,w);else{const M=v-m*2;for(let R=0;R<M;++R)h.values[w+R]-=E[R]}}}return n.blendMode=$w,n}const m6={convertArray:Vl,isTypedArray:DP,getKeyframeOrder:kP,sortedArray:AS,flattenJSON:y1,subclip:d6,makeClipAdditive:p6};class $d{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(i=2,s=a);for(let c=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class OP extends $d{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Fl,endingEnd:Fl}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],c=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case zl:s=e,a=2*t-i;break;case ud:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(c===void 0)switch(this.getSettings_().endingEnd){case zl:o=e,c=2*i-t;break;case ud:o=1,c=i+r[1]-r[0];break;default:o=e-1,c=t}const h=(i-t)*.5,f=this.valueSize;this._weightPrev=h/(t-a),this._weightNext=h/(c-i),this._offsetPrev=s*f,this._offsetNext=o*f}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,h=c-a,f=this._offsetPrev,d=this._offsetNext,m=this._weightPrev,v=this._weightNext,_=(i-t)/(r-t),E=_*_,S=E*_,y=-m*S+2*m*E-m*_,w=(1+m)*S+(-1.5-2*m)*E+(-.5+m)*_+1,M=(-1-v)*S+(1.5+v)*E+.5*_,R=v*S-v*E;for(let z=0;z!==a;++z)s[z]=y*o[f+z]+w*o[h+z]+M*o[c+z]+R*o[d+z];return s}}class _1 extends $d{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,h=c-a,f=(i-t)/(r-t),d=1-f;for(let m=0;m!==a;++m)s[m]=o[h+m]*d+o[c+m]*f;return s}}class UP extends $d{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class Fs{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Vl(t,this.TimeBufferType),this.values=Vl(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Vl(e.times,Array),values:Vl(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new UP(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new _1(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new OP(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case cd:t=this.InterpolantFactoryMethodDiscrete;break;case Tv:t=this.InterpolantFactoryMethodLinear;break;case yg:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return cd;case this.InterpolantFactoryMethodLinear:return Tv;case this.InterpolantFactoryMethodSmooth:return yg}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const c=i[a];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(o!==null&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(r!==void 0&&DP(r))for(let a=0,c=r.length;a!==c;++a){const h=r[a];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,h),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===yg,s=e.length-1;let o=1;for(let a=1;a<s;++a){let c=!1;const h=e[a],f=e[a+1];if(h!==f&&(a!==1||h!==e[0]))if(r)c=!0;else{const d=a*i,m=d-i,v=d+i;for(let _=0;_!==i;++_){const E=t[d+_];if(E!==t[m+_]||E!==t[v+_]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];const d=a*i,m=o*i;for(let v=0;v!==i;++v)t[m+v]=t[d+v]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,c=o*i,h=0;h!==i;++h)t[c+h]=t[a+h];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}Fs.prototype.TimeBufferType=Float32Array;Fs.prototype.ValueBufferType=Float32Array;Fs.prototype.DefaultInterpolation=Tv;class gc extends Fs{constructor(e,t,i){super(e,t,i)}}gc.prototype.ValueTypeName="bool";gc.prototype.ValueBufferType=Array;gc.prototype.DefaultInterpolation=cd;gc.prototype.InterpolantFactoryMethodLinear=void 0;gc.prototype.InterpolantFactoryMethodSmooth=void 0;class x1 extends Fs{}x1.prototype.ValueTypeName="color";class Sd extends Fs{}Sd.prototype.ValueTypeName="number";class FP extends $d{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(i-t)/(r-t);let h=e*a;for(let f=h+a;h!==f;h+=4)Vi.slerpFlat(s,0,o,h-a,o,h,c);return s}}class Kd extends Fs{InterpolantFactoryMethodLinear(e){return new FP(this.times,this.values,this.getValueSize(),e)}}Kd.prototype.ValueTypeName="quaternion";Kd.prototype.InterpolantFactoryMethodSmooth=void 0;class vc extends Fs{constructor(e,t,i){super(e,t,i)}}vc.prototype.ValueTypeName="string";vc.prototype.ValueBufferType=Array;vc.prototype.DefaultInterpolation=cd;vc.prototype.InterpolantFactoryMethodLinear=void 0;vc.prototype.InterpolantFactoryMethodSmooth=void 0;class wd extends Fs{}wd.prototype.ValueTypeName="vector";class Md{constructor(e="",t=-1,i=[],r=f0){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=Hr(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(v6(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(Fs.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let c=[],h=[];c.push((a+s-1)%s,a,(a+1)%s),h.push(0,1,0);const f=kP(c);c=AS(c,1,f),h=AS(h,1,f),!r&&c[0]===0&&(c.push(s),h.push(h[0])),o.push(new Sd(".morphTargetInfluences["+t[a].name+"]",c,h).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){const h=e[a],f=h.name.match(s);if(f&&f.length>1){const d=f[1];let m=r[d];m||(r[d]=m=[]),m.push(h)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(d,m,v,_,E){if(v.length!==0){const S=[],y=[];y1(v,S,y,_),S.length!==0&&E.push(new d(m,S,y))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let c=e.length||-1;const h=e.hierarchy||[];for(let d=0;d<h.length;d++){const m=h[d].keys;if(!(!m||m.length===0))if(m[0].morphTargets){const v={};let _;for(_=0;_<m.length;_++)if(m[_].morphTargets)for(let E=0;E<m[_].morphTargets.length;E++)v[m[_].morphTargets[E]]=-1;for(const E in v){const S=[],y=[];for(let w=0;w!==m[_].morphTargets.length;++w){const M=m[_];S.push(M.time),y.push(M.morphTarget===E?1:0)}r.push(new Sd(".morphTargetInfluence["+E+"]",S,y))}c=v.length*o}else{const v=".bones["+t[d].name+"]";i(wd,v+".position",m,"pos",r),i(Kd,v+".quaternion",m,"rot",r),i(wd,v+".scale",m,"scl",r)}}return r.length===0?null:new this(s,c,r,a)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function g6(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Sd;case"vector":case"vector2":case"vector3":case"vector4":return wd;case"color":return x1;case"quaternion":return Kd;case"bool":case"boolean":return gc;case"string":return vc}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function v6(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=g6(n.type);if(n.times===void 0){const t=[],i=[];y1(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const ko={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class D0{constructor(e,t,i){const r=this;let s=!1,o=0,a=0,c;const h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(f){a++,s===!1&&r.onStart!==void 0&&r.onStart(f,o,a),s=!0},this.itemEnd=function(f){o++,r.onProgress!==void 0&&r.onProgress(f,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(f){r.onError!==void 0&&r.onError(f)},this.resolveURL=function(f){return c?c(f):f},this.setURLModifier=function(f){return c=f,this},this.addHandler=function(f,d){return h.push(f,d),this},this.removeHandler=function(f){const d=h.indexOf(f);return d!==-1&&h.splice(d,2),this},this.getHandler=function(f){for(let d=0,m=h.length;d<m;d+=2){const v=h[d],_=h[d+1];if(v.global&&(v.lastIndex=0),v.test(f))return _}return null}}}const zP=new D0;class lr{constructor(e){this.manager=e!==void 0?e:zP,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}lr.DEFAULT_MATERIAL_NAME="__DEFAULT";const Co={};class y6 extends Error{constructor(e,t){super(e),this.response=t}}class Vr extends lr{constructor(e){super(e)}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=ko.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(Co[e]!==void 0){Co[e].push({onLoad:t,onProgress:i,onError:r});return}Co[e]=[],Co[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,c=this.responseType;fetch(o).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||h.body===void 0||h.body.getReader===void 0)return h;const f=Co[e],d=h.body.getReader(),m=h.headers.get("X-File-Size")||h.headers.get("Content-Length"),v=m?parseInt(m):0,_=v!==0;let E=0;const S=new ReadableStream({start(y){w();function w(){d.read().then(({done:M,value:R})=>{if(M)y.close();else{E+=R.byteLength;const z=new ProgressEvent("progress",{lengthComputable:_,loaded:E,total:v});for(let k=0,P=f.length;k<P;k++){const b=f[k];b.onProgress&&b.onProgress(z)}y.enqueue(R),w()}},M=>{y.error(M)})}}});return new Response(S)}else throw new y6(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`,h)}).then(h=>{switch(c){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(f=>new DOMParser().parseFromString(f,a));case"json":return h.json();default:if(a===void 0)return h.text();{const d=/charset="?([^;"\s]*)"?/i.exec(a),m=d&&d[1]?d[1].toLowerCase():void 0,v=new TextDecoder(m);return h.arrayBuffer().then(_=>v.decode(_))}}}).then(h=>{ko.add(e,h);const f=Co[e];delete Co[e];for(let d=0,m=f.length;d<m;d++){const v=f[d];v.onLoad&&v.onLoad(h)}}).catch(h=>{const f=Co[e];if(f===void 0)throw this.manager.itemError(e),h;delete Co[e];for(let d=0,m=f.length;d<m;d++){const v=f[d];v.onError&&v.onError(h)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class _6 extends lr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Vr(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e){const t=[];for(let i=0;i<e.length;i++){const r=Md.parse(e[i]);t.push(r)}return t}}class x6 extends lr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=[],a=new x0,c=new Vr(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(s.withCredentials);let h=0;function f(d){c.load(e[d],function(m){const v=s.parse(m,!0);o[d]={width:v.width,height:v.height,format:v.format,mipmaps:v.mipmaps},h+=1,h===6&&(v.mipmapCount===1&&(a.minFilter=mn),a.image=o,a.format=v.format,a.needsUpdate=!0,t&&t(a))},i,r)}if(Array.isArray(e))for(let d=0,m=e.length;d<m;++d)f(d);else c.load(e,function(d){const m=s.parse(d,!0);if(m.isCubemap){const v=m.mipmaps.length/m.mipmapCount;for(let _=0;_<v;_++){o[_]={mipmaps:[]};for(let E=0;E<m.mipmapCount;E++)o[_].mipmaps.push(m.mipmaps[_*m.mipmapCount+E]),o[_].format=m.format,o[_].width=m.width,o[_].height=m.height}a.image=o}else a.image.width=m.width,a.image.height=m.height,a.mipmaps=m.mipmaps;m.mipmapCount===1&&(a.minFilter=mn),a.format=m.format,a.needsUpdate=!0,t&&t(a)},i,r);return a}}class Ed extends lr{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=ko.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=gd("img");function c(){f(),ko.add(e,this),t&&t(this),s.manager.itemEnd(e)}function h(d){f(),r&&r(d),s.manager.itemError(e),s.manager.itemEnd(e)}function f(){a.removeEventListener("load",c,!1),a.removeEventListener("error",h,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",h,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class BP extends lr{constructor(e){super(e)}load(e,t,i,r){const s=new Vd;s.colorSpace=Ur;const o=new Ed(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function c(h){o.load(e[h],function(f){s.images[h]=f,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let h=0;h<e.length;++h)c(h);return s}}class S1 extends lr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Ds,a=new Vr(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(c){let h;try{h=s.parse(c)}catch(f){if(r!==void 0)r(f);else{console.error(f);return}}h.image!==void 0?o.image=h.image:h.data!==void 0&&(o.image.width=h.width,o.image.height=h.height,o.image.data=h.data),o.wrapS=h.wrapS!==void 0?h.wrapS:li,o.wrapT=h.wrapT!==void 0?h.wrapT:li,o.magFilter=h.magFilter!==void 0?h.magFilter:mn,o.minFilter=h.minFilter!==void 0?h.minFilter:mn,o.anisotropy=h.anisotropy!==void 0?h.anisotropy:1,h.colorSpace!==void 0&&(o.colorSpace=h.colorSpace),h.flipY!==void 0&&(o.flipY=h.flipY),h.format!==void 0&&(o.format=h.format),h.type!==void 0&&(o.type=h.type),h.mipmaps!==void 0&&(o.mipmaps=h.mipmaps,o.minFilter=Zs),h.mipmapCount===1&&(o.minFilter=mn),h.generateMipmaps!==void 0&&(o.generateMipmaps=h.generateMipmaps),o.needsUpdate=!0,t&&t(o,h)},i,r),o}}class S6 extends lr{constructor(e){super(e)}load(e,t,i,r){const s=new yn,o=new Ed(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},i,r),s}}class Za extends an{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new lt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class HP extends Za{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(an.DEFAULT_UP),this.updateMatrix(),this.groundColor=new lt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const q_=new Lt,KA=new j,ZA=new j;class w1{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ie(512,512),this.map=null,this.mapPass=null,this.matrix=new Lt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Gd,this._frameExtents=new Ie(1,1),this._viewportCount=1,this._viewports=[new pn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;KA.setFromMatrixPosition(e.matrixWorld),t.position.copy(KA),ZA.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(ZA),t.updateMatrixWorld(),q_.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(q_),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(q_)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class w6 extends w1{constructor(){super(new Jn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=Zu*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class VP extends Za{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(an.DEFAULT_UP),this.updateMatrix(),this.target=new an,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new w6}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const JA=new Lt,of=new j,Y_=new j;class M6 extends w1{constructor(){super(new Jn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ie(4,2),this._viewportCount=6,this._viewports=[new pn(2,1,1,1),new pn(0,1,1,1),new pn(3,1,1,1),new pn(1,1,1,1),new pn(3,0,1,1),new pn(1,0,1,1)],this._cubeDirections=[new j(1,0,0),new j(-1,0,0),new j(0,0,1),new j(0,0,-1),new j(0,1,0),new j(0,-1,0)],this._cubeUps=[new j(0,1,0),new j(0,1,0),new j(0,1,0),new j(0,1,0),new j(0,0,1),new j(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),of.setFromMatrixPosition(e.matrixWorld),i.position.copy(of),Y_.copy(i.position),Y_.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(Y_),i.updateMatrixWorld(),r.makeTranslation(-of.x,-of.y,-of.z),JA.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(JA)}}class GP extends Za{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new M6}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class E6 extends w1{constructor(){super(new Bo(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class WP extends Za{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(an.DEFAULT_UP),this.updateMatrix(),this.target=new an,this.shadow=new E6}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class jP extends Za{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class XP extends Za{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class qP{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new j)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*i),t.addScaledVector(o[4],1.092548*(i*r)),t.addScaledVector(o[5],1.092548*(r*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(i*s)),t.addScaledVector(o[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*r),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*i),t.addScaledVector(o[4],2*.429043*i*r),t.addScaledVector(o[5],2*.429043*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*i*s),t.addScaledVector(o[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}class YP extends Za{constructor(e=new qP,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class k0 extends lr{constructor(e){super(e),this.textures={}}load(e,t,i,r){const s=this,o=new Vr(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e){const t=this.textures;function i(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const r=k0.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new lt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=i(o.value);break;case"c":r.uniforms[s].value=new lt().setHex(o.value);break;case"v2":r.uniforms[s].value=new Ie().fromArray(o.value);break;case"v3":r.uniforms[s].value=new j().fromArray(o.value);break;case"v4":r.uniforms[s].value=new pn().fromArray(o.value);break;case"m3":r.uniforms[s].value=new Vt().fromArray(o.value);break;case"m4":r.uniforms[s].value=new Lt().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new Ie().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Ie().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:TP,SpriteMaterial:l1,RawShaderMaterial:AP,ShaderMaterial:ir,PointsMaterial:u1,MeshPhysicalMaterial:bP,MeshStandardMaterial:v1,MeshPhongMaterial:CP,MeshToonMaterial:IP,MeshNormalMaterial:RP,MeshLambertMaterial:PP,MeshDepthMaterial:s1,MeshDistanceMaterial:o1,MeshBasicMaterial:Ko,MeshMatcapMaterial:LP,LineDashedMaterial:NP,LineBasicMaterial:ar,Material:ji};return new t[e]}}class bS{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class $P extends qt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class KP extends lr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Vr(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e){const t={},i={};function r(v,_){if(t[_]!==void 0)return t[_];const S=v.interleavedBuffers[_],y=s(v,S.buffer),w=Mu(S.type,y),M=new y0(w,S.stride);return M.uuid=S.uuid,t[_]=M,M}function s(v,_){if(i[_]!==void 0)return i[_];const S=v.arrayBuffers[_],y=new Uint32Array(S).buffer;return i[_]=y,y}const o=e.isInstancedBufferGeometry?new $P:new qt,a=e.data.index;if(a!==void 0){const v=Mu(a.type,a.array);o.setIndex(new _n(v,1))}const c=e.data.attributes;for(const v in c){const _=c[v];let E;if(_.isInterleavedBufferAttribute){const S=r(e.data,_.data);E=new ac(S,_.itemSize,_.offset,_.normalized)}else{const S=Mu(_.type,_.array),y=_.isInstancedBufferAttribute?Qu:_n;E=new y(S,_.itemSize,_.normalized)}_.name!==void 0&&(E.name=_.name),_.usage!==void 0&&E.setUsage(_.usage),o.setAttribute(v,E)}const h=e.data.morphAttributes;if(h)for(const v in h){const _=h[v],E=[];for(let S=0,y=_.length;S<y;S++){const w=_[S];let M;if(w.isInterleavedBufferAttribute){const R=r(e.data,w.data);M=new ac(R,w.itemSize,w.offset,w.normalized)}else{const R=Mu(w.type,w.array);M=new _n(R,w.itemSize,w.normalized)}w.name!==void 0&&(M.name=w.name),E.push(M)}o.morphAttributes[v]=E}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const d=e.data.groups||e.data.drawcalls||e.data.offsets;if(d!==void 0)for(let v=0,_=d.length;v!==_;++v){const E=d[v];o.addGroup(E.start,E.count,E.materialIndex)}const m=e.data.boundingSphere;if(m!==void 0){const v=new j;m.center!==void 0&&v.fromArray(m.center),o.boundingSphere=new Gi(v,m.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class T6 extends lr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=this.path===""?bS.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Vr(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){let h=null;try{h=JSON.parse(c)}catch(d){r!==void 0&&r(d),console.error("THREE:ObjectLoader: Can't parse "+e+".",d.message);return}const f=h.metadata;if(f===void 0||f.type===void 0||f.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(h,t)},i,r)}async loadAsync(e,t){const i=this,r=this.path===""?bS.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new Vr(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),a=JSON.parse(o),c=a.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(a)}parse(e,t){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){t!==void 0&&t(h)}),a=this.parseTextures(e.textures,o),c=this.parseMaterials(e.materials,a),h=this.parseObject(e.object,s,c,a,i),f=this.parseSkeletons(e.skeletons,h);if(this.bindSkeletons(h,f),this.bindLightTargets(h),t!==void 0){let d=!1;for(const m in o)if(o[m].data instanceof HTMLImageElement){d=!0;break}d===!1&&t(h)}return h}async parseAsync(e){const t=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),c=this.parseObject(e.object,r,a,o,t),h=this.parseSkeletons(e.skeletons,c);return this.bindSkeletons(c,h),this.bindLightTargets(c),c}parseShapes(e){const t={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const s=new Jl().fromJSON(e[i]);t[s.uuid]=s}return t}parseSkeletons(e,t){const i={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new _0().fromJSON(e[s],r);i[a.uuid]=a}return i}parseGeometries(e,t){const i={};if(e!==void 0){const r=new KP;for(let s=0,o=e.length;s<o;s++){let a;const c=e[s];switch(c.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(c);break;default:c.type in $A?a=$A[c.type].fromJSON(c,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${c.type}"`)}a.uuid=c.uuid,c.name!==void 0&&(a.name=c.name),c.userData!==void 0&&(a.userData=c.userData),i[c.uuid]=a}}return i}parseMaterials(e,t){const i={},r={};if(e!==void 0){const s=new k0;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const c=e[o];i[c.uuid]===void 0&&(i[c.uuid]=s.parse(c)),r[c.uuid]=i[c.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],s=Md.parse(r);t[s.uuid]=s}return t}parseImages(e,t){const i=this,r={};let s;function o(c){return i.manager.itemStart(c),s.load(c,function(){i.manager.itemEnd(c)},void 0,function(){i.manager.itemError(c),i.manager.itemEnd(c)})}function a(c){if(typeof c=="string"){const h=c,f=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:i.resourcePath+h;return o(f)}else return c.data?{data:Mu(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){const c=new D0(t);s=new Ed(c),s.setCrossOrigin(this.crossOrigin);for(let h=0,f=e.length;h<f;h++){const d=e[h],m=d.url;if(Array.isArray(m)){const v=[];for(let _=0,E=m.length;_<E;_++){const S=m[_],y=a(S);y!==null&&(y instanceof HTMLImageElement?v.push(y):v.push(new Ds(y.data,y.width,y.height)))}r[d.uuid]=new Bl(v)}else{const v=a(d.url);r[d.uuid]=new Bl(v)}}}return r}async parseImagesAsync(e){const t=this,i={};let r;async function s(o){if(typeof o=="string"){const a=o,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await r.loadAsync(c)}else return o.data?{data:Mu(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new Ed(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const c=e[o],h=c.url;if(Array.isArray(h)){const f=[];for(let d=0,m=h.length;d<m;d++){const v=h[d],_=await s(v);_!==null&&(_ instanceof HTMLImageElement?f.push(_):f.push(new Ds(_.data,_.width,_.height)))}i[c.uuid]=new Bl(f)}else{const f=await s(c.url);i[c.uuid]=new Bl(f)}}}return i}parseTextures(e,t){function i(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const c=t[a.image],h=c.data;let f;Array.isArray(h)?(f=new Vd,h.length===6&&(f.needsUpdate=!0)):(h&&h.data?f=new Ds:f=new yn,h&&(f.needsUpdate=!0)),f.source=c,f.uuid=a.uuid,a.name!==void 0&&(f.name=a.name),a.mapping!==void 0&&(f.mapping=i(a.mapping,A6)),a.channel!==void 0&&(f.channel=a.channel),a.offset!==void 0&&f.offset.fromArray(a.offset),a.repeat!==void 0&&f.repeat.fromArray(a.repeat),a.center!==void 0&&f.center.fromArray(a.center),a.rotation!==void 0&&(f.rotation=a.rotation),a.wrap!==void 0&&(f.wrapS=i(a.wrap[0],QA),f.wrapT=i(a.wrap[1],QA)),a.format!==void 0&&(f.format=a.format),a.internalFormat!==void 0&&(f.internalFormat=a.internalFormat),a.type!==void 0&&(f.type=a.type),a.colorSpace!==void 0&&(f.colorSpace=a.colorSpace),a.minFilter!==void 0&&(f.minFilter=i(a.minFilter,eb)),a.magFilter!==void 0&&(f.magFilter=i(a.magFilter,eb)),a.anisotropy!==void 0&&(f.anisotropy=a.anisotropy),a.flipY!==void 0&&(f.flipY=a.flipY),a.generateMipmaps!==void 0&&(f.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(f.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(f.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(f.compareFunction=a.compareFunction),a.userData!==void 0&&(f.userData=a.userData),r[a.uuid]=f}return r}parseObject(e,t,i,r,s){let o;function a(m){return t[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",m),t[m]}function c(m){if(m!==void 0){if(Array.isArray(m)){const v=[];for(let _=0,E=m.length;_<E;_++){const S=m[_];i[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",S),v.push(i[S])}return v}return i[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",m),i[m]}}function h(m){return r[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",m),r[m]}let f,d;switch(e.type){case"Scene":o=new Wd,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new lt(e.background):o.background=h(e.background)),e.environment!==void 0&&(o.environment=h(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new v0(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new g0(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&o.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(o.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&o.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":o=new Jn(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new Bo(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new jP(e.color,e.intensity);break;case"DirectionalLight":o=new WP(e.color,e.intensity),o.target=e.target||"";break;case"PointLight":o=new GP(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new XP(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new VP(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),o.target=e.target||"";break;case"HemisphereLight":o=new HP(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new YP().fromJSON(e);break;case"SkinnedMesh":f=a(e.geometry),d=c(e.material),o=new uP(f,d),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":f=a(e.geometry),d=c(e.material),o=new Bn(f,d);break;case"InstancedMesh":f=a(e.geometry),d=c(e.material);const m=e.count,v=e.instanceMatrix,_=e.instanceColor;o=new hP(f,d,m),o.instanceMatrix=new Qu(new Float32Array(v.array),16),_!==void 0&&(o.instanceColor=new Qu(new Float32Array(_.array),_.itemSize));break;case"BatchedMesh":f=a(e.geometry),d=c(e.material),o=new fP(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,d),o.geometry=f,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(E=>{const S=new nr;S.min.fromArray(E.boxMin),S.max.fromArray(E.boxMax);const y=new Gi;return y.radius=E.sphereRadius,y.center.fromArray(E.sphereCenter),{boxInitialized:E.boxInitialized,box:S,sphereInitialized:E.sphereInitialized,sphere:y}}),o._maxInstanceCount=e.maxInstanceCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=h(e.matricesTexture.uuid),e.colorsTexture!==void 0&&(o._colorsTexture=h(e.colorsTexture.uuid));break;case"LOD":o=new cP;break;case"Line":o=new Wa(a(e.geometry),c(e.material));break;case"LineLoop":o=new dP(a(e.geometry),c(e.material));break;case"LineSegments":o=new uo(a(e.geometry),c(e.material));break;case"PointCloud":case"Points":o=new pP(a(e.geometry),c(e.material));break;case"Sprite":o=new lP(c(e.material));break;case"Group":o=new Tu;break;case"Bone":o=new c1;break;default:o=new an}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(o.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const m=e.children;for(let v=0;v<m.length;v++)o.add(this.parseObject(m[v],t,i,r,s))}if(e.animations!==void 0){const m=e.animations;for(let v=0;v<m.length;v++){const _=m[v];o.animations.push(s[_])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const m=e.levels;for(let v=0;v<m.length;v++){const _=m[v],E=o.getObjectByProperty("uuid",_.object);E!==void 0&&o.addLevel(E,_.distance,_.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=t[i.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const i=t.target,r=e.getObjectByProperty("uuid",i);r!==void 0?t.target=r:t.target=new an}})}}const A6={UVMapping:Va,CubeReflectionMapping:oo,CubeRefractionMapping:Ga,EquirectangularReflectionMapping:$u,EquirectangularRefractionMapping:od,CubeUVReflectionMapping:uh},QA={RepeatWrapping:ad,ClampToEdgeWrapping:li,MirroredRepeatWrapping:ld},eb={NearestFilter:_i,NearestMipmapNearestFilter:Hw,NearestMipmapLinearFilter:wu,LinearFilter:mn,LinearMipmapNearestFilter:bf,LinearMipmapLinearFilter:Zs};class b6 extends lr{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=ko.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(h=>{t&&t(h),s.manager.itemEnd(e)}).catch(h=>{r&&r(h)});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;const c=fetch(e,a).then(function(h){return h.blob()}).then(function(h){return createImageBitmap(h,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(h){return ko.add(e,h),t&&t(h),s.manager.itemEnd(e),h}).catch(function(h){r&&r(h),ko.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});ko.add(e,c),s.manager.itemStart(e)}}let jm;class M1{static getContext(){return jm===void 0&&(jm=new(window.AudioContext||window.webkitAudioContext)),jm}static setContext(e){jm=e}}class C6 extends lr{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Vr(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){try{const h=c.slice(0);M1.getContext().decodeAudioData(h,function(d){t(d)}).catch(a)}catch(h){a(h)}},i,r);function a(c){r?r(c):console.error(c),s.manager.itemError(e)}}}const tb=new Lt,nb=new Lt,wl=new Lt;class I6{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Jn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Jn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,wl.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,o=t.near*Math.tan(Kl*t.fov*.5)/t.zoom;let a,c;nb.elements[12]=-r,tb.elements[12]=r,a=-o*t.aspect+s,c=o*t.aspect+s,wl.elements[0]=2*t.near/(c-a),wl.elements[8]=(c+a)/(c-a),this.cameraL.projectionMatrix.copy(wl),a=-o*t.aspect-s,c=o*t.aspect-s,wl.elements[0]=2*t.near/(c-a),wl.elements[8]=(c+a)/(c-a),this.cameraR.projectionMatrix.copy(wl)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(nb),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(tb)}}let E1=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=ib(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=ib();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function ib(){return(typeof performance>"u"?Date:performance).now()}const Ml=new j,rb=new Vi,R6=new j,El=new j;class P6 extends an{constructor(){super(),this.type="AudioListener",this.context=M1.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new E1}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Ml,rb,R6),El.set(0,0,-1).applyQuaternion(rb),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Ml.x,r),t.positionY.linearRampToValueAtTime(Ml.y,r),t.positionZ.linearRampToValueAtTime(Ml.z,r),t.forwardX.linearRampToValueAtTime(El.x,r),t.forwardY.linearRampToValueAtTime(El.y,r),t.forwardZ.linearRampToValueAtTime(El.z,r),t.upX.linearRampToValueAtTime(i.x,r),t.upY.linearRampToValueAtTime(i.y,r),t.upZ.linearRampToValueAtTime(i.z,r)}else t.setPosition(Ml.x,Ml.y,Ml.z),t.setOrientation(El.x,El.y,El.z,i.x,i.y,i.z)}}class ZP extends an{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Tl=new j,sb=new Vi,L6=new j,Al=new j;class N6 extends ZP{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Tl,sb,L6),Al.set(0,0,1).applyQuaternion(sb);const t=this.panner;if(t.positionX){const i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Tl.x,i),t.positionY.linearRampToValueAtTime(Tl.y,i),t.positionZ.linearRampToValueAtTime(Tl.z,i),t.orientationX.linearRampToValueAtTime(Al.x,i),t.orientationY.linearRampToValueAtTime(Al.y,i),t.orientationZ.linearRampToValueAtTime(Al.z,i)}else t.setPosition(Tl.x,Tl.y,Tl.z),t.setOrientation(Al.x,Al.y,Al.z)}}class D6{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let i=0;i<t.length;i++)e+=t[i];return e/t.length}}class JP{constructor(e,t,i){this.binding=e,this.valueSize=i;let r,s,o;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)i[s+a]=i[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(i,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const c=t*this._origIndex;this._mixBufferRegion(i,r,c,1-s,t)}o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let c=t,h=t+t;c!==h;++c)if(i[c]!==i[c+t]){a.setValue(i,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(t,r);for(let s=i,o=r;s!==o;++s)t[s]=t[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[i+o]}_slerp(e,t,i,r){Vi.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,s){const o=this._workIndex*s;Vi.multiplyQuaternionsFlat(e,o,e,t,e,i),Vi.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const c=t+a;e[c]=e[c]*o+e[i+a]*r}}_lerpAdditive(e,t,i,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[i+o]*r}}}const T1="\\[\\]\\.:\\/",k6=new RegExp("["+T1+"]","g"),A1="[^"+T1+"]",O6="[^"+T1.replace("\\.","")+"]",U6=/((?:WC+[\/:])*)/.source.replace("WC",A1),F6=/(WCOD+)?/.source.replace("WCOD",O6),z6=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",A1),B6=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",A1),H6=new RegExp("^"+U6+F6+z6+B6+"$"),V6=["material","materials","bones","map"];class G6{constructor(e,t,i){const r=i||sn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class sn{constructor(e,t,i){this.path=t,this.parsedPath=i||sn.parseTrackName(t),this.node=sn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new sn.Composite(e,t,i):new sn(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(k6,"")}static parseTrackName(e){const t=H6.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);V6.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const c=i(a.children);if(c)return c}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=sn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let h=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let f=0;f<e.length;f++)if(e[f].name===h){h=f;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(h!==void 0){if(e[h]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[h]}}const o=e[r];if(o===void 0){const h=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}c=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(c=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}sn.Composite=G6;sn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};sn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};sn.prototype.GetterByBindingType=[sn.prototype._getValue_direct,sn.prototype._getValue_array,sn.prototype._getValue_arrayElement,sn.prototype._getValue_toArray];sn.prototype.SetterByBindingTypeAndVersioning=[[sn.prototype._setValue_direct,sn.prototype._setValue_direct_setNeedsUpdate,sn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[sn.prototype._setValue_array,sn.prototype._setValue_array_setNeedsUpdate,sn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[sn.prototype._setValue_arrayElement,sn.prototype._setValue_arrayElement_setNeedsUpdate,sn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[sn.prototype._setValue_fromArray,sn.prototype._setValue_fromArray_setNeedsUpdate,sn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class W6{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Hr(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,c=e.length,h=this.nCachedObjects_;for(let f=0,d=arguments.length;f!==d;++f){const m=arguments[f],v=m.uuid;let _=t[v];if(_===void 0){_=c++,t[v]=_,e.push(m);for(let E=0,S=o;E!==S;++E)s[E].push(new sn(m,i[E],r[E]))}else if(_<h){a=e[_];const E=--h,S=e[E];t[S.uuid]=_,e[_]=S,t[v]=E,e[E]=m;for(let y=0,w=o;y!==w;++y){const M=s[y],R=M[E];let z=M[_];M[_]=R,z===void 0&&(z=new sn(m,i[y],r[y])),M[E]=z}}else e[_]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h}remove(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const c=arguments[o],h=c.uuid,f=t[h];if(f!==void 0&&f>=s){const d=s++,m=e[d];t[m.uuid]=f,e[f]=m,t[h]=d,e[d]=c;for(let v=0,_=r;v!==_;++v){const E=i[v],S=E[d],y=E[f];E[f]=S,E[d]=y}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,c=arguments.length;a!==c;++a){const h=arguments[a],f=h.uuid,d=t[f];if(d!==void 0)if(delete t[f],d<s){const m=--s,v=e[m],_=--o,E=e[_];t[v.uuid]=d,e[d]=v,t[E.uuid]=m,e[m]=E,e.pop();for(let S=0,y=r;S!==y;++S){const w=i[S],M=w[m],R=w[_];w[d]=M,w[m]=R,w.pop()}}else{const m=--o,v=e[m];m>0&&(t[v.uuid]=d),e[d]=v,e.pop();for(let _=0,E=r;_!==E;++_){const S=i[_];S[d]=S[m],S.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,a=this._parsedPaths,c=this._objects,h=c.length,f=this.nCachedObjects_,d=new Array(h);r=s.length,i[e]=r,o.push(e),a.push(t),s.push(d);for(let m=f,v=c.length;m!==v;++m){const _=c[m];d[m]=new sn(_,e,t)}return d}unsubscribe_(e){const t=this._bindingsIndicesByPath,i=t[e];if(i!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,c=o[a],h=e[a];t[h]=i,o[i]=c,o.pop(),s[i]=s[a],s.pop(),r[i]=r[a],r.pop()}}}class QP{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),c={endingStart:Fl,endingEnd:Fl};for(let h=0;h!==o;++h){const f=s[h].createInterpolant(null);a[h]=f,f.settings=c}this._interpolantSettings=c,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=kR,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const c=a.parameterPositions,h=a.sampleValues;return c[0]=s,c[1]=s+i,h[0]=e/o,h[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const c=(e-s)*i;c<0||i===0?t=0:(this._startTime=null,t=i*c)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const c=this._interpolants,h=this._propertyBindings;switch(this.blendMode){case $w:for(let f=0,d=c.length;f!==d;++f)c[f].evaluate(o),h[f].accumulateAdditive(a);break;case f0:default:for(let f=0,d=c.length;f!==d;++f)c[f].evaluate(o),h[f].accumulate(r,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=i===OR;if(e===0)return s===-1?r:o&&(s&1)===1?t-r:r;if(i===DR){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const c=this.repetitions-s;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(c===1){const h=e<0;this._setEndings(h,!h,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=zl,r.endingEnd=zl):(e?r.endingStart=this.zeroSlopeAtStart?zl:Fl:r.endingStart=ud,t?r.endingEnd=this.zeroSlopeAtEnd?zl:Fl:r.endingEnd=ud)}_scheduleFading(e,t,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,c=o.sampleValues;return a[0]=s,c[0]=t,a[1]=s+e,c[1]=i,this}}const j6=new Float32Array(1);class X6 extends co{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,c=i.uuid,h=this._bindingsByRootAndName;let f=h[c];f===void 0&&(f={},h[c]=f);for(let d=0;d!==s;++d){const m=r[d],v=m.name;let _=f[v];if(_!==void 0)++_.referenceCount,o[d]=_;else{if(_=o[d],_!==void 0){_._cacheIndex===null&&(++_.referenceCount,this._addInactiveBinding(_,c,v));continue}const E=t&&t._propertyBindings[d].binding.parsedPath;_=new JP(sn.create(i,v,E),m.ValueTypeName,m.getValueSize()),++_.referenceCount,this._addInactiveBinding(_,c,v),o[d]=_}a[d].resultBuffer=_.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],c=a.knownActions,h=c[c.length-1],f=e._byClipCacheIndex;h._byClipCacheIndex=f,c[f]=h,c.pop(),e._byClipCacheIndex=null;const d=a.actionByRoot,m=(e._localRoot||this._root).uuid;delete d[m],c.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];o===void 0&&(o={},r[t]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],c=t[t.length-1],h=e._cacheIndex;c._cacheIndex=h,t[h]=c,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return i===void 0&&(i=new _1(new Float32Array(2),new Float32Array(2),1,j6),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=i,t[i]=s}clipAction(e,t,i){const r=t||this._root,s=r.uuid;let o=typeof e=="string"?Md.findByName(r,e):e;const a=o!==null?o.uuid:e,c=this._actionsByClip[a];let h=null;if(i===void 0&&(o!==null?i=o.blendMode:i=f0),c!==void 0){const d=c.actionByRoot[s];if(d!==void 0&&d.blendMode===i)return d;h=c.knownActions[0],o===null&&(o=h._clip)}if(o===null)return null;const f=new QP(this,o,t,i);return this._bindAction(f,h),this._addInactiveAction(f,a,s),f}existingAction(e,t){const i=t||this._root,r=i.uuid,s=typeof e=="string"?Md.findByName(i,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const t=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let h=0;h!==i;++h)t[h]._update(r,e,s,o);const a=this._bindings,c=this._nActiveBindings;for(let h=0;h!==c;++h)a[h].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const o=s.knownActions;for(let a=0,c=o.length;a!==c;++a){const h=o[a];this._deactivateAction(h);const f=h._cacheIndex,d=t[t.length-1];h._cacheIndex=null,h._byClipCacheIndex=null,d._cacheIndex=f,t[f]=d,t.pop(),this._removeInactiveBindingsForAction(h)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const o in i){const a=i[o].actionByRoot,c=a[t];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class b1{constructor(e){this.value=e}clone(){return new b1(this.value.clone===void 0?this.value:this.value.clone())}}let q6=0;class Y6 extends co{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:q6++}),this.name="",this.usage=pd,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let i=0,r=t.length;i<r;i++){const s=Array.isArray(t[i])?t[i]:[t[i]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class $6 extends y0{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class K6{constructor(e,t,i,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=i,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const ob=new Lt;class C1{constructor(e,t,i=0,r=1/0){this.ray=new pc(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new Zl,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return ob.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(ob),this}intersectObject(e,t=!0,i=[]){return CS(e,this,i,t),i.sort(ab),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)CS(e[r],this,i,t);return i.sort(ab),i}}function ab(n,e){return n.distance-e.distance}function CS(n,e,t,i){let r=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(r=!1),r===!0&&i===!0){const s=n.children;for(let o=0,a=s.length;o<a;o++)CS(s[o],e,t,!0)}}class IS{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Xn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Z6{constructor(e=1,t=0,i=0){return this.radius=e,this.theta=t,this.y=i,this}set(e,t,i){return this.radius=e,this.theta=t,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}clone(){return new this.constructor().copy(this)}}class I1{constructor(e,t,i,r){I1.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,i,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let i=0;i<4;i++)this.elements[i]=e[i+t];return this}set(e,t,i,r){const s=this.elements;return s[0]=e,s[2]=t,s[1]=i,s[3]=r,this}}const lb=new Ie;class J6{constructor(e=new Ie(1/0,1/0),t=new Ie(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=lb.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,lb).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const cb=new j,Xm=new j;class Q6{constructor(e=new j,t=new j){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){cb.subVectors(e,this.start),Xm.subVectors(this.end,this.start);const i=Xm.dot(Xm);let s=Xm.dot(cb)/i;return t&&(s=Xn(s,0,1)),s}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const ub=new j;class eH extends an{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const i=new qt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,c=32;o<c;o++,a++){const h=o/c*Math.PI*2,f=a/c*Math.PI*2;r.push(Math.cos(h),Math.sin(h),1,Math.cos(f),Math.sin(f),1)}i.setAttribute("position",new pt(r,3));const s=new ar({fog:!1,toneMapped:!1});this.cone=new uo(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),ub.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ub),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const da=new j,qm=new Lt,$_=new Lt;class tH extends uo{constructor(e){const t=eL(e),i=new qt,r=[],s=[],o=new lt(0,0,1),a=new lt(0,1,0);for(let h=0;h<t.length;h++){const f=t[h];f.parent&&f.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}i.setAttribute("position",new pt(r,3)),i.setAttribute("color",new pt(s,3));const c=new ar({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,c),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,i=this.geometry,r=i.getAttribute("position");$_.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(qm.multiplyMatrices($_,a.matrixWorld),da.setFromMatrixPosition(qm),r.setXYZ(o,da.x,da.y,da.z),qm.multiplyMatrices($_,a.parent.matrixWorld),da.setFromMatrixPosition(qm),r.setXYZ(o+1,da.x,da.y,da.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function eL(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,eL(n.children[t]));return e}class nH extends Bn{constructor(e,t,i){const r=new Yd(t,4,2),s=new Ko({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const iH=new j,hb=new lt,fb=new lt;class rH extends an{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new qd(t);r.rotateY(Math.PI*.5),this.material=new Ko({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new _n(o,3)),this.add(new Bn(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");hb.copy(this.light.color),fb.copy(this.light.groundColor);for(let i=0,r=t.count;i<r;i++){const s=i<r/2?hb:fb;t.setXYZ(i,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(iH.setFromMatrixPosition(this.light.matrixWorld).negate())}}class sH extends uo{constructor(e=10,t=10,i=4473924,r=8947848){i=new lt(i),r=new lt(r);const s=t/2,o=e/t,a=e/2,c=[],h=[];for(let m=0,v=0,_=-a;m<=t;m++,_+=o){c.push(-a,0,_,a,0,_),c.push(_,0,-a,_,0,a);const E=m===s?i:r;E.toArray(h,v),v+=3,E.toArray(h,v),v+=3,E.toArray(h,v),v+=3,E.toArray(h,v),v+=3}const f=new qt;f.setAttribute("position",new pt(c,3)),f.setAttribute("color",new pt(h,3));const d=new ar({vertexColors:!0,toneMapped:!1});super(f,d),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class oH extends uo{constructor(e=10,t=16,i=8,r=64,s=4473924,o=8947848){s=new lt(s),o=new lt(o);const a=[],c=[];if(t>1)for(let d=0;d<t;d++){const m=d/t*(Math.PI*2),v=Math.sin(m)*e,_=Math.cos(m)*e;a.push(0,0,0),a.push(v,0,_);const E=d&1?s:o;c.push(E.r,E.g,E.b),c.push(E.r,E.g,E.b)}for(let d=0;d<i;d++){const m=d&1?s:o,v=e-e/i*d;for(let _=0;_<r;_++){let E=_/r*(Math.PI*2),S=Math.sin(E)*v,y=Math.cos(E)*v;a.push(S,0,y),c.push(m.r,m.g,m.b),E=(_+1)/r*(Math.PI*2),S=Math.sin(E)*v,y=Math.cos(E)*v,a.push(S,0,y),c.push(m.r,m.g,m.b)}}const h=new qt;h.setAttribute("position",new pt(a,3)),h.setAttribute("color",new pt(c,3));const f=new ar({vertexColors:!0,toneMapped:!1});super(h,f),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const db=new j,Ym=new j,pb=new j;class aH extends an{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new qt;r.setAttribute("position",new pt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new ar({fog:!1,toneMapped:!1});this.lightPlane=new Wa(r,s),this.add(this.lightPlane),r=new qt,r.setAttribute("position",new pt([0,0,0,0,0,1],3)),this.targetLine=new Wa(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),db.setFromMatrixPosition(this.light.matrixWorld),Ym.setFromMatrixPosition(this.light.target.matrixWorld),pb.subVectors(Ym,db),this.lightPlane.lookAt(Ym),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Ym),this.targetLine.scale.z=pb.length()}}const $m=new j,Wn=new Hd;class lH extends uo{constructor(e){const t=new qt,i=new ar({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(_,E){c(_),c(E)}function c(_){r.push(0,0,0),s.push(0,0,0),o[_]===void 0&&(o[_]=[]),o[_].push(r.length/3-1)}t.setAttribute("position",new pt(r,3)),t.setAttribute("color",new pt(s,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const h=new lt(16755200),f=new lt(16711680),d=new lt(43775),m=new lt(16777215),v=new lt(3355443);this.setColors(h,f,d,m,v)}setColors(e,t,i,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,i.r,i.g,i.b),a.setXYZ(33,i.r,i.g,i.b),a.setXYZ(34,i.r,i.g,i.b),a.setXYZ(35,i.r,i.g,i.b),a.setXYZ(36,i.r,i.g,i.b),a.setXYZ(37,i.r,i.g,i.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,i=1,r=1;Wn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Kn("c",t,e,Wn,0,0,-1),Kn("t",t,e,Wn,0,0,1),Kn("n1",t,e,Wn,-i,-r,-1),Kn("n2",t,e,Wn,i,-r,-1),Kn("n3",t,e,Wn,-i,r,-1),Kn("n4",t,e,Wn,i,r,-1),Kn("f1",t,e,Wn,-i,-r,1),Kn("f2",t,e,Wn,i,-r,1),Kn("f3",t,e,Wn,-i,r,1),Kn("f4",t,e,Wn,i,r,1),Kn("u1",t,e,Wn,i*.7,r*1.1,-1),Kn("u2",t,e,Wn,-i*.7,r*1.1,-1),Kn("u3",t,e,Wn,0,r*2,-1),Kn("cf1",t,e,Wn,-i,0,1),Kn("cf2",t,e,Wn,i,0,1),Kn("cf3",t,e,Wn,0,-r,1),Kn("cf4",t,e,Wn,0,r,1),Kn("cn1",t,e,Wn,-i,0,-1),Kn("cn2",t,e,Wn,i,0,-1),Kn("cn3",t,e,Wn,0,-r,-1),Kn("cn4",t,e,Wn,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Kn(n,e,t,i,r,s,o){$m.set(r,s,o).unproject(i);const a=e[n];if(a!==void 0){const c=t.getAttribute("position");for(let h=0,f=a.length;h<f;h++)c.setXYZ(a[h],$m.x,$m.y,$m.z)}}const Km=new nr;class cH extends uo{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new qt;s.setIndex(new _n(i,1)),s.setAttribute("position",new _n(r,3)),super(s,new ar({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Km.setFromObject(this.object),Km.isEmpty())return;const t=Km.min,i=Km.max,r=this.geometry.attributes.position,s=r.array;s[0]=i.x,s[1]=i.y,s[2]=i.z,s[3]=t.x,s[4]=i.y,s[5]=i.z,s[6]=t.x,s[7]=t.y,s[8]=i.z,s[9]=i.x,s[10]=t.y,s[11]=i.z,s[12]=i.x,s[13]=i.y,s[14]=t.z,s[15]=t.x,s[16]=i.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=i.x,s[22]=t.y,s[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class uH extends uo{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new qt;s.setIndex(new _n(i,1)),s.setAttribute("position",new pt(r,3)),super(s,new ar({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class hH extends Wa{constructor(e,t=1,i=16776960){const r=i,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new qt;o.setAttribute("position",new pt(s,3)),o.computeBoundingSphere(),super(o,new ar({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],c=new qt;c.setAttribute("position",new pt(a,3)),c.computeBoundingSphere(),this.add(new Bn(c,new Ko({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const mb=new j;let Zm,K_;class fH extends an{constructor(e=new j(0,0,1),t=new j(0,0,0),i=1,r=16776960,s=i*.2,o=s*.2){super(),this.type="ArrowHelper",Zm===void 0&&(Zm=new qt,Zm.setAttribute("position",new pt([0,0,0,0,1,0],3)),K_=new fh(0,.5,1,5,1),K_.translate(0,-.5,0)),this.position.copy(t),this.line=new Wa(Zm,new ar({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Bn(K_,new Ko({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{mb.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(mb,t)}}setLength(e,t=e*.2,i=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class dH extends uo{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new qt;r.setAttribute("position",new pt(t,3)),r.setAttribute("color",new pt(i,3));const s=new ar({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,i){const r=new lt,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class pH{constructor(){this.type="ShapePath",this.color=new lt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new vd,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,o){return this.currentPath.bezierCurveTo(e,t,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(y){const w=[];for(let M=0,R=y.length;M<R;M++){const z=y[M],k=new Jl;k.curves=z.curves,w.push(k)}return w}function i(y,w){const M=w.length;let R=!1;for(let z=M-1,k=0;k<M;z=k++){let P=w[z],b=w[k],A=b.x-P.x,T=b.y-P.y;if(Math.abs(T)>Number.EPSILON){if(T<0&&(P=w[k],A=-A,b=w[z],T=-T),y.y<P.y||y.y>b.y)continue;if(y.y===P.y){if(y.x===P.x)return!0}else{const L=T*(y.x-P.x)-A*(y.y-P.y);if(L===0)return!0;if(L<0)continue;R=!R}}else{if(y.y!==P.y)continue;if(b.x<=y.x&&y.x<=P.x||P.x<=y.x&&y.x<=b.x)return!0}}return R}const r=io.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,c;const h=[];if(s.length===1)return a=s[0],c=new Jl,c.curves=a.curves,h.push(c),h;let f=!r(s[0].getPoints());f=e?!f:f;const d=[],m=[];let v=[],_=0,E;m[_]=void 0,v[_]=[];for(let y=0,w=s.length;y<w;y++)a=s[y],E=a.getPoints(),o=r(E),o=e?!o:o,o?(!f&&m[_]&&_++,m[_]={s:new Jl,p:E},m[_].s.curves=a.curves,f&&_++,v[_]=[]):v[_].push({h:a,p:E[0]});if(!m[0])return t(s);if(m.length>1){let y=!1,w=0;for(let M=0,R=m.length;M<R;M++)d[M]=[];for(let M=0,R=m.length;M<R;M++){const z=v[M];for(let k=0;k<z.length;k++){const P=z[k];let b=!0;for(let A=0;A<m.length;A++)i(P.p,m[A].p)&&(M!==A&&w++,b?(b=!1,d[A].push(P)):y=!0);b&&d[M].push(P)}}w>0&&y===!1&&(v=d)}let S;for(let y=0,w=m.length;y<w;y++){c=m[y].s,h.push(c),S=v[y];for(let M=0,R=S.length;M<R;M++)c.holes.push(S[M].h)}return h}}class mH extends co{constructor(e,t){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(){}disconnect(){}dispose(){}update(){}}class gH extends jr{constructor(e=1,t=1,i=1,r={}){console.warn('THREE.WebGLMultipleRenderTargets has been deprecated and will be removed in r172. Use THREE.WebGLRenderTarget and set the "count" parameter to enable MRT.'),super(e,t,{...r,count:i}),this.isWebGLMultipleRenderTargets=!0}get texture(){return this.textures}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:ch}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=ch);const vH=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:Bw,AddEquation:Sa,AddOperation:AR,AdditiveAnimationBlendMode:$w,AdditiveBlending:dS,AgXToneMapping:PR,AlphaFormat:Gw,AlwaysCompare:XR,AlwaysDepth:_R,AlwaysStencilFunc:yS,AmbientLight:jP,AnimationAction:QP,AnimationClip:Md,AnimationLoader:_6,AnimationMixer:X6,AnimationObjectGroup:W6,AnimationUtils:m6,ArcCurve:mP,ArrayCamera:oP,ArrowHelper:fH,AttachedBindMode:gS,Audio:ZP,AudioAnalyser:D6,AudioContext:M1,AudioListener:P6,AudioLoader:C6,AxesHelper:dH,BackSide:Hi,BasicDepthPacking:UR,BasicShadowMap:Q2,BatchedMesh:fP,Bone:c1,BooleanKeyframeTrack:gc,Box2:J6,Box3:nr,Box3Helper:uH,BoxGeometry:mc,BoxHelper:cH,BufferAttribute:_n,BufferGeometry:qt,BufferGeometryLoader:KP,ByteType:o0,Cache:ko,Camera:Hd,CameraHelper:lH,CanvasTexture:z5,CapsuleGeometry:w0,CatmullRomCurve3:gP,CineonToneMapping:IR,CircleGeometry:M0,ClampToEdgeWrapping:li,Clock:E1,Color:lt,ColorKeyframeTrack:x1,ColorManagement:hn,CompressedArrayTexture:U5,CompressedCubeTexture:F5,CompressedTexture:x0,CompressedTextureLoader:x6,ConeGeometry:E0,ConstantAlphaFactor:gR,ConstantColorFactor:pR,Controls:mH,CubeCamera:QR,CubeReflectionMapping:oo,CubeRefractionMapping:Ga,CubeTexture:Vd,CubeTextureLoader:BP,CubeUVReflectionMapping:uh,CubicBezierCurve:f1,CubicBezierCurve3:vP,CubicInterpolant:OP,CullFaceBack:fS,CullFaceFront:J2,CullFaceFrontBack:vO,CullFaceNone:Z2,Curve:Us,CurvePath:_P,CustomBlending:eR,CustomToneMapping:RR,CylinderGeometry:fh,Cylindrical:Z6,Data3DTexture:Jw,DataArrayTexture:p0,DataTexture:Ds,DataTextureLoader:S1,DataUtils:Hl,DecrementStencilOp:RO,DecrementWrapStencilOp:LO,DefaultLoadingManager:zP,DepthFormat:$l,DepthStencilFormat:oc,DepthTexture:r1,DetachedBindMode:NR,DirectionalLight:WP,DirectionalLightHelper:aH,DiscreteInterpolant:UP,DisplayP3ColorSpace:d0,DodecahedronGeometry:T0,DoubleSide:Is,DstAlphaFactor:cR,DstColorFactor:hR,DynamicCopyUsage:qO,DynamicDrawUsage:HO,DynamicReadUsage:WO,EdgesGeometry:xP,EllipseCurve:S0,EqualCompare:VR,EqualDepth:SR,EqualStencilFunc:OO,EquirectangularReflectionMapping:$u,EquirectangularRefractionMapping:od,Euler:Xr,EventDispatcher:co,ExtrudeGeometry:b0,FileLoader:Vr,Float16BufferAttribute:NU,Float32BufferAttribute:pt,FloatType:zn,Fog:v0,FogExp2:g0,FramebufferTexture:O5,FrontSide:jo,Frustum:Gd,GLBufferAttribute:K6,GLSL1:$O,GLSL3:_S,GreaterCompare:GR,GreaterDepth:MR,GreaterEqualCompare:jR,GreaterEqualDepth:wR,GreaterEqualStencilFunc:BO,GreaterStencilFunc:FO,GridHelper:sH,Group:Tu,HalfFloatType:xi,HemisphereLight:HP,HemisphereLightHelper:rH,IcosahedronGeometry:Xd,ImageBitmapLoader:b6,ImageLoader:Ed,ImageUtils:$R,IncrementStencilOp:IO,IncrementWrapStencilOp:PO,InstancedBufferAttribute:Qu,InstancedBufferGeometry:$P,InstancedInterleavedBuffer:$6,InstancedMesh:hP,Int16BufferAttribute:PU,Int32BufferAttribute:LU,Int8BufferAttribute:CU,IntType:Ud,InterleavedBuffer:y0,InterleavedBufferAttribute:ac,Interpolant:$d,InterpolateDiscrete:cd,InterpolateLinear:Tv,InterpolateSmooth:yg,InvertStencilOp:NO,KeepStencilOp:Pl,KeyframeTrack:Fs,LOD:cP,LatheGeometry:jd,Layers:Zl,LessCompare:HR,LessDepth:xR,LessEqualCompare:Kw,LessEqualDepth:sd,LessEqualStencilFunc:UO,LessStencilFunc:kO,Light:Za,LightProbe:YP,Line:Wa,Line3:Q6,LineBasicMaterial:ar,LineCurve:d1,LineCurve3:yP,LineDashedMaterial:NP,LineLoop:dP,LineSegments:uo,LinearDisplayP3ColorSpace:Bd,LinearFilter:mn,LinearInterpolant:_1,LinearMipMapLinearFilter:vS,LinearMipMapNearestFilter:xO,LinearMipmapLinearFilter:Zs,LinearMipmapNearestFilter:bf,LinearSRGBColorSpace:fs,LinearToneMapping:bR,LinearTransfer:hd,Loader:lr,LoaderUtils:bS,LoadingManager:D0,LoopOnce:DR,LoopPingPong:OR,LoopRepeat:kR,LuminanceAlphaFormat:Xw,LuminanceFormat:jw,MOUSE:Il,Material:ji,MaterialLoader:k0,MathUtils:Av,Matrix2:I1,Matrix3:Vt,Matrix4:Lt,MaxEquation:rR,Mesh:Bn,MeshBasicMaterial:Ko,MeshDepthMaterial:s1,MeshDistanceMaterial:o1,MeshLambertMaterial:PP,MeshMatcapMaterial:LP,MeshNormalMaterial:RP,MeshPhongMaterial:CP,MeshPhysicalMaterial:bP,MeshStandardMaterial:v1,MeshToonMaterial:IP,MinEquation:iR,MirroredRepeatWrapping:ld,MixOperation:TR,MultiplyBlending:mS,MultiplyOperation:Od,NearestFilter:_i,NearestMipMapLinearFilter:_O,NearestMipMapNearestFilter:yO,NearestMipmapLinearFilter:wu,NearestMipmapNearestFilter:Hw,NeutralToneMapping:LR,NeverCompare:BR,NeverDepth:yR,NeverStencilFunc:DO,NoBlending:to,NoColorSpace:Po,NoToneMapping:no,NormalAnimationBlendMode:f0,NormalBlending:Yl,NotEqualCompare:WR,NotEqualDepth:ER,NotEqualStencilFunc:zO,NumberKeyframeTrack:Sd,Object3D:an,ObjectLoader:T6,ObjectSpaceNormalMap:zR,OctahedronGeometry:qd,OneFactor:oR,OneMinusConstantAlphaFactor:vR,OneMinusConstantColorFactor:mR,OneMinusDstAlphaFactor:uR,OneMinusDstColorFactor:fR,OneMinusSrcAlphaFactor:Jg,OneMinusSrcColorFactor:lR,OrthographicCamera:Bo,P3Primaries:dd,PCFShadowMap:s0,PCFSoftShadowMap:Af,PMREMGenerator:xS,Path:vd,PerspectiveCamera:Jn,Plane:$s,PlaneGeometry:$a,PlaneHelper:hH,PointLight:GP,PointLightHelper:nH,Points:pP,PointsMaterial:u1,PolarGridHelper:oH,PolyhedronGeometry:Ka,PositionalAudio:N6,PropertyBinding:sn,PropertyMixer:JP,QuadraticBezierCurve:p1,QuadraticBezierCurve3:m1,Quaternion:Vi,QuaternionKeyframeTrack:Kd,QuaternionLinearInterpolant:FP,RED_GREEN_RGTC2_Format:Mv,RED_RGTC1_Format:Yw,REVISION:ch,RGBADepthPacking:FR,RGBAFormat:Qn,RGBAIntegerFormat:h0,RGBA_ASTC_10x10_Format:vv,RGBA_ASTC_10x5_Format:pv,RGBA_ASTC_10x6_Format:mv,RGBA_ASTC_10x8_Format:gv,RGBA_ASTC_12x10_Format:yv,RGBA_ASTC_12x12_Format:_v,RGBA_ASTC_4x4_Format:ov,RGBA_ASTC_5x4_Format:av,RGBA_ASTC_5x5_Format:lv,RGBA_ASTC_6x5_Format:cv,RGBA_ASTC_6x6_Format:uv,RGBA_ASTC_8x5_Format:hv,RGBA_ASTC_8x6_Format:fv,RGBA_ASTC_8x8_Format:dv,RGBA_BPTC_Format:Lf,RGBA_ETC2_EAC_Format:sv,RGBA_PVRTC_2BPPV1_Format:nv,RGBA_PVRTC_4BPPV1_Format:tv,RGBA_S3TC_DXT1_Format:If,RGBA_S3TC_DXT3_Format:Rf,RGBA_S3TC_DXT5_Format:Pf,RGBDepthPacking:TO,RGBFormat:Ww,RGBIntegerFormat:SO,RGB_BPTC_SIGNED_Format:xv,RGB_BPTC_UNSIGNED_Format:Sv,RGB_ETC1_Format:iv,RGB_ETC2_Format:rv,RGB_PVRTC_2BPPV1_Format:ev,RGB_PVRTC_4BPPV1_Format:Qg,RGB_S3TC_DXT1_Format:Cf,RGDepthPacking:AO,RGFormat:qw,RGIntegerFormat:u0,RawShaderMaterial:AP,Ray:pc,Raycaster:C1,Rec709Primaries:fd,RectAreaLight:XP,RedFormat:Fd,RedIntegerFormat:zd,ReinhardToneMapping:CR,RenderTarget:KR,RepeatWrapping:ad,ReplaceStencilOp:CO,ReverseSubtractEquation:nR,RingGeometry:C0,SIGNED_RED_GREEN_RGTC2_Format:Ev,SIGNED_RED_RGTC1_Format:wv,SRGBColorSpace:Ur,SRGBTransfer:Tn,Scene:Wd,ShaderChunk:jt,ShaderLib:Cs,ShaderMaterial:ir,ShadowMaterial:TP,Shape:Jl,ShapeGeometry:I0,ShapePath:pH,ShapeUtils:io,ShortType:a0,Skeleton:_0,SkeletonHelper:tH,SkinnedMesh:uP,Source:Bl,Sphere:Gi,SphereGeometry:Yd,Spherical:IS,SphericalHarmonics3:qP,SplineCurve:g1,SpotLight:VP,SpotLightHelper:eH,Sprite:lP,SpriteMaterial:l1,SrcAlphaFactor:Zg,SrcAlphaSaturateFactor:dR,SrcColorFactor:aR,StaticCopyUsage:XO,StaticDrawUsage:pd,StaticReadUsage:GO,StereoCamera:I6,StreamCopyUsage:YO,StreamDrawUsage:VO,StreamReadUsage:jO,StringKeyframeTrack:vc,SubtractEquation:tR,SubtractiveBlending:pS,TOUCH:Rl,TangentSpaceNormalMap:Ya,TetrahedronGeometry:R0,Texture:yn,TextureLoader:S6,TextureUtils:m5,TorusGeometry:P0,TorusKnotGeometry:L0,Triangle:Fr,TriangleFanDrawMode:EO,TriangleStripDrawMode:MO,TrianglesDrawMode:wO,TubeGeometry:N0,UVMapping:Va,Uint16BufferAttribute:Qw,Uint32BufferAttribute:e1,Uint8BufferAttribute:IU,Uint8ClampedBufferAttribute:RU,Uniform:b1,UniformsGroup:Y6,UniformsLib:rt,UniformsUtils:t1,UnsignedByteType:Mr,UnsignedInt248Type:sc,UnsignedInt5999Type:Vw,UnsignedIntType:ao,UnsignedShort4444Type:l0,UnsignedShort5551Type:c0,UnsignedShortType:Ku,VSMShadowMap:Ts,Vector2:Ie,Vector3:j,Vector4:pn,VectorKeyframeTrack:wd,VideoTexture:k5,WebGL3DRenderTarget:yU,WebGLArrayRenderTarget:vU,WebGLCoordinateSystem:Js,WebGLCubeRenderTarget:n1,WebGLMultipleRenderTargets:gH,WebGLRenderTarget:jr,WebGLRenderer:a1,WebGLUtils:sP,WebGPUCoordinateSystem:md,WireframeGeometry:EP,WrapAroundEnding:ud,ZeroCurvatureEnding:Fl,ZeroFactor:sR,ZeroSlopeEnding:zl,ZeroStencilOp:bO,createCanvasElement:YR},Symbol.toStringTag,{value:"Module"}));var tL={exports:{}},yc={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */yc.ConcurrentRoot=1;yc.ContinuousEventPriority=4;yc.DefaultEventPriority=16;yc.DiscreteEventPriority=1;yc.IdleEventPriority=536870912;yc.LegacyRoot=0;tL.exports=yc;var bu=tL.exports;function yH(n){let e;const t=new Set,i=(h,f)=>{const d=typeof h=="function"?h(e):h;if(d!==e){const m=e;e=f?d:Object.assign({},e,d),t.forEach(v=>v(e,m))}},r=()=>e,s=(h,f=r,d=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let m=f(e);function v(){const _=f(e);if(!d(m,_)){const E=m;h(m=_,E)}}return t.add(v),()=>t.delete(v)},c={setState:i,getState:r,subscribe:(h,f,d)=>f||d?s(h,f,d):(t.add(h),()=>t.delete(h)),destroy:()=>t.clear()};return e=n(i,r,c),c}const _H=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),gb=_H?be.useEffect:be.useLayoutEffect;function nL(n){const e=typeof n=="function"?yH(n):n,t=(i=e.getState,r=Object.is)=>{const[,s]=be.useReducer(S=>S+1,0),o=e.getState(),a=be.useRef(o),c=be.useRef(i),h=be.useRef(r),f=be.useRef(!1),d=be.useRef();d.current===void 0&&(d.current=i(o));let m,v=!1;(a.current!==o||c.current!==i||h.current!==r||f.current)&&(m=i(o),v=!r(d.current,m)),gb(()=>{v&&(d.current=m),a.current=o,c.current=i,h.current=r,f.current=!1});const _=be.useRef(o);gb(()=>{const S=()=>{try{const w=e.getState(),M=c.current(w);h.current(d.current,M)||(a.current=w,d.current=M,s())}catch{f.current=!0,s()}},y=e.subscribe(S);return e.getState()!==_.current&&S(),y},[]);const E=v?m:d.current;return be.useDebugValue(E),E};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const i=[t,e];return{next(){const r=i.length<=0;return{value:i.shift(),done:r}}}},t}const xH=n=>typeof n=="object"&&typeof n.then=="function",Gl=[];function iL(n,e,t=(i,r)=>i===r){if(n===e)return!0;if(!n||!e)return!1;const i=n.length;if(e.length!==i)return!1;for(let r=0;r<i;r++)if(!t(n[r],e[r]))return!1;return!0}function rL(n,e=null,t=!1,i={}){e===null&&(e=[n]);for(const s of Gl)if(iL(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return i.lifespan&&i.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,i.lifespan)),s.response;if(!t)throw s.promise}const r={keys:e,equal:i.equal,remove:()=>{const s=Gl.indexOf(r);s!==-1&&Gl.splice(s,1)},promise:(xH(n)?n:n(...e)).then(s=>{r.response=s,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))}).catch(s=>r.error=s)};if(Gl.push(r),!t)throw r.promise}const SH=(n,e,t)=>rL(n,e,!1,t),wH=(n,e,t)=>void rL(n,e,!0,t),MH=n=>{if(n===void 0||n.length===0)Gl.splice(0,Gl.length);else{const e=Gl.find(t=>iL(n,t.keys,t.equal));e&&e.remove()}};var sL={exports:{}},oL={exports:{}},aL={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(q,le){var ie=q.length;q.push(le);e:for(;0<ie;){var ye=ie-1>>>1,Ae=q[ye];if(0<r(Ae,le))q[ye]=le,q[ie]=Ae,ie=ye;else break e}}function t(q){return q.length===0?null:q[0]}function i(q){if(q.length===0)return null;var le=q[0],ie=q.pop();if(ie!==le){q[0]=ie;e:for(var ye=0,Ae=q.length,ze=Ae>>>1;ye<ze;){var pe=2*(ye+1)-1,De=q[pe],Oe=pe+1,He=q[Oe];if(0>r(De,ie))Oe<Ae&&0>r(He,De)?(q[ye]=He,q[Oe]=ie,ye=Oe):(q[ye]=De,q[pe]=ie,ye=pe);else if(Oe<Ae&&0>r(He,ie))q[ye]=He,q[Oe]=ie,ye=Oe;else break e}}return le}function r(q,le){var ie=q.sortIndex-le.sortIndex;return ie!==0?ie:q.id-le.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var c=[],h=[],f=1,d=null,m=3,v=!1,_=!1,E=!1,S=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(q){for(var le=t(h);le!==null;){if(le.callback===null)i(h);else if(le.startTime<=q)i(h),le.sortIndex=le.expirationTime,e(c,le);else break;le=t(h)}}function R(q){if(E=!1,M(q),!_)if(t(c)!==null)_=!0,oe(z);else{var le=t(h);le!==null&&Se(R,le.startTime-q)}}function z(q,le){_=!1,E&&(E=!1,y(b),b=-1),v=!0;var ie=m;try{for(M(le),d=t(c);d!==null&&(!(d.expirationTime>le)||q&&!L());){var ye=d.callback;if(typeof ye=="function"){d.callback=null,m=d.priorityLevel;var Ae=ye(d.expirationTime<=le);le=n.unstable_now(),typeof Ae=="function"?d.callback=Ae:d===t(c)&&i(c),M(le)}else i(c);d=t(c)}if(d!==null)var ze=!0;else{var pe=t(h);pe!==null&&Se(R,pe.startTime-le),ze=!1}return ze}finally{d=null,m=ie,v=!1}}var k=!1,P=null,b=-1,A=5,T=-1;function L(){return!(n.unstable_now()-T<A)}function H(){if(P!==null){var q=n.unstable_now();T=q;var le=!0;try{le=P(!0,q)}finally{le?U():(k=!1,P=null)}}else k=!1}var U;if(typeof w=="function")U=function(){w(H)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,fe=se.port2;se.port1.onmessage=H,U=function(){fe.postMessage(null)}}else U=function(){S(H,0)};function oe(q){P=q,k||(k=!0,U())}function Se(q,le){b=S(function(){q(n.unstable_now())},le)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(q){q.callback=null},n.unstable_continueExecution=function(){_||v||(_=!0,oe(z))},n.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<q?Math.floor(1e3/q):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(q){switch(m){case 1:case 2:case 3:var le=3;break;default:le=m}var ie=m;m=le;try{return q()}finally{m=ie}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(q,le){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var ie=m;m=q;try{return le()}finally{m=ie}},n.unstable_scheduleCallback=function(q,le,ie){var ye=n.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?ye+ie:ye):ie=ye,q){case 1:var Ae=-1;break;case 2:Ae=250;break;case 5:Ae=1073741823;break;case 4:Ae=1e4;break;default:Ae=5e3}return Ae=ie+Ae,q={id:f++,callback:le,priorityLevel:q,startTime:ie,expirationTime:Ae,sortIndex:-1},ie>ye?(q.sortIndex=ie,e(h,q),t(c)===null&&q===t(h)&&(E?(y(b),b=-1):E=!0,Se(R,ie-ye))):(q.sortIndex=Ae,e(c,q),_||v||(_=!0,oe(z))),q},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(q){var le=m;return function(){var ie=m;m=le;try{return q.apply(this,arguments)}finally{m=ie}}}})(aL);oL.exports=aL;var RS=oL.exports;/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EH=function(e){var t={},i=be,r=RS,s=Object.assign;function o(l){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+l,g=1;g<arguments.length;g++)u+="&args[]="+encodeURIComponent(arguments[g]);return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),h=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),_=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),S=Symbol.for("react.suspense"),y=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),R=Symbol.for("react.offscreen"),z=Symbol.iterator;function k(l){return l===null||typeof l!="object"?null:(l=z&&l[z]||l["@@iterator"],typeof l=="function"?l:null)}function P(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case f:return"Fragment";case h:return"Portal";case m:return"Profiler";case d:return"StrictMode";case S:return"Suspense";case y:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case _:return(l.displayName||"Context")+".Consumer";case v:return(l._context.displayName||"Context")+".Provider";case E:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case w:return u=l.displayName||null,u!==null?u:P(l.type)||"Memo";case M:u=l._payload,l=l._init;try{return P(l(u))}catch{}}return null}function b(l){var u=l.type;switch(l.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=u.render,l=l.displayName||l.name||"",u.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return P(u);case 8:return u===d?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function A(l){var u=l,g=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,u.flags&4098&&(g=u.return),l=u.return;while(l)}return u.tag===3?g:null}function T(l){if(A(l)!==l)throw Error(o(188))}function L(l){var u=l.alternate;if(!u){if(u=A(l),u===null)throw Error(o(188));return u!==l?null:l}for(var g=l,x=u;;){var C=g.return;if(C===null)break;var N=C.alternate;if(N===null){if(x=C.return,x!==null){g=x;continue}break}if(C.child===N.child){for(N=C.child;N;){if(N===g)return T(C),l;if(N===x)return T(C),u;N=N.sibling}throw Error(o(188))}if(g.return!==x.return)g=C,x=N;else{for(var J=!1,ae=C.child;ae;){if(ae===g){J=!0,g=C,x=N;break}if(ae===x){J=!0,x=C,g=N;break}ae=ae.sibling}if(!J){for(ae=N.child;ae;){if(ae===g){J=!0,g=N,x=C;break}if(ae===x){J=!0,x=N,g=C;break}ae=ae.sibling}if(!J)throw Error(o(189))}}if(g.alternate!==x)throw Error(o(190))}if(g.tag!==3)throw Error(o(188));return g.stateNode.current===g?l:u}function H(l){return l=L(l),l!==null?U(l):null}function U(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var u=U(l);if(u!==null)return u;l=l.sibling}return null}function se(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){if(l.tag!==4){var u=se(l);if(u!==null)return u}l=l.sibling}return null}var fe=Array.isArray,oe=e.getPublicInstance,Se=e.getRootHostContext,q=e.getChildHostContext,le=e.prepareForCommit,ie=e.resetAfterCommit,ye=e.createInstance,Ae=e.appendInitialChild,ze=e.finalizeInitialChildren,pe=e.prepareUpdate,De=e.shouldSetTextContent,Oe=e.createTextInstance,He=e.scheduleTimeout,ut=e.cancelTimeout,Tt=e.noTimeout,mt=e.isPrimaryRenderer,At=e.supportsMutation,X=e.supportsPersistence,Fe=e.supportsHydration,Be=e.getInstanceFromNode,Ke=e.preparePortalMount,Pe=e.getCurrentEventPriority,gt=e.detachDeletedInstance,Ze=e.supportsMicrotasks,st=e.scheduleMicrotask,Z=e.supportsTestSelectors,B=e.findFiberRoot,me=e.getBoundingRect,Re=e.getTextContent,Te=e.isHiddenSubtree,ke=e.matchAccessibilityRole,it=e.setFocusIfFocusable,Ge=e.setupIntersectionObserver,Qe=e.appendChild,bt=e.appendChildToContainer,We=e.commitTextUpdate,nt=e.commitMount,Dt=e.commitUpdate,yt=e.insertBefore,$e=e.insertInContainerBefore,wt=e.removeChild,te=e.removeChildFromContainer,Le=e.resetTextContent,Q=e.hideInstance,Ce=e.hideTextInstance,re=e.unhideInstance,Me=e.unhideTextInstance,je=e.clearContainer,Mt=e.cloneInstance,Nt=e.createContainerChildSet,$t=e.appendChildToContainerChildSet,en=e.finalizeContainerChildren,Ut=e.replaceContainerChildren,wn=e.cloneHiddenInstance,Dn=e.cloneHiddenTextInstance,xn=e.canHydrateInstance,ur=e.canHydrateTextInstance,Er=e.canHydrateSuspenseInstance,Ii=e.isSuspenseInstancePending,Bs=e.isSuspenseInstanceFallback,hr=e.registerSuspenseInstanceRetry,qn=e.getNextHydratableSibling,Ft=e.getFirstHydratableChild,po=e.getFirstHydratableChildWithinContainer,Hs=e.getFirstHydratableChildWithinSuspenseInstance,F=e.hydrateInstance,G=e.hydrateTextInstance,ne=e.hydrateSuspenseInstance,O=e.getNextHydratableInstanceAfterSuspenseInstance,W=e.commitHydratedContainer,Y=e.commitHydratedSuspenseInstance,ee=e.clearSuspenseBoundary,$=e.clearSuspenseBoundaryFromContainer,he=e.shouldDeleteUnhydratedTailInstances,de=e.didNotMatchHydratedContainerTextInstance,_e=e.didNotMatchHydratedTextInstance,ge;function et(l){if(ge===void 0)try{throw Error()}catch(g){var u=g.stack.trim().match(/\n( *(at )?)/);ge=u&&u[1]||""}return`
`+ge+l}var Ue=!1;function Ne(l,u){if(!l||Ue)return"";Ue=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(Ye){var x=Ye}Reflect.construct(l,[],u)}else{try{u.call()}catch(Ye){x=Ye}l.call(u.prototype)}else{try{throw Error()}catch(Ye){x=Ye}l()}}catch(Ye){if(Ye&&x&&typeof Ye.stack=="string"){for(var C=Ye.stack.split(`
`),N=x.stack.split(`
`),J=C.length-1,ae=N.length-1;1<=J&&0<=ae&&C[J]!==N[ae];)ae--;for(;1<=J&&0<=ae;J--,ae--)if(C[J]!==N[ae]){if(J!==1||ae!==1)do if(J--,ae--,0>ae||C[J]!==N[ae]){var Ee=`
`+C[J].replace(" at new "," at ");return l.displayName&&Ee.includes("<anonymous>")&&(Ee=Ee.replace("<anonymous>",l.displayName)),Ee}while(1<=J&&0<=ae);break}}}finally{Ue=!1,Error.prepareStackTrace=g}return(l=l?l.displayName||l.name:"")?et(l):""}var Je=Object.prototype.hasOwnProperty,ct=[],vt=-1;function Ct(l){return{current:l}}function tt(l){0>vt||(l.current=ct[vt],ct[vt]=null,vt--)}function Ve(l,u){vt++,ct[vt]=l.current,l.current=u}var xt={},dt=Ct(xt),Et=Ct(!1),Jt=xt;function ln(l,u){var g=l.type.contextTypes;if(!g)return xt;var x=l.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===u)return x.__reactInternalMemoizedMaskedChildContext;var C={},N;for(N in g)C[N]=u[N];return x&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=u,l.__reactInternalMemoizedMaskedChildContext=C),C}function Mn(l){return l=l.childContextTypes,l!=null}function Wt(){tt(Et),tt(dt)}function Ht(l,u,g){if(dt.current!==xt)throw Error(o(168));Ve(dt,u),Ve(Et,g)}function Cn(l,u,g){var x=l.stateNode;if(u=u.childContextTypes,typeof x.getChildContext!="function")return g;x=x.getChildContext();for(var C in x)if(!(C in u))throw Error(o(108,b(l)||"Unknown",C));return s({},g,x)}function Pt(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||xt,Jt=dt.current,Ve(dt,l),Ve(Et,Et.current),!0}function kt(l,u,g){var x=l.stateNode;if(!x)throw Error(o(169));g?(l=Cn(l,u,Jt),x.__reactInternalMemoizedMergedChildContext=l,tt(Et),tt(dt),Ve(dt,l)):tt(Et),Ve(Et,g)}var fn=Math.clz32?Math.clz32:Qt,wi=Math.log,pi=Math.LN2;function Qt(l){return l>>>=0,l===0?32:31-(wi(l)/pi|0)|0}var mo=64,Vs=4194304;function ms(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Sc(l,u){var g=l.pendingLanes;if(g===0)return 0;var x=0,C=l.suspendedLanes,N=l.pingedLanes,J=g&268435455;if(J!==0){var ae=J&~C;ae!==0?x=ms(ae):(N&=J,N!==0&&(x=ms(N)))}else J=g&~C,J!==0?x=ms(J):N!==0&&(x=ms(N));if(x===0)return 0;if(u!==0&&u!==x&&!(u&C)&&(C=x&-x,N=u&-u,C>=N||C===16&&(N&4194240)!==0))return u;if(x&4&&(x|=g&16),u=l.entangledLanes,u!==0)for(l=l.entanglements,u&=x;0<u;)g=31-fn(u),C=1<<g,x|=l[g],u&=~C;return x}function sp(l,u){switch(l){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function q0(l,u){for(var g=l.suspendedLanes,x=l.pingedLanes,C=l.expirationTimes,N=l.pendingLanes;0<N;){var J=31-fn(N),ae=1<<J,Ee=C[J];Ee===-1?(!(ae&g)||ae&x)&&(C[J]=sp(ae,u)):Ee<=u&&(l.expiredLanes|=ae),N&=~ae}}function ph(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function mh(l){for(var u=[],g=0;31>g;g++)u.push(l);return u}function Qa(l,u,g){l.pendingLanes|=u,u!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,u=31-fn(u),l[u]=g}function el(l,u){var g=l.pendingLanes&~u;l.pendingLanes=u,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=u,l.mutableReadLanes&=u,l.entangledLanes&=u,u=l.entanglements;var x=l.eventTimes;for(l=l.expirationTimes;0<g;){var C=31-fn(g),N=1<<C;u[C]=0,x[C]=-1,l[C]=-1,g&=~N}}function $r(l,u){var g=l.entangledLanes|=u;for(l=l.entanglements;g;){var x=31-fn(g),C=1<<x;C&u|l[x]&u&&(l[x]|=u),g&=~C}}var tn=0;function gh(l){return l&=-l,1<l?4<l?l&268435455?16:536870912:4:1}var wc=r.unstable_scheduleCallback,go=r.unstable_cancelCallback,Y0=r.unstable_shouldYield,$0=r.unstable_requestPaint,ei=r.unstable_now,Kr=r.unstable_ImmediatePriority,K0=r.unstable_UserBlockingPriority,vh=r.unstable_NormalPriority,Mc=r.unstable_IdlePriority,vo=null,Tr=null;function tl(l){if(Tr&&typeof Tr.onCommitFiberRoot=="function")try{Tr.onCommitFiberRoot(vo,l,void 0,(l.current.flags&128)===128)}catch{}}function nl(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var Ar=typeof Object.is=="function"?Object.is:nl,br=null,En=!1,yh=!1;function op(l){br===null?br=[l]:br.push(l)}function ap(l){En=!0,op(l)}function Cr(){if(!yh&&br!==null){yh=!0;var l=0,u=tn;try{var g=br;for(tn=1;l<g.length;l++){var x=g[l];do x=x(!0);while(x!==null)}br=null,En=!1}catch(C){throw br!==null&&(br=br.slice(l+1)),wc(Kr,Cr),C}finally{tn=u,yh=!1}}return null}var lp=a.ReactCurrentBatchConfig;function yo(l,u){if(Ar(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var g=Object.keys(l),x=Object.keys(u);if(g.length!==x.length)return!1;for(x=0;x<g.length;x++){var C=g[x];if(!Je.call(u,C)||!Ar(l[C],u[C]))return!1}return!0}function cp(l){switch(l.tag){case 5:return et(l.type);case 16:return et("Lazy");case 13:return et("Suspense");case 19:return et("SuspenseList");case 0:case 2:case 15:return l=Ne(l.type,!1),l;case 11:return l=Ne(l.type.render,!1),l;case 1:return l=Ne(l.type,!0),l;default:return""}}function Yn(l,u){if(l&&l.defaultProps){u=s({},u),l=l.defaultProps;for(var g in l)u[g]===void 0&&(u[g]=l[g]);return u}return u}var il=Ct(null),Ec=null,Zr=null,Tc=null;function rl(){Tc=Zr=Ec=null}function sl(l,u,g){mt?(Ve(il,u._currentValue),u._currentValue=g):(Ve(il,u._currentValue2),u._currentValue2=g)}function Ac(l){var u=il.current;tt(il),mt?l._currentValue=u:l._currentValue2=u}function Zo(l,u,g){for(;l!==null;){var x=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,x!==null&&(x.childLanes|=u)):x!==null&&(x.childLanes&u)!==u&&(x.childLanes|=u),l===g)break;l=l.return}}function Jo(l,u){Ec=l,Tc=Zr=null,l=l.dependencies,l!==null&&l.firstContext!==null&&(l.lanes&u&&(Pr=!0),l.firstContext=null)}function Xi(l){var u=mt?l._currentValue:l._currentValue2;if(Tc!==l)if(l={context:l,memoizedValue:u,next:null},Zr===null){if(Ec===null)throw Error(o(308));Zr=l,Ec.dependencies={lanes:0,firstContext:l}}else Zr=Zr.next=l;return u}var Ri=null,gs=!1;function bc(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Cc(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function Ir(l,u){return{eventTime:l,lane:u,tag:0,payload:null,callback:null,next:null}}function vs(l,u){var g=l.updateQueue;g!==null&&(g=g.shared,ri!==null&&l.mode&1&&!(Yt&2)?(l=g.interleaved,l===null?(u.next=u,Ri===null?Ri=[g]:Ri.push(g)):(u.next=l.next,l.next=u),g.interleaved=u):(l=g.pending,l===null?u.next=u:(u.next=l.next,l.next=u),g.pending=u))}function _o(l,u,g){if(u=u.updateQueue,u!==null&&(u=u.shared,(g&4194240)!==0)){var x=u.lanes;x&=l.pendingLanes,g|=x,u.lanes=g,$r(l,g)}}function _h(l,u){var g=l.updateQueue,x=l.alternate;if(x!==null&&(x=x.updateQueue,g===x)){var C=null,N=null;if(g=g.firstBaseUpdate,g!==null){do{var J={eventTime:g.eventTime,lane:g.lane,tag:g.tag,payload:g.payload,callback:g.callback,next:null};N===null?C=N=J:N=N.next=J,g=g.next}while(g!==null);N===null?C=N=u:N=N.next=u}else C=N=u;g={baseState:x.baseState,firstBaseUpdate:C,lastBaseUpdate:N,shared:x.shared,effects:x.effects},l.updateQueue=g;return}l=g.lastBaseUpdate,l===null?g.firstBaseUpdate=u:l.next=u,g.lastBaseUpdate=u}function ol(l,u,g,x){var C=l.updateQueue;gs=!1;var N=C.firstBaseUpdate,J=C.lastBaseUpdate,ae=C.shared.pending;if(ae!==null){C.shared.pending=null;var Ee=ae,Ye=Ee.next;Ee.next=null,J===null?N=Ye:J.next=Ye,J=Ee;var ft=l.alternate;ft!==null&&(ft=ft.updateQueue,ae=ft.lastBaseUpdate,ae!==J&&(ae===null?ft.firstBaseUpdate=Ye:ae.next=Ye,ft.lastBaseUpdate=Ee))}if(N!==null){var zt=C.baseState;J=0,ft=Ye=Ee=null,ae=N;do{var It=ae.lane,Sn=ae.eventTime;if((x&It)===It){ft!==null&&(ft=ft.next={eventTime:Sn,lane:0,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null});e:{var St=l,Di=ae;switch(It=u,Sn=g,Di.tag){case 1:if(St=Di.payload,typeof St=="function"){zt=St.call(Sn,zt,It);break e}zt=St;break e;case 3:St.flags=St.flags&-65537|128;case 0:if(St=Di.payload,It=typeof St=="function"?St.call(Sn,zt,It):St,It==null)break e;zt=s({},zt,It);break e;case 2:gs=!0}}ae.callback!==null&&ae.lane!==0&&(l.flags|=64,It=C.effects,It===null?C.effects=[ae]:It.push(ae))}else Sn={eventTime:Sn,lane:It,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},ft===null?(Ye=ft=Sn,Ee=zt):ft=ft.next=Sn,J|=It;if(ae=ae.next,ae===null){if(ae=C.shared.pending,ae===null)break;It=ae,ae=It.next,It.next=null,C.lastBaseUpdate=It,C.shared.pending=null}}while(!0);if(ft===null&&(Ee=zt),C.baseState=Ee,C.firstBaseUpdate=Ye,C.lastBaseUpdate=ft,u=C.shared.interleaved,u!==null){C=u;do J|=C.lane,C=C.next;while(C!==u)}else N===null&&(C.shared.lanes=0);Uc|=J,l.lanes=J,l.memoizedState=zt}}function Gs(l,u,g){if(l=u.effects,u.effects=null,l!==null)for(u=0;u<l.length;u++){var x=l[u],C=x.callback;if(C!==null){if(x.callback=null,x=g,typeof C!="function")throw Error(o(191,C));C.call(x)}}}var xh=new i.Component().refs;function Ic(l,u,g,x){u=l.memoizedState,g=g(x,u),g=g==null?u:s({},u,g),l.memoizedState=g,l.lanes===0&&(l.updateQueue.baseState=g)}var al={isMounted:function(l){return(l=l._reactInternals)?A(l)===l:!1},enqueueSetState:function(l,u,g){l=l._reactInternals;var x=$i(),C=ta(l),N=Ir(x,C);N.payload=u,g!=null&&(N.callback=g),vs(l,N),u=es(l,C,x),u!==null&&_o(u,l,C)},enqueueReplaceState:function(l,u,g){l=l._reactInternals;var x=$i(),C=ta(l),N=Ir(x,C);N.tag=1,N.payload=u,g!=null&&(N.callback=g),vs(l,N),u=es(l,C,x),u!==null&&_o(u,l,C)},enqueueForceUpdate:function(l,u){l=l._reactInternals;var g=$i(),x=ta(l),C=Ir(g,x);C.tag=2,u!=null&&(C.callback=u),vs(l,C),u=es(l,x,g),u!==null&&_o(u,l,x)}};function Sh(l,u,g,x,C,N,J){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(x,N,J):u.prototype&&u.prototype.isPureReactComponent?!yo(g,x)||!yo(C,N):!0}function qi(l,u,g){var x=!1,C=xt,N=u.contextType;return typeof N=="object"&&N!==null?N=Xi(N):(C=Mn(u)?Jt:dt.current,x=u.contextTypes,N=(x=x!=null)?ln(l,C):xt),u=new u(g,N),l.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=al,l.stateNode=u,u._reactInternals=l,x&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=C,l.__reactInternalMemoizedMaskedChildContext=N),u}function wh(l,u,g,x){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(g,x),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(g,x),u.state!==l&&al.enqueueReplaceState(u,u.state,null)}function Rc(l,u,g,x){var C=l.stateNode;C.props=g,C.state=l.memoizedState,C.refs=xh,bc(l);var N=u.contextType;typeof N=="object"&&N!==null?C.context=Xi(N):(N=Mn(u)?Jt:dt.current,C.context=ln(l,N)),C.state=l.memoizedState,N=u.getDerivedStateFromProps,typeof N=="function"&&(Ic(l,u,N,g),C.state=l.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(u=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),u!==C.state&&al.enqueueReplaceState(C,C.state,null),ol(l,g,C,x),C.state=l.memoizedState),typeof C.componentDidMount=="function"&&(l.flags|=4194308)}var Rr=[],p=0,I=null,D=0,V=[],ue=0,xe=null,qe=1,Kt="";function In(l,u){Rr[p++]=D,Rr[p++]=I,I=l,D=u}function nn(l,u,g){V[ue++]=qe,V[ue++]=Kt,V[ue++]=xe,xe=l;var x=qe;l=Kt;var C=32-fn(x)-1;x&=~(1<<C),g+=1;var N=32-fn(u)+C;if(30<N){var J=C-C%5;N=(x&(1<<J)-1).toString(32),x>>=J,C-=J,qe=1<<32-fn(u)+C|g<<C|x,Kt=N+l}else qe=1<<N|g<<C|x,Kt=l}function ti(l){l.return!==null&&(In(l,1),nn(l,1,0))}function ni(l){for(;l===I;)I=Rr[--p],Rr[p]=null,D=Rr[--p],Rr[p]=null;for(;l===xe;)xe=V[--ue],V[ue]=null,Kt=V[--ue],V[ue]=null,qe=V[--ue],V[ue]=null}var ii=null,Rn=null,gn=!1,xo=!1,ys=null;function cM(l,u){var g=ts(5,null,null,0);g.elementType="DELETED",g.stateNode=u,g.return=l,u=l.deletions,u===null?(l.deletions=[g],l.flags|=16):u.push(g)}function uM(l,u){switch(l.tag){case 5:return u=xn(u,l.type,l.pendingProps),u!==null?(l.stateNode=u,ii=l,Rn=Ft(u),!0):!1;case 6:return u=ur(u,l.pendingProps),u!==null?(l.stateNode=u,ii=l,Rn=null,!0):!1;case 13:if(u=Er(u),u!==null){var g=xe!==null?{id:qe,overflow:Kt}:null;return l.memoizedState={dehydrated:u,treeContext:g,retryLane:1073741824},g=ts(18,null,null,0),g.stateNode=u,g.return=l,l.child=g,ii=l,Rn=null,!0}return!1;default:return!1}}function Z0(l){return(l.mode&1)!==0&&(l.flags&128)===0}function J0(l){if(gn){var u=Rn;if(u){var g=u;if(!uM(l,u)){if(Z0(l))throw Error(o(418));u=qn(g);var x=ii;u&&uM(l,u)?cM(x,g):(l.flags=l.flags&-4097|2,gn=!1,ii=l)}}else{if(Z0(l))throw Error(o(418));l.flags=l.flags&-4097|2,gn=!1,ii=l}}}function hM(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;ii=l}function Mh(l){if(!Fe||l!==ii)return!1;if(!gn)return hM(l),gn=!0,!1;if(l.tag!==3&&(l.tag!==5||he(l.type)&&!De(l.type,l.memoizedProps))){var u=Rn;if(u){if(Z0(l)){for(l=Rn;l;)l=qn(l);throw Error(o(418))}for(;u;)cM(l,u),u=qn(u)}}if(hM(l),l.tag===13){if(!Fe)throw Error(o(316));if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(o(317));Rn=O(l)}else Rn=ii?qn(l.stateNode):null;return!0}function Pc(){Fe&&(Rn=ii=null,xo=gn=!1)}function Q0(l){ys===null?ys=[l]:ys.push(l)}function Eh(l,u,g){if(l=g.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(g._owner){if(g=g._owner,g){if(g.tag!==1)throw Error(o(309));var x=g.stateNode}if(!x)throw Error(o(147,l));var C=x,N=""+l;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===N?u.ref:(u=function(J){var ae=C.refs;ae===xh&&(ae=C.refs={}),J===null?delete ae[N]:ae[N]=J},u._stringRef=N,u)}if(typeof l!="string")throw Error(o(284));if(!g._owner)throw Error(o(290,l))}return l}function up(l,u){throw l=Object.prototype.toString.call(u),Error(o(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l))}function fM(l){var u=l._init;return u(l._payload)}function dM(l){function u(ve,ce){if(l){var we=ve.deletions;we===null?(ve.deletions=[ce],ve.flags|=16):we.push(ce)}}function g(ve,ce){if(!l)return null;for(;ce!==null;)u(ve,ce),ce=ce.sibling;return null}function x(ve,ce){for(ve=new Map;ce!==null;)ce.key!==null?ve.set(ce.key,ce):ve.set(ce.index,ce),ce=ce.sibling;return ve}function C(ve,ce){return ve=ia(ve,ce),ve.index=0,ve.sibling=null,ve}function N(ve,ce,we){return ve.index=we,l?(we=ve.alternate,we!==null?(we=we.index,we<ce?(ve.flags|=2,ce):we):(ve.flags|=2,ce)):(ve.flags|=1048576,ce)}function J(ve){return l&&ve.alternate===null&&(ve.flags|=2),ve}function ae(ve,ce,we,at){return ce===null||ce.tag!==6?(ce=Oy(we,ve.mode,at),ce.return=ve,ce):(ce=C(ce,we),ce.return=ve,ce)}function Ee(ve,ce,we,at){var _t=we.type;return _t===f?ft(ve,ce,we.props.children,at,we.key):ce!==null&&(ce.elementType===_t||typeof _t=="object"&&_t!==null&&_t.$$typeof===M&&fM(_t)===ce.type)?(at=C(ce,we.props),at.ref=Eh(ve,ce,we),at.return=ve,at):(at=Hp(we.type,we.key,we.props,null,ve.mode,at),at.ref=Eh(ve,ce,we),at.return=ve,at)}function Ye(ve,ce,we,at){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==we.containerInfo||ce.stateNode.implementation!==we.implementation?(ce=Uy(we,ve.mode,at),ce.return=ve,ce):(ce=C(ce,we.children||[]),ce.return=ve,ce)}function ft(ve,ce,we,at,_t){return ce===null||ce.tag!==7?(ce=pl(we,ve.mode,at,_t),ce.return=ve,ce):(ce=C(ce,we),ce.return=ve,ce)}function zt(ve,ce,we){if(typeof ce=="string"&&ce!==""||typeof ce=="number")return ce=Oy(""+ce,ve.mode,we),ce.return=ve,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case c:return we=Hp(ce.type,ce.key,ce.props,null,ve.mode,we),we.ref=Eh(ve,null,ce),we.return=ve,we;case h:return ce=Uy(ce,ve.mode,we),ce.return=ve,ce;case M:var at=ce._init;return zt(ve,at(ce._payload),we)}if(fe(ce)||k(ce))return ce=pl(ce,ve.mode,we,null),ce.return=ve,ce;up(ve,ce)}return null}function It(ve,ce,we,at){var _t=ce!==null?ce.key:null;if(typeof we=="string"&&we!==""||typeof we=="number")return _t!==null?null:ae(ve,ce,""+we,at);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case c:return we.key===_t?Ee(ve,ce,we,at):null;case h:return we.key===_t?Ye(ve,ce,we,at):null;case M:return _t=we._init,It(ve,ce,_t(we._payload),at)}if(fe(we)||k(we))return _t!==null?null:ft(ve,ce,we,at,null);up(ve,we)}return null}function Sn(ve,ce,we,at,_t){if(typeof at=="string"&&at!==""||typeof at=="number")return ve=ve.get(we)||null,ae(ce,ve,""+at,_t);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case c:return ve=ve.get(at.key===null?we:at.key)||null,Ee(ce,ve,at,_t);case h:return ve=ve.get(at.key===null?we:at.key)||null,Ye(ce,ve,at,_t);case M:var Xt=at._init;return Sn(ve,ce,we,Xt(at._payload),_t)}if(fe(at)||k(at))return ve=ve.get(we)||null,ft(ce,ve,at,_t,null);up(ce,at)}return null}function St(ve,ce,we,at){for(var _t=null,Xt=null,Bt=ce,cn=ce=0,gi=null;Bt!==null&&cn<we.length;cn++){Bt.index>cn?(gi=Bt,Bt=null):gi=Bt.sibling;var un=It(ve,Bt,we[cn],at);if(un===null){Bt===null&&(Bt=gi);break}l&&Bt&&un.alternate===null&&u(ve,Bt),ce=N(un,ce,cn),Xt===null?_t=un:Xt.sibling=un,Xt=un,Bt=gi}if(cn===we.length)return g(ve,Bt),gn&&In(ve,cn),_t;if(Bt===null){for(;cn<we.length;cn++)Bt=zt(ve,we[cn],at),Bt!==null&&(ce=N(Bt,ce,cn),Xt===null?_t=Bt:Xt.sibling=Bt,Xt=Bt);return gn&&In(ve,cn),_t}for(Bt=x(ve,Bt);cn<we.length;cn++)gi=Sn(Bt,ve,cn,we[cn],at),gi!==null&&(l&&gi.alternate!==null&&Bt.delete(gi.key===null?cn:gi.key),ce=N(gi,ce,cn),Xt===null?_t=gi:Xt.sibling=gi,Xt=gi);return l&&Bt.forEach(function(ra){return u(ve,ra)}),gn&&In(ve,cn),_t}function Di(ve,ce,we,at){var _t=k(we);if(typeof _t!="function")throw Error(o(150));if(we=_t.call(we),we==null)throw Error(o(151));for(var Xt=_t=null,Bt=ce,cn=ce=0,gi=null,un=we.next();Bt!==null&&!un.done;cn++,un=we.next()){Bt.index>cn?(gi=Bt,Bt=null):gi=Bt.sibling;var ra=It(ve,Bt,un.value,at);if(ra===null){Bt===null&&(Bt=gi);break}l&&Bt&&ra.alternate===null&&u(ve,Bt),ce=N(ra,ce,cn),Xt===null?_t=ra:Xt.sibling=ra,Xt=ra,Bt=gi}if(un.done)return g(ve,Bt),gn&&In(ve,cn),_t;if(Bt===null){for(;!un.done;cn++,un=we.next())un=zt(ve,un.value,at),un!==null&&(ce=N(un,ce,cn),Xt===null?_t=un:Xt.sibling=un,Xt=un);return gn&&In(ve,cn),_t}for(Bt=x(ve,Bt);!un.done;cn++,un=we.next())un=Sn(Bt,ve,cn,un.value,at),un!==null&&(l&&un.alternate!==null&&Bt.delete(un.key===null?cn:un.key),ce=N(un,ce,cn),Xt===null?_t=un:Xt.sibling=un,Xt=un);return l&&Bt.forEach(function(GN){return u(ve,GN)}),gn&&In(ve,cn),_t}function ns(ve,ce,we,at){if(typeof we=="object"&&we!==null&&we.type===f&&we.key===null&&(we=we.props.children),typeof we=="object"&&we!==null){switch(we.$$typeof){case c:e:{for(var _t=we.key,Xt=ce;Xt!==null;){if(Xt.key===_t){if(_t=we.type,_t===f){if(Xt.tag===7){g(ve,Xt.sibling),ce=C(Xt,we.props.children),ce.return=ve,ve=ce;break e}}else if(Xt.elementType===_t||typeof _t=="object"&&_t!==null&&_t.$$typeof===M&&fM(_t)===Xt.type){g(ve,Xt.sibling),ce=C(Xt,we.props),ce.ref=Eh(ve,Xt,we),ce.return=ve,ve=ce;break e}g(ve,Xt);break}else u(ve,Xt);Xt=Xt.sibling}we.type===f?(ce=pl(we.props.children,ve.mode,at,we.key),ce.return=ve,ve=ce):(at=Hp(we.type,we.key,we.props,null,ve.mode,at),at.ref=Eh(ve,ce,we),at.return=ve,ve=at)}return J(ve);case h:e:{for(Xt=we.key;ce!==null;){if(ce.key===Xt)if(ce.tag===4&&ce.stateNode.containerInfo===we.containerInfo&&ce.stateNode.implementation===we.implementation){g(ve,ce.sibling),ce=C(ce,we.children||[]),ce.return=ve,ve=ce;break e}else{g(ve,ce);break}else u(ve,ce);ce=ce.sibling}ce=Uy(we,ve.mode,at),ce.return=ve,ve=ce}return J(ve);case M:return Xt=we._init,ns(ve,ce,Xt(we._payload),at)}if(fe(we))return St(ve,ce,we,at);if(k(we))return Di(ve,ce,we,at);up(ve,we)}return typeof we=="string"&&we!==""||typeof we=="number"?(we=""+we,ce!==null&&ce.tag===6?(g(ve,ce.sibling),ce=C(ce,we),ce.return=ve,ve=ce):(g(ve,ce),ce=Oy(we,ve.mode,at),ce.return=ve,ve=ce),J(ve)):g(ve,ce)}return ns}var Lc=dM(!0),pM=dM(!1),Th={},Jr=Ct(Th),Ah=Ct(Th),Nc=Ct(Th);function Ws(l){if(l===Th)throw Error(o(174));return l}function ey(l,u){Ve(Nc,u),Ve(Ah,l),Ve(Jr,Th),l=Se(u),tt(Jr),Ve(Jr,l)}function Dc(){tt(Jr),tt(Ah),tt(Nc)}function mM(l){var u=Ws(Nc.current),g=Ws(Jr.current);u=q(g,l.type,u),g!==u&&(Ve(Ah,l),Ve(Jr,u))}function ty(l){Ah.current===l&&(tt(Jr),tt(Ah))}var On=Ct(0);function hp(l){for(var u=l;u!==null;){if(u.tag===13){var g=u.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||Ii(g)||Bs(g)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if(u.flags&128)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var ny=[];function iy(){for(var l=0;l<ny.length;l++){var u=ny[l];mt?u._workInProgressVersionPrimary=null:u._workInProgressVersionSecondary=null}ny.length=0}var fp=a.ReactCurrentDispatcher,Qr=a.ReactCurrentBatchConfig,kc=0,Gn=null,Pi=null,mi=null,dp=!1,bh=!1,Ch=0,pN=0;function Li(){throw Error(o(321))}function ry(l,u){if(u===null)return!1;for(var g=0;g<u.length&&g<l.length;g++)if(!Ar(l[g],u[g]))return!1;return!0}function sy(l,u,g,x,C,N){if(kc=N,Gn=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,fp.current=l===null||l.memoizedState===null?yN:_N,l=g(x,C),bh){N=0;do{if(bh=!1,Ch=0,25<=N)throw Error(o(301));N+=1,mi=Pi=null,u.updateQueue=null,fp.current=xN,l=g(x,C)}while(bh)}if(fp.current=yp,u=Pi!==null&&Pi.next!==null,kc=0,mi=Pi=Gn=null,dp=!1,u)throw Error(o(300));return l}function oy(){var l=Ch!==0;return Ch=0,l}function So(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mi===null?Gn.memoizedState=mi=l:mi=mi.next=l,mi}function js(){if(Pi===null){var l=Gn.alternate;l=l!==null?l.memoizedState:null}else l=Pi.next;var u=mi===null?Gn.memoizedState:mi.next;if(u!==null)mi=u,Pi=l;else{if(l===null)throw Error(o(310));Pi=l,l={memoizedState:Pi.memoizedState,baseState:Pi.baseState,baseQueue:Pi.baseQueue,queue:Pi.queue,next:null},mi===null?Gn.memoizedState=mi=l:mi=mi.next=l}return mi}function ll(l,u){return typeof u=="function"?u(l):u}function pp(l){var u=js(),g=u.queue;if(g===null)throw Error(o(311));g.lastRenderedReducer=l;var x=Pi,C=x.baseQueue,N=g.pending;if(N!==null){if(C!==null){var J=C.next;C.next=N.next,N.next=J}x.baseQueue=C=N,g.pending=null}if(C!==null){N=C.next,x=x.baseState;var ae=J=null,Ee=null,Ye=N;do{var ft=Ye.lane;if((kc&ft)===ft)Ee!==null&&(Ee=Ee.next={lane:0,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null}),x=Ye.hasEagerState?Ye.eagerState:l(x,Ye.action);else{var zt={lane:ft,action:Ye.action,hasEagerState:Ye.hasEagerState,eagerState:Ye.eagerState,next:null};Ee===null?(ae=Ee=zt,J=x):Ee=Ee.next=zt,Gn.lanes|=ft,Uc|=ft}Ye=Ye.next}while(Ye!==null&&Ye!==N);Ee===null?J=x:Ee.next=ae,Ar(x,u.memoizedState)||(Pr=!0),u.memoizedState=x,u.baseState=J,u.baseQueue=Ee,g.lastRenderedState=x}if(l=g.interleaved,l!==null){C=l;do N=C.lane,Gn.lanes|=N,Uc|=N,C=C.next;while(C!==l)}else C===null&&(g.lanes=0);return[u.memoizedState,g.dispatch]}function mp(l){var u=js(),g=u.queue;if(g===null)throw Error(o(311));g.lastRenderedReducer=l;var x=g.dispatch,C=g.pending,N=u.memoizedState;if(C!==null){g.pending=null;var J=C=C.next;do N=l(N,J.action),J=J.next;while(J!==C);Ar(N,u.memoizedState)||(Pr=!0),u.memoizedState=N,u.baseQueue===null&&(u.baseState=N),g.lastRenderedState=N}return[N,x]}function gM(){}function vM(l,u){var g=Gn,x=js(),C=u(),N=!Ar(x.memoizedState,C);if(N&&(x.memoizedState=C,Pr=!0),x=x.queue,Rh(xM.bind(null,g,x,l),[l]),x.getSnapshot!==u||N||mi!==null&&mi.memoizedState.tag&1){if(g.flags|=2048,Ih(9,_M.bind(null,g,x,C,u),void 0,null),ri===null)throw Error(o(349));kc&30||yM(g,u,C)}return C}function yM(l,u,g){l.flags|=16384,l={getSnapshot:u,value:g},u=Gn.updateQueue,u===null?(u={lastEffect:null,stores:null},Gn.updateQueue=u,u.stores=[l]):(g=u.stores,g===null?u.stores=[l]:g.push(l))}function _M(l,u,g,x){u.value=g,u.getSnapshot=x,SM(u)&&es(l,1,-1)}function xM(l,u,g){return g(function(){SM(u)&&es(l,1,-1)})}function SM(l){var u=l.getSnapshot;l=l.value;try{var g=u();return!Ar(l,g)}catch{return!0}}function ay(l){var u=So();return typeof l=="function"&&(l=l()),u.memoizedState=u.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ll,lastRenderedState:l},u.queue=l,l=l.dispatch=vN.bind(null,Gn,l),[u.memoizedState,l]}function Ih(l,u,g,x){return l={tag:l,create:u,destroy:g,deps:x,next:null},u=Gn.updateQueue,u===null?(u={lastEffect:null,stores:null},Gn.updateQueue=u,u.lastEffect=l.next=l):(g=u.lastEffect,g===null?u.lastEffect=l.next=l:(x=g.next,g.next=l,l.next=x,u.lastEffect=l)),l}function wM(){return js().memoizedState}function gp(l,u,g,x){var C=So();Gn.flags|=l,C.memoizedState=Ih(1|u,g,void 0,x===void 0?null:x)}function vp(l,u,g,x){var C=js();x=x===void 0?null:x;var N=void 0;if(Pi!==null){var J=Pi.memoizedState;if(N=J.destroy,x!==null&&ry(x,J.deps)){C.memoizedState=Ih(u,g,N,x);return}}Gn.flags|=l,C.memoizedState=Ih(1|u,g,N,x)}function ly(l,u){return gp(8390656,8,l,u)}function Rh(l,u){return vp(2048,8,l,u)}function MM(l,u){return vp(4,2,l,u)}function EM(l,u){return vp(4,4,l,u)}function TM(l,u){if(typeof u=="function")return l=l(),u(l),function(){u(null)};if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function AM(l,u,g){return g=g!=null?g.concat([l]):null,vp(4,4,TM.bind(null,u,l),g)}function cy(){}function bM(l,u){var g=js();u=u===void 0?null:u;var x=g.memoizedState;return x!==null&&u!==null&&ry(u,x[1])?x[0]:(g.memoizedState=[l,u],l)}function CM(l,u){var g=js();u=u===void 0?null:u;var x=g.memoizedState;return x!==null&&u!==null&&ry(u,x[1])?x[0]:(l=l(),g.memoizedState=[l,u],l)}function mN(l,u){var g=tn;tn=g!==0&&4>g?g:4,l(!0);var x=Qr.transition;Qr.transition={};try{l(!1),u()}finally{tn=g,Qr.transition=x}}function IM(){return js().memoizedState}function gN(l,u,g){var x=ta(l);g={lane:x,action:g,hasEagerState:!1,eagerState:null,next:null},RM(l)?PM(u,g):(LM(l,u,g),g=$i(),l=es(l,x,g),l!==null&&NM(l,u,x))}function vN(l,u,g){var x=ta(l),C={lane:x,action:g,hasEagerState:!1,eagerState:null,next:null};if(RM(l))PM(u,C);else{LM(l,u,C);var N=l.alternate;if(l.lanes===0&&(N===null||N.lanes===0)&&(N=u.lastRenderedReducer,N!==null))try{var J=u.lastRenderedState,ae=N(J,g);if(C.hasEagerState=!0,C.eagerState=ae,Ar(ae,J))return}catch{}finally{}g=$i(),l=es(l,x,g),l!==null&&NM(l,u,x)}}function RM(l){var u=l.alternate;return l===Gn||u!==null&&u===Gn}function PM(l,u){bh=dp=!0;var g=l.pending;g===null?u.next=u:(u.next=g.next,g.next=u),l.pending=u}function LM(l,u,g){ri!==null&&l.mode&1&&!(Yt&2)?(l=u.interleaved,l===null?(g.next=g,Ri===null?Ri=[u]:Ri.push(u)):(g.next=l.next,l.next=g),u.interleaved=g):(l=u.pending,l===null?g.next=g:(g.next=l.next,l.next=g),u.pending=g)}function NM(l,u,g){if(g&4194240){var x=u.lanes;x&=l.pendingLanes,g|=x,u.lanes=g,$r(l,g)}}var yp={readContext:Xi,useCallback:Li,useContext:Li,useEffect:Li,useImperativeHandle:Li,useInsertionEffect:Li,useLayoutEffect:Li,useMemo:Li,useReducer:Li,useRef:Li,useState:Li,useDebugValue:Li,useDeferredValue:Li,useTransition:Li,useMutableSource:Li,useSyncExternalStore:Li,useId:Li,unstable_isNewReconciler:!1},yN={readContext:Xi,useCallback:function(l,u){return So().memoizedState=[l,u===void 0?null:u],l},useContext:Xi,useEffect:ly,useImperativeHandle:function(l,u,g){return g=g!=null?g.concat([l]):null,gp(4194308,4,TM.bind(null,u,l),g)},useLayoutEffect:function(l,u){return gp(4194308,4,l,u)},useInsertionEffect:function(l,u){return gp(4,2,l,u)},useMemo:function(l,u){var g=So();return u=u===void 0?null:u,l=l(),g.memoizedState=[l,u],l},useReducer:function(l,u,g){var x=So();return u=g!==void 0?g(u):u,x.memoizedState=x.baseState=u,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:u},x.queue=l,l=l.dispatch=gN.bind(null,Gn,l),[x.memoizedState,l]},useRef:function(l){var u=So();return l={current:l},u.memoizedState=l},useState:ay,useDebugValue:cy,useDeferredValue:function(l){var u=ay(l),g=u[0],x=u[1];return ly(function(){var C=Qr.transition;Qr.transition={};try{x(l)}finally{Qr.transition=C}},[l]),g},useTransition:function(){var l=ay(!1),u=l[0];return l=mN.bind(null,l[1]),So().memoizedState=l,[u,l]},useMutableSource:function(){},useSyncExternalStore:function(l,u,g){var x=Gn,C=So();if(gn){if(g===void 0)throw Error(o(407));g=g()}else{if(g=u(),ri===null)throw Error(o(349));kc&30||yM(x,u,g)}C.memoizedState=g;var N={value:g,getSnapshot:u};return C.queue=N,ly(xM.bind(null,x,N,l),[l]),x.flags|=2048,Ih(9,_M.bind(null,x,N,g,u),void 0,null),g},useId:function(){var l=So(),u=ri.identifierPrefix;if(gn){var g=Kt,x=qe;g=(x&~(1<<32-fn(x)-1)).toString(32)+g,u=":"+u+"R"+g,g=Ch++,0<g&&(u+="H"+g.toString(32)),u+=":"}else g=pN++,u=":"+u+"r"+g.toString(32)+":";return l.memoizedState=u},unstable_isNewReconciler:!1},_N={readContext:Xi,useCallback:bM,useContext:Xi,useEffect:Rh,useImperativeHandle:AM,useInsertionEffect:MM,useLayoutEffect:EM,useMemo:CM,useReducer:pp,useRef:wM,useState:function(){return pp(ll)},useDebugValue:cy,useDeferredValue:function(l){var u=pp(ll),g=u[0],x=u[1];return Rh(function(){var C=Qr.transition;Qr.transition={};try{x(l)}finally{Qr.transition=C}},[l]),g},useTransition:function(){var l=pp(ll)[0],u=js().memoizedState;return[l,u]},useMutableSource:gM,useSyncExternalStore:vM,useId:IM,unstable_isNewReconciler:!1},xN={readContext:Xi,useCallback:bM,useContext:Xi,useEffect:Rh,useImperativeHandle:AM,useInsertionEffect:MM,useLayoutEffect:EM,useMemo:CM,useReducer:mp,useRef:wM,useState:function(){return mp(ll)},useDebugValue:cy,useDeferredValue:function(l){var u=mp(ll),g=u[0],x=u[1];return Rh(function(){var C=Qr.transition;Qr.transition={};try{x(l)}finally{Qr.transition=C}},[l]),g},useTransition:function(){var l=mp(ll)[0],u=js().memoizedState;return[l,u]},useMutableSource:gM,useSyncExternalStore:vM,useId:IM,unstable_isNewReconciler:!1};function uy(l,u){try{var g="",x=u;do g+=cp(x),x=x.return;while(x);var C=g}catch(N){C=`
Error generating stack: `+N.message+`
`+N.stack}return{value:l,source:u,stack:C}}function hy(l,u){try{console.error(u.value)}catch(g){setTimeout(function(){throw g})}}var SN=typeof WeakMap=="function"?WeakMap:Map;function DM(l,u,g){g=Ir(-1,g),g.tag=3,g.payload={element:null};var x=u.value;return g.callback=function(){Dp||(Dp=!0,Iy=x),hy(l,u)},g}function kM(l,u,g){g=Ir(-1,g),g.tag=3;var x=l.type.getDerivedStateFromError;if(typeof x=="function"){var C=u.value;g.payload=function(){return x(C)},g.callback=function(){hy(l,u)}}var N=l.stateNode;return N!==null&&typeof N.componentDidCatch=="function"&&(g.callback=function(){hy(l,u),typeof x!="function"&&(Qo===null?Qo=new Set([this]):Qo.add(this));var J=u.stack;this.componentDidCatch(u.value,{componentStack:J!==null?J:""})}),g}function OM(l,u,g){var x=l.pingCache;if(x===null){x=l.pingCache=new SN;var C=new Set;x.set(u,C)}else C=x.get(u),C===void 0&&(C=new Set,x.set(u,C));C.has(g)||(C.add(g),l=kN.bind(null,l,u,g),u.then(l,l))}function UM(l){do{var u;if((u=l.tag===13)&&(u=l.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return l;l=l.return}while(l!==null);return null}function FM(l,u,g,x,C){return l.mode&1?(l.flags|=65536,l.lanes=C,l):(l===u?l.flags|=65536:(l.flags|=128,g.flags|=131072,g.flags&=-52805,g.tag===1&&(g.alternate===null?g.tag=17:(u=Ir(-1,1),u.tag=2,vs(g,u))),g.lanes|=1),l)}function Xs(l){l.flags|=4}function zM(l,u){if(l!==null&&l.child===u.child)return!0;if(u.flags&16)return!1;for(l=u.child;l!==null;){if(l.flags&12854||l.subtreeFlags&12854)return!1;l=l.sibling}return!0}var Ph,Lh,_p,xp;if(At)Ph=function(l,u){for(var g=u.child;g!==null;){if(g.tag===5||g.tag===6)Ae(l,g.stateNode);else if(g.tag!==4&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===u)break;for(;g.sibling===null;){if(g.return===null||g.return===u)return;g=g.return}g.sibling.return=g.return,g=g.sibling}},Lh=function(){},_p=function(l,u,g,x,C){if(l=l.memoizedProps,l!==x){var N=u.stateNode,J=Ws(Jr.current);g=pe(N,g,l,x,C,J),(u.updateQueue=g)&&Xs(u)}},xp=function(l,u,g,x){g!==x&&Xs(u)};else if(X){Ph=function(l,u,g,x){for(var C=u.child;C!==null;){if(C.tag===5){var N=C.stateNode;g&&x&&(N=wn(N,C.type,C.memoizedProps,C)),Ae(l,N)}else if(C.tag===6)N=C.stateNode,g&&x&&(N=Dn(N,C.memoizedProps,C)),Ae(l,N);else if(C.tag!==4){if(C.tag===22&&C.memoizedState!==null)N=C.child,N!==null&&(N.return=C),Ph(l,C,!0,!0);else if(C.child!==null){C.child.return=C,C=C.child;continue}}if(C===u)break;for(;C.sibling===null;){if(C.return===null||C.return===u)return;C=C.return}C.sibling.return=C.return,C=C.sibling}};var BM=function(l,u,g,x){for(var C=u.child;C!==null;){if(C.tag===5){var N=C.stateNode;g&&x&&(N=wn(N,C.type,C.memoizedProps,C)),$t(l,N)}else if(C.tag===6)N=C.stateNode,g&&x&&(N=Dn(N,C.memoizedProps,C)),$t(l,N);else if(C.tag!==4){if(C.tag===22&&C.memoizedState!==null)N=C.child,N!==null&&(N.return=C),BM(l,C,!0,!0);else if(C.child!==null){C.child.return=C,C=C.child;continue}}if(C===u)break;for(;C.sibling===null;){if(C.return===null||C.return===u)return;C=C.return}C.sibling.return=C.return,C=C.sibling}};Lh=function(l,u){var g=u.stateNode;if(!zM(l,u)){l=g.containerInfo;var x=Nt(l);BM(x,u,!1,!1),g.pendingChildren=x,Xs(u),en(l,x)}},_p=function(l,u,g,x,C){var N=l.stateNode,J=l.memoizedProps;if((l=zM(l,u))&&J===x)u.stateNode=N;else{var ae=u.stateNode,Ee=Ws(Jr.current),Ye=null;J!==x&&(Ye=pe(ae,g,J,x,C,Ee)),l&&Ye===null?u.stateNode=N:(N=Mt(N,Ye,g,J,x,u,l,ae),ze(N,g,x,C,Ee)&&Xs(u),u.stateNode=N,l?Xs(u):Ph(N,u,!1,!1))}},xp=function(l,u,g,x){g!==x?(l=Ws(Nc.current),g=Ws(Jr.current),u.stateNode=Oe(x,l,g,u),Xs(u)):u.stateNode=l.stateNode}}else Lh=function(){},_p=function(){},xp=function(){};function Nh(l,u){if(!gn)switch(l.tailMode){case"hidden":u=l.tail;for(var g=null;u!==null;)u.alternate!==null&&(g=u),u=u.sibling;g===null?l.tail=null:g.sibling=null;break;case"collapsed":g=l.tail;for(var x=null;g!==null;)g.alternate!==null&&(x=g),g=g.sibling;x===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:x.sibling=null}}function Ni(l){var u=l.alternate!==null&&l.alternate.child===l.child,g=0,x=0;if(u)for(var C=l.child;C!==null;)g|=C.lanes|C.childLanes,x|=C.subtreeFlags&14680064,x|=C.flags&14680064,C.return=l,C=C.sibling;else for(C=l.child;C!==null;)g|=C.lanes|C.childLanes,x|=C.subtreeFlags,x|=C.flags,C.return=l,C=C.sibling;return l.subtreeFlags|=x,l.childLanes=g,u}function wN(l,u,g){var x=u.pendingProps;switch(ni(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ni(u),null;case 1:return Mn(u.type)&&Wt(),Ni(u),null;case 3:return x=u.stateNode,Dc(),tt(Et),tt(dt),iy(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(l===null||l.child===null)&&(Mh(u)?Xs(u):l===null||l.memoizedState.isDehydrated&&!(u.flags&256)||(u.flags|=1024,ys!==null&&(Ly(ys),ys=null))),Lh(l,u),Ni(u),null;case 5:ty(u),g=Ws(Nc.current);var C=u.type;if(l!==null&&u.stateNode!=null)_p(l,u,C,x,g),l.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!x){if(u.stateNode===null)throw Error(o(166));return Ni(u),null}if(l=Ws(Jr.current),Mh(u)){if(!Fe)throw Error(o(175));l=F(u.stateNode,u.type,u.memoizedProps,g,l,u,!xo),u.updateQueue=l,l!==null&&Xs(u)}else{var N=ye(C,x,g,l,u);Ph(N,u,!1,!1),u.stateNode=N,ze(N,C,x,g,l)&&Xs(u)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return Ni(u),null;case 6:if(l&&u.stateNode!=null)xp(l,u,l.memoizedProps,x);else{if(typeof x!="string"&&u.stateNode===null)throw Error(o(166));if(l=Ws(Nc.current),g=Ws(Jr.current),Mh(u)){if(!Fe)throw Error(o(176));if(l=u.stateNode,x=u.memoizedProps,(g=G(l,x,u,!xo))&&(C=ii,C!==null))switch(N=(C.mode&1)!==0,C.tag){case 3:de(C.stateNode.containerInfo,l,x,N);break;case 5:_e(C.type,C.memoizedProps,C.stateNode,l,x,N)}g&&Xs(u)}else u.stateNode=Oe(x,l,g,u)}return Ni(u),null;case 13:if(tt(On),x=u.memoizedState,gn&&Rn!==null&&u.mode&1&&!(u.flags&128)){for(l=Rn;l;)l=qn(l);return Pc(),u.flags|=98560,u}if(x!==null&&x.dehydrated!==null){if(x=Mh(u),l===null){if(!x)throw Error(o(318));if(!Fe)throw Error(o(344));if(l=u.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(o(317));ne(l,u)}else Pc(),!(u.flags&128)&&(u.memoizedState=null),u.flags|=4;return Ni(u),null}return ys!==null&&(Ly(ys),ys=null),u.flags&128?(u.lanes=g,u):(x=x!==null,g=!1,l===null?Mh(u):g=l.memoizedState!==null,x&&!g&&(u.child.flags|=8192,u.mode&1&&(l===null||On.current&1?ci===0&&(ci=3):Dy())),u.updateQueue!==null&&(u.flags|=4),Ni(u),null);case 4:return Dc(),Lh(l,u),l===null&&Ke(u.stateNode.containerInfo),Ni(u),null;case 10:return Ac(u.type._context),Ni(u),null;case 17:return Mn(u.type)&&Wt(),Ni(u),null;case 19:if(tt(On),C=u.memoizedState,C===null)return Ni(u),null;if(x=(u.flags&128)!==0,N=C.rendering,N===null)if(x)Nh(C,!1);else{if(ci!==0||l!==null&&l.flags&128)for(l=u.child;l!==null;){if(N=hp(l),N!==null){for(u.flags|=128,Nh(C,!1),l=N.updateQueue,l!==null&&(u.updateQueue=l,u.flags|=4),u.subtreeFlags=0,l=g,x=u.child;x!==null;)g=x,C=l,g.flags&=14680066,N=g.alternate,N===null?(g.childLanes=0,g.lanes=C,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=N.childLanes,g.lanes=N.lanes,g.child=N.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=N.memoizedProps,g.memoizedState=N.memoizedState,g.updateQueue=N.updateQueue,g.type=N.type,C=N.dependencies,g.dependencies=C===null?null:{lanes:C.lanes,firstContext:C.firstContext}),x=x.sibling;return Ve(On,On.current&1|2),u.child}l=l.sibling}C.tail!==null&&ei()>Cy&&(u.flags|=128,x=!0,Nh(C,!1),u.lanes=4194304)}else{if(!x)if(l=hp(N),l!==null){if(u.flags|=128,x=!0,l=l.updateQueue,l!==null&&(u.updateQueue=l,u.flags|=4),Nh(C,!0),C.tail===null&&C.tailMode==="hidden"&&!N.alternate&&!gn)return Ni(u),null}else 2*ei()-C.renderingStartTime>Cy&&g!==1073741824&&(u.flags|=128,x=!0,Nh(C,!1),u.lanes=4194304);C.isBackwards?(N.sibling=u.child,u.child=N):(l=C.last,l!==null?l.sibling=N:u.child=N,C.last=N)}return C.tail!==null?(u=C.tail,C.rendering=u,C.tail=u.sibling,C.renderingStartTime=ei(),u.sibling=null,l=On.current,Ve(On,x?l&1|2:l&1),u):(Ni(u),null);case 22:case 23:return Ny(),x=u.memoizedState!==null,l!==null&&l.memoizedState!==null!==x&&(u.flags|=8192),x&&u.mode&1?Lr&1073741824&&(Ni(u),At&&u.subtreeFlags&6&&(u.flags|=8192)):Ni(u),null;case 24:return null;case 25:return null}throw Error(o(156,u.tag))}var MN=a.ReactCurrentOwner,Pr=!1;function Yi(l,u,g,x){u.child=l===null?pM(u,null,g,x):Lc(u,l.child,g,x)}function HM(l,u,g,x,C){g=g.render;var N=u.ref;return Jo(u,C),x=sy(l,u,g,x,N,C),g=oy(),l!==null&&!Pr?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~C,wo(l,u,C)):(gn&&g&&ti(u),u.flags|=1,Yi(l,u,x,C),u.child)}function VM(l,u,g,x,C){if(l===null){var N=g.type;return typeof N=="function"&&!ky(N)&&N.defaultProps===void 0&&g.compare===null&&g.defaultProps===void 0?(u.tag=15,u.type=N,GM(l,u,N,x,C)):(l=Hp(g.type,null,x,u,u.mode,C),l.ref=u.ref,l.return=u,u.child=l)}if(N=l.child,!(l.lanes&C)){var J=N.memoizedProps;if(g=g.compare,g=g!==null?g:yo,g(J,x)&&l.ref===u.ref)return wo(l,u,C)}return u.flags|=1,l=ia(N,x),l.ref=u.ref,l.return=u,u.child=l}function GM(l,u,g,x,C){if(l!==null&&yo(l.memoizedProps,x)&&l.ref===u.ref)if(Pr=!1,(l.lanes&C)!==0)l.flags&131072&&(Pr=!0);else return u.lanes=l.lanes,wo(l,u,C);return fy(l,u,g,x,C)}function WM(l,u,g){var x=u.pendingProps,C=x.children,N=l!==null?l.memoizedState:null;if(x.mode==="hidden")if(!(u.mode&1))u.memoizedState={baseLanes:0,cachePool:null},Ve(Oc,Lr),Lr|=g;else if(g&1073741824)u.memoizedState={baseLanes:0,cachePool:null},x=N!==null?N.baseLanes:g,Ve(Oc,Lr),Lr|=x;else return l=N!==null?N.baseLanes|g:g,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:l,cachePool:null},u.updateQueue=null,Ve(Oc,Lr),Lr|=l,null;else N!==null?(x=N.baseLanes|g,u.memoizedState=null):x=g,Ve(Oc,Lr),Lr|=x;return Yi(l,u,C,g),u.child}function jM(l,u){var g=u.ref;(l===null&&g!==null||l!==null&&l.ref!==g)&&(u.flags|=512,u.flags|=2097152)}function fy(l,u,g,x,C){var N=Mn(g)?Jt:dt.current;return N=ln(u,N),Jo(u,C),g=sy(l,u,g,x,N,C),x=oy(),l!==null&&!Pr?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~C,wo(l,u,C)):(gn&&x&&ti(u),u.flags|=1,Yi(l,u,g,C),u.child)}function XM(l,u,g,x,C){if(Mn(g)){var N=!0;Pt(u)}else N=!1;if(Jo(u,C),u.stateNode===null)l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2),qi(u,g,x),Rc(u,g,x,C),x=!0;else if(l===null){var J=u.stateNode,ae=u.memoizedProps;J.props=ae;var Ee=J.context,Ye=g.contextType;typeof Ye=="object"&&Ye!==null?Ye=Xi(Ye):(Ye=Mn(g)?Jt:dt.current,Ye=ln(u,Ye));var ft=g.getDerivedStateFromProps,zt=typeof ft=="function"||typeof J.getSnapshotBeforeUpdate=="function";zt||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(ae!==x||Ee!==Ye)&&wh(u,J,x,Ye),gs=!1;var It=u.memoizedState;J.state=It,ol(u,x,J,C),Ee=u.memoizedState,ae!==x||It!==Ee||Et.current||gs?(typeof ft=="function"&&(Ic(u,g,ft,x),Ee=u.memoizedState),(ae=gs||Sh(u,g,ae,x,It,Ee,Ye))?(zt||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount()),typeof J.componentDidMount=="function"&&(u.flags|=4194308)):(typeof J.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=x,u.memoizedState=Ee),J.props=x,J.state=Ee,J.context=Ye,x=ae):(typeof J.componentDidMount=="function"&&(u.flags|=4194308),x=!1)}else{J=u.stateNode,Cc(l,u),ae=u.memoizedProps,Ye=u.type===u.elementType?ae:Yn(u.type,ae),J.props=Ye,zt=u.pendingProps,It=J.context,Ee=g.contextType,typeof Ee=="object"&&Ee!==null?Ee=Xi(Ee):(Ee=Mn(g)?Jt:dt.current,Ee=ln(u,Ee));var Sn=g.getDerivedStateFromProps;(ft=typeof Sn=="function"||typeof J.getSnapshotBeforeUpdate=="function")||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(ae!==zt||It!==Ee)&&wh(u,J,x,Ee),gs=!1,It=u.memoizedState,J.state=It,ol(u,x,J,C);var St=u.memoizedState;ae!==zt||It!==St||Et.current||gs?(typeof Sn=="function"&&(Ic(u,g,Sn,x),St=u.memoizedState),(Ye=gs||Sh(u,g,Ye,x,It,St,Ee)||!1)?(ft||typeof J.UNSAFE_componentWillUpdate!="function"&&typeof J.componentWillUpdate!="function"||(typeof J.componentWillUpdate=="function"&&J.componentWillUpdate(x,St,Ee),typeof J.UNSAFE_componentWillUpdate=="function"&&J.UNSAFE_componentWillUpdate(x,St,Ee)),typeof J.componentDidUpdate=="function"&&(u.flags|=4),typeof J.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof J.componentDidUpdate!="function"||ae===l.memoizedProps&&It===l.memoizedState||(u.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||ae===l.memoizedProps&&It===l.memoizedState||(u.flags|=1024),u.memoizedProps=x,u.memoizedState=St),J.props=x,J.state=St,J.context=Ee,x=Ye):(typeof J.componentDidUpdate!="function"||ae===l.memoizedProps&&It===l.memoizedState||(u.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||ae===l.memoizedProps&&It===l.memoizedState||(u.flags|=1024),x=!1)}return dy(l,u,g,x,N,C)}function dy(l,u,g,x,C,N){jM(l,u);var J=(u.flags&128)!==0;if(!x&&!J)return C&&kt(u,g,!1),wo(l,u,N);x=u.stateNode,MN.current=u;var ae=J&&typeof g.getDerivedStateFromError!="function"?null:x.render();return u.flags|=1,l!==null&&J?(u.child=Lc(u,l.child,null,N),u.child=Lc(u,null,ae,N)):Yi(l,u,ae,N),u.memoizedState=x.state,C&&kt(u,g,!0),u.child}function qM(l){var u=l.stateNode;u.pendingContext?Ht(l,u.pendingContext,u.pendingContext!==u.context):u.context&&Ht(l,u.context,!1),ey(l,u.containerInfo)}function YM(l,u,g,x,C){return Pc(),Q0(C),u.flags|=256,Yi(l,u,g,x),u.child}var Sp={dehydrated:null,treeContext:null,retryLane:0};function wp(l){return{baseLanes:l,cachePool:null}}function $M(l,u,g){var x=u.pendingProps,C=On.current,N=!1,J=(u.flags&128)!==0,ae;if((ae=J)||(ae=l!==null&&l.memoizedState===null?!1:(C&2)!==0),ae?(N=!0,u.flags&=-129):(l===null||l.memoizedState!==null)&&(C|=1),Ve(On,C&1),l===null)return J0(u),l=u.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?(u.mode&1?Bs(l)?u.lanes=8:u.lanes=1073741824:u.lanes=1,null):(C=x.children,l=x.fallback,N?(x=u.mode,N=u.child,C={mode:"hidden",children:C},!(x&1)&&N!==null?(N.childLanes=0,N.pendingProps=C):N=Vp(C,x,0,null),l=pl(l,x,g,null),N.return=u,l.return=u,N.sibling=l,u.child=N,u.child.memoizedState=wp(g),u.memoizedState=Sp,l):py(u,C));if(C=l.memoizedState,C!==null){if(ae=C.dehydrated,ae!==null){if(J)return u.flags&256?(u.flags&=-257,Mp(l,u,g,Error(o(422)))):u.memoizedState!==null?(u.child=l.child,u.flags|=128,null):(N=x.fallback,C=u.mode,x=Vp({mode:"visible",children:x.children},C,0,null),N=pl(N,C,g,null),N.flags|=2,x.return=u,N.return=u,x.sibling=N,u.child=x,u.mode&1&&Lc(u,l.child,null,g),u.child.memoizedState=wp(g),u.memoizedState=Sp,N);if(!(u.mode&1))u=Mp(l,u,g,null);else if(Bs(ae))u=Mp(l,u,g,Error(o(419)));else if(x=(g&l.childLanes)!==0,Pr||x){if(x=ri,x!==null){switch(g&-g){case 4:N=2;break;case 16:N=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:N=32;break;case 536870912:N=268435456;break;default:N=0}x=N&(x.suspendedLanes|g)?0:N,x!==0&&x!==C.retryLane&&(C.retryLane=x,es(l,x,-1))}Dy(),u=Mp(l,u,g,Error(o(421)))}else Ii(ae)?(u.flags|=128,u.child=l.child,u=ON.bind(null,l),hr(ae,u),u=null):(g=C.treeContext,Fe&&(Rn=Hs(ae),ii=u,gn=!0,ys=null,xo=!1,g!==null&&(V[ue++]=qe,V[ue++]=Kt,V[ue++]=xe,qe=g.id,Kt=g.overflow,xe=u)),u=py(u,u.pendingProps.children),u.flags|=4096);return u}return N?(x=ZM(l,u,x.children,x.fallback,g),N=u.child,C=l.child.memoizedState,N.memoizedState=C===null?wp(g):{baseLanes:C.baseLanes|g,cachePool:null},N.childLanes=l.childLanes&~g,u.memoizedState=Sp,x):(g=KM(l,u,x.children,g),u.memoizedState=null,g)}return N?(x=ZM(l,u,x.children,x.fallback,g),N=u.child,C=l.child.memoizedState,N.memoizedState=C===null?wp(g):{baseLanes:C.baseLanes|g,cachePool:null},N.childLanes=l.childLanes&~g,u.memoizedState=Sp,x):(g=KM(l,u,x.children,g),u.memoizedState=null,g)}function py(l,u){return u=Vp({mode:"visible",children:u},l.mode,0,null),u.return=l,l.child=u}function KM(l,u,g,x){var C=l.child;return l=C.sibling,g=ia(C,{mode:"visible",children:g}),!(u.mode&1)&&(g.lanes=x),g.return=u,g.sibling=null,l!==null&&(x=u.deletions,x===null?(u.deletions=[l],u.flags|=16):x.push(l)),u.child=g}function ZM(l,u,g,x,C){var N=u.mode;l=l.child;var J=l.sibling,ae={mode:"hidden",children:g};return!(N&1)&&u.child!==l?(g=u.child,g.childLanes=0,g.pendingProps=ae,u.deletions=null):(g=ia(l,ae),g.subtreeFlags=l.subtreeFlags&14680064),J!==null?x=ia(J,x):(x=pl(x,N,C,null),x.flags|=2),x.return=u,g.return=u,g.sibling=x,u.child=g,x}function Mp(l,u,g,x){return x!==null&&Q0(x),Lc(u,l.child,null,g),l=py(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function JM(l,u,g){l.lanes|=u;var x=l.alternate;x!==null&&(x.lanes|=u),Zo(l.return,u,g)}function my(l,u,g,x,C){var N=l.memoizedState;N===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:x,tail:g,tailMode:C}:(N.isBackwards=u,N.rendering=null,N.renderingStartTime=0,N.last=x,N.tail=g,N.tailMode=C)}function QM(l,u,g){var x=u.pendingProps,C=x.revealOrder,N=x.tail;if(Yi(l,u,x.children,g),x=On.current,x&2)x=x&1|2,u.flags|=128;else{if(l!==null&&l.flags&128)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&JM(l,g,u);else if(l.tag===19)JM(l,g,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}x&=1}if(Ve(On,x),!(u.mode&1))u.memoizedState=null;else switch(C){case"forwards":for(g=u.child,C=null;g!==null;)l=g.alternate,l!==null&&hp(l)===null&&(C=g),g=g.sibling;g=C,g===null?(C=u.child,u.child=null):(C=g.sibling,g.sibling=null),my(u,!1,C,g,N);break;case"backwards":for(g=null,C=u.child,u.child=null;C!==null;){if(l=C.alternate,l!==null&&hp(l)===null){u.child=C;break}l=C.sibling,C.sibling=g,g=C,C=l}my(u,!0,g,null,N);break;case"together":my(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function wo(l,u,g){if(l!==null&&(u.dependencies=l.dependencies),Uc|=u.lanes,!(g&u.childLanes))return null;if(l!==null&&u.child!==l.child)throw Error(o(153));if(u.child!==null){for(l=u.child,g=ia(l,l.pendingProps),u.child=g,g.return=u;l.sibling!==null;)l=l.sibling,g=g.sibling=ia(l,l.pendingProps),g.return=u;g.sibling=null}return u.child}function EN(l,u,g){switch(u.tag){case 3:qM(u),Pc();break;case 5:mM(u);break;case 1:Mn(u.type)&&Pt(u);break;case 4:ey(u,u.stateNode.containerInfo);break;case 10:sl(u,u.type._context,u.memoizedProps.value);break;case 13:var x=u.memoizedState;if(x!==null)return x.dehydrated!==null?(Ve(On,On.current&1),u.flags|=128,null):g&u.child.childLanes?$M(l,u,g):(Ve(On,On.current&1),l=wo(l,u,g),l!==null?l.sibling:null);Ve(On,On.current&1);break;case 19:if(x=(g&u.childLanes)!==0,l.flags&128){if(x)return QM(l,u,g);u.flags|=128}var C=u.memoizedState;if(C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),Ve(On,On.current),x)break;return null;case 22:case 23:return u.lanes=0,WM(l,u,g)}return wo(l,u,g)}function TN(l,u){switch(ni(u),u.tag){case 1:return Mn(u.type)&&Wt(),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return Dc(),tt(Et),tt(dt),iy(),l=u.flags,l&65536&&!(l&128)?(u.flags=l&-65537|128,u):null;case 5:return ty(u),null;case 13:if(tt(On),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(o(340));Pc()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return tt(On),null;case 4:return Dc(),null;case 10:return Ac(u.type._context),null;case 22:case 23:return Ny(),null;case 24:return null;default:return null}}var Ep=!1,cl=!1,AN=typeof WeakSet=="function"?WeakSet:Set,ot=null;function Tp(l,u){var g=l.ref;if(g!==null)if(typeof g=="function")try{g(null)}catch(x){pr(l,u,x)}else g.current=null}function gy(l,u,g){try{g()}catch(x){pr(l,u,x)}}var eE=!1;function bN(l,u){for(le(l.containerInfo),ot=u;ot!==null;)if(l=ot,u=l.child,(l.subtreeFlags&1028)!==0&&u!==null)u.return=l,ot=u;else for(;ot!==null;){l=ot;try{var g=l.alternate;if(l.flags&1024)switch(l.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var x=g.memoizedProps,C=g.memoizedState,N=l.stateNode,J=N.getSnapshotBeforeUpdate(l.elementType===l.type?x:Yn(l.type,x),C);N.__reactInternalSnapshotBeforeUpdate=J}break;case 3:At&&je(l.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(ae){pr(l,l.return,ae)}if(u=l.sibling,u!==null){u.return=l.return,ot=u;break}ot=l.return}return g=eE,eE=!1,g}function ul(l,u,g){var x=u.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var C=x=x.next;do{if((C.tag&l)===l){var N=C.destroy;C.destroy=void 0,N!==void 0&&gy(u,g,N)}C=C.next}while(C!==x)}}function Dh(l,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var g=u=u.next;do{if((g.tag&l)===l){var x=g.create;g.destroy=x()}g=g.next}while(g!==u)}}function vy(l){var u=l.ref;if(u!==null){var g=l.stateNode;switch(l.tag){case 5:l=oe(g);break;default:l=g}typeof u=="function"?u(l):u.current=l}}function tE(l,u,g){if(Tr&&typeof Tr.onCommitFiberUnmount=="function")try{Tr.onCommitFiberUnmount(vo,u)}catch{}switch(u.tag){case 0:case 11:case 14:case 15:if(l=u.updateQueue,l!==null&&(l=l.lastEffect,l!==null)){var x=l=l.next;do{var C=x,N=C.destroy;C=C.tag,N!==void 0&&(C&2||C&4)&&gy(u,g,N),x=x.next}while(x!==l)}break;case 1:if(Tp(u,g),l=u.stateNode,typeof l.componentWillUnmount=="function")try{l.props=u.memoizedProps,l.state=u.memoizedState,l.componentWillUnmount()}catch(J){pr(u,g,J)}break;case 5:Tp(u,g);break;case 4:At?aE(l,u,g):X&&X&&(u=u.stateNode.containerInfo,g=Nt(u),Ut(u,g))}}function nE(l,u,g){for(var x=u;;)if(tE(l,x,g),x.child===null||At&&x.tag===4){if(x===u)break;for(;x.sibling===null;){if(x.return===null||x.return===u)return;x=x.return}x.sibling.return=x.return,x=x.sibling}else x.child.return=x,x=x.child}function iE(l){var u=l.alternate;u!==null&&(l.alternate=null,iE(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&gt(u)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function rE(l){return l.tag===5||l.tag===3||l.tag===4}function sE(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||rE(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function oE(l){if(At){e:{for(var u=l.return;u!==null;){if(rE(u))break e;u=u.return}throw Error(o(160))}var g=u;switch(g.tag){case 5:u=g.stateNode,g.flags&32&&(Le(u),g.flags&=-33),g=sE(l),_y(l,g,u);break;case 3:case 4:u=g.stateNode.containerInfo,g=sE(l),yy(l,g,u);break;default:throw Error(o(161))}}}function yy(l,u,g){var x=l.tag;if(x===5||x===6)l=l.stateNode,u?$e(g,l,u):bt(g,l);else if(x!==4&&(l=l.child,l!==null))for(yy(l,u,g),l=l.sibling;l!==null;)yy(l,u,g),l=l.sibling}function _y(l,u,g){var x=l.tag;if(x===5||x===6)l=l.stateNode,u?yt(g,l,u):Qe(g,l);else if(x!==4&&(l=l.child,l!==null))for(_y(l,u,g),l=l.sibling;l!==null;)_y(l,u,g),l=l.sibling}function aE(l,u,g){for(var x=u,C=!1,N,J;;){if(!C){C=x.return;e:for(;;){if(C===null)throw Error(o(160));switch(N=C.stateNode,C.tag){case 5:J=!1;break e;case 3:N=N.containerInfo,J=!0;break e;case 4:N=N.containerInfo,J=!0;break e}C=C.return}C=!0}if(x.tag===5||x.tag===6)nE(l,x,g),J?te(N,x.stateNode):wt(N,x.stateNode);else if(x.tag===18)J?$(N,x.stateNode):ee(N,x.stateNode);else if(x.tag===4){if(x.child!==null){N=x.stateNode.containerInfo,J=!0,x.child.return=x,x=x.child;continue}}else if(tE(l,x,g),x.child!==null){x.child.return=x,x=x.child;continue}if(x===u)break;for(;x.sibling===null;){if(x.return===null||x.return===u)return;x=x.return,x.tag===4&&(C=!1)}x.sibling.return=x.return,x=x.sibling}}function xy(l,u){if(At){switch(u.tag){case 0:case 11:case 14:case 15:ul(3,u,u.return),Dh(3,u),ul(5,u,u.return);return;case 1:return;case 5:var g=u.stateNode;if(g!=null){var x=u.memoizedProps;l=l!==null?l.memoizedProps:x;var C=u.type,N=u.updateQueue;u.updateQueue=null,N!==null&&Dt(g,N,C,l,x,u)}return;case 6:if(u.stateNode===null)throw Error(o(162));g=u.memoizedProps,We(u.stateNode,l!==null?l.memoizedProps:g,g);return;case 3:Fe&&l!==null&&l.memoizedState.isDehydrated&&W(u.stateNode.containerInfo);return;case 12:return;case 13:Ap(u);return;case 19:Ap(u);return;case 17:return}throw Error(o(163))}switch(u.tag){case 0:case 11:case 14:case 15:ul(3,u,u.return),Dh(3,u),ul(5,u,u.return);return;case 12:return;case 13:Ap(u);return;case 19:Ap(u);return;case 3:Fe&&l!==null&&l.memoizedState.isDehydrated&&W(u.stateNode.containerInfo);break;case 22:case 23:return}e:if(X){switch(u.tag){case 1:case 5:case 6:break e;case 3:case 4:u=u.stateNode,Ut(u.containerInfo,u.pendingChildren);break e}throw Error(o(163))}}function Ap(l){var u=l.updateQueue;if(u!==null){l.updateQueue=null;var g=l.stateNode;g===null&&(g=l.stateNode=new AN),u.forEach(function(x){var C=UN.bind(null,l,x);g.has(x)||(g.add(x),x.then(C,C))})}}function CN(l,u){for(ot=u;ot!==null;){u=ot;var g=u.deletions;if(g!==null)for(var x=0;x<g.length;x++){var C=g[x];try{var N=l;At?aE(N,C,u):nE(N,C,u);var J=C.alternate;J!==null&&(J.return=null),C.return=null}catch(_t){pr(C,u,_t)}}if(g=u.child,u.subtreeFlags&12854&&g!==null)g.return=u,ot=g;else for(;ot!==null;){u=ot;try{var ae=u.flags;if(ae&32&&At&&Le(u.stateNode),ae&512){var Ee=u.alternate;if(Ee!==null){var Ye=Ee.ref;Ye!==null&&(typeof Ye=="function"?Ye(null):Ye.current=null)}}if(ae&8192)switch(u.tag){case 13:if(u.memoizedState!==null){var ft=u.alternate;(ft===null||ft.memoizedState===null)&&(by=ei())}break;case 22:var zt=u.memoizedState!==null,It=u.alternate,Sn=It!==null&&It.memoizedState!==null;if(g=u,At){e:if(x=g,C=zt,N=null,At)for(var St=x;;){if(St.tag===5){if(N===null){N=St;var Di=St.stateNode;C?Q(Di):re(St.stateNode,St.memoizedProps)}}else if(St.tag===6){if(N===null){var ns=St.stateNode;C?Ce(ns):Me(ns,St.memoizedProps)}}else if((St.tag!==22&&St.tag!==23||St.memoizedState===null||St===x)&&St.child!==null){St.child.return=St,St=St.child;continue}if(St===x)break;for(;St.sibling===null;){if(St.return===null||St.return===x)break e;N===St&&(N=null),St=St.return}N===St&&(N=null),St.sibling.return=St.return,St=St.sibling}}if(zt&&!Sn&&g.mode&1){ot=g;for(var ve=g.child;ve!==null;){for(g=ot=ve;ot!==null;){x=ot;var ce=x.child;switch(x.tag){case 0:case 11:case 14:case 15:ul(4,x,x.return);break;case 1:Tp(x,x.return);var we=x.stateNode;if(typeof we.componentWillUnmount=="function"){var at=x.return;try{we.props=x.memoizedProps,we.state=x.memoizedState,we.componentWillUnmount()}catch(_t){pr(x,at,_t)}}break;case 5:Tp(x,x.return);break;case 22:if(x.memoizedState!==null){uE(g);continue}}ce!==null?(ce.return=x,ot=ce):uE(g)}ve=ve.sibling}}}switch(ae&4102){case 2:oE(u),u.flags&=-3;break;case 6:oE(u),u.flags&=-3,xy(u.alternate,u);break;case 4096:u.flags&=-4097;break;case 4100:u.flags&=-4097,xy(u.alternate,u);break;case 4:xy(u.alternate,u)}}catch(_t){pr(u,u.return,_t)}if(g=u.sibling,g!==null){g.return=u.return,ot=g;break}ot=u.return}}}function IN(l,u,g){ot=l,lE(l)}function lE(l,u,g){for(var x=(l.mode&1)!==0;ot!==null;){var C=ot,N=C.child;if(C.tag===22&&x){var J=C.memoizedState!==null||Ep;if(!J){var ae=C.alternate,Ee=ae!==null&&ae.memoizedState!==null||cl;ae=Ep;var Ye=cl;if(Ep=J,(cl=Ee)&&!Ye)for(ot=C;ot!==null;)J=ot,Ee=J.child,J.tag===22&&J.memoizedState!==null?hE(C):Ee!==null?(Ee.return=J,ot=Ee):hE(C);for(;N!==null;)ot=N,lE(N),N=N.sibling;ot=C,Ep=ae,cl=Ye}cE(l)}else C.subtreeFlags&8772&&N!==null?(N.return=C,ot=N):cE(l)}}function cE(l){for(;ot!==null;){var u=ot;if(u.flags&8772){var g=u.alternate;try{if(u.flags&8772)switch(u.tag){case 0:case 11:case 15:cl||Dh(5,u);break;case 1:var x=u.stateNode;if(u.flags&4&&!cl)if(g===null)x.componentDidMount();else{var C=u.elementType===u.type?g.memoizedProps:Yn(u.type,g.memoizedProps);x.componentDidUpdate(C,g.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var N=u.updateQueue;N!==null&&Gs(u,N,x);break;case 3:var J=u.updateQueue;if(J!==null){if(g=null,u.child!==null)switch(u.child.tag){case 5:g=oe(u.child.stateNode);break;case 1:g=u.child.stateNode}Gs(u,J,g)}break;case 5:var ae=u.stateNode;g===null&&u.flags&4&&nt(ae,u.type,u.memoizedProps,u);break;case 6:break;case 4:break;case 12:break;case 13:if(Fe&&u.memoizedState===null){var Ee=u.alternate;if(Ee!==null){var Ye=Ee.memoizedState;if(Ye!==null){var ft=Ye.dehydrated;ft!==null&&Y(ft)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}cl||u.flags&512&&vy(u)}catch(zt){pr(u,u.return,zt)}}if(u===l){ot=null;break}if(g=u.sibling,g!==null){g.return=u.return,ot=g;break}ot=u.return}}function uE(l){for(;ot!==null;){var u=ot;if(u===l){ot=null;break}var g=u.sibling;if(g!==null){g.return=u.return,ot=g;break}ot=u.return}}function hE(l){for(;ot!==null;){var u=ot;try{switch(u.tag){case 0:case 11:case 15:var g=u.return;try{Dh(4,u)}catch(Ee){pr(u,g,Ee)}break;case 1:var x=u.stateNode;if(typeof x.componentDidMount=="function"){var C=u.return;try{x.componentDidMount()}catch(Ee){pr(u,C,Ee)}}var N=u.return;try{vy(u)}catch(Ee){pr(u,N,Ee)}break;case 5:var J=u.return;try{vy(u)}catch(Ee){pr(u,J,Ee)}}}catch(Ee){pr(u,u.return,Ee)}if(u===l){ot=null;break}var ae=u.sibling;if(ae!==null){ae.return=u.return,ot=ae;break}ot=u.return}}var bp=0,Cp=1,Ip=2,Rp=3,Pp=4;if(typeof Symbol=="function"&&Symbol.for){var kh=Symbol.for;bp=kh("selector.component"),Cp=kh("selector.has_pseudo_class"),Ip=kh("selector.role"),Rp=kh("selector.test_id"),Pp=kh("selector.text")}function Sy(l){var u=Be(l);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(o(364));return u}if(l=B(l),l===null)throw Error(o(362));return l.stateNode.current}function wy(l,u){switch(u.$$typeof){case bp:if(l.type===u.value)return!0;break;case Cp:e:{u=u.value,l=[l,0];for(var g=0;g<l.length;){var x=l[g++],C=l[g++],N=u[C];if(x.tag!==5||!Te(x)){for(;N!=null&&wy(x,N);)C++,N=u[C];if(C===u.length){u=!0;break e}else for(x=x.child;x!==null;)l.push(x,C),x=x.sibling}}u=!1}return u;case Ip:if(l.tag===5&&ke(l.stateNode,u.value))return!0;break;case Pp:if((l.tag===5||l.tag===6)&&(l=Re(l),l!==null&&0<=l.indexOf(u.value)))return!0;break;case Rp:if(l.tag===5&&(l=l.memoizedProps["data-testname"],typeof l=="string"&&l.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function My(l){switch(l.$$typeof){case bp:return"<"+(P(l.value)||"Unknown")+">";case Cp:return":has("+(My(l)||"")+")";case Ip:return'[role="'+l.value+'"]';case Pp:return'"'+l.value+'"';case Rp:return'[data-testname="'+l.value+'"]';default:throw Error(o(365))}}function fE(l,u){var g=[];l=[l,0];for(var x=0;x<l.length;){var C=l[x++],N=l[x++],J=u[N];if(C.tag!==5||!Te(C)){for(;J!=null&&wy(C,J);)N++,J=u[N];if(N===u.length)g.push(C);else for(C=C.child;C!==null;)l.push(C,N),C=C.sibling}}return g}function Ey(l,u){if(!Z)throw Error(o(363));l=Sy(l),l=fE(l,u),u=[],l=Array.from(l);for(var g=0;g<l.length;){var x=l[g++];if(x.tag===5)Te(x)||u.push(x.stateNode);else for(x=x.child;x!==null;)l.push(x),x=x.sibling}return u}var RN=Math.ceil,Lp=a.ReactCurrentDispatcher,Ty=a.ReactCurrentOwner,$n=a.ReactCurrentBatchConfig,Yt=0,ri=null,si=null,Mi=0,Lr=0,Oc=Ct(0),ci=0,Oh=null,Uc=0,Np=0,Ay=0,Uh=null,fr=null,by=0,Cy=1/0;function Fc(){Cy=ei()+500}var Dp=!1,Iy=null,Qo=null,kp=!1,ea=null,Op=0,Fh=0,Ry=null,Up=-1,Fp=0;function $i(){return Yt&6?ei():Up!==-1?Up:Up=ei()}function ta(l){return l.mode&1?Yt&2&&Mi!==0?Mi&-Mi:lp.transition!==null?(Fp===0&&(l=mo,mo<<=1,!(mo&4194240)&&(mo=64),Fp=l),Fp):(l=tn,l!==0?l:Pe()):1}function es(l,u,g){if(50<Fh)throw Fh=0,Ry=null,Error(o(185));var x=zp(l,u);return x===null?null:(Qa(x,u,g),(!(Yt&2)||x!==ri)&&(x===ri&&(!(Yt&2)&&(Np|=u),ci===4&&na(x,Mi)),dr(x,g),u===1&&Yt===0&&!(l.mode&1)&&(Fc(),En&&Cr())),x)}function zp(l,u){l.lanes|=u;var g=l.alternate;for(g!==null&&(g.lanes|=u),g=l,l=l.return;l!==null;)l.childLanes|=u,g=l.alternate,g!==null&&(g.childLanes|=u),g=l,l=l.return;return g.tag===3?g.stateNode:null}function dr(l,u){var g=l.callbackNode;q0(l,u);var x=Sc(l,l===ri?Mi:0);if(x===0)g!==null&&go(g),l.callbackNode=null,l.callbackPriority=0;else if(u=x&-x,l.callbackPriority!==u){if(g!=null&&go(g),u===1)l.tag===0?ap(pE.bind(null,l)):op(pE.bind(null,l)),Ze?st(function(){Yt===0&&Cr()}):wc(Kr,Cr),g=null;else{switch(gh(x)){case 1:g=Kr;break;case 4:g=K0;break;case 16:g=vh;break;case 536870912:g=Mc;break;default:g=vh}g=ME(g,dE.bind(null,l))}l.callbackPriority=u,l.callbackNode=g}}function dE(l,u){if(Up=-1,Fp=0,Yt&6)throw Error(o(327));var g=l.callbackNode;if(dl()&&l.callbackNode!==g)return null;var x=Sc(l,l===ri?Mi:0);if(x===0)return null;if(x&30||x&l.expiredLanes||u)u=Bp(l,x);else{u=x;var C=Yt;Yt|=2;var N=vE();(ri!==l||Mi!==u)&&(Fc(),hl(l,u));do try{NN();break}catch(ae){gE(l,ae)}while(!0);rl(),Lp.current=N,Yt=C,si!==null?u=0:(ri=null,Mi=0,u=ci)}if(u!==0){if(u===2&&(C=ph(l),C!==0&&(x=C,u=Py(l,C))),u===1)throw g=Oh,hl(l,0),na(l,x),dr(l,ei()),g;if(u===6)na(l,x);else{if(C=l.current.alternate,!(x&30)&&!PN(C)&&(u=Bp(l,x),u===2&&(N=ph(l),N!==0&&(x=N,u=Py(l,N))),u===1))throw g=Oh,hl(l,0),na(l,x),dr(l,ei()),g;switch(l.finishedWork=C,l.finishedLanes=x,u){case 0:case 1:throw Error(o(345));case 2:fl(l,fr);break;case 3:if(na(l,x),(x&130023424)===x&&(u=by+500-ei(),10<u)){if(Sc(l,0)!==0)break;if(C=l.suspendedLanes,(C&x)!==x){$i(),l.pingedLanes|=l.suspendedLanes&C;break}l.timeoutHandle=He(fl.bind(null,l,fr),u);break}fl(l,fr);break;case 4:if(na(l,x),(x&4194240)===x)break;for(u=l.eventTimes,C=-1;0<x;){var J=31-fn(x);N=1<<J,J=u[J],J>C&&(C=J),x&=~N}if(x=C,x=ei()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*RN(x/1960))-x,10<x){l.timeoutHandle=He(fl.bind(null,l,fr),x);break}fl(l,fr);break;case 5:fl(l,fr);break;default:throw Error(o(329))}}}return dr(l,ei()),l.callbackNode===g?dE.bind(null,l):null}function Py(l,u){var g=Uh;return l.current.memoizedState.isDehydrated&&(hl(l,u).flags|=256),l=Bp(l,u),l!==2&&(u=fr,fr=g,u!==null&&Ly(u)),l}function Ly(l){fr===null?fr=l:fr.push.apply(fr,l)}function PN(l){for(var u=l;;){if(u.flags&16384){var g=u.updateQueue;if(g!==null&&(g=g.stores,g!==null))for(var x=0;x<g.length;x++){var C=g[x],N=C.getSnapshot;C=C.value;try{if(!Ar(N(),C))return!1}catch{return!1}}}if(g=u.child,u.subtreeFlags&16384&&g!==null)g.return=u,u=g;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function na(l,u){for(u&=~Ay,u&=~Np,l.suspendedLanes|=u,l.pingedLanes&=~u,l=l.expirationTimes;0<u;){var g=31-fn(u),x=1<<g;l[g]=-1,u&=~x}}function pE(l){if(Yt&6)throw Error(o(327));dl();var u=Sc(l,0);if(!(u&1))return dr(l,ei()),null;var g=Bp(l,u);if(l.tag!==0&&g===2){var x=ph(l);x!==0&&(u=x,g=Py(l,x))}if(g===1)throw g=Oh,hl(l,0),na(l,u),dr(l,ei()),g;if(g===6)throw Error(o(345));return l.finishedWork=l.current.alternate,l.finishedLanes=u,fl(l,fr),dr(l,ei()),null}function mE(l){ea!==null&&ea.tag===0&&!(Yt&6)&&dl();var u=Yt;Yt|=1;var g=$n.transition,x=tn;try{if($n.transition=null,tn=1,l)return l()}finally{tn=x,$n.transition=g,Yt=u,!(Yt&6)&&Cr()}}function Ny(){Lr=Oc.current,tt(Oc)}function hl(l,u){l.finishedWork=null,l.finishedLanes=0;var g=l.timeoutHandle;if(g!==Tt&&(l.timeoutHandle=Tt,ut(g)),si!==null)for(g=si.return;g!==null;){var x=g;switch(ni(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&Wt();break;case 3:Dc(),tt(Et),tt(dt),iy();break;case 5:ty(x);break;case 4:Dc();break;case 13:tt(On);break;case 19:tt(On);break;case 10:Ac(x.type._context);break;case 22:case 23:Ny()}g=g.return}if(ri=l,si=l=ia(l.current,null),Mi=Lr=u,ci=0,Oh=null,Ay=Np=Uc=0,fr=Uh=null,Ri!==null){for(u=0;u<Ri.length;u++)if(g=Ri[u],x=g.interleaved,x!==null){g.interleaved=null;var C=x.next,N=g.pending;if(N!==null){var J=N.next;N.next=C,x.next=J}g.pending=x}Ri=null}return l}function gE(l,u){do{var g=si;try{if(rl(),fp.current=yp,dp){for(var x=Gn.memoizedState;x!==null;){var C=x.queue;C!==null&&(C.pending=null),x=x.next}dp=!1}if(kc=0,mi=Pi=Gn=null,bh=!1,Ch=0,Ty.current=null,g===null||g.return===null){ci=1,Oh=u,si=null;break}e:{var N=l,J=g.return,ae=g,Ee=u;if(u=Mi,ae.flags|=32768,Ee!==null&&typeof Ee=="object"&&typeof Ee.then=="function"){var Ye=Ee,ft=ae,zt=ft.tag;if(!(ft.mode&1)&&(zt===0||zt===11||zt===15)){var It=ft.alternate;It?(ft.updateQueue=It.updateQueue,ft.memoizedState=It.memoizedState,ft.lanes=It.lanes):(ft.updateQueue=null,ft.memoizedState=null)}var Sn=UM(J);if(Sn!==null){Sn.flags&=-257,FM(Sn,J,ae,N,u),Sn.mode&1&&OM(N,Ye,u),u=Sn,Ee=Ye;var St=u.updateQueue;if(St===null){var Di=new Set;Di.add(Ee),u.updateQueue=Di}else St.add(Ee);break e}else{if(!(u&1)){OM(N,Ye,u),Dy();break e}Ee=Error(o(426))}}else if(gn&&ae.mode&1){var ns=UM(J);if(ns!==null){!(ns.flags&65536)&&(ns.flags|=256),FM(ns,J,ae,N,u),Q0(Ee);break e}}N=Ee,ci!==4&&(ci=2),Uh===null?Uh=[N]:Uh.push(N),Ee=uy(Ee,ae),ae=J;do{switch(ae.tag){case 3:ae.flags|=65536,u&=-u,ae.lanes|=u;var ve=DM(ae,Ee,u);_h(ae,ve);break e;case 1:N=Ee;var ce=ae.type,we=ae.stateNode;if(!(ae.flags&128)&&(typeof ce.getDerivedStateFromError=="function"||we!==null&&typeof we.componentDidCatch=="function"&&(Qo===null||!Qo.has(we)))){ae.flags|=65536,u&=-u,ae.lanes|=u;var at=kM(ae,N,u);_h(ae,at);break e}}ae=ae.return}while(ae!==null)}_E(g)}catch(_t){u=_t,si===g&&g!==null&&(si=g=g.return);continue}break}while(!0)}function vE(){var l=Lp.current;return Lp.current=yp,l===null?yp:l}function Dy(){(ci===0||ci===3||ci===2)&&(ci=4),ri===null||!(Uc&268435455)&&!(Np&268435455)||na(ri,Mi)}function Bp(l,u){var g=Yt;Yt|=2;var x=vE();ri===l&&Mi===u||hl(l,u);do try{LN();break}catch(C){gE(l,C)}while(!0);if(rl(),Yt=g,Lp.current=x,si!==null)throw Error(o(261));return ri=null,Mi=0,ci}function LN(){for(;si!==null;)yE(si)}function NN(){for(;si!==null&&!Y0();)yE(si)}function yE(l){var u=wE(l.alternate,l,Lr);l.memoizedProps=l.pendingProps,u===null?_E(l):si=u,Ty.current=null}function _E(l){var u=l;do{var g=u.alternate;if(l=u.return,u.flags&32768){if(g=TN(g,u),g!==null){g.flags&=32767,si=g;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{ci=6,si=null;return}}else if(g=wN(g,u,Lr),g!==null){si=g;return}if(u=u.sibling,u!==null){si=u;return}si=u=l}while(u!==null);ci===0&&(ci=5)}function fl(l,u){var g=tn,x=$n.transition;try{$n.transition=null,tn=1,DN(l,u,g)}finally{$n.transition=x,tn=g}return null}function DN(l,u,g){do dl();while(ea!==null);if(Yt&6)throw Error(o(327));var x=l.finishedWork,C=l.finishedLanes;if(x===null)return null;if(l.finishedWork=null,l.finishedLanes=0,x===l.current)throw Error(o(177));l.callbackNode=null,l.callbackPriority=0;var N=x.lanes|x.childLanes;if(el(l,N),l===ri&&(si=ri=null,Mi=0),!(x.subtreeFlags&2064)&&!(x.flags&2064)||kp||(kp=!0,ME(vh,function(){return dl(),null})),N=(x.flags&15990)!==0,x.subtreeFlags&15990||N){N=$n.transition,$n.transition=null;var J=tn;tn=1;var ae=Yt;Yt|=4,Ty.current=null,bN(l,x),CN(l,x),ie(l.containerInfo),l.current=x,IN(x),$0(),Yt=ae,tn=J,$n.transition=N}else l.current=x;if(kp&&(kp=!1,ea=l,Op=C),N=l.pendingLanes,N===0&&(Qo=null),tl(x.stateNode),dr(l,ei()),u!==null)for(g=l.onRecoverableError,x=0;x<u.length;x++)g(u[x]);if(Dp)throw Dp=!1,l=Iy,Iy=null,l;return Op&1&&l.tag!==0&&dl(),N=l.pendingLanes,N&1?l===Ry?Fh++:(Fh=0,Ry=l):Fh=0,Cr(),null}function dl(){if(ea!==null){var l=gh(Op),u=$n.transition,g=tn;try{if($n.transition=null,tn=16>l?16:l,ea===null)var x=!1;else{if(l=ea,ea=null,Op=0,Yt&6)throw Error(o(331));var C=Yt;for(Yt|=4,ot=l.current;ot!==null;){var N=ot,J=N.child;if(ot.flags&16){var ae=N.deletions;if(ae!==null){for(var Ee=0;Ee<ae.length;Ee++){var Ye=ae[Ee];for(ot=Ye;ot!==null;){var ft=ot;switch(ft.tag){case 0:case 11:case 15:ul(8,ft,N)}var zt=ft.child;if(zt!==null)zt.return=ft,ot=zt;else for(;ot!==null;){ft=ot;var It=ft.sibling,Sn=ft.return;if(iE(ft),ft===Ye){ot=null;break}if(It!==null){It.return=Sn,ot=It;break}ot=Sn}}}var St=N.alternate;if(St!==null){var Di=St.child;if(Di!==null){St.child=null;do{var ns=Di.sibling;Di.sibling=null,Di=ns}while(Di!==null)}}ot=N}}if(N.subtreeFlags&2064&&J!==null)J.return=N,ot=J;else e:for(;ot!==null;){if(N=ot,N.flags&2048)switch(N.tag){case 0:case 11:case 15:ul(9,N,N.return)}var ve=N.sibling;if(ve!==null){ve.return=N.return,ot=ve;break e}ot=N.return}}var ce=l.current;for(ot=ce;ot!==null;){J=ot;var we=J.child;if(J.subtreeFlags&2064&&we!==null)we.return=J,ot=we;else e:for(J=ce;ot!==null;){if(ae=ot,ae.flags&2048)try{switch(ae.tag){case 0:case 11:case 15:Dh(9,ae)}}catch(_t){pr(ae,ae.return,_t)}if(ae===J){ot=null;break e}var at=ae.sibling;if(at!==null){at.return=ae.return,ot=at;break e}ot=ae.return}}if(Yt=C,Cr(),Tr&&typeof Tr.onPostCommitFiberRoot=="function")try{Tr.onPostCommitFiberRoot(vo,l)}catch{}x=!0}return x}finally{tn=g,$n.transition=u}}return!1}function xE(l,u,g){u=uy(g,u),u=DM(l,u,1),vs(l,u),u=$i(),l=zp(l,1),l!==null&&(Qa(l,1,u),dr(l,u))}function pr(l,u,g){if(l.tag===3)xE(l,l,g);else for(;u!==null;){if(u.tag===3){xE(u,l,g);break}else if(u.tag===1){var x=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Qo===null||!Qo.has(x))){l=uy(g,l),l=kM(u,l,1),vs(u,l),l=$i(),u=zp(u,1),u!==null&&(Qa(u,1,l),dr(u,l));break}}u=u.return}}function kN(l,u,g){var x=l.pingCache;x!==null&&x.delete(u),u=$i(),l.pingedLanes|=l.suspendedLanes&g,ri===l&&(Mi&g)===g&&(ci===4||ci===3&&(Mi&130023424)===Mi&&500>ei()-by?hl(l,0):Ay|=g),dr(l,u)}function SE(l,u){u===0&&(l.mode&1?(u=Vs,Vs<<=1,!(Vs&130023424)&&(Vs=4194304)):u=1);var g=$i();l=zp(l,u),l!==null&&(Qa(l,u,g),dr(l,g))}function ON(l){var u=l.memoizedState,g=0;u!==null&&(g=u.retryLane),SE(l,g)}function UN(l,u){var g=0;switch(l.tag){case 13:var x=l.stateNode,C=l.memoizedState;C!==null&&(g=C.retryLane);break;case 19:x=l.stateNode;break;default:throw Error(o(314))}x!==null&&x.delete(u),SE(l,g)}var wE;wE=function(l,u,g){if(l!==null)if(l.memoizedProps!==u.pendingProps||Et.current)Pr=!0;else{if(!(l.lanes&g)&&!(u.flags&128))return Pr=!1,EN(l,u,g);Pr=!!(l.flags&131072)}else Pr=!1,gn&&u.flags&1048576&&nn(u,D,u.index);switch(u.lanes=0,u.tag){case 2:var x=u.type;l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2),l=u.pendingProps;var C=ln(u,dt.current);Jo(u,g),C=sy(null,u,x,l,C,g);var N=oy();return u.flags|=1,typeof C=="object"&&C!==null&&typeof C.render=="function"&&C.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,Mn(x)?(N=!0,Pt(u)):N=!1,u.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,bc(u),C.updater=al,u.stateNode=C,C._reactInternals=u,Rc(u,x,l,g),u=dy(null,u,x,!0,N,g)):(u.tag=0,gn&&N&&ti(u),Yi(null,u,C,g),u=u.child),u;case 16:x=u.elementType;e:{switch(l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2),l=u.pendingProps,C=x._init,x=C(x._payload),u.type=x,C=u.tag=zN(x),l=Yn(x,l),C){case 0:u=fy(null,u,x,l,g);break e;case 1:u=XM(null,u,x,l,g);break e;case 11:u=HM(null,u,x,l,g);break e;case 14:u=VM(null,u,x,Yn(x.type,l),g);break e}throw Error(o(306,x,""))}return u;case 0:return x=u.type,C=u.pendingProps,C=u.elementType===x?C:Yn(x,C),fy(l,u,x,C,g);case 1:return x=u.type,C=u.pendingProps,C=u.elementType===x?C:Yn(x,C),XM(l,u,x,C,g);case 3:e:{if(qM(u),l===null)throw Error(o(387));x=u.pendingProps,N=u.memoizedState,C=N.element,Cc(l,u),ol(u,x,null,g);var J=u.memoizedState;if(x=J.element,Fe&&N.isDehydrated)if(N={element:x,isDehydrated:!1,cache:J.cache,transitions:J.transitions},u.updateQueue.baseState=N,u.memoizedState=N,u.flags&256){C=Error(o(423)),u=YM(l,u,x,g,C);break e}else if(x!==C){C=Error(o(424)),u=YM(l,u,x,g,C);break e}else for(Fe&&(Rn=po(u.stateNode.containerInfo),ii=u,gn=!0,ys=null,xo=!1),g=pM(u,null,x,g),u.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(Pc(),x===C){u=wo(l,u,g);break e}Yi(l,u,x,g)}u=u.child}return u;case 5:return mM(u),l===null&&J0(u),x=u.type,C=u.pendingProps,N=l!==null?l.memoizedProps:null,J=C.children,De(x,C)?J=null:N!==null&&De(x,N)&&(u.flags|=32),jM(l,u),Yi(l,u,J,g),u.child;case 6:return l===null&&J0(u),null;case 13:return $M(l,u,g);case 4:return ey(u,u.stateNode.containerInfo),x=u.pendingProps,l===null?u.child=Lc(u,null,x,g):Yi(l,u,x,g),u.child;case 11:return x=u.type,C=u.pendingProps,C=u.elementType===x?C:Yn(x,C),HM(l,u,x,C,g);case 7:return Yi(l,u,u.pendingProps,g),u.child;case 8:return Yi(l,u,u.pendingProps.children,g),u.child;case 12:return Yi(l,u,u.pendingProps.children,g),u.child;case 10:e:{if(x=u.type._context,C=u.pendingProps,N=u.memoizedProps,J=C.value,sl(u,x,J),N!==null)if(Ar(N.value,J)){if(N.children===C.children&&!Et.current){u=wo(l,u,g);break e}}else for(N=u.child,N!==null&&(N.return=u);N!==null;){var ae=N.dependencies;if(ae!==null){J=N.child;for(var Ee=ae.firstContext;Ee!==null;){if(Ee.context===x){if(N.tag===1){Ee=Ir(-1,g&-g),Ee.tag=2;var Ye=N.updateQueue;if(Ye!==null){Ye=Ye.shared;var ft=Ye.pending;ft===null?Ee.next=Ee:(Ee.next=ft.next,ft.next=Ee),Ye.pending=Ee}}N.lanes|=g,Ee=N.alternate,Ee!==null&&(Ee.lanes|=g),Zo(N.return,g,u),ae.lanes|=g;break}Ee=Ee.next}}else if(N.tag===10)J=N.type===u.type?null:N.child;else if(N.tag===18){if(J=N.return,J===null)throw Error(o(341));J.lanes|=g,ae=J.alternate,ae!==null&&(ae.lanes|=g),Zo(J,g,u),J=N.sibling}else J=N.child;if(J!==null)J.return=N;else for(J=N;J!==null;){if(J===u){J=null;break}if(N=J.sibling,N!==null){N.return=J.return,J=N;break}J=J.return}N=J}Yi(l,u,C.children,g),u=u.child}return u;case 9:return C=u.type,x=u.pendingProps.children,Jo(u,g),C=Xi(C),x=x(C),u.flags|=1,Yi(l,u,x,g),u.child;case 14:return x=u.type,C=Yn(x,u.pendingProps),C=Yn(x.type,C),VM(l,u,x,C,g);case 15:return GM(l,u,u.type,u.pendingProps,g);case 17:return x=u.type,C=u.pendingProps,C=u.elementType===x?C:Yn(x,C),l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2),u.tag=1,Mn(x)?(l=!0,Pt(u)):l=!1,Jo(u,g),qi(u,x,C),Rc(u,x,C,g),dy(null,u,x,!0,l,g);case 19:return QM(l,u,g);case 22:return WM(l,u,g)}throw Error(o(156,u.tag))};function ME(l,u){return wc(l,u)}function FN(l,u,g,x){this.tag=l,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ts(l,u,g,x){return new FN(l,u,g,x)}function ky(l){return l=l.prototype,!(!l||!l.isReactComponent)}function zN(l){if(typeof l=="function")return ky(l)?1:0;if(l!=null){if(l=l.$$typeof,l===E)return 11;if(l===w)return 14}return 2}function ia(l,u){var g=l.alternate;return g===null?(g=ts(l.tag,u,l.key,l.mode),g.elementType=l.elementType,g.type=l.type,g.stateNode=l.stateNode,g.alternate=l,l.alternate=g):(g.pendingProps=u,g.type=l.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=l.flags&14680064,g.childLanes=l.childLanes,g.lanes=l.lanes,g.child=l.child,g.memoizedProps=l.memoizedProps,g.memoizedState=l.memoizedState,g.updateQueue=l.updateQueue,u=l.dependencies,g.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},g.sibling=l.sibling,g.index=l.index,g.ref=l.ref,g}function Hp(l,u,g,x,C,N){var J=2;if(x=l,typeof l=="function")ky(l)&&(J=1);else if(typeof l=="string")J=5;else e:switch(l){case f:return pl(g.children,C,N,u);case d:J=8,C|=8;break;case m:return l=ts(12,g,u,C|2),l.elementType=m,l.lanes=N,l;case S:return l=ts(13,g,u,C),l.elementType=S,l.lanes=N,l;case y:return l=ts(19,g,u,C),l.elementType=y,l.lanes=N,l;case R:return Vp(g,C,N,u);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case v:J=10;break e;case _:J=9;break e;case E:J=11;break e;case w:J=14;break e;case M:J=16,x=null;break e}throw Error(o(130,l==null?l:typeof l,""))}return u=ts(J,g,u,C),u.elementType=l,u.type=x,u.lanes=N,u}function pl(l,u,g,x){return l=ts(7,l,x,u),l.lanes=g,l}function Vp(l,u,g,x){return l=ts(22,l,x,u),l.elementType=R,l.lanes=g,l.stateNode={},l}function Oy(l,u,g){return l=ts(6,l,null,u),l.lanes=g,l}function Uy(l,u,g){return u=ts(4,l.children!==null?l.children:[],l.key,u),u.lanes=g,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}function BN(l,u,g,x,C){this.tag=u,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Tt,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mh(0),this.expirationTimes=mh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mh(0),this.identifierPrefix=x,this.onRecoverableError=C,Fe&&(this.mutableSourceEagerHydrationData=null)}function EE(l,u,g,x,C,N,J,ae,Ee){return l=new BN(l,u,g,ae,Ee),u===1?(u=1,N===!0&&(u|=8)):u=0,N=ts(3,null,null,u),l.current=N,N.stateNode=l,N.memoizedState={element:x,isDehydrated:g,cache:null,transitions:null},bc(N),l}function TE(l){if(!l)return xt;l=l._reactInternals;e:{if(A(l)!==l||l.tag!==1)throw Error(o(170));var u=l;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(Mn(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(o(171))}if(l.tag===1){var g=l.type;if(Mn(g))return Cn(l,g,u)}return u}function AE(l){var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(o(188)):(l=Object.keys(l).join(","),Error(o(268,l)));return l=H(u),l===null?null:l.stateNode}function bE(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var g=l.retryLane;l.retryLane=g!==0&&g<u?g:u}}function Fy(l,u){bE(l,u),(l=l.alternate)&&bE(l,u)}function HN(l){return l=H(l),l===null?null:l.stateNode}function VN(){return null}return t.attemptContinuousHydration=function(l){if(l.tag===13){var u=$i();es(l,134217728,u),Fy(l,134217728)}},t.attemptHydrationAtCurrentPriority=function(l){if(l.tag===13){var u=$i(),g=ta(l);es(l,g,u),Fy(l,g)}},t.attemptSynchronousHydration=function(l){switch(l.tag){case 3:var u=l.stateNode;if(u.current.memoizedState.isDehydrated){var g=ms(u.pendingLanes);g!==0&&($r(u,g|1),dr(u,ei()),!(Yt&6)&&(Fc(),Cr()))}break;case 13:var x=$i();mE(function(){return es(l,1,x)}),Fy(l,1)}},t.batchedUpdates=function(l,u){var g=Yt;Yt|=1;try{return l(u)}finally{Yt=g,Yt===0&&(Fc(),En&&Cr())}},t.createComponentSelector=function(l){return{$$typeof:bp,value:l}},t.createContainer=function(l,u,g,x,C,N,J){return EE(l,u,!1,null,g,x,C,N,J)},t.createHasPseudoClassSelector=function(l){return{$$typeof:Cp,value:l}},t.createHydrationContainer=function(l,u,g,x,C,N,J,ae,Ee){return l=EE(g,x,!0,l,C,N,J,ae,Ee),l.context=TE(null),g=l.current,x=$i(),C=ta(g),N=Ir(x,C),N.callback=u??null,vs(g,N),l.current.lanes=C,Qa(l,C,x),dr(l,x),l},t.createPortal=function(l,u,g){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:x==null?null:""+x,children:l,containerInfo:u,implementation:g}},t.createRoleSelector=function(l){return{$$typeof:Ip,value:l}},t.createTestNameSelector=function(l){return{$$typeof:Rp,value:l}},t.createTextSelector=function(l){return{$$typeof:Pp,value:l}},t.deferredUpdates=function(l){var u=tn,g=$n.transition;try{return $n.transition=null,tn=16,l()}finally{tn=u,$n.transition=g}},t.discreteUpdates=function(l,u,g,x,C){var N=tn,J=$n.transition;try{return $n.transition=null,tn=1,l(u,g,x,C)}finally{tn=N,$n.transition=J,Yt===0&&Fc()}},t.findAllNodes=Ey,t.findBoundingRects=function(l,u){if(!Z)throw Error(o(363));u=Ey(l,u),l=[];for(var g=0;g<u.length;g++)l.push(me(u[g]));for(u=l.length-1;0<u;u--){g=l[u];for(var x=g.x,C=x+g.width,N=g.y,J=N+g.height,ae=u-1;0<=ae;ae--)if(u!==ae){var Ee=l[ae],Ye=Ee.x,ft=Ye+Ee.width,zt=Ee.y,It=zt+Ee.height;if(x>=Ye&&N>=zt&&C<=ft&&J<=It){l.splice(u,1);break}else if(x!==Ye||g.width!==Ee.width||It<N||zt>J){if(!(N!==zt||g.height!==Ee.height||ft<x||Ye>C)){Ye>x&&(Ee.width+=Ye-x,Ee.x=x),ft<C&&(Ee.width=C-Ye),l.splice(u,1);break}}else{zt>N&&(Ee.height+=zt-N,Ee.y=N),It<J&&(Ee.height=J-zt),l.splice(u,1);break}}}return l},t.findHostInstance=AE,t.findHostInstanceWithNoPortals=function(l){return l=L(l),l=l!==null?se(l):null,l===null?null:l.stateNode},t.findHostInstanceWithWarning=function(l){return AE(l)},t.flushControlled=function(l){var u=Yt;Yt|=1;var g=$n.transition,x=tn;try{$n.transition=null,tn=1,l()}finally{tn=x,$n.transition=g,Yt=u,Yt===0&&(Fc(),Cr())}},t.flushPassiveEffects=dl,t.flushSync=mE,t.focusWithin=function(l,u){if(!Z)throw Error(o(363));for(l=Sy(l),u=fE(l,u),u=Array.from(u),l=0;l<u.length;){var g=u[l++];if(!Te(g)){if(g.tag===5&&it(g.stateNode))return!0;for(g=g.child;g!==null;)u.push(g),g=g.sibling}}return!1},t.getCurrentUpdatePriority=function(){return tn},t.getFindAllNodesFailureDescription=function(l,u){if(!Z)throw Error(o(363));var g=0,x=[];l=[Sy(l),0];for(var C=0;C<l.length;){var N=l[C++],J=l[C++],ae=u[J];if((N.tag!==5||!Te(N))&&(wy(N,ae)&&(x.push(My(ae)),J++,J>g&&(g=J)),J<u.length))for(N=N.child;N!==null;)l.push(N,J),N=N.sibling}if(g<u.length){for(l=[];g<u.length;g++)l.push(My(u[g]));return`findAllNodes was able to match part of the selector:
  `+(x.join(" > ")+`

No matching component was found for:
  `)+l.join(" > ")}return null},t.getPublicRootInstance=function(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return oe(l.child.stateNode);default:return l.child.stateNode}},t.injectIntoDevTools=function(l){if(l={bundleType:l.bundleType,version:l.version,rendererPackageName:l.rendererPackageName,rendererConfig:l.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:HN,findFiberByHostInstance:l.findFiberByHostInstance||VN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")l=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)l=!0;else{try{vo=u.inject(l),Tr=u}catch{}l=!!u.checkDCE}}return l},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(l,u,g,x){if(!Z)throw Error(o(363));l=Ey(l,u);var C=Ge(l,g,x).disconnect;return{disconnect:function(){C()}}},t.registerMutableSourceForHydration=function(l,u){var g=u._getVersion;g=g(u._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[u,g]:l.mutableSourceEagerHydrationData.push(u,g)},t.runWithPriority=function(l,u){var g=tn;try{return tn=l,u()}finally{tn=g}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(l,u,g,x){var C=u.current,N=$i(),J=ta(C);return g=TE(g),u.context===null?u.context=g:u.pendingContext=g,u=Ir(N,J),u.payload={element:l},x=x===void 0?null:x,x!==null&&(u.callback=x),vs(C,u),l=es(C,J,N),l!==null&&_o(l,C,J),J},t};sL.exports=EH;var TH=sL.exports;const AH=jS(TH),R1={},P1=n=>void Object.assign(R1,n);function bH(n,e){function t(f,{args:d=[],attach:m,...v},_){let E=`${f[0].toUpperCase()}${f.slice(1)}`,S;if(f==="primitive"){if(v.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const y=v.object;S=lu(y,{type:f,root:_,attach:m,primitive:!0})}else{const y=R1[E];if(!y)throw new Error(`R3F: ${E} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(d))throw new Error("R3F: The args prop must be an array!");S=lu(new y(...d),{type:f,root:_,attach:m,memoizedProps:{args:d}})}return S.__r3f.attach===void 0&&(S.isBufferGeometry?S.__r3f.attach="geometry":S.isMaterial&&(S.__r3f.attach="material")),E!=="inject"&&Q_(S,v),S}function i(f,d){let m=!1;if(d){var v,_;(v=d.__r3f)!=null&&v.attach?J_(f,d,d.__r3f.attach):d.isObject3D&&f.isObject3D&&(f.add(d),m=!0),m||(_=f.__r3f)==null||_.objects.push(d),d.__r3f||lu(d,{}),d.__r3f.parent=f,LS(d),cu(d)}}function r(f,d,m){let v=!1;if(d){var _,E;if((_=d.__r3f)!=null&&_.attach)J_(f,d,d.__r3f.attach);else if(d.isObject3D&&f.isObject3D){d.parent=f,d.dispatchEvent({type:"added"}),f.dispatchEvent({type:"childadded",child:d});const S=f.children.filter(w=>w!==d),y=S.indexOf(m);f.children=[...S.slice(0,y),d,...S.slice(y)],v=!0}v||(E=f.__r3f)==null||E.objects.push(d),d.__r3f||lu(d,{}),d.__r3f.parent=f,LS(d),cu(d)}}function s(f,d,m=!1){f&&[...f].forEach(v=>o(d,v,m))}function o(f,d,m){if(d){var v,_,E;if(d.__r3f&&(d.__r3f.parent=null),(v=f.__r3f)!=null&&v.objects&&(f.__r3f.objects=f.__r3f.objects.filter(R=>R!==d)),(_=d.__r3f)!=null&&_.attach)Sb(f,d,d.__r3f.attach);else if(d.isObject3D&&f.isObject3D){var S;f.remove(d),(S=d.__r3f)!=null&&S.root&&DH(xg(d),d)}const w=(E=d.__r3f)==null?void 0:E.primitive,M=!w&&(m===void 0?d.dispose!==null:m);if(!w){var y;s((y=d.__r3f)==null?void 0:y.objects,d,M),s(d.children,d,M)}if(delete d.__r3f,M&&d.dispose&&d.type!=="Scene"){const R=()=>{try{d.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?RS.unstable_scheduleCallback(RS.unstable_IdlePriority,R):R()}cu(f)}}function a(f,d,m,v){var _;const E=(_=f.__r3f)==null?void 0:_.parent;if(!E)return;const S=t(d,m,f.__r3f.root);if(f.children){for(const y of f.children)y.__r3f&&i(S,y);f.children=f.children.filter(y=>!y.__r3f)}f.__r3f.objects.forEach(y=>i(S,y)),f.__r3f.objects=[],f.__r3f.autoRemovedBeforeAppend||o(E,f),S.parent&&(S.__r3f.autoRemovedBeforeAppend=!0),i(E,S),S.raycast&&S.__r3f.eventCount&&xg(S).getState().internal.interaction.push(S),[v,v.alternate].forEach(y=>{y!==null&&(y.stateNode=S,y.ref&&(typeof y.ref=="function"?y.ref(S):y.ref.current=S))})}const c=()=>{};return{reconciler:AH({createInstance:t,removeChild:o,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(f,d)=>{if(!d)return;const m=f.getState().scene;m.__r3f&&(m.__r3f.root=f,i(m,d))},removeChildFromContainer:(f,d)=>{d&&o(f.getState().scene,d)},insertInContainerBefore:(f,d,m)=>{if(!d||!m)return;const v=f.getState().scene;v.__r3f&&r(v,d,m)},getRootHostContext:()=>null,getChildHostContext:f=>f,finalizeInitialChildren(f){var d;return!!((d=f==null?void 0:f.__r3f)!=null?d:{}).handlers},prepareUpdate(f,d,m,v){var _;if(((_=f==null?void 0:f.__r3f)!=null?_:{}).primitive&&v.object&&v.object!==f)return[!0];{const{args:S=[],children:y,...w}=v,{args:M=[],children:R,...z}=m;if(!Array.isArray(S))throw new Error("R3F: the args prop must be an array!");if(S.some((P,b)=>P!==M[b]))return[!0];const k=pL(f,w,z,!0);return k.changes.length?[!1,k]:null}},commitUpdate(f,[d,m],v,_,E,S){d?a(f,v,E,S):Q_(f,m)},commitMount(f,d,m,v){var _;const E=(_=f.__r3f)!=null?_:{};f.raycast&&E.handlers&&E.eventCount&&xg(f).getState().internal.interaction.push(f)},getPublicInstance:f=>f,prepareForCommit:()=>null,preparePortalMount:f=>lu(f.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(f){var d;const{attach:m,parent:v}=(d=f.__r3f)!=null?d:{};m&&v&&Sb(v,f,m),f.isObject3D&&(f.visible=!1),cu(f)},unhideInstance(f,d){var m;const{attach:v,parent:_}=(m=f.__r3f)!=null?m:{};v&&_&&J_(_,f,v),(f.isObject3D&&d.visible==null||d.visible)&&(f.visible=!0),cu(f)},createTextInstance:c,hideTextInstance:c,unhideTextInstance:c,getCurrentEventPriority:()=>e?e():bu.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&An.fun(performance.now)?performance.now:An.fun(Date.now)?Date.now:()=>0,scheduleTimeout:An.fun(setTimeout)?setTimeout:void 0,cancelTimeout:An.fun(clearTimeout)?clearTimeout:void 0}),applyProps:Q_}}var vb,yb;const Z_=n=>"colorSpace"in n||"outputColorSpace"in n,lL=()=>{var n;return(n=R1.ColorManagement)!=null?n:null},cL=n=>n&&n.isOrthographicCamera,CH=n=>n&&n.hasOwnProperty("current"),Zd=typeof window<"u"&&((vb=window.document)!=null&&vb.createElement||((yb=window.navigator)==null?void 0:yb.product)==="ReactNative")?be.useLayoutEffect:be.useEffect;function uL(n){const e=be.useRef(n);return Zd(()=>void(e.current=n),[n]),e}function IH({set:n}){return Zd(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}class hL extends be.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}hL.getDerivedStateFromError=()=>({error:!0});const fL="__default",_b=new Map,RH=n=>n&&!!n.memoized&&!!n.changes;function dL(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}const af=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()};function xg(n){let e=n.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const An={obj:n=>n===Object(n)&&!An.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:i="reference",strict:r=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(An.str(n)||An.num(n)||An.boo(n))return n===e;const s=An.obj(n);if(s&&i==="reference")return n===e;const o=An.arr(n);if(o&&t==="reference")return n===e;if((o||s)&&n===e)return!0;let a;for(a in n)if(!(a in e))return!1;if(s&&t==="shallow"&&i==="shallow"){for(a in r?e:n)if(!An.equ(n[a],e[a],{strict:r,objects:"reference"}))return!1}else for(a in r?e:n)if(n[a]!==e[a])return!1;if(An.und(a)){if(o&&n.length===0&&e.length===0||s&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function PH(n){const e={nodes:{},materials:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material)}),e}function LH(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function lu(n,e){const t=n;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},n}function PS(n,e){let t=n;if(e.includes("-")){const i=e.split("-"),r=i.pop();return t=i.reduce((s,o)=>s[o],n),{target:t,key:r}}else return{target:t,key:e}}const xb=/-\d+$/;function J_(n,e,t){if(An.str(t)){if(xb.test(t)){const s=t.replace(xb,""),{target:o,key:a}=PS(n,s);Array.isArray(o[a])||(o[a]=[])}const{target:i,key:r}=PS(n,t);e.__r3f.previousAttach=i[r],i[r]=e}else e.__r3f.previousAttach=t(n,e)}function Sb(n,e,t){var i,r;if(An.str(t)){const{target:s,key:o}=PS(n,t),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(i=e.__r3f)==null||i.previousAttach==null||i.previousAttach(n,e);(r=e.__r3f)==null||delete r.previousAttach}function pL(n,{children:e,key:t,ref:i,...r},{children:s,key:o,ref:a,...c}={},h=!1){const f=n.__r3f,d=Object.entries(r),m=[];if(h){const _=Object.keys(c);for(let E=0;E<_.length;E++)r.hasOwnProperty(_[E])||d.unshift([_[E],fL+"remove"])}d.forEach(([_,E])=>{var S;if((S=n.__r3f)!=null&&S.primitive&&_==="object"||An.equ(E,c[_]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(_))return m.push([_,E,!0,[]]);let y=[];_.includes("-")&&(y=_.split("-")),m.push([_,E,!1,y]);for(const w in r){const M=r[w];w.startsWith(`${_}-`)&&m.push([w,M,!1,w.split("-")])}});const v={...r};return f!=null&&f.memoizedProps&&f!=null&&f.memoizedProps.args&&(v.args=f.memoizedProps.args),f!=null&&f.memoizedProps&&f!=null&&f.memoizedProps.attach&&(v.attach=f.memoizedProps.attach),{memoized:v,changes:m}}function Q_(n,e){var t;const i=n.__r3f,r=i==null?void 0:i.root,s=r==null||r.getState==null?void 0:r.getState(),{memoized:o,changes:a}=RH(e)?e:pL(n,e),c=i==null?void 0:i.eventCount;n.__r3f&&(n.__r3f.memoizedProps=o);for(let m=0;m<a.length;m++){let[v,_,E,S]=a[m];if(Z_(n)){const R="srgb",z="srgb-linear";v==="encoding"?(v="colorSpace",_=_===3001?R:z):v==="outputEncoding"&&(v="outputColorSpace",_=_===3001?R:z)}let y=n,w=y[v];if(S.length&&(w=S.reduce((M,R)=>M[R],n),!(w&&w.set))){const[M,...R]=S.reverse();y=R.reverse().reduce((z,k)=>z[k],n),v=M}if(_===fL+"remove")if(y.constructor){let M=_b.get(y.constructor);M||(M=new y.constructor,_b.set(y.constructor,M)),_=M[v]}else _=0;if(E&&i)_?i.handlers[v]=_:delete i.handlers[v],i.eventCount=Object.keys(i.handlers).length;else if(w&&w.set&&(w.copy||w instanceof Zl)){if(Array.isArray(_))w.fromArray?w.fromArray(_):w.set(..._);else if(w.copy&&_&&_.constructor&&w.constructor===_.constructor)w.copy(_);else if(_!==void 0){var h;const M=(h=w)==null?void 0:h.isColor;!M&&w.setScalar?w.setScalar(_):w instanceof Zl&&_ instanceof Zl?w.mask=_.mask:w.set(_),!lL()&&s&&!s.linear&&M&&w.convertSRGBToLinear()}}else{var f;if(y[v]=_,(f=y[v])!=null&&f.isTexture&&y[v].format===Qn&&y[v].type===Mr&&s){const M=y[v];Z_(M)&&Z_(s.gl)?M.colorSpace=s.gl.outputColorSpace:M.encoding=s.gl.outputEncoding}}cu(n)}if(i&&i.parent&&n.raycast&&c!==i.eventCount){const m=xg(n).getState().internal,v=m.interaction.indexOf(n);v>-1&&m.interaction.splice(v,1),i.eventCount&&m.interaction.push(n)}return!(a.length===1&&a[0][0]==="onUpdate")&&a.length&&(t=n.__r3f)!=null&&t.parent&&LS(n),n}function cu(n){var e,t;const i=(e=n.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();i&&i.internal.frames===0&&i.invalidate()}function LS(n){n.onUpdate==null||n.onUpdate(n)}function mL(n,e){n.manual||(cL(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function Jm(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function NH(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return bu.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return bu.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return bu.ContinuousEventPriority;default:return bu.DefaultEventPriority}}function gL(n,e,t,i){const r=t.get(e);r&&(t.delete(e),t.size===0&&(n.delete(i),r.target.releasePointerCapture(i)))}function DH(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(i=>i!==e),t.initialHits=t.initialHits.filter(i=>i!==e),t.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((i,r)=>{gL(t.capturedMap,e,i,r)})}function kH(n){function e(c){const{internal:h}=n.getState(),f=c.offsetX-h.initialClick[0],d=c.offsetY-h.initialClick[1];return Math.round(Math.sqrt(f*f+d*d))}function t(c){return c.filter(h=>["Move","Over","Enter","Out","Leave"].some(f=>{var d;return(d=h.__r3f)==null?void 0:d.handlers["onPointer"+f]}))}function i(c,h){const f=n.getState(),d=new Set,m=[],v=h?h(f.internal.interaction):f.internal.interaction;for(let y=0;y<v.length;y++){const w=af(v[y]);w&&(w.raycaster.camera=void 0)}f.previousRoot||f.events.compute==null||f.events.compute(c,f);function _(y){const w=af(y);if(!w||!w.events.enabled||w.raycaster.camera===null)return[];if(w.raycaster.camera===void 0){var M;w.events.compute==null||w.events.compute(c,w,(M=w.previousRoot)==null?void 0:M.getState()),w.raycaster.camera===void 0&&(w.raycaster.camera=null)}return w.raycaster.camera?w.raycaster.intersectObject(y,!0):[]}let E=v.flatMap(_).sort((y,w)=>{const M=af(y.object),R=af(w.object);return!M||!R?y.distance-w.distance:R.events.priority-M.events.priority||y.distance-w.distance}).filter(y=>{const w=Jm(y);return d.has(w)?!1:(d.add(w),!0)});f.events.filter&&(E=f.events.filter(E,f));for(const y of E){let w=y.object;for(;w;){var S;(S=w.__r3f)!=null&&S.eventCount&&m.push({...y,eventObject:w}),w=w.parent}}if("pointerId"in c&&f.internal.capturedMap.has(c.pointerId))for(let y of f.internal.capturedMap.get(c.pointerId).values())d.has(Jm(y.intersection))||m.push(y.intersection);return m}function r(c,h,f,d){const m=n.getState();if(c.length){const v={stopped:!1};for(const _ of c){const E=af(_.object)||m,{raycaster:S,pointer:y,camera:w,internal:M}=E,R=new j(y.x,y.y,0).unproject(w),z=T=>{var L,H;return(L=(H=M.capturedMap.get(T))==null?void 0:H.has(_.eventObject))!=null?L:!1},k=T=>{const L={intersection:_,target:h.target};M.capturedMap.has(T)?M.capturedMap.get(T).set(_.eventObject,L):M.capturedMap.set(T,new Map([[_.eventObject,L]])),h.target.setPointerCapture(T)},P=T=>{const L=M.capturedMap.get(T);L&&gL(M.capturedMap,_.eventObject,L,T)};let b={};for(let T in h){let L=h[T];typeof L!="function"&&(b[T]=L)}let A={..._,...b,pointer:y,intersections:c,stopped:v.stopped,delta:f,unprojectedPoint:R,ray:S.ray,camera:w,stopPropagation(){const T="pointerId"in h&&M.capturedMap.get(h.pointerId);if((!T||T.has(_.eventObject))&&(A.stopped=v.stopped=!0,M.hovered.size&&Array.from(M.hovered.values()).find(L=>L.eventObject===_.eventObject))){const L=c.slice(0,c.indexOf(_));s([...L,_])}},target:{hasPointerCapture:z,setPointerCapture:k,releasePointerCapture:P},currentTarget:{hasPointerCapture:z,setPointerCapture:k,releasePointerCapture:P},nativeEvent:h};if(d(A),v.stopped===!0)break}}return c}function s(c){const{internal:h}=n.getState();for(const f of h.hovered.values())if(!c.length||!c.find(d=>d.object===f.object&&d.index===f.index&&d.instanceId===f.instanceId)){const m=f.eventObject.__r3f,v=m==null?void 0:m.handlers;if(h.hovered.delete(Jm(f)),m!=null&&m.eventCount){const _={...f,intersections:c};v.onPointerOut==null||v.onPointerOut(_),v.onPointerLeave==null||v.onPointerLeave(_)}}}function o(c,h){for(let f=0;f<h.length;f++){const d=h[f].__r3f;d==null||d.handlers.onPointerMissed==null||d.handlers.onPointerMissed(c)}}function a(c){switch(c){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return h=>{const{internal:f}=n.getState();"pointerId"in h&&f.capturedMap.has(h.pointerId)&&requestAnimationFrame(()=>{f.capturedMap.has(h.pointerId)&&(f.capturedMap.delete(h.pointerId),s([]))})}}return function(f){const{onPointerMissed:d,internal:m}=n.getState();m.lastEvent.current=f;const v=c==="onPointerMove",_=c==="onClick"||c==="onContextMenu"||c==="onDoubleClick",S=i(f,v?t:void 0),y=_?e(f):0;c==="onPointerDown"&&(m.initialClick=[f.offsetX,f.offsetY],m.initialHits=S.map(M=>M.eventObject)),_&&!S.length&&y<=2&&(o(f,m.interaction),d&&d(f)),v&&s(S);function w(M){const R=M.eventObject,z=R.__r3f,k=z==null?void 0:z.handlers;if(z!=null&&z.eventCount)if(v){if(k.onPointerOver||k.onPointerEnter||k.onPointerOut||k.onPointerLeave){const P=Jm(M),b=m.hovered.get(P);b?b.stopped&&M.stopPropagation():(m.hovered.set(P,M),k.onPointerOver==null||k.onPointerOver(M),k.onPointerEnter==null||k.onPointerEnter(M))}k.onPointerMove==null||k.onPointerMove(M)}else{const P=k[c];P?(!_||m.initialHits.includes(R))&&(o(f,m.interaction.filter(b=>!m.initialHits.includes(b))),P(M)):_&&m.initialHits.includes(R)&&o(f,m.interaction.filter(b=>!m.initialHits.includes(b)))}}r(S,f,y,w)}}return{handlePointer:a}}const OH=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],vL=n=>!!(n!=null&&n.render),L1=be.createContext(null),UH=(n,e)=>{const t=nL((a,c)=>{const h=new j,f=new j,d=new j;function m(y=c().camera,w=f,M=c().size){const{width:R,height:z,top:k,left:P}=M,b=R/z;w.isVector3?d.copy(w):d.set(...w);const A=y.getWorldPosition(h).distanceTo(d);if(cL(y))return{width:R/y.zoom,height:z/y.zoom,top:k,left:P,factor:1,distance:A,aspect:b};{const T=y.fov*Math.PI/180,L=2*Math.tan(T/2)*A,H=L*(R/z);return{width:H,height:L,top:k,left:P,factor:R/H,distance:A,aspect:b}}}let v;const _=y=>a(w=>({performance:{...w.performance,current:y}})),E=new Ie;return{set:a,get:c,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(y=1)=>n(c(),y),advance:(y,w)=>e(y,w,c()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new E1,pointer:E,mouse:E,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const y=c();v&&clearTimeout(v),y.performance.current!==y.performance.min&&_(y.performance.min),v=setTimeout(()=>_(c().performance.max),y.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:m},setEvents:y=>a(w=>({...w,events:{...w.events,...y}})),setSize:(y,w,M,R,z)=>{const k=c().camera,P={width:y,height:w,top:R||0,left:z||0,updateStyle:M};a(b=>({size:P,viewport:{...b.viewport,...m(k,f,P)}}))},setDpr:y=>a(w=>{const M=dL(y);return{viewport:{...w.viewport,dpr:M,initialDpr:w.viewport.initialDpr||M}}}),setFrameloop:(y="always")=>{const w=c().clock;w.stop(),w.elapsedTime=0,y!=="never"&&(w.start(),w.elapsedTime=0),a(()=>({frameloop:y}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:be.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(y,w,M)=>{const R=c().internal;return R.priority=R.priority+(w>0?1:0),R.subscribers.push({ref:y,priority:w,store:M}),R.subscribers=R.subscribers.sort((z,k)=>z.priority-k.priority),()=>{const z=c().internal;z!=null&&z.subscribers&&(z.priority=z.priority-(w>0?1:0),z.subscribers=z.subscribers.filter(k=>k.ref!==y))}}}}}),i=t.getState();let r=i.size,s=i.viewport.dpr,o=i.camera;return t.subscribe(()=>{const{camera:a,size:c,viewport:h,gl:f,set:d}=t.getState();if(c.width!==r.width||c.height!==r.height||h.dpr!==s){var m;r=c,s=h.dpr,mL(a,c),f.setPixelRatio(h.dpr);const v=(m=c.updateStyle)!=null?m:typeof HTMLCanvasElement<"u"&&f.domElement instanceof HTMLCanvasElement;f.setSize(c.width,c.height,v)}a!==o&&(o=a,d(v=>({viewport:{...v.viewport,...v.viewport.getCurrentViewport(a)}})))}),t.subscribe(a=>n(a)),t};let Qm,FH=new Set,zH=new Set,BH=new Set;function ex(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function lf(n,e){switch(n){case"before":return ex(FH,e);case"after":return ex(zH,e);case"tail":return ex(BH,e)}}let tx,nx;function ix(n,e,t){let i=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(i=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),tx=e.internal.subscribers,Qm=0;Qm<tx.length;Qm++)nx=tx[Qm],nx.ref.current(nx.store.getState(),i,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function HH(n){let e=!1,t=!1,i,r,s;function o(h){r=requestAnimationFrame(o),e=!0,i=0,lf("before",h),t=!0;for(const d of n.values()){var f;s=d.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((f=s.gl.xr)!=null&&f.isPresenting)&&(i+=ix(h,s))}if(t=!1,lf("after",h),i===0)return lf("tail",h),e=!1,cancelAnimationFrame(r)}function a(h,f=1){var d;if(!h)return n.forEach(m=>a(m.store.getState(),f));(d=h.gl.xr)!=null&&d.isPresenting||!h.internal.active||h.frameloop==="never"||(f>1?h.internal.frames=Math.min(60,h.internal.frames+f):t?h.internal.frames=2:h.internal.frames=1,e||(e=!0,requestAnimationFrame(o)))}function c(h,f=!0,d,m){if(f&&lf("before",h),d)ix(h,d,m);else for(const v of n.values())ix(h,v.store.getState());f&&lf("after",h)}return{loop:o,invalidate:a,advance:c}}function N1(){const n=be.useContext(L1);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function Or(n=t=>t,e){return N1()(n,e)}function O0(n,e=0){const t=N1(),i=t.getState().internal.subscribe,r=uL(n);return Zd(()=>i(r,e,t),[e,i,t]),null}const wb=new WeakMap;function yL(n,e){return function(t,...i){let r=wb.get(t);return r||(r=new t,wb.set(t,r)),n&&n(r),Promise.all(i.map(s=>new Promise((o,a)=>r.load(s,c=>{c.scene&&Object.assign(c,PH(c.scene)),o(c)},e,c=>a(new Error(`Could not load ${s}: ${c==null?void 0:c.message}`))))))}}function eh(n,e,t,i){const r=Array.isArray(e)?e:[e],s=SH(yL(t,i),[n,...r],{equal:An.equ});return Array.isArray(e)?s:s[0]}eh.preload=function(n,e,t){const i=Array.isArray(e)?e:[e];return wH(yL(t),[n,...i])};eh.clear=function(n,e){const t=Array.isArray(e)?e:[e];return MH([n,...t])};const th=new Map,{invalidate:Mb,advance:Eb}=HH(th),{reconciler:Td,applyProps:ya}=bH(th,NH),au={objects:"shallow",strict:!1},VH=(n,e)=>{const t=typeof n=="function"?n(e):n;return vL(t)?t:new a1({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function GH(n,e){const t=typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement;if(e){const{width:i,height:r,top:s,left:o,updateStyle:a=t}=e;return{width:i,height:r,top:s,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:i,height:r,top:s,left:o}=n.parentElement.getBoundingClientRect();return{width:i,height:r,top:s,left:o,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function WH(n){const e=th.get(n),t=e==null?void 0:e.fiber,i=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=i||UH(Mb,Eb),o=t||Td.createContainer(s,bu.ConcurrentRoot,null,!1,null,"",r,null);e||th.set(n,{fiber:o,store:s});let a,c=!1,h;return{configure(f={}){let{gl:d,size:m,scene:v,events:_,onCreated:E,shadows:S=!1,linear:y=!1,flat:w=!1,legacy:M=!1,orthographic:R=!1,frameloop:z="always",dpr:k=[1,2],performance:P,raycaster:b,camera:A,onPointerMissed:T}=f,L=s.getState(),H=L.gl;L.gl||L.set({gl:H=VH(d,n)});let U=L.raycaster;U||L.set({raycaster:U=new C1});const{params:se,...fe}=b||{};if(An.equ(fe,U,au)||ya(U,{...fe}),An.equ(se,U.params,au)||ya(U,{params:{...U.params,...se}}),!L.camera||L.camera===h&&!An.equ(h,A,au)){h=A;const ie=A instanceof Hd,ye=ie?A:R?new Bo(0,0,0,0,.1,1e3):new Jn(75,0,.1,1e3);ie||(ye.position.z=5,A&&(ya(ye,A),("aspect"in A||"left"in A||"right"in A||"bottom"in A||"top"in A)&&(ye.manual=!0,ye.updateProjectionMatrix())),!L.camera&&!(A!=null&&A.rotation)&&ye.lookAt(0,0,0)),L.set({camera:ye}),U.camera=ye}if(!L.scene){let ie;v!=null&&v.isScene?ie=v:(ie=new Wd,v&&ya(ie,v)),L.set({scene:lu(ie)})}if(!L.xr){var oe;const ie=(ze,pe)=>{const De=s.getState();De.frameloop!=="never"&&Eb(ze,!0,De,pe)},ye=()=>{const ze=s.getState();ze.gl.xr.enabled=ze.gl.xr.isPresenting,ze.gl.xr.setAnimationLoop(ze.gl.xr.isPresenting?ie:null),ze.gl.xr.isPresenting||Mb(ze)},Ae={connect(){const ze=s.getState().gl;ze.xr.addEventListener("sessionstart",ye),ze.xr.addEventListener("sessionend",ye)},disconnect(){const ze=s.getState().gl;ze.xr.removeEventListener("sessionstart",ye),ze.xr.removeEventListener("sessionend",ye)}};typeof((oe=H.xr)==null?void 0:oe.addEventListener)=="function"&&Ae.connect(),L.set({xr:Ae})}if(H.shadowMap){const ie=H.shadowMap.enabled,ye=H.shadowMap.type;if(H.shadowMap.enabled=!!S,An.boo(S))H.shadowMap.type=Af;else if(An.str(S)){var Se;const Ae={basic:Q2,percentage:s0,soft:Af,variance:Ts};H.shadowMap.type=(Se=Ae[S])!=null?Se:Af}else An.obj(S)&&Object.assign(H.shadowMap,S);(ie!==H.shadowMap.enabled||ye!==H.shadowMap.type)&&(H.shadowMap.needsUpdate=!0)}const q=lL();q&&("enabled"in q?q.enabled=!M:"legacyMode"in q&&(q.legacyMode=M)),c||ya(H,{outputEncoding:y?3e3:3001,toneMapping:w?no:Bw}),L.legacy!==M&&L.set(()=>({legacy:M})),L.linear!==y&&L.set(()=>({linear:y})),L.flat!==w&&L.set(()=>({flat:w})),d&&!An.fun(d)&&!vL(d)&&!An.equ(d,H,au)&&ya(H,d),_&&!L.events.handlers&&L.set({events:_(s)});const le=GH(n,m);return An.equ(le,L.size,au)||L.setSize(le.width,le.height,le.updateStyle,le.top,le.left),k&&L.viewport.dpr!==dL(k)&&L.setDpr(k),L.frameloop!==z&&L.setFrameloop(z),L.onPointerMissed||L.set({onPointerMissed:T}),P&&!An.equ(P,L.performance,au)&&L.set(ie=>({performance:{...ie.performance,...P}})),a=E,c=!0,this},render(f){return c||this.configure(),Td.updateContainer(K.jsx(jH,{store:s,children:f,onCreated:a,rootElement:n}),o,null,()=>{}),s},unmount(){_L(n)}}}function jH({store:n,children:e,onCreated:t,rootElement:i}){return Zd(()=>{const r=n.getState();r.set(s=>({internal:{...s.internal,active:!0}})),t&&t(r),n.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),K.jsx(L1.Provider,{value:n,children:e})}function _L(n,e){const t=th.get(n),i=t==null?void 0:t.fiber;if(i){const r=t==null?void 0:t.store.getState();r&&(r.internal.active=!1),Td.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var s,o,a,c;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=r.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(c=r.gl)!=null&&c.xr&&r.xr.disconnect(),LH(r),th.delete(n)}catch{}},500)})}}function XH(n,e,t){return K.jsx(qH,{children:n,container:e,state:t},e.uuid)}function qH({state:n={},children:e,container:t}){const{events:i,size:r,...s}=n,o=N1(),[a]=be.useState(()=>new C1),[c]=be.useState(()=>new Ie),h=be.useCallback((d,m)=>{const v={...d};Object.keys(d).forEach(E=>{(OH.includes(E)||d[E]!==m[E]&&m[E])&&delete v[E]});let _;if(m&&r){const E=m.camera;_=d.viewport.getCurrentViewport(E,new j,r),E!==d.camera&&mL(E,r)}return{...v,scene:t,raycaster:a,pointer:c,mouse:c,previousRoot:o,events:{...d.events,...m==null?void 0:m.events,...i},size:{...d.size,...r},viewport:{...d.viewport,..._},...s}},[n]),[f]=be.useState(()=>{const d=o.getState();return nL((v,_)=>({...d,scene:t,raycaster:a,pointer:c,mouse:c,previousRoot:o,events:{...d.events,...i},size:{...d.size,...r},...s,set:v,get:_,setEvents:E=>v(S=>({...S,events:{...S.events,...E}}))}))});return be.useEffect(()=>{const d=o.subscribe(m=>f.setState(v=>h(m,v)));return()=>{d()}},[h]),be.useEffect(()=>{f.setState(d=>h(o.getState(),d))},[h]),be.useEffect(()=>()=>{f.destroy()},[]),K.jsx(K.Fragment,{children:Td.createPortal(K.jsx(L1.Provider,{value:f,children:e}),f,null)})}Td.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:be.version});const rx={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function YH(n){const{handlePointer:e}=kH(n);return{priority:1,enabled:!0,compute(t,i,r){i.pointer.set(t.offsetX/i.size.width*2-1,-(t.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(rx).reduce((t,i)=>({...t,[i]:e(i)}),{}),update:()=>{var t;const{events:i,internal:r}=n.getState();(t=r.lastEvent)!=null&&t.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{var i;const{set:r,events:s}=n.getState();s.disconnect==null||s.disconnect(),r(o=>({events:{...o.events,connected:t}})),Object.entries((i=s.handlers)!=null?i:[]).forEach(([o,a])=>{const[c,h]=rx[o];t.addEventListener(c,a,{passive:h})})},disconnect:()=>{const{set:t,events:i}=n.getState();if(i.connected){var r;Object.entries((r=i.handlers)!=null?r:[]).forEach(([s,o])=>{if(i&&i.connected instanceof HTMLElement){const[a]=rx[s];i.connected.removeEventListener(a,o)}}),t(s=>({events:{...s.events,connected:void 0}}))}}}}function Tb(n,e){let t;return(...i)=>{window.clearTimeout(t),t=window.setTimeout(()=>n(...i),e)}}function $H({debounce:n,scroll:e,polyfill:t,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const r=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,o]=be.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),a=be.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),c=n?typeof n=="number"?n:n.scroll:null,h=n?typeof n=="number"?n:n.resize:null,f=be.useRef(!1);be.useEffect(()=>(f.current=!0,()=>void(f.current=!1)));const[d,m,v]=be.useMemo(()=>{const y=()=>{if(!a.current.element)return;const{left:w,top:M,width:R,height:z,bottom:k,right:P,x:b,y:A}=a.current.element.getBoundingClientRect(),T={left:w,top:M,width:R,height:z,bottom:k,right:P,x:b,y:A};a.current.element instanceof HTMLElement&&i&&(T.height=a.current.element.offsetHeight,T.width=a.current.element.offsetWidth),Object.freeze(T),f.current&&!QH(a.current.lastBounds,T)&&o(a.current.lastBounds=T)};return[y,h?Tb(y,h):y,c?Tb(y,c):y]},[o,i,c,h]);function _(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(y=>y.removeEventListener("scroll",v,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null),a.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",a.current.orientationHandler))}function E(){a.current.element&&(a.current.resizeObserver=new r(v),a.current.resizeObserver.observe(a.current.element),e&&a.current.scrollContainers&&a.current.scrollContainers.forEach(y=>y.addEventListener("scroll",v,{capture:!0,passive:!0})),a.current.orientationHandler=()=>{v()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",a.current.orientationHandler))}const S=y=>{!y||y===a.current.element||(_(),a.current.element=y,a.current.scrollContainers=xL(y),E())};return ZH(v,!!e),KH(m),be.useEffect(()=>{_(),E()},[e,v,m]),be.useEffect(()=>_,[]),[S,s,d]}function KH(n){be.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function ZH(n,e){be.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function xL(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:i,overflowY:r}=window.getComputedStyle(n);return[t,i,r].some(s=>s==="auto"||s==="scroll")&&e.push(n),[...e,...xL(n.parentElement)]}const JH=["x","y","top","bottom","left","right","width","height"],QH=(n,e)=>JH.every(t=>n[t]===e[t]);var eV=Object.defineProperty,tV=Object.defineProperties,nV=Object.getOwnPropertyDescriptors,Ab=Object.getOwnPropertySymbols,iV=Object.prototype.hasOwnProperty,rV=Object.prototype.propertyIsEnumerable,bb=(n,e,t)=>e in n?eV(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Cb=(n,e)=>{for(var t in e||(e={}))iV.call(e,t)&&bb(n,t,e[t]);if(Ab)for(var t of Ab(e))rV.call(e,t)&&bb(n,t,e[t]);return n},sV=(n,e)=>tV(n,nV(e)),Ib,Rb;typeof window<"u"&&((Ib=window.document)!=null&&Ib.createElement||((Rb=window.navigator)==null?void 0:Rb.product)==="ReactNative")?be.useLayoutEffect:be.useEffect;function SL(n,e,t){if(!n)return;if(t(n)===!0)return n;let i=n.child;for(;i;){const r=SL(i,e,t);if(r)return r;i=i.sibling}}function wL(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const Pb=console.error;console.error=function(){const n=[...arguments].join("");if(n!=null&&n.startsWith("Warning:")&&n.includes("useContext")){console.error=Pb;return}return Pb.apply(this,arguments)};const D1=wL(be.createContext(null));class ML extends be.Component{render(){return be.createElement(D1.Provider,{value:this._reactInternals},this.props.children)}}function oV(){const n=be.useContext(D1);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=be.useId();return be.useMemo(()=>{for(const i of[n,n==null?void 0:n.alternate]){if(!i)continue;const r=SL(i,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(r)return r}},[n,e])}function aV(){const n=oV(),[e]=be.useState(()=>new Map);e.clear();let t=n;for(;t;){if(t.type&&typeof t.type=="object"){const r=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;r&&r!==D1&&!e.has(r)&&e.set(r,be.useContext(wL(r)))}t=t.return}return e}function lV(){const n=aV();return be.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>i=>be.createElement(e,null,be.createElement(t.Provider,sV(Cb({},i),{value:n.get(t)}))),e=>be.createElement(ML,Cb({},e))),[n])}const cV=be.forwardRef(function({children:e,fallback:t,resize:i,style:r,gl:s,events:o=YH,eventSource:a,eventPrefix:c,shadows:h,linear:f,flat:d,legacy:m,orthographic:v,frameloop:_,dpr:E,performance:S,raycaster:y,camera:w,scene:M,onPointerMissed:R,onCreated:z,...k},P){be.useMemo(()=>P1(vH),[]);const b=lV(),[A,T]=$H({scroll:!0,debounce:{scroll:50,resize:0},...i}),L=be.useRef(null),H=be.useRef(null);be.useImperativeHandle(P,()=>L.current);const U=uL(R),[se,fe]=be.useState(!1),[oe,Se]=be.useState(!1);if(se)throw se;if(oe)throw oe;const q=be.useRef(null);Zd(()=>{const ie=L.current;T.width>0&&T.height>0&&ie&&(q.current||(q.current=WH(ie)),q.current.configure({gl:s,events:o,shadows:h,linear:f,flat:d,legacy:m,orthographic:v,frameloop:_,dpr:E,performance:S,raycaster:y,camera:w,scene:M,size:T,onPointerMissed:(...ye)=>U.current==null?void 0:U.current(...ye),onCreated:ye=>{ye.events.connect==null||ye.events.connect(a?CH(a)?a.current:a:H.current),c&&ye.setEvents({compute:(Ae,ze)=>{const pe=Ae[c+"X"],De=Ae[c+"Y"];ze.pointer.set(pe/ze.size.width*2-1,-(De/ze.size.height)*2+1),ze.raycaster.setFromCamera(ze.pointer,ze.camera)}}),z==null||z(ye)}}),q.current.render(K.jsx(b,{children:K.jsx(hL,{set:Se,children:K.jsx(be.Suspense,{fallback:K.jsx(IH,{set:fe}),children:e??null})})})))}),be.useEffect(()=>{const ie=L.current;if(ie)return()=>_L(ie)},[]);const le=a?"none":"auto";return K.jsx("div",{ref:H,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:le,...r},...k,children:K.jsx("div",{ref:A,style:{width:"100%",height:"100%"},children:K.jsx("canvas",{ref:L,style:{display:"block"},children:t})})})}),uV=be.forwardRef(function(e,t){return K.jsx(ML,{children:K.jsx(cV,{...e,ref:t})})});function nh(){return nh=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},nh.apply(null,arguments)}const EL=parseInt(ch.replace(/\D+/g,""));var as=Uint8Array,Ca=Uint16Array,NS=Uint32Array,TL=new as([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),AL=new as([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),hV=new as([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),bL=function(n,e){for(var t=new Ca(31),i=0;i<31;++i)t[i]=e+=1<<n[i-1];for(var r=new NS(t[30]),i=1;i<30;++i)for(var s=t[i];s<t[i+1];++s)r[s]=s-t[i]<<5|i;return[t,r]},CL=bL(TL,2),IL=CL[0],fV=CL[1];IL[28]=258,fV[258]=28;var dV=bL(AL,0),pV=dV[0],DS=new Ca(32768);for(var Ln=0;Ln<32768;++Ln){var pa=(Ln&43690)>>>1|(Ln&21845)<<1;pa=(pa&52428)>>>2|(pa&13107)<<2,pa=(pa&61680)>>>4|(pa&3855)<<4,DS[Ln]=((pa&65280)>>>8|(pa&255)<<8)>>>1}var Of=function(n,e,t){for(var i=n.length,r=0,s=new Ca(e);r<i;++r)++s[n[r]-1];var o=new Ca(e);for(r=0;r<e;++r)o[r]=o[r-1]+s[r-1]<<1;var a;if(t){a=new Ca(1<<e);var c=15-e;for(r=0;r<i;++r)if(n[r])for(var h=r<<4|n[r],f=e-n[r],d=o[n[r]-1]++<<f,m=d|(1<<f)-1;d<=m;++d)a[DS[d]>>>c]=h}else for(a=new Ca(i),r=0;r<i;++r)n[r]&&(a[r]=DS[o[n[r]-1]++]>>>15-n[r]);return a},Jd=new as(288);for(var Ln=0;Ln<144;++Ln)Jd[Ln]=8;for(var Ln=144;Ln<256;++Ln)Jd[Ln]=9;for(var Ln=256;Ln<280;++Ln)Jd[Ln]=7;for(var Ln=280;Ln<288;++Ln)Jd[Ln]=8;var RL=new as(32);for(var Ln=0;Ln<32;++Ln)RL[Ln]=5;var mV=Of(Jd,9,1),gV=Of(RL,5,1),sx=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},Ms=function(n,e,t){var i=e/8|0;return(n[i]|n[i+1]<<8)>>(e&7)&t},ox=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},vV=function(n){return(n/8|0)+(n&7&&1)},yV=function(n,e,t){(t==null||t>n.length)&&(t=n.length);var i=new(n instanceof Ca?Ca:n instanceof NS?NS:as)(t-e);return i.set(n.subarray(e,t)),i},_V=function(n,e,t){var i=n.length;if(!i||t&&!t.l&&i<5)return e||new as(0);var r=!e||t,s=!t||t.i;t||(t={}),e||(e=new as(i*3));var o=function(Oe){var He=e.length;if(Oe>He){var ut=new as(Math.max(He*2,Oe));ut.set(e),e=ut}},a=t.f||0,c=t.p||0,h=t.b||0,f=t.l,d=t.d,m=t.m,v=t.n,_=i*8;do{if(!f){t.f=a=Ms(n,c,1);var E=Ms(n,c+1,3);if(c+=3,E)if(E==1)f=mV,d=gV,m=9,v=5;else if(E==2){var M=Ms(n,c,31)+257,R=Ms(n,c+10,15)+4,z=M+Ms(n,c+5,31)+1;c+=14;for(var k=new as(z),P=new as(19),b=0;b<R;++b)P[hV[b]]=Ms(n,c+b*3,7);c+=R*3;for(var A=sx(P),T=(1<<A)-1,L=Of(P,A,1),b=0;b<z;){var H=L[Ms(n,c,T)];c+=H&15;var S=H>>>4;if(S<16)k[b++]=S;else{var U=0,se=0;for(S==16?(se=3+Ms(n,c,3),c+=2,U=k[b-1]):S==17?(se=3+Ms(n,c,7),c+=3):S==18&&(se=11+Ms(n,c,127),c+=7);se--;)k[b++]=U}}var fe=k.subarray(0,M),oe=k.subarray(M);m=sx(fe),v=sx(oe),f=Of(fe,m,1),d=Of(oe,v,1)}else throw"invalid block type";else{var S=vV(c)+4,y=n[S-4]|n[S-3]<<8,w=S+y;if(w>i){if(s)throw"unexpected EOF";break}r&&o(h+y),e.set(n.subarray(S,w),h),t.b=h+=y,t.p=c=w*8;continue}if(c>_){if(s)throw"unexpected EOF";break}}r&&o(h+131072);for(var Se=(1<<m)-1,q=(1<<v)-1,le=c;;le=c){var U=f[ox(n,c)&Se],ie=U>>>4;if(c+=U&15,c>_){if(s)throw"unexpected EOF";break}if(!U)throw"invalid length/literal";if(ie<256)e[h++]=ie;else if(ie==256){le=c,f=null;break}else{var ye=ie-254;if(ie>264){var b=ie-257,Ae=TL[b];ye=Ms(n,c,(1<<Ae)-1)+IL[b],c+=Ae}var ze=d[ox(n,c)&q],pe=ze>>>4;if(!ze)throw"invalid distance";c+=ze&15;var oe=pV[pe];if(pe>3){var Ae=AL[pe];oe+=ox(n,c)&(1<<Ae)-1,c+=Ae}if(c>_){if(s)throw"unexpected EOF";break}r&&o(h+131072);for(var De=h+ye;h<De;h+=4)e[h]=e[h-oe],e[h+1]=e[h+1-oe],e[h+2]=e[h+2-oe],e[h+3]=e[h+3-oe];h=De}}t.l=f,t.p=le,t.b=h,f&&(a=1,t.m=m,t.d=d,t.n=v)}while(!a);return h==e.length?e:yV(e,0,h)},xV=new as(0),SV=function(n){if((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)throw"invalid zlib data";if(n[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function eg(n,e){return _V((SV(n),n.subarray(2,-4)),e)}var wV=typeof TextDecoder<"u"&&new TextDecoder,MV=0;try{wV.decode(xV,{stream:!0}),MV=1}catch{}const EV=n=>n&&n.isCubeTexture;class TV extends Bn{constructor(e,t){var i,r;const s=EV(e),a=((r=s?(i=e.image[0])==null?void 0:i.width:e.image.width)!=null?r:1024)/4,c=Math.floor(Math.log2(a)),h=Math.pow(2,c),f=3*Math.max(h,16*7),d=4*h,m=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/f}`,`#define CUBEUV_TEXEL_HEIGHT ${1/d}`,`#define CUBEUV_MAX_MIP ${c}.0`],v=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,_=m.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${EL>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,E={map:{value:e},height:{value:(t==null?void 0:t.height)||15},radius:{value:(t==null?void 0:t.radius)||100}},S=new Xd(1,16),y=new ir({uniforms:E,fragmentShader:_,vertexShader:v,side:Is});super(S,y)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var AV=Object.defineProperty,bV=(n,e,t)=>e in n?AV(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,CV=(n,e,t)=>(bV(n,e+"",t),t);class IV{constructor(){CV(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}var RV=Object.defineProperty,PV=(n,e,t)=>e in n?RV(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Rt=(n,e,t)=>(PV(n,typeof e!="symbol"?e+"":e,t),t);const tg=new pc,Lb=new $s,LV=Math.cos(70*(Math.PI/180)),Nb=(n,e)=>(n%e+e)%e;let NV=class extends IV{constructor(e,t){super(),Rt(this,"object"),Rt(this,"domElement"),Rt(this,"enabled",!0),Rt(this,"target",new j),Rt(this,"minDistance",0),Rt(this,"maxDistance",1/0),Rt(this,"minZoom",0),Rt(this,"maxZoom",1/0),Rt(this,"minPolarAngle",0),Rt(this,"maxPolarAngle",Math.PI),Rt(this,"minAzimuthAngle",-1/0),Rt(this,"maxAzimuthAngle",1/0),Rt(this,"enableDamping",!1),Rt(this,"dampingFactor",.05),Rt(this,"enableZoom",!0),Rt(this,"zoomSpeed",1),Rt(this,"enableRotate",!0),Rt(this,"rotateSpeed",1),Rt(this,"enablePan",!0),Rt(this,"panSpeed",1),Rt(this,"screenSpacePanning",!0),Rt(this,"keyPanSpeed",7),Rt(this,"zoomToCursor",!1),Rt(this,"autoRotate",!1),Rt(this,"autoRotateSpeed",2),Rt(this,"reverseOrbit",!1),Rt(this,"reverseHorizontalOrbit",!1),Rt(this,"reverseVerticalOrbit",!1),Rt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Rt(this,"mouseButtons",{LEFT:Il.ROTATE,MIDDLE:Il.DOLLY,RIGHT:Il.PAN}),Rt(this,"touches",{ONE:Rl.ROTATE,TWO:Rl.DOLLY_PAN}),Rt(this,"target0"),Rt(this,"position0"),Rt(this,"zoom0"),Rt(this,"_domElementKeyEvents",null),Rt(this,"getPolarAngle"),Rt(this,"getAzimuthalAngle"),Rt(this,"setPolarAngle"),Rt(this,"setAzimuthalAngle"),Rt(this,"getDistance"),Rt(this,"getZoomScale"),Rt(this,"listenToKeyEvents"),Rt(this,"stopListenToKeyEvents"),Rt(this,"saveState"),Rt(this,"reset"),Rt(this,"update"),Rt(this,"connect"),Rt(this,"dispose"),Rt(this,"dollyIn"),Rt(this,"dollyOut"),Rt(this,"getScale"),Rt(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>f.phi,this.getAzimuthalAngle=()=>f.theta,this.setPolarAngle=te=>{let Le=Nb(te,2*Math.PI),Q=f.phi;Q<0&&(Q+=2*Math.PI),Le<0&&(Le+=2*Math.PI);let Ce=Math.abs(Le-Q);2*Math.PI-Ce<Ce&&(Le<Q?Le+=2*Math.PI:Q+=2*Math.PI),d.phi=Le-Q,i.update()},this.setAzimuthalAngle=te=>{let Le=Nb(te,2*Math.PI),Q=f.theta;Q<0&&(Q+=2*Math.PI),Le<0&&(Le+=2*Math.PI);let Ce=Math.abs(Le-Q);2*Math.PI-Ce<Ce&&(Le<Q?Le+=2*Math.PI:Q+=2*Math.PI),d.theta=Le-Q,i.update()},this.getDistance=()=>i.object.position.distanceTo(i.target),this.listenToKeyEvents=te=>{te.addEventListener("keydown",Qe),this._domElementKeyEvents=te},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",Qe),this._domElementKeyEvents=null},this.saveState=()=>{i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=()=>{i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(r),i.update(),c=a.NONE},this.update=(()=>{const te=new j,Le=new j(0,1,0),Q=new Vi().setFromUnitVectors(e.up,Le),Ce=Q.clone().invert(),re=new j,Me=new Vi,je=2*Math.PI;return function(){const Nt=i.object.position;Q.setFromUnitVectors(e.up,Le),Ce.copy(Q).invert(),te.copy(Nt).sub(i.target),te.applyQuaternion(Q),f.setFromVector3(te),i.autoRotate&&c===a.NONE&&se(H()),i.enableDamping?(f.theta+=d.theta*i.dampingFactor,f.phi+=d.phi*i.dampingFactor):(f.theta+=d.theta,f.phi+=d.phi);let $t=i.minAzimuthAngle,en=i.maxAzimuthAngle;isFinite($t)&&isFinite(en)&&($t<-Math.PI?$t+=je:$t>Math.PI&&($t-=je),en<-Math.PI?en+=je:en>Math.PI&&(en-=je),$t<=en?f.theta=Math.max($t,Math.min(en,f.theta)):f.theta=f.theta>($t+en)/2?Math.max($t,f.theta):Math.min(en,f.theta)),f.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,f.phi)),f.makeSafe(),i.enableDamping===!0?i.target.addScaledVector(v,i.dampingFactor):i.target.add(v),i.zoomToCursor&&A||i.object.isOrthographicCamera?f.radius=ze(f.radius):f.radius=ze(f.radius*m),te.setFromSpherical(f),te.applyQuaternion(Ce),Nt.copy(i.target).add(te),i.object.matrixAutoUpdate||i.object.updateMatrix(),i.object.lookAt(i.target),i.enableDamping===!0?(d.theta*=1-i.dampingFactor,d.phi*=1-i.dampingFactor,v.multiplyScalar(1-i.dampingFactor)):(d.set(0,0,0),v.set(0,0,0));let Ut=!1;if(i.zoomToCursor&&A){let wn=null;if(i.object instanceof Jn&&i.object.isPerspectiveCamera){const Dn=te.length();wn=ze(Dn*m);const xn=Dn-wn;i.object.position.addScaledVector(P,xn),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const Dn=new j(b.x,b.y,0);Dn.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/m)),i.object.updateProjectionMatrix(),Ut=!0;const xn=new j(b.x,b.y,0);xn.unproject(i.object),i.object.position.sub(xn).add(Dn),i.object.updateMatrixWorld(),wn=te.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;wn!==null&&(i.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(wn).add(i.object.position):(tg.origin.copy(i.object.position),tg.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(tg.direction))<LV?e.lookAt(i.target):(Lb.setFromNormalAndCoplanarPoint(i.object.up,i.target),tg.intersectPlane(Lb,i.target))))}else i.object instanceof Bo&&i.object.isOrthographicCamera&&(Ut=m!==1,Ut&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/m)),i.object.updateProjectionMatrix()));return m=1,A=!1,Ut||re.distanceToSquared(i.object.position)>h||8*(1-Me.dot(i.object.quaternion))>h?(i.dispatchEvent(r),re.copy(i.object.position),Me.copy(i.object.quaternion),Ut=!1,!0):!1}})(),this.connect=te=>{i.domElement=te,i.domElement.style.touchAction="none",i.domElement.addEventListener("contextmenu",nt),i.domElement.addEventListener("pointerdown",me),i.domElement.addEventListener("pointercancel",Te),i.domElement.addEventListener("wheel",Ge)},this.dispose=()=>{var te,Le,Q,Ce,re,Me;i.domElement&&(i.domElement.style.touchAction="auto"),(te=i.domElement)==null||te.removeEventListener("contextmenu",nt),(Le=i.domElement)==null||Le.removeEventListener("pointerdown",me),(Q=i.domElement)==null||Q.removeEventListener("pointercancel",Te),(Ce=i.domElement)==null||Ce.removeEventListener("wheel",Ge),(re=i.domElement)==null||re.ownerDocument.removeEventListener("pointermove",Re),(Me=i.domElement)==null||Me.ownerDocument.removeEventListener("pointerup",Te),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",Qe)};const i=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let c=a.NONE;const h=1e-6,f=new IS,d=new IS;let m=1;const v=new j,_=new Ie,E=new Ie,S=new Ie,y=new Ie,w=new Ie,M=new Ie,R=new Ie,z=new Ie,k=new Ie,P=new j,b=new Ie;let A=!1;const T=[],L={};function H(){return 2*Math.PI/60/60*i.autoRotateSpeed}function U(){return Math.pow(.95,i.zoomSpeed)}function se(te){i.reverseOrbit||i.reverseHorizontalOrbit?d.theta+=te:d.theta-=te}function fe(te){i.reverseOrbit||i.reverseVerticalOrbit?d.phi+=te:d.phi-=te}const oe=(()=>{const te=new j;return function(Q,Ce){te.setFromMatrixColumn(Ce,0),te.multiplyScalar(-Q),v.add(te)}})(),Se=(()=>{const te=new j;return function(Q,Ce){i.screenSpacePanning===!0?te.setFromMatrixColumn(Ce,1):(te.setFromMatrixColumn(Ce,0),te.crossVectors(i.object.up,te)),te.multiplyScalar(Q),v.add(te)}})(),q=(()=>{const te=new j;return function(Q,Ce){const re=i.domElement;if(re&&i.object instanceof Jn&&i.object.isPerspectiveCamera){const Me=i.object.position;te.copy(Me).sub(i.target);let je=te.length();je*=Math.tan(i.object.fov/2*Math.PI/180),oe(2*Q*je/re.clientHeight,i.object.matrix),Se(2*Ce*je/re.clientHeight,i.object.matrix)}else re&&i.object instanceof Bo&&i.object.isOrthographicCamera?(oe(Q*(i.object.right-i.object.left)/i.object.zoom/re.clientWidth,i.object.matrix),Se(Ce*(i.object.top-i.object.bottom)/i.object.zoom/re.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}})();function le(te){i.object instanceof Jn&&i.object.isPerspectiveCamera||i.object instanceof Bo&&i.object.isOrthographicCamera?m=te:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function ie(te){le(m/te)}function ye(te){le(m*te)}function Ae(te){if(!i.zoomToCursor||!i.domElement)return;A=!0;const Le=i.domElement.getBoundingClientRect(),Q=te.clientX-Le.left,Ce=te.clientY-Le.top,re=Le.width,Me=Le.height;b.x=Q/re*2-1,b.y=-(Ce/Me)*2+1,P.set(b.x,b.y,1).unproject(i.object).sub(i.object.position).normalize()}function ze(te){return Math.max(i.minDistance,Math.min(i.maxDistance,te))}function pe(te){_.set(te.clientX,te.clientY)}function De(te){Ae(te),R.set(te.clientX,te.clientY)}function Oe(te){y.set(te.clientX,te.clientY)}function He(te){E.set(te.clientX,te.clientY),S.subVectors(E,_).multiplyScalar(i.rotateSpeed);const Le=i.domElement;Le&&(se(2*Math.PI*S.x/Le.clientHeight),fe(2*Math.PI*S.y/Le.clientHeight)),_.copy(E),i.update()}function ut(te){z.set(te.clientX,te.clientY),k.subVectors(z,R),k.y>0?ie(U()):k.y<0&&ye(U()),R.copy(z),i.update()}function Tt(te){w.set(te.clientX,te.clientY),M.subVectors(w,y).multiplyScalar(i.panSpeed),q(M.x,M.y),y.copy(w),i.update()}function mt(te){Ae(te),te.deltaY<0?ye(U()):te.deltaY>0&&ie(U()),i.update()}function At(te){let Le=!1;switch(te.code){case i.keys.UP:q(0,i.keyPanSpeed),Le=!0;break;case i.keys.BOTTOM:q(0,-i.keyPanSpeed),Le=!0;break;case i.keys.LEFT:q(i.keyPanSpeed,0),Le=!0;break;case i.keys.RIGHT:q(-i.keyPanSpeed,0),Le=!0;break}Le&&(te.preventDefault(),i.update())}function X(){if(T.length==1)_.set(T[0].pageX,T[0].pageY);else{const te=.5*(T[0].pageX+T[1].pageX),Le=.5*(T[0].pageY+T[1].pageY);_.set(te,Le)}}function Fe(){if(T.length==1)y.set(T[0].pageX,T[0].pageY);else{const te=.5*(T[0].pageX+T[1].pageX),Le=.5*(T[0].pageY+T[1].pageY);y.set(te,Le)}}function Be(){const te=T[0].pageX-T[1].pageX,Le=T[0].pageY-T[1].pageY,Q=Math.sqrt(te*te+Le*Le);R.set(0,Q)}function Ke(){i.enableZoom&&Be(),i.enablePan&&Fe()}function Pe(){i.enableZoom&&Be(),i.enableRotate&&X()}function gt(te){if(T.length==1)E.set(te.pageX,te.pageY);else{const Q=wt(te),Ce=.5*(te.pageX+Q.x),re=.5*(te.pageY+Q.y);E.set(Ce,re)}S.subVectors(E,_).multiplyScalar(i.rotateSpeed);const Le=i.domElement;Le&&(se(2*Math.PI*S.x/Le.clientHeight),fe(2*Math.PI*S.y/Le.clientHeight)),_.copy(E)}function Ze(te){if(T.length==1)w.set(te.pageX,te.pageY);else{const Le=wt(te),Q=.5*(te.pageX+Le.x),Ce=.5*(te.pageY+Le.y);w.set(Q,Ce)}M.subVectors(w,y).multiplyScalar(i.panSpeed),q(M.x,M.y),y.copy(w)}function st(te){const Le=wt(te),Q=te.pageX-Le.x,Ce=te.pageY-Le.y,re=Math.sqrt(Q*Q+Ce*Ce);z.set(0,re),k.set(0,Math.pow(z.y/R.y,i.zoomSpeed)),ie(k.y),R.copy(z)}function Z(te){i.enableZoom&&st(te),i.enablePan&&Ze(te)}function B(te){i.enableZoom&&st(te),i.enableRotate&&gt(te)}function me(te){var Le,Q;i.enabled!==!1&&(T.length===0&&((Le=i.domElement)==null||Le.ownerDocument.addEventListener("pointermove",Re),(Q=i.domElement)==null||Q.ownerDocument.addEventListener("pointerup",Te)),Dt(te),te.pointerType==="touch"?bt(te):ke(te))}function Re(te){i.enabled!==!1&&(te.pointerType==="touch"?We(te):it(te))}function Te(te){var Le,Q,Ce;yt(te),T.length===0&&((Le=i.domElement)==null||Le.releasePointerCapture(te.pointerId),(Q=i.domElement)==null||Q.ownerDocument.removeEventListener("pointermove",Re),(Ce=i.domElement)==null||Ce.ownerDocument.removeEventListener("pointerup",Te)),i.dispatchEvent(o),c=a.NONE}function ke(te){let Le;switch(te.button){case 0:Le=i.mouseButtons.LEFT;break;case 1:Le=i.mouseButtons.MIDDLE;break;case 2:Le=i.mouseButtons.RIGHT;break;default:Le=-1}switch(Le){case Il.DOLLY:if(i.enableZoom===!1)return;De(te),c=a.DOLLY;break;case Il.ROTATE:if(te.ctrlKey||te.metaKey||te.shiftKey){if(i.enablePan===!1)return;Oe(te),c=a.PAN}else{if(i.enableRotate===!1)return;pe(te),c=a.ROTATE}break;case Il.PAN:if(te.ctrlKey||te.metaKey||te.shiftKey){if(i.enableRotate===!1)return;pe(te),c=a.ROTATE}else{if(i.enablePan===!1)return;Oe(te),c=a.PAN}break;default:c=a.NONE}c!==a.NONE&&i.dispatchEvent(s)}function it(te){if(i.enabled!==!1)switch(c){case a.ROTATE:if(i.enableRotate===!1)return;He(te);break;case a.DOLLY:if(i.enableZoom===!1)return;ut(te);break;case a.PAN:if(i.enablePan===!1)return;Tt(te);break}}function Ge(te){i.enabled===!1||i.enableZoom===!1||c!==a.NONE&&c!==a.ROTATE||(te.preventDefault(),i.dispatchEvent(s),mt(te),i.dispatchEvent(o))}function Qe(te){i.enabled===!1||i.enablePan===!1||At(te)}function bt(te){switch($e(te),T.length){case 1:switch(i.touches.ONE){case Rl.ROTATE:if(i.enableRotate===!1)return;X(),c=a.TOUCH_ROTATE;break;case Rl.PAN:if(i.enablePan===!1)return;Fe(),c=a.TOUCH_PAN;break;default:c=a.NONE}break;case 2:switch(i.touches.TWO){case Rl.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;Ke(),c=a.TOUCH_DOLLY_PAN;break;case Rl.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;Pe(),c=a.TOUCH_DOLLY_ROTATE;break;default:c=a.NONE}break;default:c=a.NONE}c!==a.NONE&&i.dispatchEvent(s)}function We(te){switch($e(te),c){case a.TOUCH_ROTATE:if(i.enableRotate===!1)return;gt(te),i.update();break;case a.TOUCH_PAN:if(i.enablePan===!1)return;Ze(te),i.update();break;case a.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;Z(te),i.update();break;case a.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;B(te),i.update();break;default:c=a.NONE}}function nt(te){i.enabled!==!1&&te.preventDefault()}function Dt(te){T.push(te)}function yt(te){delete L[te.pointerId];for(let Le=0;Le<T.length;Le++)if(T[Le].pointerId==te.pointerId){T.splice(Le,1);return}}function $e(te){let Le=L[te.pointerId];Le===void 0&&(Le=new Ie,L[te.pointerId]=Le),Le.set(te.pageX,te.pageY)}function wt(te){const Le=te.pointerId===T[0].pointerId?T[1]:T[0];return L[Le.pointerId]}this.dollyIn=(te=U())=>{ye(te),i.update()},this.dollyOut=(te=U())=>{ie(te),i.update()},this.getScale=()=>m,this.setScale=te=>{le(te),i.update()},this.getZoomScale=()=>U(),t!==void 0&&this.connect(t),this.update()}};class DV extends S1{constructor(e){super(e),this.type=xi}parse(e){const o=function(b,A){switch(b){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(A||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(A||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(A||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(A||""))}},f=`
`,d=function(b,A,T){A=A||1024;let H=b.pos,U=-1,se=0,fe="",oe=String.fromCharCode.apply(null,new Uint16Array(b.subarray(H,H+128)));for(;0>(U=oe.indexOf(f))&&se<A&&H<b.byteLength;)fe+=oe,se+=oe.length,H+=128,oe+=String.fromCharCode.apply(null,new Uint16Array(b.subarray(H,H+128)));return-1<U?(b.pos+=se+U+1,fe+oe.slice(0,U)):!1},m=function(b){const A=/^#\?(\S+)/,T=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,L=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,H=/^\s*FORMAT=(\S+)\s*$/,U=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,se={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let fe,oe;for((b.pos>=b.byteLength||!(fe=d(b)))&&o(1,"no header found"),(oe=fe.match(A))||o(3,"bad initial token"),se.valid|=1,se.programtype=oe[1],se.string+=fe+`
`;fe=d(b),fe!==!1;){if(se.string+=fe+`
`,fe.charAt(0)==="#"){se.comments+=fe+`
`;continue}if((oe=fe.match(T))&&(se.gamma=parseFloat(oe[1])),(oe=fe.match(L))&&(se.exposure=parseFloat(oe[1])),(oe=fe.match(H))&&(se.valid|=2,se.format=oe[1]),(oe=fe.match(U))&&(se.valid|=4,se.height=parseInt(oe[1],10),se.width=parseInt(oe[2],10)),se.valid&2&&se.valid&4)break}return se.valid&2||o(3,"missing format specifier"),se.valid&4||o(3,"missing image size specifier"),se},v=function(b,A,T){const L=A;if(L<8||L>32767||b[0]!==2||b[1]!==2||b[2]&128)return new Uint8Array(b);L!==(b[2]<<8|b[3])&&o(3,"wrong scanline width");const H=new Uint8Array(4*A*T);H.length||o(4,"unable to allocate buffer space");let U=0,se=0;const fe=4*L,oe=new Uint8Array(4),Se=new Uint8Array(fe);let q=T;for(;q>0&&se<b.byteLength;){se+4>b.byteLength&&o(1),oe[0]=b[se++],oe[1]=b[se++],oe[2]=b[se++],oe[3]=b[se++],(oe[0]!=2||oe[1]!=2||(oe[2]<<8|oe[3])!=L)&&o(3,"bad rgbe scanline format");let le=0,ie;for(;le<fe&&se<b.byteLength;){ie=b[se++];const Ae=ie>128;if(Ae&&(ie-=128),(ie===0||le+ie>fe)&&o(3,"bad scanline data"),Ae){const ze=b[se++];for(let pe=0;pe<ie;pe++)Se[le++]=ze}else Se.set(b.subarray(se,se+ie),le),le+=ie,se+=ie}const ye=L;for(let Ae=0;Ae<ye;Ae++){let ze=0;H[U]=Se[Ae+ze],ze+=L,H[U+1]=Se[Ae+ze],ze+=L,H[U+2]=Se[Ae+ze],ze+=L,H[U+3]=Se[Ae+ze],U+=4}q--}return H},_=function(b,A,T,L){const H=b[A+3],U=Math.pow(2,H-128)/255;T[L+0]=b[A+0]*U,T[L+1]=b[A+1]*U,T[L+2]=b[A+2]*U,T[L+3]=1},E=function(b,A,T,L){const H=b[A+3],U=Math.pow(2,H-128)/255;T[L+0]=Hl.toHalfFloat(Math.min(b[A+0]*U,65504)),T[L+1]=Hl.toHalfFloat(Math.min(b[A+1]*U,65504)),T[L+2]=Hl.toHalfFloat(Math.min(b[A+2]*U,65504)),T[L+3]=Hl.toHalfFloat(1)},S=new Uint8Array(e);S.pos=0;const y=m(S),w=y.width,M=y.height,R=v(S.subarray(S.pos),w,M);let z,k,P;switch(this.type){case zn:P=R.length/4;const b=new Float32Array(P*4);for(let T=0;T<P;T++)_(R,T*4,b,T*4);z=b,k=zn;break;case xi:P=R.length/4;const A=new Uint16Array(P*4);for(let T=0;T<P;T++)E(R,T*4,A,T*4);z=A,k=xi;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:w,height:M,data:z,header:y.string,gamma:y.gamma,exposure:y.exposure,type:k}}setDataType(e){return this.type=e,this}load(e,t,i,r){function s(o,a){switch(o.type){case zn:case xi:"colorSpace"in o?o.colorSpace="srgb-linear":o.encoding=3e3,o.minFilter=mn,o.magFilter=mn,o.generateMipmaps=!1,o.flipY=!0;break}t&&t(o,a)}return super.load(e,s,i,r)}}const cf=EL>=152;class kV extends S1{constructor(e){super(e),this.type=xi}parse(e){const A=Math.pow(2.7182818,2.2);function T(F,G){for(var ne=0,O=0;O<65536;++O)(O==0||F[O>>3]&1<<(O&7))&&(G[ne++]=O);for(var W=ne-1;ne<65536;)G[ne++]=0;return W}function L(F){for(var G=0;G<16384;G++)F[G]={},F[G].len=0,F[G].lit=0,F[G].p=null}const H={l:0,c:0,lc:0};function U(F,G,ne,O,W){for(;ne<F;)G=G<<8|wt(O,W),ne+=8;ne-=F,H.l=G>>ne&(1<<F)-1,H.c=G,H.lc=ne}const se=new Array(59);function fe(F){for(var G=0;G<=58;++G)se[G]=0;for(var G=0;G<65537;++G)se[F[G]]+=1;for(var ne=0,G=58;G>0;--G){var O=ne+se[G]>>1;se[G]=ne,ne=O}for(var G=0;G<65537;++G){var W=F[G];W>0&&(F[G]=W|se[W]++<<6)}}function oe(F,G,ne,O,W,Y,ee){for(var $=ne,he=0,de=0;W<=Y;W++){if($.value-ne.value>O)return!1;U(6,he,de,F,$);var _e=H.l;if(he=H.c,de=H.lc,ee[W]=_e,_e==63){if($.value-ne.value>O)throw"Something wrong with hufUnpackEncTable";U(8,he,de,F,$);var ge=H.l+6;if(he=H.c,de=H.lc,W+ge>Y+1)throw"Something wrong with hufUnpackEncTable";for(;ge--;)ee[W++]=0;W--}else if(_e>=59){var ge=_e-59+2;if(W+ge>Y+1)throw"Something wrong with hufUnpackEncTable";for(;ge--;)ee[W++]=0;W--}}fe(ee)}function Se(F){return F&63}function q(F){return F>>6}function le(F,G,ne,O){for(;G<=ne;G++){var W=q(F[G]),Y=Se(F[G]);if(W>>Y)throw"Invalid table entry";if(Y>14){var ee=O[W>>Y-14];if(ee.len)throw"Invalid table entry";if(ee.lit++,ee.p){var $=ee.p;ee.p=new Array(ee.lit);for(var he=0;he<ee.lit-1;++he)ee.p[he]=$[he]}else ee.p=new Array(1);ee.p[ee.lit-1]=G}else if(Y)for(var de=0,he=1<<14-Y;he>0;he--){var ee=O[(W<<14-Y)+de];if(ee.len||ee.p)throw"Invalid table entry";ee.len=Y,ee.lit=G,de++}}return!0}const ie={c:0,lc:0};function ye(F,G,ne,O){F=F<<8|wt(ne,O),G+=8,ie.c=F,ie.lc=G}const Ae={c:0,lc:0};function ze(F,G,ne,O,W,Y,ee,$,he,de){if(F==G){O<8&&(ye(ne,O,W,ee),ne=ie.c,O=ie.lc),O-=8;var _e=ne>>O,_e=new Uint8Array([_e])[0];if(he.value+_e>de)return!1;for(var ge=$[he.value-1];_e-- >0;)$[he.value++]=ge}else if(he.value<de)$[he.value++]=F;else return!1;Ae.c=ne,Ae.lc=O}function pe(F){return F&65535}function De(F){var G=pe(F);return G>32767?G-65536:G}const Oe={a:0,b:0};function He(F,G){var ne=De(F),O=De(G),W=O,Y=ne+(W&1)+(W>>1),ee=Y,$=Y-W;Oe.a=ee,Oe.b=$}function ut(F,G){var ne=pe(F),O=pe(G),W=ne-(O>>1)&65535,Y=O+W-32768&65535;Oe.a=Y,Oe.b=W}function Tt(F,G,ne,O,W,Y,ee){for(var $=ee<16384,he=ne>W?W:ne,de=1,_e;de<=he;)de<<=1;for(de>>=1,_e=de,de>>=1;de>=1;){for(var ge=0,et=ge+Y*(W-_e),Ue=Y*de,Ne=Y*_e,Je=O*de,ct=O*_e,vt,Ct,tt,Ve;ge<=et;ge+=Ne){for(var xt=ge,dt=ge+O*(ne-_e);xt<=dt;xt+=ct){var Et=xt+Je,Jt=xt+Ue,ln=Jt+Je;$?(He(F[xt+G],F[Jt+G]),vt=Oe.a,tt=Oe.b,He(F[Et+G],F[ln+G]),Ct=Oe.a,Ve=Oe.b,He(vt,Ct),F[xt+G]=Oe.a,F[Et+G]=Oe.b,He(tt,Ve),F[Jt+G]=Oe.a,F[ln+G]=Oe.b):(ut(F[xt+G],F[Jt+G]),vt=Oe.a,tt=Oe.b,ut(F[Et+G],F[ln+G]),Ct=Oe.a,Ve=Oe.b,ut(vt,Ct),F[xt+G]=Oe.a,F[Et+G]=Oe.b,ut(tt,Ve),F[Jt+G]=Oe.a,F[ln+G]=Oe.b)}if(ne&de){var Jt=xt+Ue;$?He(F[xt+G],F[Jt+G]):ut(F[xt+G],F[Jt+G]),vt=Oe.a,F[Jt+G]=Oe.b,F[xt+G]=vt}}if(W&de)for(var xt=ge,dt=ge+O*(ne-_e);xt<=dt;xt+=ct){var Et=xt+Je;$?He(F[xt+G],F[Et+G]):ut(F[xt+G],F[Et+G]),vt=Oe.a,F[Et+G]=Oe.b,F[xt+G]=vt}_e=de,de>>=1}return ge}function mt(F,G,ne,O,W,Y,ee,$,he,de){for(var _e=0,ge=0,et=$,Ue=Math.trunc(W.value+(Y+7)/8);W.value<Ue;)for(ye(_e,ge,ne,W),_e=ie.c,ge=ie.lc;ge>=14;){var Ne=_e>>ge-14&16383,Je=G[Ne];if(Je.len)ge-=Je.len,ze(Je.lit,ee,_e,ge,ne,O,W,he,de,et),_e=Ae.c,ge=Ae.lc;else{if(!Je.p)throw"hufDecode issues";var ct;for(ct=0;ct<Je.lit;ct++){for(var vt=Se(F[Je.p[ct]]);ge<vt&&W.value<Ue;)ye(_e,ge,ne,W),_e=ie.c,ge=ie.lc;if(ge>=vt&&q(F[Je.p[ct]])==(_e>>ge-vt&(1<<vt)-1)){ge-=vt,ze(Je.p[ct],ee,_e,ge,ne,O,W,he,de,et),_e=Ae.c,ge=Ae.lc;break}}if(ct==Je.lit)throw"hufDecode issues"}}var Ct=8-Y&7;for(_e>>=Ct,ge-=Ct;ge>0;){var Je=G[_e<<14-ge&16383];if(Je.len)ge-=Je.len,ze(Je.lit,ee,_e,ge,ne,O,W,he,de,et),_e=Ae.c,ge=Ae.lc;else throw"hufDecode issues"}return!0}function At(F,G,ne,O,W,Y){var ee={value:0},$=ne.value,he=$e(G,ne),de=$e(G,ne);ne.value+=4;var _e=$e(G,ne);if(ne.value+=4,he<0||he>=65537||de<0||de>=65537)throw"Something wrong with HUF_ENCSIZE";var ge=new Array(65537),et=new Array(16384);L(et);var Ue=O-(ne.value-$);if(oe(F,G,ne,Ue,he,de,ge),_e>8*(O-(ne.value-$)))throw"Something wrong with hufUncompress";le(ge,he,de,et),mt(ge,et,F,G,ne,_e,de,Y,W,ee)}function X(F,G,ne){for(var O=0;O<ne;++O)G[O]=F[G[O]]}function Fe(F){for(var G=1;G<F.length;G++){var ne=F[G-1]+F[G]-128;F[G]=ne}}function Be(F,G){for(var ne=0,O=Math.floor((F.length+1)/2),W=0,Y=F.length-1;!(W>Y||(G[W++]=F[ne++],W>Y));)G[W++]=F[O++]}function Ke(F){for(var G=F.byteLength,ne=new Array,O=0,W=new DataView(F);G>0;){var Y=W.getInt8(O++);if(Y<0){var ee=-Y;G-=ee+1;for(var $=0;$<ee;$++)ne.push(W.getUint8(O++))}else{var ee=Y;G-=2;for(var he=W.getUint8(O++),$=0;$<ee+1;$++)ne.push(he)}}return ne}function Pe(F,G,ne,O,W,Y){var Et=new DataView(Y.buffer),ee=ne[F.idx[0]].width,$=ne[F.idx[0]].height,he=3,de=Math.floor(ee/8),_e=Math.ceil(ee/8),ge=Math.ceil($/8),et=ee-(_e-1)*8,Ue=$-(ge-1)*8,Ne={value:0},Je=new Array(he),ct=new Array(he),vt=new Array(he),Ct=new Array(he),tt=new Array(he);for(let Ht=0;Ht<he;++Ht)tt[Ht]=G[F.idx[Ht]],Je[Ht]=Ht<1?0:Je[Ht-1]+_e*ge,ct[Ht]=new Float32Array(64),vt[Ht]=new Uint16Array(64),Ct[Ht]=new Uint16Array(_e*64);for(let Ht=0;Ht<ge;++Ht){var Ve=8;Ht==ge-1&&(Ve=Ue);var xt=8;for(let Pt=0;Pt<_e;++Pt){Pt==_e-1&&(xt=et);for(let kt=0;kt<he;++kt)vt[kt].fill(0),vt[kt][0]=W[Je[kt]++],gt(Ne,O,vt[kt]),Ze(vt[kt],ct[kt]),st(ct[kt]);Z(ct);for(let kt=0;kt<he;++kt)B(ct[kt],Ct[kt],Pt*64)}let Cn=0;for(let Pt=0;Pt<he;++Pt){const kt=ne[F.idx[Pt]].type;for(let fn=8*Ht;fn<8*Ht+Ve;++fn){Cn=tt[Pt][fn];for(let wi=0;wi<de;++wi){const pi=wi*64+(fn&7)*8;Et.setUint16(Cn+0*2*kt,Ct[Pt][pi+0],!0),Et.setUint16(Cn+1*2*kt,Ct[Pt][pi+1],!0),Et.setUint16(Cn+2*2*kt,Ct[Pt][pi+2],!0),Et.setUint16(Cn+3*2*kt,Ct[Pt][pi+3],!0),Et.setUint16(Cn+4*2*kt,Ct[Pt][pi+4],!0),Et.setUint16(Cn+5*2*kt,Ct[Pt][pi+5],!0),Et.setUint16(Cn+6*2*kt,Ct[Pt][pi+6],!0),Et.setUint16(Cn+7*2*kt,Ct[Pt][pi+7],!0),Cn+=8*2*kt}}if(de!=_e)for(let fn=8*Ht;fn<8*Ht+Ve;++fn){const wi=tt[Pt][fn]+8*de*2*kt,pi=de*64+(fn&7)*8;for(let Qt=0;Qt<xt;++Qt)Et.setUint16(wi+Qt*2*kt,Ct[Pt][pi+Qt],!0)}}}for(var dt=new Uint16Array(ee),Et=new DataView(Y.buffer),Jt=0;Jt<he;++Jt){ne[F.idx[Jt]].decoded=!0;var ln=ne[F.idx[Jt]].type;if(ne[Jt].type==2)for(var Mn=0;Mn<$;++Mn){const Ht=tt[Jt][Mn];for(var Wt=0;Wt<ee;++Wt)dt[Wt]=Et.getUint16(Ht+Wt*2*ln,!0);for(var Wt=0;Wt<ee;++Wt)Et.setFloat32(Ht+Wt*2*ln,re(dt[Wt]),!0)}}}function gt(F,G,ne){for(var O,W=1;W<64;)O=G[F.value],O==65280?W=64:O>>8==255?W+=O&255:(ne[W]=O,W++),F.value++}function Ze(F,G){G[0]=re(F[0]),G[1]=re(F[1]),G[2]=re(F[5]),G[3]=re(F[6]),G[4]=re(F[14]),G[5]=re(F[15]),G[6]=re(F[27]),G[7]=re(F[28]),G[8]=re(F[2]),G[9]=re(F[4]),G[10]=re(F[7]),G[11]=re(F[13]),G[12]=re(F[16]),G[13]=re(F[26]),G[14]=re(F[29]),G[15]=re(F[42]),G[16]=re(F[3]),G[17]=re(F[8]),G[18]=re(F[12]),G[19]=re(F[17]),G[20]=re(F[25]),G[21]=re(F[30]),G[22]=re(F[41]),G[23]=re(F[43]),G[24]=re(F[9]),G[25]=re(F[11]),G[26]=re(F[18]),G[27]=re(F[24]),G[28]=re(F[31]),G[29]=re(F[40]),G[30]=re(F[44]),G[31]=re(F[53]),G[32]=re(F[10]),G[33]=re(F[19]),G[34]=re(F[23]),G[35]=re(F[32]),G[36]=re(F[39]),G[37]=re(F[45]),G[38]=re(F[52]),G[39]=re(F[54]),G[40]=re(F[20]),G[41]=re(F[22]),G[42]=re(F[33]),G[43]=re(F[38]),G[44]=re(F[46]),G[45]=re(F[51]),G[46]=re(F[55]),G[47]=re(F[60]),G[48]=re(F[21]),G[49]=re(F[34]),G[50]=re(F[37]),G[51]=re(F[47]),G[52]=re(F[50]),G[53]=re(F[56]),G[54]=re(F[59]),G[55]=re(F[61]),G[56]=re(F[35]),G[57]=re(F[36]),G[58]=re(F[48]),G[59]=re(F[49]),G[60]=re(F[57]),G[61]=re(F[58]),G[62]=re(F[62]),G[63]=re(F[63])}function st(F){const G=.5*Math.cos(.7853975),ne=.5*Math.cos(3.14159/16),O=.5*Math.cos(3.14159/8),W=.5*Math.cos(3*3.14159/16),Y=.5*Math.cos(5*3.14159/16),ee=.5*Math.cos(3*3.14159/8),$=.5*Math.cos(7*3.14159/16);for(var he=new Array(4),de=new Array(4),_e=new Array(4),ge=new Array(4),et=0;et<8;++et){var Ue=et*8;he[0]=O*F[Ue+2],he[1]=ee*F[Ue+2],he[2]=O*F[Ue+6],he[3]=ee*F[Ue+6],de[0]=ne*F[Ue+1]+W*F[Ue+3]+Y*F[Ue+5]+$*F[Ue+7],de[1]=W*F[Ue+1]-$*F[Ue+3]-ne*F[Ue+5]-Y*F[Ue+7],de[2]=Y*F[Ue+1]-ne*F[Ue+3]+$*F[Ue+5]+W*F[Ue+7],de[3]=$*F[Ue+1]-Y*F[Ue+3]+W*F[Ue+5]-ne*F[Ue+7],_e[0]=G*(F[Ue+0]+F[Ue+4]),_e[3]=G*(F[Ue+0]-F[Ue+4]),_e[1]=he[0]+he[3],_e[2]=he[1]-he[2],ge[0]=_e[0]+_e[1],ge[1]=_e[3]+_e[2],ge[2]=_e[3]-_e[2],ge[3]=_e[0]-_e[1],F[Ue+0]=ge[0]+de[0],F[Ue+1]=ge[1]+de[1],F[Ue+2]=ge[2]+de[2],F[Ue+3]=ge[3]+de[3],F[Ue+4]=ge[3]-de[3],F[Ue+5]=ge[2]-de[2],F[Ue+6]=ge[1]-de[1],F[Ue+7]=ge[0]-de[0]}for(var Ne=0;Ne<8;++Ne)he[0]=O*F[16+Ne],he[1]=ee*F[16+Ne],he[2]=O*F[48+Ne],he[3]=ee*F[48+Ne],de[0]=ne*F[8+Ne]+W*F[24+Ne]+Y*F[40+Ne]+$*F[56+Ne],de[1]=W*F[8+Ne]-$*F[24+Ne]-ne*F[40+Ne]-Y*F[56+Ne],de[2]=Y*F[8+Ne]-ne*F[24+Ne]+$*F[40+Ne]+W*F[56+Ne],de[3]=$*F[8+Ne]-Y*F[24+Ne]+W*F[40+Ne]-ne*F[56+Ne],_e[0]=G*(F[Ne]+F[32+Ne]),_e[3]=G*(F[Ne]-F[32+Ne]),_e[1]=he[0]+he[3],_e[2]=he[1]-he[2],ge[0]=_e[0]+_e[1],ge[1]=_e[3]+_e[2],ge[2]=_e[3]-_e[2],ge[3]=_e[0]-_e[1],F[0+Ne]=ge[0]+de[0],F[8+Ne]=ge[1]+de[1],F[16+Ne]=ge[2]+de[2],F[24+Ne]=ge[3]+de[3],F[32+Ne]=ge[3]-de[3],F[40+Ne]=ge[2]-de[2],F[48+Ne]=ge[1]-de[1],F[56+Ne]=ge[0]-de[0]}function Z(F){for(var G=0;G<64;++G){var ne=F[0][G],O=F[1][G],W=F[2][G];F[0][G]=ne+1.5747*W,F[1][G]=ne-.1873*O-.4682*W,F[2][G]=ne+1.8556*O}}function B(F,G,ne){for(var O=0;O<64;++O)G[ne+O]=Hl.toHalfFloat(me(F[O]))}function me(F){return F<=1?Math.sign(F)*Math.pow(Math.abs(F),2.2):Math.sign(F)*Math.pow(A,Math.abs(F)-1)}function Re(F){return new DataView(F.array.buffer,F.offset.value,F.size)}function Te(F){var G=F.viewer.buffer.slice(F.offset.value,F.offset.value+F.size),ne=new Uint8Array(Ke(G)),O=new Uint8Array(ne.length);return Fe(ne),Be(ne,O),new DataView(O.buffer)}function ke(F){var G=F.array.slice(F.offset.value,F.offset.value+F.size),ne=eg(G),O=new Uint8Array(ne.length);return Fe(ne),Be(ne,O),new DataView(O.buffer)}function it(F){for(var G=F.viewer,ne={value:F.offset.value},O=new Uint16Array(F.width*F.scanlineBlockSize*(F.channels*F.type)),W=new Uint8Array(8192),Y=0,ee=new Array(F.channels),$=0;$<F.channels;$++)ee[$]={},ee[$].start=Y,ee[$].end=ee[$].start,ee[$].nx=F.width,ee[$].ny=F.lines,ee[$].size=F.type,Y+=ee[$].nx*ee[$].ny*ee[$].size;var he=Me(G,ne),de=Me(G,ne);if(de>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(he<=de)for(var $=0;$<de-he+1;$++)W[$+he]=te(G,ne);var _e=new Uint16Array(65536),ge=T(W,_e),et=$e(G,ne);At(F.array,G,ne,et,O,Y);for(var $=0;$<F.channels;++$)for(var Ue=ee[$],Ne=0;Ne<ee[$].size;++Ne)Tt(O,Ue.start+Ne,Ue.nx,Ue.size,Ue.ny,Ue.nx*Ue.size,ge);X(_e,O,Y);for(var Je=0,ct=new Uint8Array(O.buffer.byteLength),vt=0;vt<F.lines;vt++)for(var Ct=0;Ct<F.channels;Ct++){var Ue=ee[Ct],tt=Ue.nx*Ue.size,Ve=new Uint8Array(O.buffer,Ue.end*2,tt*2);ct.set(Ve,Je),Je+=tt*2,Ue.end+=tt}return new DataView(ct.buffer)}function Ge(F){var G=F.array.slice(F.offset.value,F.offset.value+F.size),ne=eg(G);const O=F.lines*F.channels*F.width,W=F.type==1?new Uint16Array(O):new Uint32Array(O);let Y=0,ee=0;const $=new Array(4);for(let he=0;he<F.lines;he++)for(let de=0;de<F.channels;de++){let _e=0;switch(F.type){case 1:$[0]=Y,$[1]=$[0]+F.width,Y=$[1]+F.width;for(let ge=0;ge<F.width;++ge){const et=ne[$[0]++]<<8|ne[$[1]++];_e+=et,W[ee]=_e,ee++}break;case 2:$[0]=Y,$[1]=$[0]+F.width,$[2]=$[1]+F.width,Y=$[2]+F.width;for(let ge=0;ge<F.width;++ge){const et=ne[$[0]++]<<24|ne[$[1]++]<<16|ne[$[2]++]<<8;_e+=et,W[ee]=_e,ee++}break}}return new DataView(W.buffer)}function Qe(F){var G=F.viewer,ne={value:F.offset.value},O=new Uint8Array(F.width*F.lines*(F.channels*F.type*2)),W={version:Le(G,ne),unknownUncompressedSize:Le(G,ne),unknownCompressedSize:Le(G,ne),acCompressedSize:Le(G,ne),dcCompressedSize:Le(G,ne),rleCompressedSize:Le(G,ne),rleUncompressedSize:Le(G,ne),rleRawSize:Le(G,ne),totalAcUncompressedCount:Le(G,ne),totalDcUncompressedCount:Le(G,ne),acCompression:Le(G,ne)};if(W.version<2)throw"EXRLoader.parse: "+qn.compression+" version "+W.version+" is unsupported";for(var Y=new Array,ee=Me(G,ne)-2;ee>0;){var $=bt(G.buffer,ne),he=te(G,ne),de=he>>2&3,_e=(he>>4)-1,ge=new Int8Array([_e])[0],et=te(G,ne);Y.push({name:$,index:ge,type:et,compression:de}),ee-=$.length+3}for(var Ue=qn.channels,Ne=new Array(F.channels),Je=0;Je<F.channels;++Je){var ct=Ne[Je]={},vt=Ue[Je];ct.name=vt.name,ct.compression=0,ct.decoded=!1,ct.type=vt.pixelType,ct.pLinear=vt.pLinear,ct.width=F.width,ct.height=F.lines}for(var Ct={idx:new Array(3)},tt=0;tt<F.channels;++tt)for(var ct=Ne[tt],Je=0;Je<Y.length;++Je){var Ve=Y[Je];ct.name==Ve.name&&(ct.compression=Ve.compression,Ve.index>=0&&(Ct.idx[Ve.index]=tt),ct.offset=tt)}if(W.acCompressedSize>0)switch(W.acCompression){case 0:var Et=new Uint16Array(W.totalAcUncompressedCount);At(F.array,G,ne,W.acCompressedSize,Et,W.totalAcUncompressedCount);break;case 1:var xt=F.array.slice(ne.value,ne.value+W.totalAcUncompressedCount),dt=eg(xt),Et=new Uint16Array(dt.buffer);ne.value+=W.totalAcUncompressedCount;break}if(W.dcCompressedSize>0){var Jt={array:F.array,offset:ne,size:W.dcCompressedSize},ln=new Uint16Array(ke(Jt).buffer);ne.value+=W.dcCompressedSize}if(W.rleRawSize>0){var xt=F.array.slice(ne.value,ne.value+W.rleCompressedSize),dt=eg(xt),Mn=Ke(dt.buffer);ne.value+=W.rleCompressedSize}for(var Wt=0,Ht=new Array(Ne.length),Je=0;Je<Ht.length;++Je)Ht[Je]=new Array;for(var Cn=0;Cn<F.lines;++Cn)for(var Pt=0;Pt<Ne.length;++Pt)Ht[Pt].push(Wt),Wt+=Ne[Pt].width*F.type*2;Pe(Ct,Ht,Ne,Et,ln,O);for(var Je=0;Je<Ne.length;++Je){var ct=Ne[Je];if(!ct.decoded)switch(ct.compression){case 2:for(var kt=0,fn=0,Cn=0;Cn<F.lines;++Cn){for(var wi=Ht[Je][kt],pi=0;pi<ct.width;++pi){for(var Qt=0;Qt<2*ct.type;++Qt)O[wi++]=Mn[fn+Qt*ct.width*ct.height];fn++}kt++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(O.buffer)}function bt(F,G){for(var ne=new Uint8Array(F),O=0;ne[G.value+O]!=0;)O+=1;var W=new TextDecoder().decode(ne.slice(G.value,G.value+O));return G.value=G.value+O+1,W}function We(F,G,ne){var O=new TextDecoder().decode(new Uint8Array(F).slice(G.value,G.value+ne));return G.value=G.value+ne,O}function nt(F,G){var ne=yt(F,G),O=$e(F,G);return[ne,O]}function Dt(F,G){var ne=$e(F,G),O=$e(F,G);return[ne,O]}function yt(F,G){var ne=F.getInt32(G.value,!0);return G.value=G.value+4,ne}function $e(F,G){var ne=F.getUint32(G.value,!0);return G.value=G.value+4,ne}function wt(F,G){var ne=F[G.value];return G.value=G.value+1,ne}function te(F,G){var ne=F.getUint8(G.value);return G.value=G.value+1,ne}const Le=function(F,G){let ne;return"getBigInt64"in DataView.prototype?ne=Number(F.getBigInt64(G.value,!0)):ne=F.getUint32(G.value+4,!0)+Number(F.getUint32(G.value,!0)<<32),G.value+=8,ne};function Q(F,G){var ne=F.getFloat32(G.value,!0);return G.value+=4,ne}function Ce(F,G){return Hl.toHalfFloat(Q(F,G))}function re(F){var G=(F&31744)>>10,ne=F&1023;return(F>>15?-1:1)*(G?G===31?ne?NaN:1/0:Math.pow(2,G-15)*(1+ne/1024):6103515625e-14*(ne/1024))}function Me(F,G){var ne=F.getUint16(G.value,!0);return G.value+=2,ne}function je(F,G){return re(Me(F,G))}function Mt(F,G,ne,O){for(var W=ne.value,Y=[];ne.value<W+O-1;){var ee=bt(G,ne),$=yt(F,ne),he=te(F,ne);ne.value+=3;var de=yt(F,ne),_e=yt(F,ne);Y.push({name:ee,pixelType:$,pLinear:he,xSampling:de,ySampling:_e})}return ne.value+=1,Y}function Nt(F,G){var ne=Q(F,G),O=Q(F,G),W=Q(F,G),Y=Q(F,G),ee=Q(F,G),$=Q(F,G),he=Q(F,G),de=Q(F,G);return{redX:ne,redY:O,greenX:W,greenY:Y,blueX:ee,blueY:$,whiteX:he,whiteY:de}}function $t(F,G){var ne=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],O=te(F,G);return ne[O]}function en(F,G){var ne=$e(F,G),O=$e(F,G),W=$e(F,G),Y=$e(F,G);return{xMin:ne,yMin:O,xMax:W,yMax:Y}}function Ut(F,G){var ne=["INCREASING_Y"],O=te(F,G);return ne[O]}function wn(F,G){var ne=Q(F,G),O=Q(F,G);return[ne,O]}function Dn(F,G){var ne=Q(F,G),O=Q(F,G),W=Q(F,G);return[ne,O,W]}function xn(F,G,ne,O,W){if(O==="string"||O==="stringvector"||O==="iccProfile")return We(G,ne,W);if(O==="chlist")return Mt(F,G,ne,W);if(O==="chromaticities")return Nt(F,ne);if(O==="compression")return $t(F,ne);if(O==="box2i")return en(F,ne);if(O==="lineOrder")return Ut(F,ne);if(O==="float")return Q(F,ne);if(O==="v2f")return wn(F,ne);if(O==="v3f")return Dn(F,ne);if(O==="int")return yt(F,ne);if(O==="rational")return nt(F,ne);if(O==="timecode")return Dt(F,ne);if(O==="preview")return ne.value+=W,"skipped";ne.value+=W}function ur(F,G,ne){const O={};if(F.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";O.version=F.getUint8(4);const W=F.getUint8(5);O.spec={singleTile:!!(W&2),longName:!!(W&4),deepFormat:!!(W&8),multiPart:!!(W&16)},ne.value=8;for(var Y=!0;Y;){var ee=bt(G,ne);if(ee==0)Y=!1;else{var $=bt(G,ne),he=$e(F,ne),de=xn(F,G,ne,$,he);de===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${$}'.`):O[ee]=de}}if(W&-5)throw console.error("EXRHeader:",O),"THREE.EXRLoader: provided file is currently unsupported.";return O}function Er(F,G,ne,O,W){const Y={size:0,viewer:G,array:ne,offset:O,width:F.dataWindow.xMax-F.dataWindow.xMin+1,height:F.dataWindow.yMax-F.dataWindow.yMin+1,channels:F.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:F.channels[0].pixelType,uncompress:null,getter:null,format:null,[cf?"colorSpace":"encoding"]:null};switch(F.compression){case"NO_COMPRESSION":Y.lines=1,Y.uncompress=Re;break;case"RLE_COMPRESSION":Y.lines=1,Y.uncompress=Te;break;case"ZIPS_COMPRESSION":Y.lines=1,Y.uncompress=ke;break;case"ZIP_COMPRESSION":Y.lines=16,Y.uncompress=ke;break;case"PIZ_COMPRESSION":Y.lines=32,Y.uncompress=it;break;case"PXR24_COMPRESSION":Y.lines=16,Y.uncompress=Ge;break;case"DWAA_COMPRESSION":Y.lines=32,Y.uncompress=Qe;break;case"DWAB_COMPRESSION":Y.lines=256,Y.uncompress=Qe;break;default:throw"EXRLoader.parse: "+F.compression+" is unsupported"}if(Y.scanlineBlockSize=Y.lines,Y.type==1)switch(W){case zn:Y.getter=je,Y.inputSize=2;break;case xi:Y.getter=Me,Y.inputSize=2;break}else if(Y.type==2)switch(W){case zn:Y.getter=Q,Y.inputSize=4;break;case xi:Y.getter=Ce,Y.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+Y.type+" for "+F.compression+".";Y.blockCount=(F.dataWindow.yMax+1)/Y.scanlineBlockSize;for(var ee=0;ee<Y.blockCount;ee++)Le(G,O);Y.outputChannels=Y.channels==3?4:Y.channels;const $=Y.width*Y.height*Y.outputChannels;switch(W){case zn:Y.byteArray=new Float32Array($),Y.channels<Y.outputChannels&&Y.byteArray.fill(1,0,$);break;case xi:Y.byteArray=new Uint16Array($),Y.channels<Y.outputChannels&&Y.byteArray.fill(15360,0,$);break;default:console.error("THREE.EXRLoader: unsupported type: ",W);break}return Y.bytesPerLine=Y.width*Y.inputSize*Y.channels,Y.outputChannels==4?Y.format=Qn:Y.format=Fd,cf?Y.colorSpace="srgb-linear":Y.encoding=3e3,Y}const Ii=new DataView(e),Bs=new Uint8Array(e),hr={value:0},qn=ur(Ii,e,hr),Ft=Er(qn,Ii,Bs,hr,this.type),po={value:0},Hs={R:0,G:1,B:2,A:3,Y:0};for(let F=0;F<Ft.height/Ft.scanlineBlockSize;F++){const G=$e(Ii,hr);Ft.size=$e(Ii,hr),Ft.lines=G+Ft.scanlineBlockSize>Ft.height?Ft.height-G:Ft.scanlineBlockSize;const O=Ft.size<Ft.lines*Ft.bytesPerLine?Ft.uncompress(Ft):Re(Ft);hr.value+=Ft.size;for(let W=0;W<Ft.scanlineBlockSize;W++){const Y=W+F*Ft.scanlineBlockSize;if(Y>=Ft.height)break;for(let ee=0;ee<Ft.channels;ee++){const $=Hs[qn.channels[ee].name];for(let he=0;he<Ft.width;he++){po.value=(W*(Ft.channels*Ft.width)+ee*Ft.width+he)*Ft.inputSize;const de=(Ft.height-1-Y)*(Ft.width*Ft.outputChannels)+he*Ft.outputChannels+$;Ft.byteArray[de]=Ft.getter(O,po)}}}}return{header:qn,width:Ft.width,height:Ft.height,data:Ft.byteArray,format:Ft.format,[cf?"colorSpace":"encoding"]:Ft[cf?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,i,r){function s(o,a){cf?o.colorSpace=a.colorSpace:o.encoding=a.encoding,o.minFilter=mn,o.magFilter=mn,o.generateMipmaps=!1,o.flipY=!1,t&&t(o,a)}return super.load(e,s,i,r)}}function OV(n,e,t,i){const r=class extends ir{constructor(o={}){const a=Object.entries(n);super({uniforms:a.reduce((c,[h,f])=>{const d=t1.clone({[h]:{value:f}});return{...c,...d}},{}),vertexShader:e,fragmentShader:t}),this.key="",a.forEach(([c])=>Object.defineProperty(this,c,{get:()=>this.uniforms[c].value,set:h=>this.uniforms[c].value=h})),Object.assign(this,o)}};return r.key=Av.generateUUID(),r}const UV=()=>parseInt(ch.replace(/\D+/g,"")),FV=UV(),zV=be.forwardRef(({makeDefault:n,camera:e,regress:t,domElement:i,enableDamping:r=!0,keyEvents:s=!1,onChange:o,onStart:a,onEnd:c,...h},f)=>{const d=Or(k=>k.invalidate),m=Or(k=>k.camera),v=Or(k=>k.gl),_=Or(k=>k.events),E=Or(k=>k.setEvents),S=Or(k=>k.set),y=Or(k=>k.get),w=Or(k=>k.performance),M=e||m,R=i||_.connected||v.domElement,z=be.useMemo(()=>new NV(M),[M]);return O0(()=>{z.enabled&&z.update()},-1),be.useEffect(()=>(s&&z.connect(s===!0?R:s),z.connect(R),()=>void z.dispose()),[s,R,t,z,d]),be.useEffect(()=>{const k=A=>{d(),t&&w.regress(),o&&o(A)},P=A=>{a&&a(A)},b=A=>{c&&c(A)};return z.addEventListener("change",k),z.addEventListener("start",P),z.addEventListener("end",b),()=>{z.removeEventListener("start",P),z.removeEventListener("end",b),z.removeEventListener("change",k)}},[o,a,c,z,d,E]),be.useEffect(()=>{if(n){const k=y().controls;return S({controls:z}),()=>S({controls:k})}},[n,z]),be.createElement("primitive",nh({ref:f,object:z,enableDamping:r},h))}),BV=OV({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new lt,sectionColor:new lt,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new j,worldPlanePosition:new j},`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform vec3 worldPlanePosition;
    uniform float fadeDistance;
    uniform bool infiniteGrid;
    uniform bool followCamera;

    void main() {
      localPosition = position.xzy;
      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;
      
      worldPosition = modelMatrix * vec4(localPosition, 1.0);
      if (followCamera) {
        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);
        localPosition = (inverse(modelMatrix) * worldPosition).xyz;
      }

      gl_Position = projectionMatrix * viewMatrix * worldPosition;
    }
  `,`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform float cellSize;
    uniform float sectionSize;
    uniform vec3 cellColor;
    uniform vec3 sectionColor;
    uniform float fadeDistance;
    uniform float fadeStrength;
    uniform float fadeFrom;
    uniform float cellThickness;
    uniform float sectionThickness;

    float getGrid(float size, float thickness) {
      vec2 r = localPosition.xz / size;
      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
      float line = min(grid.x, grid.y) + 1.0 - thickness;
      return 1.0 - min(line, 1.0);
    }

    void main() {
      float g1 = getGrid(cellSize, cellThickness);
      float g2 = getGrid(sectionSize, sectionThickness);

      vec3 from = worldCamProjPosition*vec3(fadeFrom);
      float dist = distance(from, worldPosition.xyz);
      float d = 1.0 - min(dist / fadeDistance, 1.0);
      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));

      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));
      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);
      if (gl_FragColor.a <= 0.0) discard;

      #include <tonemapping_fragment>
      #include <${FV>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `),HV=be.forwardRef(({args:n,cellColor:e="#000000",sectionColor:t="#2080ff",cellSize:i=.5,sectionSize:r=1,followCamera:s=!1,infiniteGrid:o=!1,fadeDistance:a=100,fadeStrength:c=1,fadeFrom:h=1,cellThickness:f=.5,sectionThickness:d=1,side:m=Hi,...v},_)=>{P1({GridMaterial:BV});const E=be.useRef(null);be.useImperativeHandle(_,()=>E.current,[]);const S=new $s,y=new j(0,1,0),w=new j(0,0,0);O0(z=>{S.setFromNormalAndCoplanarPoint(y,w).applyMatrix4(E.current.matrixWorld);const k=E.current.material,P=k.uniforms.worldCamProjPosition,b=k.uniforms.worldPlanePosition;S.projectPoint(z.camera.position,P.value),b.value.set(0,0,0).applyMatrix4(E.current.matrixWorld)});const M={cellSize:i,sectionSize:r,cellColor:e,sectionColor:t,cellThickness:f,sectionThickness:d},R={fadeDistance:a,fadeStrength:c,fadeFrom:h,infiniteGrid:o,followCamera:s};return be.createElement("mesh",nh({ref:E,frustumCulled:!1},v),be.createElement("gridMaterial",nh({transparent:!0,"extensions-derivatives":!0,side:m},M,R)),be.createElement("planeGeometry",{args:n}))}),VV=3e3,GV=3001,PL=(n,e,t)=>{let i;switch(n){case Mr:i=new Uint8ClampedArray(e*t*4);break;case xi:i=new Uint16Array(e*t*4);break;case ao:i=new Uint32Array(e*t*4);break;case o0:i=new Int8Array(e*t*4);break;case a0:i=new Int16Array(e*t*4);break;case Ud:i=new Int32Array(e*t*4);break;case zn:i=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return i};let ng;const WV=(n,e,t,i)=>{if(ng!==void 0)return ng;const r=new jr(1,1,i);e.setRenderTarget(r);const s=new Bn(new $a,new Ko({color:16777215}));e.render(s,t),e.setRenderTarget(null);const o=PL(n,r.width,r.height);return e.readRenderTargetPixels(r,0,0,r.width,r.height,o),r.dispose(),s.geometry.dispose(),s.material.dispose(),ng=o[0]!==0,ng};class k1{constructor(e){var t,i,r,s,o,a,c,h,f,d,m,v,_,E,S,y;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(M){throw this._renderer.setRenderTarget(null),M}this._renderer.setRenderTarget(null)},this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const w={format:Qn,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((t=e.renderTargetOptions)===null||t===void 0?void 0:t.anisotropy)!==void 0?(i=e.renderTargetOptions)===null||i===void 0?void 0:i.anisotropy:1,generateMipmaps:((r=e.renderTargetOptions)===null||r===void 0?void 0:r.generateMipmaps)!==void 0?(s=e.renderTargetOptions)===null||s===void 0?void 0:s.generateMipmaps:!1,magFilter:((o=e.renderTargetOptions)===null||o===void 0?void 0:o.magFilter)!==void 0?(a=e.renderTargetOptions)===null||a===void 0?void 0:a.magFilter:mn,minFilter:((c=e.renderTargetOptions)===null||c===void 0?void 0:c.minFilter)!==void 0?(h=e.renderTargetOptions)===null||h===void 0?void 0:h.minFilter:mn,samples:((f=e.renderTargetOptions)===null||f===void 0?void 0:f.samples)!==void 0?(d=e.renderTargetOptions)===null||d===void 0?void 0:d.samples:void 0,wrapS:((m=e.renderTargetOptions)===null||m===void 0?void 0:m.wrapS)!==void 0?(v=e.renderTargetOptions)===null||v===void 0?void 0:v.wrapS:li,wrapT:((_=e.renderTargetOptions)===null||_===void 0?void 0:_.wrapT)!==void 0?(E=e.renderTargetOptions)===null||E===void 0?void 0:E.wrapT:li};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=k1.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Wd,this._camera=new Bo,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!WV(this._type,this._renderer,this._camera,w)){let M;switch(this._type){case xi:M=this._renderer.extensions.has("EXT_color_buffer_float")?zn:void 0;break}M!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${zn}`),this._type=M):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new Bn(new $a,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new jr(this.width,this.height,w),this._renderTarget.texture.mapping=((S=e.renderTargetOptions)===null||S===void 0?void 0:S.mapping)!==void 0?(y=e.renderTargetOptions)===null||y===void 0?void 0:y.mapping:Va}static instantiateRenderer(){const e=new a1;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=PL(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new Ds(this.toArray(),this.width,this.height,Qn,this._type,(e==null?void 0:e.mapping)||Va,(e==null?void 0:e.wrapS)||li,(e==null?void 0:e.wrapT)||li,(e==null?void 0:e.magFilter)||mn,(e==null?void 0:e.minFilter)||mn,(e==null?void 0:e.anisotropy)||1,fs);return t.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof ir&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof yn&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof yn&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const jV=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,XV=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class qV extends ir{constructor({gamma:e,offsetHdr:t,offsetSdr:i,gainMapMin:r,gainMapMax:s,maxDisplayBoost:o,hdrCapacityMin:a,hdrCapacityMax:c,sdr:h,gainMap:f}){super({name:"GainMapDecoderMaterial",vertexShader:jV,fragmentShader:XV,uniforms:{sdr:{value:h},gainMap:{value:f},gamma:{value:new j(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new j().fromArray(t)},offsetSdr:{value:new j().fromArray(i)},gainMapMin:{value:new j().fromArray(r)},gainMapMax:{value:new j().fromArray(s)},weightFactor:{value:(Math.log2(o)-a)/(c-a)}},blending:to,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=o,this._hdrCapacityMin=a,this._hdrCapacityMax=c,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class LL extends Error{}class NL extends Error{}const uf=(n,e,t)=>{const i=new RegExp(`${e}="([^"]*)"`,"i").exec(n);if(i)return i[1];const r=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(n);if(r){const s=r[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return s&&s.length===3?s.map(o=>o.replace(/<\/?rdf:li>/g,"")):r[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},YV=n=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(n):e=n.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const i=e.indexOf("x:xmpmeta>",t),r=e.slice(t,i+10);try{const s=uf(r,"hdrgm:GainMapMin","0"),o=uf(r,"hdrgm:GainMapMax"),a=uf(r,"hdrgm:Gamma","1"),c=uf(r,"hdrgm:OffsetSDR","0.015625"),h=uf(r,"hdrgm:OffsetHDR","0.015625"),f=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(r),d=f?f[1]:"0",m=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(r);if(!m)throw new Error("Incomplete gainmap metadata");const v=m[1];return{gainMapMin:Array.isArray(s)?s.map(_=>parseFloat(_)):[parseFloat(s),parseFloat(s),parseFloat(s)],gainMapMax:Array.isArray(o)?o.map(_=>parseFloat(_)):[parseFloat(o),parseFloat(o),parseFloat(o)],gamma:Array.isArray(a)?a.map(_=>parseFloat(_)):[parseFloat(a),parseFloat(a),parseFloat(a)],offsetSdr:Array.isArray(c)?c.map(_=>parseFloat(_)):[parseFloat(c),parseFloat(c),parseFloat(c)],offsetHdr:Array.isArray(h)?h.map(_=>parseFloat(_)):[parseFloat(h),parseFloat(h),parseFloat(h)],hdrCapacityMin:parseFloat(d),hdrCapacityMax:parseFloat(v)}}catch{}t=e.indexOf("<x:xmpmeta",i)}};class $V{constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,i)=>{const r=this.options.debug,s=new DataView(e.buffer);if(s.getUint16(0)!==65496){i(new Error("Not a valid jpeg"));return}const o=s.byteLength;let a=2,c=0,h;for(;a<o;){if(++c>250){i(new Error(`Found no marker after ${c} loops `));return}if(s.getUint8(a)!==255){i(new Error(`Not a valid marker at offset 0x${a.toString(16)}, found: 0x${s.getUint8(a).toString(16)}`));return}if(h=s.getUint8(a+1),r&&console.log(`Marker: ${h.toString(16)}`),h===226){r&&console.log("Found APP2 marker (0xffe2)");const f=a+4;if(s.getUint32(f)===1297106432){const d=f+4;let m;if(s.getUint16(d)===18761)m=!1;else if(s.getUint16(d)===19789)m=!0;else{i(new Error("No valid endianness marker found in TIFF header"));return}if(s.getUint16(d+2,!m)!==42){i(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const v=s.getUint32(d+4,!m);if(v<8){i(new Error("Not valid TIFF data! (First offset less than 8)"));return}const _=d+v,E=s.getUint16(_,!m),S=_+2;let y=0;for(let z=S;z<S+12*E;z+=12)s.getUint16(z,!m)===45057&&(y=s.getUint32(z+8,!m));const M=_+2+E*12+4,R=[];for(let z=M;z<M+y*16;z+=16){const k={MPType:s.getUint32(z,!m),size:s.getUint32(z+4,!m),dataOffset:s.getUint32(z+8,!m),dependantImages:s.getUint32(z+12,!m),start:-1,end:-1,isFII:!1};k.dataOffset?(k.start=d+k.dataOffset,k.isFII=!1):(k.start=0,k.isFII=!0),k.end=k.start+k.size,R.push(k)}if(this.options.extractNonFII&&R.length){const z=new Blob([s]),k=[];for(const P of R){if(P.isFII&&!this.options.extractFII)continue;const b=z.slice(P.start,P.end+1,"image/jpeg");k.push(b)}t(k)}}}a+=2+s.getUint16(a+2)}})}}const KV=async n=>{const e=YV(n);if(!e)throw new NL("Gain map XMP metadata not found");const i=await new $V({extractFII:!0,extractNonFII:!0}).extract(n);if(i.length!==2)throw new LL("Gain map recovery image not found");return{sdr:new Uint8Array(await i[0].arrayBuffer()),gainMap:new Uint8Array(await i[1].arrayBuffer()),metadata:e}},Db=n=>new Promise((e,t)=>{const i=document.createElement("img");i.onload=()=>{e(i)},i.onerror=r=>{t(r)},i.src=URL.createObjectURL(n)});class DL extends lr{constructor(e,t){super(t),e&&(this._renderer=e),this._internalLoadingManager=new D0}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=new qV({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new yn,sdr:new yn});return new k1({width:16,height:16,type:xi,colorSpace:fs,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(e,t,i,r){const s=r?new Blob([r],{type:"image/jpeg"}):void 0,o=new Blob([i],{type:"image/jpeg"});let a,c,h=!1;if(typeof createImageBitmap>"u"){const m=await Promise.all([s?Db(s):Promise.resolve(void 0),Db(o)]);c=m[0],a=m[1],h=!0}else{const m=await Promise.all([s?createImageBitmap(s,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(o,{imageOrientation:"flipY"})]);c=m[0],a=m[1]}const f=new yn(c||new ImageData(2,2),Va,li,li,mn,vS,Qn,Mr,1,fs);f.flipY=h,f.needsUpdate=!0;const d=new yn(a,Va,li,li,mn,vS,Qn,Mr,1,Ur);d.flipY=h,d.needsUpdate=!0,e.width=a.width,e.height=a.height,e.material.gainMap=f,e.material.sdr=d,e.material.gainMapMin=t.gainMapMin,e.material.gainMapMax=t.gainMapMax,e.material.offsetHdr=t.offsetHdr,e.material.offsetSdr=t.offsetSdr,e.material.gamma=t.gamma,e.material.hdrCapacityMin=t.hdrCapacityMin,e.material.hdrCapacityMax=t.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,t.hdrCapacityMax),e.material.needsUpdate=!0,e.render()}}class ZV extends DL{load([e,t,i],r,s,o){const a=this.prepareQuadRenderer();let c,h,f;const d=async()=>{if(c&&h&&f){try{await this.render(a,f,c,h)}catch(A){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(i),typeof o=="function"&&o(A),a.disposeOnDemandRenderer();return}typeof r=="function"&&r(a),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(i),a.disposeOnDemandRenderer()}};let m=!0,v=0,_=0,E=!0,S=0,y=0,w=!0,M=0,R=0;const z=()=>{if(typeof s=="function"){const A=v+S+M,T=_+y+R,L=m&&E&&w;s(new ProgressEvent("progress",{lengthComputable:L,loaded:T,total:A}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(i);const k=new Vr(this._internalLoadingManager);k.setResponseType("arraybuffer"),k.setRequestHeader(this.requestHeader),k.setPath(this.path),k.setWithCredentials(this.withCredentials),k.load(e,async A=>{if(typeof A=="string")throw new Error("Invalid sdr buffer");c=A,await d()},A=>{m=A.lengthComputable,_=A.loaded,v=A.total,z()},A=>{this.manager.itemError(e),typeof o=="function"&&o(A)});const P=new Vr(this._internalLoadingManager);P.setResponseType("arraybuffer"),P.setRequestHeader(this.requestHeader),P.setPath(this.path),P.setWithCredentials(this.withCredentials),P.load(t,async A=>{if(typeof A=="string")throw new Error("Invalid gainmap buffer");h=A,await d()},A=>{E=A.lengthComputable,y=A.loaded,S=A.total,z()},A=>{this.manager.itemError(t),typeof o=="function"&&o(A)});const b=new Vr(this._internalLoadingManager);return b.setRequestHeader(this.requestHeader),b.setPath(this.path),b.setWithCredentials(this.withCredentials),b.load(i,async A=>{if(typeof A!="string")throw new Error("Invalid metadata string");f=JSON.parse(A),await d()},A=>{w=A.lengthComputable,R=A.loaded,M=A.total,z()},A=>{this.manager.itemError(i),typeof o=="function"&&o(A)}),a}}class JV extends DL{load(e,t,i,r){const s=this.prepareQuadRenderer(),o=new Vr(this._internalLoadingManager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(this.withCredentials),this.manager.itemStart(e),o.load(e,async a=>{if(typeof a=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const c=new Uint8Array(a);let h,f,d;try{const m=await KV(c);h=m.sdr,f=m.gainMap,d=m.metadata}catch(m){if(m instanceof NL||m instanceof LL)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),d={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},h=c;else throw m}try{await this.render(s,d,h,f)}catch(m){this.manager.itemError(e),typeof r=="function"&&r(m),s.disposeOnDemandRenderer();return}typeof t=="function"&&t(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()},i,a=>{this.manager.itemError(e),typeof r=="function"&&r(a)}),s}}const Ad={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},kL="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",Uu=n=>Array.isArray(n),O1=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function U0({files:n=O1,path:e="",preset:t=void 0,encoding:i=void 0,extensions:r}={}){let s=null,o=!1;t&&(U1(t),n=Ad[t],e=kL),o=Uu(n);const{extension:a,isCubemap:c}=F1(n);if(s=z1(a),!s)throw new Error("useEnvironment: Unrecognized file extension: "+n);const h=Or(v=>v.gl);be.useLayoutEffect(()=>{if(a!=="webp"&&a!=="jpg"&&a!=="jpeg")return;function v(){eh.clear(s,o?[n]:n)}h.domElement.addEventListener("webglcontextlost",v,{once:!0})},[n,h.domElement]);const f=eh(s,o?[n]:n,v=>{(a==="webp"||a==="jpg"||a==="jpeg")&&v.setRenderer(h),v.setPath==null||v.setPath(e),r&&r(v)});let d=o?f[0]:f;if(a==="jpg"||a==="jpeg"||a==="webp"){var m;d=(m=d.renderTarget)==null?void 0:m.texture}return d.mapping=c?oo:$u,"colorSpace"in d?d.colorSpace=i??c?"srgb":"srgb-linear":d.encoding=i??c?GV:VV,d}const QV={files:O1,path:"",preset:void 0,extensions:void 0};U0.preload=n=>{const e={...QV,...n};let{files:t,path:i=""}=e;const{preset:r,extensions:s}=e;r&&(U1(r),t=Ad[r],i=kL);const{extension:o}=F1(t);if(o==="webp"||o==="jpg"||o==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const a=z1(o);if(!a)throw new Error("useEnvironment: Unrecognized file extension: "+t);eh.preload(a,Uu(t)?[t]:t,c=>{c.setPath==null||c.setPath(i),s&&s(c)})};const e8={files:O1,preset:void 0};U0.clear=n=>{const e={...e8,...n};let{files:t}=e;const{preset:i}=e;i&&(U1(i),t=Ad[i]);const{extension:r}=F1(t),s=z1(r);if(!s)throw new Error("useEnvironment: Unrecognized file extension: "+t);eh.clear(s,Uu(t)?[t]:t)};function U1(n){if(!(n in Ad))throw new Error("Preset must be one of: "+Object.keys(Ad).join(", "))}function F1(n){var e;const t=Uu(n)&&n.length===6,i=Uu(n)&&n.length===3&&n.some(o=>o.endsWith("json")),r=Uu(n)?n[0]:n;return{extension:t?"cube":i?"webp":r.startsWith("data:application/exr")?"exr":r.startsWith("data:application/hdr")?"hdr":r.startsWith("data:image/jpeg")?"jpg":(e=r.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:i}}function z1(n){return n==="cube"?BP:n==="hdr"?DV:n==="exr"?kV:n==="jpg"||n==="jpeg"?JV:n==="webp"?ZV:null}const t8=n=>n.current&&n.current.isScene,n8=n=>t8(n)?n.current:n;function B1(n,e,t,i,r={}){var s,o,a,c;r={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...r};const h=n8(e||t),f=h.background,d=h.environment,m={backgroundBlurriness:h.backgroundBlurriness,backgroundIntensity:h.backgroundIntensity,backgroundRotation:(s=(o=h.backgroundRotation)==null||o.clone==null?void 0:o.clone())!==null&&s!==void 0?s:[0,0,0],environmentIntensity:h.environmentIntensity,environmentRotation:(a=(c=h.environmentRotation)==null||c.clone==null?void 0:c.clone())!==null&&a!==void 0?a:[0,0,0]};return n!=="only"&&(h.environment=i),n&&(h.background=i),ya(h,r),()=>{n!=="only"&&(h.environment=d),n&&(h.background=f),ya(h,m)}}function H1({scene:n,background:e=!1,map:t,...i}){const r=Or(s=>s.scene);return be.useLayoutEffect(()=>{if(t)return B1(e,n,r,t,i)}),null}function OL({background:n=!1,scene:e,blur:t,backgroundBlurriness:i,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:o,environmentRotation:a,...c}){const h=U0(c),f=Or(d=>d.scene);return be.useLayoutEffect(()=>B1(n,e,f,h,{backgroundBlurriness:t??i,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:o,environmentRotation:a})),be.useEffect(()=>()=>{h.dispose()},[h]),null}function i8({children:n,near:e=.1,far:t=1e3,resolution:i=256,frames:r=1,map:s,background:o=!1,blur:a,backgroundBlurriness:c,backgroundIntensity:h,backgroundRotation:f,environmentIntensity:d,environmentRotation:m,scene:v,files:_,path:E,preset:S=void 0,extensions:y}){const w=Or(b=>b.gl),M=Or(b=>b.scene),R=be.useRef(null),[z]=be.useState(()=>new Wd),k=be.useMemo(()=>{const b=new n1(i);return b.texture.type=xi,b},[i]);be.useEffect(()=>()=>{k.dispose()},[k]),be.useLayoutEffect(()=>{if(r===1){const b=w.autoClear;w.autoClear=!0,R.current.update(w,z),w.autoClear=b}return B1(o,v,M,k.texture,{backgroundBlurriness:a??c,backgroundIntensity:h,backgroundRotation:f,environmentIntensity:d,environmentRotation:m})},[n,z,k.texture,v,M,o,r,w]);let P=1;return O0(()=>{if(r===1/0||P<r){const b=w.autoClear;w.autoClear=!0,R.current.update(w,z),w.autoClear=b,P++}}),be.createElement(be.Fragment,null,XH(be.createElement(be.Fragment,null,n,be.createElement("cubeCamera",{ref:R,args:[e,t,k]}),_||S?be.createElement(OL,{background:!0,files:_,preset:S,path:E,extensions:y}):s?be.createElement(H1,{background:!0,map:s,extensions:y}):null),z))}function r8(n){var e,t,i,r;const s=U0(n),o=n.map||s;be.useMemo(()=>P1({GroundProjectedEnvImpl:TV}),[]),be.useEffect(()=>()=>{s.dispose()},[s]);const a=be.useMemo(()=>[o],[o]),c=(e=n.ground)==null?void 0:e.height,h=(t=n.ground)==null?void 0:t.radius,f=(i=(r=n.ground)==null?void 0:r.scale)!==null&&i!==void 0?i:1e3;return be.createElement(be.Fragment,null,be.createElement(H1,nh({},n,{map:o})),be.createElement("groundProjectedEnvImpl",{args:a,scale:f,height:c,radius:h}))}function s8(n){return n.ground?be.createElement(r8,n):n.map?be.createElement(H1,n):n.children?be.createElement(i8,n):be.createElement(OL,n)}const o8={},kb=n=>{let e;const t=new Set,i=(f,d)=>{const m=typeof f=="function"?f(e):f;if(!Object.is(m,e)){const v=e;e=d??(typeof m!="object"||m===null)?m:Object.assign({},e,m),t.forEach(_=>_(e,v))}},r=()=>e,c={setState:i,getState:r,getInitialState:()=>h,subscribe:f=>(t.add(f),()=>t.delete(f)),destroy:()=>{(o8?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},h=e=n(i,r,c);return c},a8=n=>n?kb(n):kb;var UL={exports:{}},FL={},zL={exports:{}},BL={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ih=be;function l8(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var c8=typeof Object.is=="function"?Object.is:l8,u8=ih.useState,h8=ih.useEffect,f8=ih.useLayoutEffect,d8=ih.useDebugValue;function p8(n,e){var t=e(),i=u8({inst:{value:t,getSnapshot:e}}),r=i[0].inst,s=i[1];return f8(function(){r.value=t,r.getSnapshot=e,ax(r)&&s({inst:r})},[n,t,e]),h8(function(){return ax(r)&&s({inst:r}),n(function(){ax(r)&&s({inst:r})})},[n]),d8(t),t}function ax(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!c8(n,t)}catch{return!0}}function m8(n,e){return e()}var g8=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?m8:p8;BL.useSyncExternalStore=ih.useSyncExternalStore!==void 0?ih.useSyncExternalStore:g8;zL.exports=BL;var v8=zL.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var F0=be,y8=v8;function _8(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var x8=typeof Object.is=="function"?Object.is:_8,S8=y8.useSyncExternalStore,w8=F0.useRef,M8=F0.useEffect,E8=F0.useMemo,T8=F0.useDebugValue;FL.useSyncExternalStoreWithSelector=function(n,e,t,i,r){var s=w8(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=E8(function(){function c(v){if(!h){if(h=!0,f=v,v=i(v),r!==void 0&&o.hasValue){var _=o.value;if(r(_,v))return d=_}return d=v}if(_=d,x8(f,v))return _;var E=i(v);return r!==void 0&&r(_,E)?(f=v,_):(f=v,d=E)}var h=!1,f,d,m=t===void 0?null:t;return[function(){return c(e())},m===null?void 0:function(){return c(m())}]},[e,t,i,r]);var a=S8(n,s[0],s[1]);return M8(function(){o.hasValue=!0,o.value=a},[a]),T8(a),a};UL.exports=FL;var A8=UL.exports;const b8=jS(A8),HL={},{useDebugValue:C8}=sD,{useSyncExternalStoreWithSelector:I8}=b8;let Ob=!1;const R8=n=>n;function P8(n,e=R8,t){(HL?"production":void 0)!=="production"&&t&&!Ob&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Ob=!0);const i=I8(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return C8(i),i}const Ub=n=>{(HL?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?a8(n):n,t=(i,r)=>P8(e,i,r);return Object.assign(t,e),t},VL=n=>n?Ub(n):Ub,L8=n=>(e,t,i)=>{const r=i.subscribe;return i.subscribe=(o,a,c)=>{let h=o;if(a){const f=(c==null?void 0:c.equalityFn)||Object.is;let d=o(i.getState());h=m=>{const v=o(m);if(!f(d,v)){const _=d;a(d=v,_)}},c!=null&&c.fireImmediately&&a(d,d)}return r(h)},n(e,t,i)},N8=L8,D8={id:"player-1",position:{x:0,y:0,z:0},rotation:0,isMoving:!1,currentRoom:"main-lab"},k8={showLIMS:!1,showInventory:!1,showMissions:!1,activeEquipmentInterface:void 0,showQRScanner:!1,notifications:[]},zs=VL()(N8((n,e)=>({player:D8,currentLaboratory:null,activeMissions:[],inventory:[],currentSample:void 0,ui:k8,updatePlayerPosition:t=>n(i=>({player:{...i.player,position:t}})),updatePlayerRotation:t=>n(i=>({player:{...i.player,rotation:t}})),setPlayerMoving:t=>n(i=>({player:{...i.player,isMoving:t}})),setInteractionTarget:t=>n(i=>({player:{...i.player,interactionTarget:t}})),setCurrentLaboratory:t=>n({currentLaboratory:t}),setActiveMissions:t=>n({activeMissions:t}),addMission:t=>n(i=>({activeMissions:[...i.activeMissions,t]})),updateMission:(t,i)=>n(r=>({activeMissions:r.activeMissions.map(s=>s.id===t?{...s,...i}:s)})),setCurrentSample:t=>n({currentSample:t}),toggleLIMS:()=>n(t=>({ui:{...t.ui,showLIMS:!t.ui.showLIMS}})),toggleInventory:()=>n(t=>({ui:{...t.ui,showInventory:!t.ui.showInventory}})),toggleMissions:()=>n(t=>({ui:{...t.ui,showMissions:!t.ui.showMissions}})),setActiveEquipmentInterface:t=>n(i=>({ui:{...i.ui,activeEquipmentInterface:t}})),toggleQRScanner:()=>n(t=>({ui:{...t.ui,showQRScanner:!t.ui.showQRScanner}})),addNotification:t=>n(i=>({ui:{...i.ui,notifications:[...i.ui.notifications,{...t,id:`notification-${Date.now()}-${Math.random()}`,timestamp:new Date,read:!1}]}})),markNotificationRead:t=>n(i=>({ui:{...i.ui,notifications:i.ui.notifications.map(r=>r.id===t?{...r,read:!0}:r)}})),clearNotifications:()=>n(t=>({ui:{...t.ui,notifications:[]}}))}))),Fb={forward:!1,backward:!1,left:!1,right:!1,interact:!1,inventory:!1,menu:!1},GL=VL(n=>({controls:Fb,updateControls:e=>n(t=>({controls:{...t.controls,...e}})),resetControls:()=>n({controls:Fb})}));function O8({position:n=[0,.5,0]}){const e=be.useRef(null),{controls:t}=GL(),{player:i,updatePlayerPosition:r,updatePlayerRotation:s,setPlayerMoving:o}=zs(),a=be.useRef(new j),c=be.useRef(new j),h=5,f=.1;return O0((d,m)=>{if(!e.current)return;let v=!1;if(c.current.set(0,0,0),t.forward&&(c.current.z-=1,v=!0),t.backward&&(c.current.z+=1,v=!0),t.left&&(c.current.x-=1,v=!0),t.right&&(c.current.x+=1,v=!0),v){if(c.current.normalize(),a.current.copy(c.current).multiplyScalar(h*m),e.current.position.add(a.current),c.current.length()>0){const _=Math.atan2(c.current.x,c.current.z);e.current.rotation.y=Av.lerp(e.current.rotation.y,_,f),s(e.current.rotation.y)}r({x:e.current.position.x,y:e.current.position.y,z:e.current.position.z})}o(v),v?e.current.position.y=n[1]+Math.sin(d.clock.elapsedTime*8)*.05:e.current.position.y=Av.lerp(e.current.position.y,n[1],.1)}),be.useEffect(()=>{e.current&&e.current.position.set(...n)},[n]),K.jsxs("group",{children:[K.jsxs("mesh",{ref:e,castShadow:!0,children:[K.jsx("capsuleGeometry",{args:[.3,1.2,4,8]}),K.jsx("meshStandardMaterial",{color:"#4f46e5"})]}),K.jsxs("mesh",{position:[0,.3,-.4],castShadow:!0,children:[K.jsx("sphereGeometry",{args:[.1]}),K.jsx("meshStandardMaterial",{color:"#1f2937"})]})]})}function zb({type:n,position:e,id:t}){const[i,r]=be.useState(!1),{setActiveEquipmentInterface:s,player:o}=zs(),a=()=>{Math.sqrt(Math.pow(o.position.x-e[0],2)+Math.pow(o.position.z-e[2],2))<3&&s(t)},c=()=>{switch(n){case"balance":return K.jsxs("group",{children:[K.jsxs("mesh",{position:[0,0,0],children:[K.jsx("boxGeometry",{args:[.4,.1,.3]}),K.jsx("meshStandardMaterial",{color:"#d1d5db"})]}),K.jsxs("mesh",{position:[0,.1,0],children:[K.jsx("cylinderGeometry",{args:[.15,.15,.02]}),K.jsx("meshStandardMaterial",{color:"#9ca3af"})]}),K.jsxs("mesh",{position:[.2,.15,0],children:[K.jsx("boxGeometry",{args:[.1,.05,.02]}),K.jsx("meshStandardMaterial",{color:"#111827"})]})]});case"GC-MS":return K.jsxs("group",{children:[K.jsxs("mesh",{position:[0,.2,0],children:[K.jsx("boxGeometry",{args:[1.2,.4,.8]}),K.jsx("meshStandardMaterial",{color:"#e5e7eb"})]}),K.jsxs("mesh",{position:[0,.4,.4],children:[K.jsx("boxGeometry",{args:[.8,.1,.02]}),K.jsx("meshStandardMaterial",{color:"#1f2937"})]}),K.jsxs("mesh",{position:[-.3,.4,.2],children:[K.jsx("cylinderGeometry",{args:[.02,.02,.1]}),K.jsx("meshStandardMaterial",{color:"#4b5563"})]})]});default:return K.jsxs("mesh",{children:[K.jsx("boxGeometry",{args:[.5,.3,.5]}),K.jsx("meshStandardMaterial",{color:"#6b7280"})]})}};return K.jsxs("group",{position:e,onClick:a,onPointerEnter:()=>r(!0),onPointerLeave:()=>r(!1),children:[c(),i&&K.jsxs("mesh",{position:[0,.8,0],children:[K.jsx("cylinderGeometry",{args:[.3,.3,.02]}),K.jsx("meshBasicMaterial",{color:"#3b82f6",transparent:!0,opacity:.7})]}),K.jsx("group",{position:[0,.6,0],children:K.jsxs("mesh",{children:[K.jsx("planeGeometry",{args:[1,.2]}),K.jsx("meshBasicMaterial",{color:"#1f2937",transparent:!0,opacity:.8})]})})]})}function U8({laboratory:n}){return K.jsxs("group",{children:[K.jsxs("mesh",{receiveShadow:!0,position:[0,-.1,0],children:[K.jsx("boxGeometry",{args:[20,.2,20]}),K.jsx("meshStandardMaterial",{color:"#e5e7eb"})]}),K.jsxs("group",{children:[K.jsxs("mesh",{position:[0,2.5,10],children:[K.jsx("boxGeometry",{args:[20,5,.2]}),K.jsx("meshStandardMaterial",{color:"#f3f4f6"})]}),K.jsxs("mesh",{position:[-10,2.5,0],children:[K.jsx("boxGeometry",{args:[.2,5,20]}),K.jsx("meshStandardMaterial",{color:"#f3f4f6"})]}),K.jsxs("mesh",{position:[10,2.5,0],children:[K.jsx("boxGeometry",{args:[.2,5,20]}),K.jsx("meshStandardMaterial",{color:"#f3f4f6"})]})]}),K.jsxs("mesh",{position:[0,5.1,0],children:[K.jsx("boxGeometry",{args:[20,.2,20]}),K.jsx("meshStandardMaterial",{color:"#f9fafb"})]}),K.jsxs("group",{position:[0,0,3],children:[K.jsxs("mesh",{position:[0,.9,0],receiveShadow:!0,children:[K.jsx("boxGeometry",{args:[8,.1,2]}),K.jsx("meshStandardMaterial",{color:"#6b7280"})]}),K.jsxs("mesh",{position:[-3.5,.45,.8],children:[K.jsx("boxGeometry",{args:[.1,.9,.1]}),K.jsx("meshStandardMaterial",{color:"#374151"})]}),K.jsxs("mesh",{position:[3.5,.45,.8],children:[K.jsx("boxGeometry",{args:[.1,.9,.1]}),K.jsx("meshStandardMaterial",{color:"#374151"})]}),K.jsxs("mesh",{position:[-3.5,.45,-.8],children:[K.jsx("boxGeometry",{args:[.1,.9,.1]}),K.jsx("meshStandardMaterial",{color:"#374151"})]}),K.jsxs("mesh",{position:[3.5,.45,-.8],children:[K.jsx("boxGeometry",{args:[.1,.9,.1]}),K.jsx("meshStandardMaterial",{color:"#374151"})]})]}),K.jsx(zb,{type:"balance",position:[-2,1,3],id:"balance-1"}),K.jsx(zb,{type:"GC-MS",position:[2,1,3],id:"gc-ms-1"}),K.jsx(O8,{position:[0,0,-2]})]})}function F8(){const{currentLaboratory:n}=zs(),t=n||{id:"lab-1",ownerId:"user-1",name:"Main Laboratory",level:1,layout:{width:20,height:20,objects:[]},equipment:[],createdAt:new Date,updatedAt:new Date};return K.jsx("div",{className:"w-full h-full",children:K.jsx(uV,{camera:{position:[10,10,10],fov:50},shadows:!0,gl:{preserveDrawingBuffer:!0},children:K.jsxs(be.Suspense,{fallback:null,children:[K.jsx("ambientLight",{intensity:.3}),K.jsx("directionalLight",{position:[10,10,5],intensity:1,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-camera-far":50,"shadow-camera-left":-20,"shadow-camera-right":20,"shadow-camera-top":20,"shadow-camera-bottom":-20}),K.jsx(U8,{laboratory:t}),K.jsx(HV,{args:[20,20],cellSize:1,cellThickness:.5,cellColor:"#d1d5db",sectionSize:5,sectionThickness:1,sectionColor:"#9ca3af",fadeDistance:25,fadeStrength:1,followCamera:!1,infiniteGrid:!0}),K.jsx(s8,{preset:"studio"}),K.jsx(zV,{enablePan:!0,enableZoom:!0,enableRotate:!0,minDistance:5,maxDistance:25,maxPolarAngle:Math.PI/2})]})})})}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var z8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B8=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),cr=(n,e)=>{const t=be.forwardRef(({color:i="currentColor",size:r=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:a="",children:c,...h},f)=>be.createElement("svg",{ref:f,...z8,width:r,height:r,stroke:i,strokeWidth:o?Number(s)*24/Number(r):s,className:["lucide",`lucide-${B8(n)}`,a].join(" "),...h},[...e.map(([d,m])=>be.createElement(d,m)),...Array.isArray(c)?c:[c]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WL=cr("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H8=cr("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V8=cr("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uf=cr("Beaker",[["path",{d:"M4.5 3h15",key:"c7n0jr"}],["path",{d:"M6 3v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V3",key:"m1uhx7"}],["path",{d:"M6 14h12",key:"4cwo0f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bb=cr("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G8=cr("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W8=cr("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j8=cr("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X8=cr("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sg=cr("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q8=cr("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y8=cr("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kS=cr("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $8=cr("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qd=cr("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function K8(){const{toggleLIMS:n}=zs();return K.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:K.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-6xl h-full max-h-[90vh] flex flex-col",children:[K.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[K.jsxs("div",{className:"flex items-center gap-2",children:[K.jsx(Uf,{className:"text-blue-600",size:24}),K.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Laboratory Information Management System"})]}),K.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:K.jsx(Qd,{size:20})})]}),K.jsxs("div",{className:"flex-1 flex",children:[K.jsx("div",{className:"w-64 bg-gray-50 border-r border-gray-200 p-4",children:K.jsxs("nav",{className:"space-y-2",children:[K.jsx("div",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide",children:"Modules"}),K.jsxs("button",{className:"w-full flex items-center gap-2 px-3 py-2 text-sm bg-blue-100 text-blue-700 rounded-lg",children:[K.jsx(Uf,{size:16}),"Sample Management"]}),K.jsxs("button",{className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:[K.jsx(V8,{size:16}),"Analysis Results"]}),K.jsxs("button",{className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:[K.jsx(Y8,{size:16}),"Equipment Control"]})]})}),K.jsxs("div",{className:"flex-1 p-6",children:[K.jsxs("div",{className:"mb-6",children:[K.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Sample Management"}),K.jsx("p",{className:"text-gray-600",children:"Manage sample registration, tracking, and analysis workflows."})]}),K.jsxs("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:[K.jsx(Uf,{size:48,className:"mx-auto text-gray-400 mb-4"}),K.jsx("h4",{className:"text-lg font-medium text-gray-800 mb-2",children:"No Samples Registered"}),K.jsx("p",{className:"text-gray-600 mb-4",children:"Start by creating your first sample or scan a QR code to register an existing sample."}),K.jsxs("div",{className:"flex gap-2 justify-center",children:[K.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Create Sample"}),K.jsx("button",{className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Scan QR Code"})]})]})]})]})]})})}function Z8(){const{toggleMissions:n,activeMissions:e}=zs();return K.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:K.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl h-full max-h-[80vh] flex flex-col",children:[K.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[K.jsxs("div",{className:"flex items-center gap-2",children:[K.jsx(kS,{className:"text-orange-600",size:24}),K.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Active Missions"})]}),K.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:K.jsx(Qd,{size:20})})]}),K.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:e.length===0?K.jsxs("div",{className:"text-center py-12",children:[K.jsx(kS,{size:48,className:"mx-auto text-gray-400 mb-4"}),K.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"No Active Missions"}),K.jsx("p",{className:"text-gray-600 mb-4",children:"Check back later for new analytical challenges and opportunities."}),K.jsx("button",{className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:"Browse Available Missions"})]}):K.jsx("div",{className:"space-y-4",children:e.map(t=>K.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:[K.jsxs("div",{className:"flex items-start justify-between mb-3",children:[K.jsxs("div",{children:[K.jsx("h4",{className:"font-medium text-gray-800 mb-1",children:t.title}),K.jsxs("p",{className:"text-sm text-gray-600",children:["Client: ",t.client]})]}),K.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[K.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[K.jsx(j8,{size:14}),t.rewards.money.toLocaleString()]}),K.jsxs("div",{className:"flex items-center gap-1 text-orange-600",children:[K.jsx(W8,{size:14}),Math.ceil((t.deadline.getTime()-Date.now())/(1e3*60*60*24))," days"]})]})]}),K.jsx("p",{className:"text-gray-700 mb-3",children:t.description}),K.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:t.requiredEquipment.map(i=>K.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full",children:i},i))}),K.jsxs("div",{className:"flex justify-between items-center",children:[K.jsxs("div",{className:"text-sm text-gray-500",children:["Difficulty:",K.jsx("span",{className:`ml-1 font-medium ${t.difficulty==="easy"?"text-green-600":t.difficulty==="medium"?"text-yellow-600":t.difficulty==="hard"?"text-orange-600":"text-red-600"}`,children:t.difficulty.charAt(0).toUpperCase()+t.difficulty.slice(1)})]}),K.jsx("button",{className:"px-3 py-1 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 transition-colors",children:"View Details"})]})]},t.id))})})]})})}function J8(){const{toggleInventory:n,inventory:e}=zs(),t=i=>{switch(i){case"sample":return K.jsx(Uf,{size:16});case"tool":return K.jsx($8,{size:16});default:return K.jsx(Sg,{size:16})}};return K.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:K.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl h-full max-h-[70vh] flex flex-col",children:[K.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[K.jsxs("div",{className:"flex items-center gap-2",children:[K.jsx(Sg,{className:"text-green-600",size:24}),K.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Laboratory Inventory"})]}),K.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:K.jsx(Qd,{size:20})})]}),K.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:e.length===0?K.jsxs("div",{className:"text-center py-12",children:[K.jsx(Sg,{size:48,className:"mx-auto text-gray-400 mb-4"}),K.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Empty Inventory"}),K.jsx("p",{className:"text-gray-600",children:"Your laboratory inventory is empty. Start by purchasing equipment or collecting samples."})]}):K.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:e.map(i=>K.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:K.jsxs("div",{className:"flex items-start gap-3",children:[K.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:t(i.type)}),K.jsxs("div",{className:"flex-1",children:[K.jsx("h4",{className:"font-medium text-gray-800 mb-1",children:i.name}),K.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["Type: ",i.type.charAt(0).toUpperCase()+i.type.slice(1)]}),K.jsxs("div",{className:"flex justify-between items-center",children:[K.jsxs("span",{className:"text-sm font-medium text-gray-800",children:["Qty: ",i.quantity]}),K.jsx("button",{className:"text-sm text-blue-600 hover:text-blue-700",children:"Use"})]})]})]})},i.id))})})]})})}function Q8(){const{toggleQRScanner:n,addNotification:e}=zs(),[t,i]=be.useState(!1),[r,s]=be.useState(null),o=be.useRef(null);be.useEffect(()=>(a(),()=>{c()}),[]);const a=async()=>{try{s(null);const f=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});o.current&&(o.current.srcObject=f,i(!0))}catch(f){s("Unable to access camera. Please check permissions."),console.error("Camera access error:",f)}},c=()=>{var f;(f=o.current)!=null&&f.srcObject&&(o.current.srcObject.getTracks().forEach(m=>m.stop()),o.current.srcObject=null),i(!1)},h=f=>{e({type:"success",title:"QR Code Scanned",message:`Scanned code: ${f}`}),n()};return K.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:K.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md flex flex-col",children:[K.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[K.jsxs("div",{className:"flex items-center gap-2",children:[K.jsx(Bb,{className:"text-blue-600",size:24}),K.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"QR Code Scanner"})]}),K.jsx("button",{onClick:n,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:K.jsx(Qd,{size:20})})]}),K.jsx("div",{className:"p-6",children:r?K.jsxs("div",{className:"text-center py-8",children:[K.jsx(WL,{size:48,className:"mx-auto text-red-500 mb-4"}),K.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Camera Error"}),K.jsx("p",{className:"text-gray-600 mb-4",children:r}),K.jsx("button",{onClick:a,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Try Again"})]}):K.jsxs("div",{className:"space-y-4",children:[K.jsxs("div",{className:"relative bg-black rounded-lg overflow-hidden aspect-square",children:[K.jsx("video",{ref:o,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),K.jsxs("div",{className:"absolute inset-4 border-2 border-white rounded-lg",children:[K.jsx("div",{className:"absolute top-0 left-0 w-6 h-6 border-t-4 border-l-4 border-blue-500 rounded-tl-lg"}),K.jsx("div",{className:"absolute top-0 right-0 w-6 h-6 border-t-4 border-r-4 border-blue-500 rounded-tr-lg"}),K.jsx("div",{className:"absolute bottom-0 left-0 w-6 h-6 border-b-4 border-l-4 border-blue-500 rounded-bl-lg"}),K.jsx("div",{className:"absolute bottom-0 right-0 w-6 h-6 border-b-4 border-r-4 border-blue-500 rounded-br-lg"})]}),!t&&K.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:K.jsxs("div",{className:"text-white text-center",children:[K.jsx(Bb,{size:48,className:"mx-auto mb-2 opacity-50"}),K.jsx("p",{className:"text-sm opacity-75",children:"Starting camera..."})]})})]}),K.jsx("div",{className:"text-center",children:K.jsx("p",{className:"text-gray-600 text-sm",children:"Position the QR code within the frame to scan"})}),K.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[K.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Or enter sample ID manually:"}),K.jsxs("div",{className:"flex gap-2",children:[K.jsx("input",{type:"text",placeholder:"Sample ID",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),K.jsx("button",{onClick:()=>h("manual-input"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Submit"})]})]})]})})]})})}function eG(){const{ui:n,markNotificationRead:e,clearNotifications:t}=zs(),{notifications:i}=n,r=i.filter(o=>!o.read);if(r.length===0)return null;const s=o=>{switch(o){case"success":return K.jsx(G8,{size:20,className:"text-green-500"});case"error":return K.jsx(WL,{size:20,className:"text-red-500"});case"warning":return K.jsx(H8,{size:20,className:"text-yellow-500"});default:return K.jsx(X8,{size:20,className:"text-blue-500"})}};return K.jsxs("div",{className:"absolute top-20 right-4 w-80 max-h-96 overflow-y-auto space-y-2 z-40 pointer-events-auto",children:[r.map(o=>K.jsx("div",{className:"bg-white rounded-lg shadow-lg border border-gray-200 p-4 animate-slide-in-right",children:K.jsxs("div",{className:"flex items-start gap-3",children:[s(o.type),K.jsxs("div",{className:"flex-1 min-w-0",children:[K.jsx("h4",{className:"text-sm font-medium text-gray-800 mb-1",children:o.title}),K.jsx("p",{className:"text-sm text-gray-600",children:o.message}),K.jsx("div",{className:"text-xs text-gray-400 mt-2",children:o.timestamp.toLocaleTimeString()})]}),K.jsx("button",{onClick:()=>e(o.id),className:"p-1 hover:bg-gray-100 rounded-full transition-colors flex-shrink-0",children:K.jsx(Qd,{size:16})})]})},o.id)),r.length>1&&K.jsx("div",{className:"text-center",children:K.jsx("button",{onClick:t,className:"text-sm text-gray-500 hover:text-gray-700 underline",children:"Clear all notifications"})})]})}function tG(){const{toggleLIMS:n,toggleInventory:e,toggleMissions:t,toggleQRScanner:i,ui:r,player:s}=zs();return K.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[K.jsxs("div",{className:"absolute top-4 left-4 right-4 flex justify-between items-start pointer-events-auto",children:[K.jsxs("div",{className:"bg-black/20 backdrop-blur-sm text-white px-4 py-2 rounded-lg",children:[K.jsx("div",{className:"text-sm font-medium",children:"Dr. Scientist"}),K.jsx("div",{className:"text-xs opacity-80",children:"Level 1  $5,000"})]}),K.jsxs("div",{className:"flex gap-2",children:[K.jsx("button",{onClick:n,className:`p-3 rounded-lg backdrop-blur-sm transition-colors ${r.showLIMS?"bg-blue-500/80 text-white":"bg-black/20 text-white hover:bg-black/30"}`,title:"Laboratory Information Management System",children:K.jsx(Uf,{size:20})}),K.jsx("button",{onClick:e,className:`p-3 rounded-lg backdrop-blur-sm transition-colors ${r.showInventory?"bg-blue-500/80 text-white":"bg-black/20 text-white hover:bg-black/30"}`,title:"Inventory",children:K.jsx(Sg,{size:20})}),K.jsx("button",{onClick:t,className:`p-3 rounded-lg backdrop-blur-sm transition-colors ${r.showMissions?"bg-blue-500/80 text-white":"bg-black/20 text-white hover:bg-black/30"}`,title:"Missions",children:K.jsx(kS,{size:20})}),K.jsx("button",{onClick:i,className:`p-3 rounded-lg backdrop-blur-sm transition-colors ${r.showQRScanner?"bg-blue-500/80 text-white":"bg-black/20 text-white hover:bg-black/30"}`,title:"QR Code Scanner",children:K.jsx(q8,{size:20})})]})]}),K.jsx("div",{className:"absolute bottom-4 left-4 bg-black/20 backdrop-blur-sm text-white px-4 py-2 rounded-lg text-sm",children:K.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[K.jsxs("div",{children:[K.jsx("div",{className:"opacity-80",children:"Movement:"}),K.jsx("div",{children:"WASD / Arrow Keys"})]}),K.jsxs("div",{children:[K.jsx("div",{className:"opacity-80",children:"Interact:"}),K.jsx("div",{children:"E / Space"})]})]})}),!1]})}function nG(){const{ui:n}=zs();return K.jsxs(K.Fragment,{children:[K.jsx(tG,{}),K.jsx(eG,{}),n.showLIMS&&K.jsx(K8,{}),n.showMissions&&K.jsx(Z8,{}),n.showInventory&&K.jsx(J8,{}),n.showQRScanner&&K.jsx(Q8,{})]})}const Hb={KeyW:"forward",ArrowUp:"forward",KeyS:"backward",ArrowDown:"backward",KeyA:"left",ArrowLeft:"left",KeyD:"right",ArrowRight:"right",KeyE:"interact",Space:"interact",KeyI:"inventory",Tab:"inventory",Escape:"menu"};function iG(){const{updateControls:n}=GL();be.useEffect(()=>{const e=r=>{const s=Hb[r.code];s&&(r.preventDefault(),n({[s]:!0}))},t=r=>{const s=Hb[r.code];s&&(r.preventDefault(),n({[s]:!1}))},i=r=>{r.code==="Tab"&&r.preventDefault()};return window.addEventListener("keydown",e),window.addEventListener("keyup",t),window.addEventListener("keydown",i,!0),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",t),window.removeEventListener("keydown",i,!0)}},[n])}var Vb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jL=function(n){const e=[];let t=0;for(let i=0;i<n.length;i++){let r=n.charCodeAt(i);r<128?e[t++]=r:r<2048?(e[t++]=r>>6|192,e[t++]=r&63|128):(r&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(r=65536+((r&1023)<<10)+(n.charCodeAt(++i)&1023),e[t++]=r>>18|240,e[t++]=r>>12&63|128,e[t++]=r>>6&63|128,e[t++]=r&63|128):(e[t++]=r>>12|224,e[t++]=r>>6&63|128,e[t++]=r&63|128)}return e},rG=function(n){const e=[];let t=0,i=0;for(;t<n.length;){const r=n[t++];if(r<128)e[i++]=String.fromCharCode(r);else if(r>191&&r<224){const s=n[t++];e[i++]=String.fromCharCode((r&31)<<6|s&63)}else if(r>239&&r<365){const s=n[t++],o=n[t++],a=n[t++],c=((r&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[i++]=String.fromCharCode(55296+(c>>10)),e[i++]=String.fromCharCode(56320+(c&1023))}else{const s=n[t++],o=n[t++];e[i++]=String.fromCharCode((r&15)<<12|(s&63)<<6|o&63)}}return e.join("")},XL={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let r=0;r<n.length;r+=3){const s=n[r],o=r+1<n.length,a=o?n[r+1]:0,c=r+2<n.length,h=c?n[r+2]:0,f=s>>2,d=(s&3)<<4|a>>4;let m=(a&15)<<2|h>>6,v=h&63;c||(v=64,o||(m=64)),i.push(t[f],t[d],t[m],t[v])}return i.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(jL(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):rG(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let r=0;r<n.length;){const s=t[n.charAt(r++)],a=r<n.length?t[n.charAt(r)]:0;++r;const h=r<n.length?t[n.charAt(r)]:64;++r;const d=r<n.length?t[n.charAt(r)]:64;if(++r,s==null||a==null||h==null||d==null)throw new sG;const m=s<<2|a>>4;if(i.push(m),h!==64){const v=a<<4&240|h>>2;if(i.push(v),d!==64){const _=h<<6&192|d;i.push(_)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class sG extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const oG=function(n){const e=jL(n);return XL.encodeByteArray(e,!0)},Rv=function(n){return oG(n).replace(/\./g,"")},qL=function(n){try{return XL.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aG(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lG=()=>aG().__FIREBASE_DEFAULTS__,cG=()=>{if(typeof process>"u"||typeof Vb>"u")return;const n=Vb.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},uG=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&qL(n[1]);return e&&JSON.parse(e)},V1=()=>{try{return lG()||cG()||uG()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},YL=n=>{var e,t;return(t=(e=V1())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},$L=n=>{const e=YL(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),i]:[e.substring(0,t),i]},KL=()=>{var n;return(n=V1())===null||n===void 0?void 0:n.config},ZL=n=>{var e;return(e=V1())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hG{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,i)=>{t?this.reject(t):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,i))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JL(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},i=e||"demo-project",r=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${i}`,aud:i,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Rv(JSON.stringify(t)),Rv(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function fG(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(rr())}function dG(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function QL(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function pG(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function mG(){const n=rr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function e3(){try{return typeof indexedDB=="object"}catch{return!1}}function t3(){return new Promise((n,e)=>{try{let t=!0;const i="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(i);r.onsuccess=()=>{r.result.close(),t||self.indexedDB.deleteDatabase(i),n(!0)},r.onupgradeneeded=()=>{t=!1},r.onerror=()=>{var s;e(((s=r.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}function gG(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vG="FirebaseError";class ps extends Error{constructor(e,t,i){super(t),this.code=e,this.customData=i,this.name=vG,Object.setPrototypeOf(this,ps.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_c.prototype.create)}}class _c{constructor(e,t,i){this.service=e,this.serviceName=t,this.errors=i}create(e,...t){const i=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],o=s?yG(s,i):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new ps(r,a,i)}}function yG(n,e){return n.replace(_G,(t,i)=>{const r=e[i];return r!=null?String(r):`<${i}?>`})}const _G=/\{\$([^}]+)}/g;function xG(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function bd(n,e){if(n===e)return!0;const t=Object.keys(n),i=Object.keys(e);for(const r of t){if(!i.includes(r))return!1;const s=n[r],o=e[r];if(Gb(s)&&Gb(o)){if(!bd(s,o))return!1}else if(s!==o)return!1}for(const r of i)if(!t.includes(r))return!1;return!0}function Gb(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(n){const e=[];for(const[t,i]of Object.entries(n))Array.isArray(i)?i.forEach(r=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function SG(n,e){const t=new wG(n,e);return t.subscribe.bind(t)}class wG{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,i){let r;if(e===void 0&&t===void 0&&i===void 0)throw new Error("Missing Observer.");MG(e,["next","error","complete"])?r=e:r={next:e,error:t,complete:i},r.next===void 0&&(r.next=lx),r.error===void 0&&(r.error=lx),r.complete===void 0&&(r.complete=lx);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function MG(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function lx(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EG=1e3,TG=2,AG=4*60*60*1e3,bG=.5;function Wb(n,e=EG,t=TG){const i=e*Math.pow(t,n),r=Math.round(bG*i*(Math.random()-.5)*2);return Math.min(AG,i+r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ho(n){return n&&n._delegate?n._delegate:n}class ds{constructor(e,t,i){this.name=e,this.instanceFactory=t,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nl="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CG{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const i=new hG;if(this.instancesDeferred.set(t,i),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&i.resolve(r)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const i=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(i)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:i})}catch(s){if(r)return null;throw s}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(RG(e))try{this.getOrInitializeService({instanceIdentifier:Nl})}catch{}for(const[t,i]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:r});i.resolve(s)}catch{}}}}clearInstance(e=Nl){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Nl){return this.instances.has(e)}getOptions(e=Nl){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:i,options:t});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);i===a&&o.resolve(r)}return r}onInit(e,t){var i;const r=this.normalizeInstanceIdentifier(t),s=(i=this.onInitCallbacks.get(r))!==null&&i!==void 0?i:new Set;s.add(e),this.onInitCallbacks.set(r,s);const o=this.instances.get(r);return o&&e(o,r),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const i=this.onInitCallbacks.get(t);if(i)for(const r of i)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:IG(e),options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Nl){return this.component?this.component.multipleInstances?e:Nl:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function IG(n){return n===Nl?void 0:n}function RG(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PG{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new CG(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dn;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(dn||(dn={}));const LG={debug:dn.DEBUG,verbose:dn.VERBOSE,info:dn.INFO,warn:dn.WARN,error:dn.ERROR,silent:dn.SILENT},NG=dn.INFO,DG={[dn.DEBUG]:"log",[dn.VERBOSE]:"log",[dn.INFO]:"info",[dn.WARN]:"warn",[dn.ERROR]:"error"},kG=(n,e,...t)=>{if(e<n.logLevel)return;const i=new Date().toISOString(),r=DG[e];if(r)console[r](`[${i}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class z0{constructor(e){this.name=e,this._logLevel=NG,this._logHandler=kG,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in dn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?LG[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,dn.DEBUG,...e),this._logHandler(this,dn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,dn.VERBOSE,...e),this._logHandler(this,dn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,dn.INFO,...e),this._logHandler(this,dn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,dn.WARN,...e),this._logHandler(this,dn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,dn.ERROR,...e),this._logHandler(this,dn.ERROR,...e)}}const OG=(n,e)=>e.some(t=>n instanceof t);let jb,Xb;function UG(){return jb||(jb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function FG(){return Xb||(Xb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const n3=new WeakMap,OS=new WeakMap,i3=new WeakMap,cx=new WeakMap,G1=new WeakMap;function zG(n){const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Fa(n.result)),r()},o=()=>{i(n.error),r()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&n3.set(t,n)}).catch(()=>{}),G1.set(e,n),e}function BG(n){if(OS.has(n))return;const e=new Promise((t,i)=>{const r=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),r()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),r()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});OS.set(n,e)}let US={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return OS.get(n);if(e==="objectStoreNames")return n.objectStoreNames||i3.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Fa(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function HG(n){US=n(US)}function VG(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const i=n.call(ux(this),e,...t);return i3.set(i,e.sort?e.sort():[e]),Fa(i)}:FG().includes(n)?function(...e){return n.apply(ux(this),e),Fa(n3.get(this))}:function(...e){return Fa(n.apply(ux(this),e))}}function GG(n){return typeof n=="function"?VG(n):(n instanceof IDBTransaction&&BG(n),OG(n,UG())?new Proxy(n,US):n)}function Fa(n){if(n instanceof IDBRequest)return zG(n);if(cx.has(n))return cx.get(n);const e=GG(n);return e!==n&&(cx.set(n,e),G1.set(e,n)),e}const ux=n=>G1.get(n);function r3(n,e,{blocked:t,upgrade:i,blocking:r,terminated:s}={}){const o=indexedDB.open(n,e),a=Fa(o);return i&&o.addEventListener("upgradeneeded",c=>{i(Fa(o.result),c.oldVersion,c.newVersion,Fa(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),r&&c.addEventListener("versionchange",h=>r(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}const WG=["get","getKey","getAll","getAllKeys","count"],jG=["put","add","delete","clear"],hx=new Map;function qb(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(hx.get(e))return hx.get(e);const t=e.replace(/FromIndex$/,""),i=e!==t,r=jG.includes(t);if(!(t in(i?IDBIndex:IDBObjectStore).prototype)||!(r||WG.includes(t)))return;const s=async function(o,...a){const c=this.transaction(o,r?"readwrite":"readonly");let h=c.store;return i&&(h=h.index(a.shift())),(await Promise.all([h[t](...a),r&&c.done]))[0]};return hx.set(e,s),s}HG(n=>({...n,get:(e,t,i)=>qb(e,t)||n.get(e,t,i),has:(e,t)=>!!qb(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XG{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(qG(t)){const i=t.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(t=>t).join(" ")}}function qG(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const FS="@firebase/app",Yb="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xo=new z0("@firebase/app"),YG="@firebase/app-compat",$G="@firebase/analytics-compat",KG="@firebase/analytics",ZG="@firebase/app-check-compat",JG="@firebase/app-check",QG="@firebase/auth",e9="@firebase/auth-compat",t9="@firebase/database",n9="@firebase/data-connect",i9="@firebase/database-compat",r9="@firebase/functions",s9="@firebase/functions-compat",o9="@firebase/installations",a9="@firebase/installations-compat",l9="@firebase/messaging",c9="@firebase/messaging-compat",u9="@firebase/performance",h9="@firebase/performance-compat",f9="@firebase/remote-config",d9="@firebase/remote-config-compat",p9="@firebase/storage",m9="@firebase/storage-compat",g9="@firebase/firestore",v9="@firebase/vertexai-preview",y9="@firebase/firestore-compat",_9="firebase",x9="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zS="[DEFAULT]",S9={[FS]:"fire-core",[YG]:"fire-core-compat",[KG]:"fire-analytics",[$G]:"fire-analytics-compat",[JG]:"fire-app-check",[ZG]:"fire-app-check-compat",[QG]:"fire-auth",[e9]:"fire-auth-compat",[t9]:"fire-rtdb",[n9]:"fire-data-connect",[i9]:"fire-rtdb-compat",[r9]:"fire-fn",[s9]:"fire-fn-compat",[o9]:"fire-iid",[a9]:"fire-iid-compat",[l9]:"fire-fcm",[c9]:"fire-fcm-compat",[u9]:"fire-perf",[h9]:"fire-perf-compat",[f9]:"fire-rc",[d9]:"fire-rc-compat",[p9]:"fire-gcs",[m9]:"fire-gcs-compat",[g9]:"fire-fst",[y9]:"fire-fst-compat",[v9]:"fire-vertex","fire-js":"fire-js",[_9]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pv=new Map,w9=new Map,BS=new Map;function $b(n,e){try{n.container.addComponent(e)}catch(t){Xo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Os(n){const e=n.name;if(BS.has(e))return Xo.debug(`There were multiple attempts to register component ${e}.`),!1;BS.set(e,n);for(const t of Pv.values())$b(t,n);for(const t of w9.values())$b(t,n);return!0}function Ja(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Ia(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},za=new _c("app","Firebase",M9);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E9{constructor(e,t,i){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new ds("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw za.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xc=x9;function s3(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const i=Object.assign({name:zS,automaticDataCollectionEnabled:!1},e),r=i.name;if(typeof r!="string"||!r)throw za.create("bad-app-name",{appName:String(r)});if(t||(t=KL()),!t)throw za.create("no-options");const s=Pv.get(r);if(s){if(bd(t,s.options)&&bd(i,s.config))return s;throw za.create("duplicate-app",{appName:r})}const o=new PG(r);for(const c of BS.values())o.addComponent(c);const a=new E9(t,i,o);return Pv.set(r,a),a}function B0(n=zS){const e=Pv.get(n);if(!e&&n===zS&&KL())return s3();if(!e)throw za.create("no-app",{appName:n});return e}function Sr(n,e,t){var i;let r=(i=S9[n])!==null&&i!==void 0?i:n;t&&(r+=`-${t}`);const s=r.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${r}" with version "${e}":`];s&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xo.warn(a.join(" "));return}Os(new ds(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T9="firebase-heartbeat-database",A9=1,Cd="firebase-heartbeat-store";let fx=null;function o3(){return fx||(fx=r3(T9,A9,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Cd)}catch(t){console.warn(t)}}}}).catch(n=>{throw za.create("idb-open",{originalErrorMessage:n.message})})),fx}async function b9(n){try{const t=(await o3()).transaction(Cd),i=await t.objectStore(Cd).get(a3(n));return await t.done,i}catch(e){if(e instanceof ps)Xo.warn(e.message);else{const t=za.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Xo.warn(t.message)}}}async function Kb(n,e){try{const i=(await o3()).transaction(Cd,"readwrite");await i.objectStore(Cd).put(e,a3(n)),await i.done}catch(t){if(t instanceof ps)Xo.warn(t.message);else{const i=za.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Xo.warn(i.message)}}}function a3(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C9=1024,I9=30*24*60*60*1e3;class R9{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new L9(t),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){var e,t;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Zb();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=I9}),this._storage.overwrite(this._heartbeatsCache))}catch(i){Xo.warn(i)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Zb(),{heartbeatsToSend:i,unsentEntries:r}=P9(this._heartbeatsCache.heartbeats),s=Rv(JSON.stringify({version:2,heartbeats:i}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Xo.warn(t),""}}}function Zb(){return new Date().toISOString().substring(0,10)}function P9(n,e=C9){const t=[];let i=n.slice();for(const r of n){const s=t.find(o=>o.agent===r.agent);if(s){if(s.dates.push(r.date),Jb(t)>e){s.dates.pop();break}}else if(t.push({agent:r.agent,dates:[r.date]}),Jb(t)>e){t.pop();break}i=i.slice(1)}return{heartbeatsToSend:t,unsentEntries:i}}class L9{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return e3()?t3().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await b9(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return Kb(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const r=await this.read();return Kb(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Jb(n){return Rv(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N9(n){Os(new ds("platform-logger",e=>new XG(e),"PRIVATE")),Os(new ds("heartbeat",e=>new R9(e),"PRIVATE")),Sr(FS,Yb,n),Sr(FS,Yb,"esm2017"),Sr("fire-js","")}N9("");var Qb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var l3;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(P,b){function A(){}A.prototype=b.prototype,P.D=b.prototype,P.prototype=new A,P.prototype.constructor=P,P.C=function(T,L,H){for(var U=Array(arguments.length-2),se=2;se<arguments.length;se++)U[se-2]=arguments[se];return b.prototype[L].apply(T,U)}}function t(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(i,t),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(P,b,A){A||(A=0);var T=Array(16);if(typeof b=="string")for(var L=0;16>L;++L)T[L]=b.charCodeAt(A++)|b.charCodeAt(A++)<<8|b.charCodeAt(A++)<<16|b.charCodeAt(A++)<<24;else for(L=0;16>L;++L)T[L]=b[A++]|b[A++]<<8|b[A++]<<16|b[A++]<<24;b=P.g[0],A=P.g[1],L=P.g[2];var H=P.g[3],U=b+(H^A&(L^H))+T[0]+3614090360&4294967295;b=A+(U<<7&4294967295|U>>>25),U=H+(L^b&(A^L))+T[1]+3905402710&4294967295,H=b+(U<<12&4294967295|U>>>20),U=L+(A^H&(b^A))+T[2]+606105819&4294967295,L=H+(U<<17&4294967295|U>>>15),U=A+(b^L&(H^b))+T[3]+3250441966&4294967295,A=L+(U<<22&4294967295|U>>>10),U=b+(H^A&(L^H))+T[4]+4118548399&4294967295,b=A+(U<<7&4294967295|U>>>25),U=H+(L^b&(A^L))+T[5]+1200080426&4294967295,H=b+(U<<12&4294967295|U>>>20),U=L+(A^H&(b^A))+T[6]+2821735955&4294967295,L=H+(U<<17&4294967295|U>>>15),U=A+(b^L&(H^b))+T[7]+4249261313&4294967295,A=L+(U<<22&4294967295|U>>>10),U=b+(H^A&(L^H))+T[8]+1770035416&4294967295,b=A+(U<<7&4294967295|U>>>25),U=H+(L^b&(A^L))+T[9]+2336552879&4294967295,H=b+(U<<12&4294967295|U>>>20),U=L+(A^H&(b^A))+T[10]+4294925233&4294967295,L=H+(U<<17&4294967295|U>>>15),U=A+(b^L&(H^b))+T[11]+2304563134&4294967295,A=L+(U<<22&4294967295|U>>>10),U=b+(H^A&(L^H))+T[12]+1804603682&4294967295,b=A+(U<<7&4294967295|U>>>25),U=H+(L^b&(A^L))+T[13]+4254626195&4294967295,H=b+(U<<12&4294967295|U>>>20),U=L+(A^H&(b^A))+T[14]+2792965006&4294967295,L=H+(U<<17&4294967295|U>>>15),U=A+(b^L&(H^b))+T[15]+1236535329&4294967295,A=L+(U<<22&4294967295|U>>>10),U=b+(L^H&(A^L))+T[1]+4129170786&4294967295,b=A+(U<<5&4294967295|U>>>27),U=H+(A^L&(b^A))+T[6]+3225465664&4294967295,H=b+(U<<9&4294967295|U>>>23),U=L+(b^A&(H^b))+T[11]+643717713&4294967295,L=H+(U<<14&4294967295|U>>>18),U=A+(H^b&(L^H))+T[0]+3921069994&4294967295,A=L+(U<<20&4294967295|U>>>12),U=b+(L^H&(A^L))+T[5]+3593408605&4294967295,b=A+(U<<5&4294967295|U>>>27),U=H+(A^L&(b^A))+T[10]+38016083&4294967295,H=b+(U<<9&4294967295|U>>>23),U=L+(b^A&(H^b))+T[15]+3634488961&4294967295,L=H+(U<<14&4294967295|U>>>18),U=A+(H^b&(L^H))+T[4]+3889429448&4294967295,A=L+(U<<20&4294967295|U>>>12),U=b+(L^H&(A^L))+T[9]+568446438&4294967295,b=A+(U<<5&4294967295|U>>>27),U=H+(A^L&(b^A))+T[14]+3275163606&4294967295,H=b+(U<<9&4294967295|U>>>23),U=L+(b^A&(H^b))+T[3]+4107603335&4294967295,L=H+(U<<14&4294967295|U>>>18),U=A+(H^b&(L^H))+T[8]+1163531501&4294967295,A=L+(U<<20&4294967295|U>>>12),U=b+(L^H&(A^L))+T[13]+2850285829&4294967295,b=A+(U<<5&4294967295|U>>>27),U=H+(A^L&(b^A))+T[2]+4243563512&4294967295,H=b+(U<<9&4294967295|U>>>23),U=L+(b^A&(H^b))+T[7]+1735328473&4294967295,L=H+(U<<14&4294967295|U>>>18),U=A+(H^b&(L^H))+T[12]+2368359562&4294967295,A=L+(U<<20&4294967295|U>>>12),U=b+(A^L^H)+T[5]+4294588738&4294967295,b=A+(U<<4&4294967295|U>>>28),U=H+(b^A^L)+T[8]+2272392833&4294967295,H=b+(U<<11&4294967295|U>>>21),U=L+(H^b^A)+T[11]+1839030562&4294967295,L=H+(U<<16&4294967295|U>>>16),U=A+(L^H^b)+T[14]+4259657740&4294967295,A=L+(U<<23&4294967295|U>>>9),U=b+(A^L^H)+T[1]+2763975236&4294967295,b=A+(U<<4&4294967295|U>>>28),U=H+(b^A^L)+T[4]+1272893353&4294967295,H=b+(U<<11&4294967295|U>>>21),U=L+(H^b^A)+T[7]+4139469664&4294967295,L=H+(U<<16&4294967295|U>>>16),U=A+(L^H^b)+T[10]+3200236656&4294967295,A=L+(U<<23&4294967295|U>>>9),U=b+(A^L^H)+T[13]+681279174&4294967295,b=A+(U<<4&4294967295|U>>>28),U=H+(b^A^L)+T[0]+3936430074&4294967295,H=b+(U<<11&4294967295|U>>>21),U=L+(H^b^A)+T[3]+3572445317&4294967295,L=H+(U<<16&4294967295|U>>>16),U=A+(L^H^b)+T[6]+76029189&4294967295,A=L+(U<<23&4294967295|U>>>9),U=b+(A^L^H)+T[9]+3654602809&4294967295,b=A+(U<<4&4294967295|U>>>28),U=H+(b^A^L)+T[12]+3873151461&4294967295,H=b+(U<<11&4294967295|U>>>21),U=L+(H^b^A)+T[15]+530742520&4294967295,L=H+(U<<16&4294967295|U>>>16),U=A+(L^H^b)+T[2]+3299628645&4294967295,A=L+(U<<23&4294967295|U>>>9),U=b+(L^(A|~H))+T[0]+4096336452&4294967295,b=A+(U<<6&4294967295|U>>>26),U=H+(A^(b|~L))+T[7]+1126891415&4294967295,H=b+(U<<10&4294967295|U>>>22),U=L+(b^(H|~A))+T[14]+2878612391&4294967295,L=H+(U<<15&4294967295|U>>>17),U=A+(H^(L|~b))+T[5]+4237533241&4294967295,A=L+(U<<21&4294967295|U>>>11),U=b+(L^(A|~H))+T[12]+1700485571&4294967295,b=A+(U<<6&4294967295|U>>>26),U=H+(A^(b|~L))+T[3]+2399980690&4294967295,H=b+(U<<10&4294967295|U>>>22),U=L+(b^(H|~A))+T[10]+4293915773&4294967295,L=H+(U<<15&4294967295|U>>>17),U=A+(H^(L|~b))+T[1]+2240044497&4294967295,A=L+(U<<21&4294967295|U>>>11),U=b+(L^(A|~H))+T[8]+1873313359&4294967295,b=A+(U<<6&4294967295|U>>>26),U=H+(A^(b|~L))+T[15]+4264355552&4294967295,H=b+(U<<10&4294967295|U>>>22),U=L+(b^(H|~A))+T[6]+2734768916&4294967295,L=H+(U<<15&4294967295|U>>>17),U=A+(H^(L|~b))+T[13]+1309151649&4294967295,A=L+(U<<21&4294967295|U>>>11),U=b+(L^(A|~H))+T[4]+4149444226&4294967295,b=A+(U<<6&4294967295|U>>>26),U=H+(A^(b|~L))+T[11]+3174756917&4294967295,H=b+(U<<10&4294967295|U>>>22),U=L+(b^(H|~A))+T[2]+718787259&4294967295,L=H+(U<<15&4294967295|U>>>17),U=A+(H^(L|~b))+T[9]+3951481745&4294967295,P.g[0]=P.g[0]+b&4294967295,P.g[1]=P.g[1]+(L+(U<<21&4294967295|U>>>11))&4294967295,P.g[2]=P.g[2]+L&4294967295,P.g[3]=P.g[3]+H&4294967295}i.prototype.u=function(P,b){b===void 0&&(b=P.length);for(var A=b-this.blockSize,T=this.B,L=this.h,H=0;H<b;){if(L==0)for(;H<=A;)r(this,P,H),H+=this.blockSize;if(typeof P=="string"){for(;H<b;)if(T[L++]=P.charCodeAt(H++),L==this.blockSize){r(this,T),L=0;break}}else for(;H<b;)if(T[L++]=P[H++],L==this.blockSize){r(this,T),L=0;break}}this.h=L,this.o+=b},i.prototype.v=function(){var P=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);P[0]=128;for(var b=1;b<P.length-8;++b)P[b]=0;var A=8*this.o;for(b=P.length-8;b<P.length;++b)P[b]=A&255,A/=256;for(this.u(P),P=Array(16),b=A=0;4>b;++b)for(var T=0;32>T;T+=8)P[A++]=this.g[b]>>>T&255;return P};function s(P,b){var A=a;return Object.prototype.hasOwnProperty.call(A,P)?A[P]:A[P]=b(P)}function o(P,b){this.h=b;for(var A=[],T=!0,L=P.length-1;0<=L;L--){var H=P[L]|0;T&&H==b||(A[L]=H,T=!1)}this.g=A}var a={};function c(P){return-128<=P&&128>P?s(P,function(b){return new o([b|0],0>b?-1:0)}):new o([P|0],0>P?-1:0)}function h(P){if(isNaN(P)||!isFinite(P))return d;if(0>P)return S(h(-P));for(var b=[],A=1,T=0;P>=A;T++)b[T]=P/A|0,A*=4294967296;return new o(b,0)}function f(P,b){if(P.length==0)throw Error("number format error: empty string");if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(P.charAt(0)=="-")return S(f(P.substring(1),b));if(0<=P.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=h(Math.pow(b,8)),T=d,L=0;L<P.length;L+=8){var H=Math.min(8,P.length-L),U=parseInt(P.substring(L,L+H),b);8>H?(H=h(Math.pow(b,H)),T=T.j(H).add(h(U))):(T=T.j(A),T=T.add(h(U)))}return T}var d=c(0),m=c(1),v=c(16777216);n=o.prototype,n.m=function(){if(E(this))return-S(this).m();for(var P=0,b=1,A=0;A<this.g.length;A++){var T=this.i(A);P+=(0<=T?T:4294967296+T)*b,b*=4294967296}return P},n.toString=function(P){if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(_(this))return"0";if(E(this))return"-"+S(this).toString(P);for(var b=h(Math.pow(P,6)),A=this,T="";;){var L=R(A,b).g;A=y(A,L.j(b));var H=((0<A.g.length?A.g[0]:A.h)>>>0).toString(P);if(A=L,_(A))return H+T;for(;6>H.length;)H="0"+H;T=H+T}},n.i=function(P){return 0>P?0:P<this.g.length?this.g[P]:this.h};function _(P){if(P.h!=0)return!1;for(var b=0;b<P.g.length;b++)if(P.g[b]!=0)return!1;return!0}function E(P){return P.h==-1}n.l=function(P){return P=y(this,P),E(P)?-1:_(P)?0:1};function S(P){for(var b=P.g.length,A=[],T=0;T<b;T++)A[T]=~P.g[T];return new o(A,~P.h).add(m)}n.abs=function(){return E(this)?S(this):this},n.add=function(P){for(var b=Math.max(this.g.length,P.g.length),A=[],T=0,L=0;L<=b;L++){var H=T+(this.i(L)&65535)+(P.i(L)&65535),U=(H>>>16)+(this.i(L)>>>16)+(P.i(L)>>>16);T=U>>>16,H&=65535,U&=65535,A[L]=U<<16|H}return new o(A,A[A.length-1]&-2147483648?-1:0)};function y(P,b){return P.add(S(b))}n.j=function(P){if(_(this)||_(P))return d;if(E(this))return E(P)?S(this).j(S(P)):S(S(this).j(P));if(E(P))return S(this.j(S(P)));if(0>this.l(v)&&0>P.l(v))return h(this.m()*P.m());for(var b=this.g.length+P.g.length,A=[],T=0;T<2*b;T++)A[T]=0;for(T=0;T<this.g.length;T++)for(var L=0;L<P.g.length;L++){var H=this.i(T)>>>16,U=this.i(T)&65535,se=P.i(L)>>>16,fe=P.i(L)&65535;A[2*T+2*L]+=U*fe,w(A,2*T+2*L),A[2*T+2*L+1]+=H*fe,w(A,2*T+2*L+1),A[2*T+2*L+1]+=U*se,w(A,2*T+2*L+1),A[2*T+2*L+2]+=H*se,w(A,2*T+2*L+2)}for(T=0;T<b;T++)A[T]=A[2*T+1]<<16|A[2*T];for(T=b;T<2*b;T++)A[T]=0;return new o(A,0)};function w(P,b){for(;(P[b]&65535)!=P[b];)P[b+1]+=P[b]>>>16,P[b]&=65535,b++}function M(P,b){this.g=P,this.h=b}function R(P,b){if(_(b))throw Error("division by zero");if(_(P))return new M(d,d);if(E(P))return b=R(S(P),b),new M(S(b.g),S(b.h));if(E(b))return b=R(P,S(b)),new M(S(b.g),b.h);if(30<P.g.length){if(E(P)||E(b))throw Error("slowDivide_ only works with positive integers.");for(var A=m,T=b;0>=T.l(P);)A=z(A),T=z(T);var L=k(A,1),H=k(T,1);for(T=k(T,2),A=k(A,2);!_(T);){var U=H.add(T);0>=U.l(P)&&(L=L.add(A),H=U),T=k(T,1),A=k(A,1)}return b=y(P,L.j(b)),new M(L,b)}for(L=d;0<=P.l(b);){for(A=Math.max(1,Math.floor(P.m()/b.m())),T=Math.ceil(Math.log(A)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),H=h(A),U=H.j(b);E(U)||0<U.l(P);)A-=T,H=h(A),U=H.j(b);_(H)&&(H=m),L=L.add(H),P=y(P,U)}return new M(L,P)}n.A=function(P){return R(this,P).h},n.and=function(P){for(var b=Math.max(this.g.length,P.g.length),A=[],T=0;T<b;T++)A[T]=this.i(T)&P.i(T);return new o(A,this.h&P.h)},n.or=function(P){for(var b=Math.max(this.g.length,P.g.length),A=[],T=0;T<b;T++)A[T]=this.i(T)|P.i(T);return new o(A,this.h|P.h)},n.xor=function(P){for(var b=Math.max(this.g.length,P.g.length),A=[],T=0;T<b;T++)A[T]=this.i(T)^P.i(T);return new o(A,this.h^P.h)};function z(P){for(var b=P.g.length+1,A=[],T=0;T<b;T++)A[T]=P.i(T)<<1|P.i(T-1)>>>31;return new o(A,P.h)}function k(P,b){var A=b>>5;b%=32;for(var T=P.g.length-A,L=[],H=0;H<T;H++)L[H]=0<b?P.i(H+A)>>>b|P.i(H+A+1)<<32-b:P.i(H+A);return new o(L,P.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,l3=o}).apply(typeof Qb<"u"?Qb:typeof self<"u"?self:typeof window<"u"?window:{});var ig=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,I,D){return p==Array.prototype||p==Object.prototype||(p[I]=D.value),p};function t(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof ig=="object"&&ig];for(var I=0;I<p.length;++I){var D=p[I];if(D&&D.Math==Math)return D}throw Error("Cannot find global object")}var i=t(this);function r(p,I){if(I)e:{var D=i;p=p.split(".");for(var V=0;V<p.length-1;V++){var ue=p[V];if(!(ue in D))break e;D=D[ue]}p=p[p.length-1],V=D[p],I=I(V),I!=V&&I!=null&&e(D,p,{configurable:!0,writable:!0,value:I})}}function s(p,I){p instanceof String&&(p+="");var D=0,V=!1,ue={next:function(){if(!V&&D<p.length){var xe=D++;return{value:I(xe,p[xe]),done:!1}}return V=!0,{done:!0,value:void 0}}};return ue[Symbol.iterator]=function(){return ue},ue}r("Array.prototype.values",function(p){return p||function(){return s(this,function(I,D){return D})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function c(p){var I=typeof p;return I=I!="object"?I:p?Array.isArray(p)?"array":I:"null",I=="array"||I=="object"&&typeof p.length=="number"}function h(p){var I=typeof p;return I=="object"&&p!=null||I=="function"}function f(p,I,D){return p.call.apply(p.bind,arguments)}function d(p,I,D){if(!p)throw Error();if(2<arguments.length){var V=Array.prototype.slice.call(arguments,2);return function(){var ue=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ue,V),p.apply(I,ue)}}return function(){return p.apply(I,arguments)}}function m(p,I,D){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?f:d,m.apply(null,arguments)}function v(p,I){var D=Array.prototype.slice.call(arguments,1);return function(){var V=D.slice();return V.push.apply(V,arguments),p.apply(this,V)}}function _(p,I){function D(){}D.prototype=I.prototype,p.aa=I.prototype,p.prototype=new D,p.prototype.constructor=p,p.Qb=function(V,ue,xe){for(var qe=Array(arguments.length-2),Kt=2;Kt<arguments.length;Kt++)qe[Kt-2]=arguments[Kt];return I.prototype[ue].apply(V,qe)}}function E(p){const I=p.length;if(0<I){const D=Array(I);for(let V=0;V<I;V++)D[V]=p[V];return D}return[]}function S(p,I){for(let D=1;D<arguments.length;D++){const V=arguments[D];if(c(V)){const ue=p.length||0,xe=V.length||0;p.length=ue+xe;for(let qe=0;qe<xe;qe++)p[ue+qe]=V[qe]}else p.push(V)}}class y{constructor(I,D){this.i=I,this.j=D,this.h=0,this.g=null}get(){let I;return 0<this.h?(this.h--,I=this.g,this.g=I.next,I.next=null):I=this.i(),I}}function w(p){return/^[\s\xa0]*$/.test(p)}function M(){var p=a.navigator;return p&&(p=p.userAgent)?p:""}function R(p){return R[" "](p),p}R[" "]=function(){};var z=M().indexOf("Gecko")!=-1&&!(M().toLowerCase().indexOf("webkit")!=-1&&M().indexOf("Edge")==-1)&&!(M().indexOf("Trident")!=-1||M().indexOf("MSIE")!=-1)&&M().indexOf("Edge")==-1;function k(p,I,D){for(const V in p)I.call(D,p[V],V,p)}function P(p,I){for(const D in p)I.call(void 0,p[D],D,p)}function b(p){const I={};for(const D in p)I[D]=p[D];return I}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(p,I){let D,V;for(let ue=1;ue<arguments.length;ue++){V=arguments[ue];for(D in V)p[D]=V[D];for(let xe=0;xe<A.length;xe++)D=A[xe],Object.prototype.hasOwnProperty.call(V,D)&&(p[D]=V[D])}}function L(p){var I=1;p=p.split(":");const D=[];for(;0<I&&p.length;)D.push(p.shift()),I--;return p.length&&D.push(p.join(":")),D}function H(p){a.setTimeout(()=>{throw p},0)}function U(){var p=le;let I=null;return p.g&&(I=p.g,p.g=p.g.next,p.g||(p.h=null),I.next=null),I}class se{constructor(){this.h=this.g=null}add(I,D){const V=fe.get();V.set(I,D),this.h?this.h.next=V:this.g=V,this.h=V}}var fe=new y(()=>new oe,p=>p.reset());class oe{constructor(){this.next=this.g=this.h=null}set(I,D){this.h=I,this.g=D,this.next=null}reset(){this.next=this.g=this.h=null}}let Se,q=!1,le=new se,ie=()=>{const p=a.Promise.resolve(void 0);Se=()=>{p.then(ye)}};var ye=()=>{for(var p;p=U();){try{p.h.call(p.g)}catch(D){H(D)}var I=fe;I.j(p),100>I.h&&(I.h++,p.next=I.g,I.g=p)}q=!1};function Ae(){this.s=this.s,this.C=this.C}Ae.prototype.s=!1,Ae.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ae.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ze(p,I){this.type=p,this.g=this.target=I,this.defaultPrevented=!1}ze.prototype.h=function(){this.defaultPrevented=!0};var pe=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var p=!1,I=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const D=()=>{};a.addEventListener("test",D,I),a.removeEventListener("test",D,I)}catch{}return p}();function De(p,I){if(ze.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var D=this.type=p.type,V=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=I,I=p.relatedTarget){if(z){e:{try{R(I.nodeName);var ue=!0;break e}catch{}ue=!1}ue||(I=null)}}else D=="mouseover"?I=p.fromElement:D=="mouseout"&&(I=p.toElement);this.relatedTarget=I,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:Oe[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&De.aa.h.call(this)}}_(De,ze);var Oe={2:"touch",3:"pen",4:"mouse"};De.prototype.h=function(){De.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var He="closure_listenable_"+(1e6*Math.random()|0),ut=0;function Tt(p,I,D,V,ue){this.listener=p,this.proxy=null,this.src=I,this.type=D,this.capture=!!V,this.ha=ue,this.key=++ut,this.da=this.fa=!1}function mt(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function At(p){this.src=p,this.g={},this.h=0}At.prototype.add=function(p,I,D,V,ue){var xe=p.toString();p=this.g[xe],p||(p=this.g[xe]=[],this.h++);var qe=Fe(p,I,V,ue);return-1<qe?(I=p[qe],D||(I.fa=!1)):(I=new Tt(I,this.src,xe,!!V,ue),I.fa=D,p.push(I)),I};function X(p,I){var D=I.type;if(D in p.g){var V=p.g[D],ue=Array.prototype.indexOf.call(V,I,void 0),xe;(xe=0<=ue)&&Array.prototype.splice.call(V,ue,1),xe&&(mt(I),p.g[D].length==0&&(delete p.g[D],p.h--))}}function Fe(p,I,D,V){for(var ue=0;ue<p.length;++ue){var xe=p[ue];if(!xe.da&&xe.listener==I&&xe.capture==!!D&&xe.ha==V)return ue}return-1}var Be="closure_lm_"+(1e6*Math.random()|0),Ke={};function Pe(p,I,D,V,ue){if(Array.isArray(I)){for(var xe=0;xe<I.length;xe++)Pe(p,I[xe],D,V,ue);return null}return D=ke(D),p&&p[He]?p.K(I,D,h(V)?!!V.capture:!1,ue):gt(p,I,D,!1,V,ue)}function gt(p,I,D,V,ue,xe){if(!I)throw Error("Invalid event type");var qe=h(ue)?!!ue.capture:!!ue,Kt=Re(p);if(Kt||(p[Be]=Kt=new At(p)),D=Kt.add(I,D,V,qe,xe),D.proxy)return D;if(V=Ze(),D.proxy=V,V.src=p,V.listener=D,p.addEventListener)pe||(ue=qe),ue===void 0&&(ue=!1),p.addEventListener(I.toString(),V,ue);else if(p.attachEvent)p.attachEvent(B(I.toString()),V);else if(p.addListener&&p.removeListener)p.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return D}function Ze(){function p(D){return I.call(p.src,p.listener,D)}const I=me;return p}function st(p,I,D,V,ue){if(Array.isArray(I))for(var xe=0;xe<I.length;xe++)st(p,I[xe],D,V,ue);else V=h(V)?!!V.capture:!!V,D=ke(D),p&&p[He]?(p=p.i,I=String(I).toString(),I in p.g&&(xe=p.g[I],D=Fe(xe,D,V,ue),-1<D&&(mt(xe[D]),Array.prototype.splice.call(xe,D,1),xe.length==0&&(delete p.g[I],p.h--)))):p&&(p=Re(p))&&(I=p.g[I.toString()],p=-1,I&&(p=Fe(I,D,V,ue)),(D=-1<p?I[p]:null)&&Z(D))}function Z(p){if(typeof p!="number"&&p&&!p.da){var I=p.src;if(I&&I[He])X(I.i,p);else{var D=p.type,V=p.proxy;I.removeEventListener?I.removeEventListener(D,V,p.capture):I.detachEvent?I.detachEvent(B(D),V):I.addListener&&I.removeListener&&I.removeListener(V),(D=Re(I))?(X(D,p),D.h==0&&(D.src=null,I[Be]=null)):mt(p)}}}function B(p){return p in Ke?Ke[p]:Ke[p]="on"+p}function me(p,I){if(p.da)p=!0;else{I=new De(I,this);var D=p.listener,V=p.ha||p.src;p.fa&&Z(p),p=D.call(V,I)}return p}function Re(p){return p=p[Be],p instanceof At?p:null}var Te="__closure_events_fn_"+(1e9*Math.random()>>>0);function ke(p){return typeof p=="function"?p:(p[Te]||(p[Te]=function(I){return p.handleEvent(I)}),p[Te])}function it(){Ae.call(this),this.i=new At(this),this.M=this,this.F=null}_(it,Ae),it.prototype[He]=!0,it.prototype.removeEventListener=function(p,I,D,V){st(this,p,I,D,V)};function Ge(p,I){var D,V=p.F;if(V)for(D=[];V;V=V.F)D.push(V);if(p=p.M,V=I.type||I,typeof I=="string")I=new ze(I,p);else if(I instanceof ze)I.target=I.target||p;else{var ue=I;I=new ze(V,p),T(I,ue)}if(ue=!0,D)for(var xe=D.length-1;0<=xe;xe--){var qe=I.g=D[xe];ue=Qe(qe,V,!0,I)&&ue}if(qe=I.g=p,ue=Qe(qe,V,!0,I)&&ue,ue=Qe(qe,V,!1,I)&&ue,D)for(xe=0;xe<D.length;xe++)qe=I.g=D[xe],ue=Qe(qe,V,!1,I)&&ue}it.prototype.N=function(){if(it.aa.N.call(this),this.i){var p=this.i,I;for(I in p.g){for(var D=p.g[I],V=0;V<D.length;V++)mt(D[V]);delete p.g[I],p.h--}}this.F=null},it.prototype.K=function(p,I,D,V){return this.i.add(String(p),I,!1,D,V)},it.prototype.L=function(p,I,D,V){return this.i.add(String(p),I,!0,D,V)};function Qe(p,I,D,V){if(I=p.i.g[String(I)],!I)return!0;I=I.concat();for(var ue=!0,xe=0;xe<I.length;++xe){var qe=I[xe];if(qe&&!qe.da&&qe.capture==D){var Kt=qe.listener,In=qe.ha||qe.src;qe.fa&&X(p.i,qe),ue=Kt.call(In,V)!==!1&&ue}}return ue&&!V.defaultPrevented}function bt(p,I,D){if(typeof p=="function")D&&(p=m(p,D));else if(p&&typeof p.handleEvent=="function")p=m(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(I)?-1:a.setTimeout(p,I||0)}function We(p){p.g=bt(()=>{p.g=null,p.i&&(p.i=!1,We(p))},p.l);const I=p.h;p.h=null,p.m.apply(null,I)}class nt extends Ae{constructor(I,D){super(),this.m=I,this.l=D,this.h=null,this.i=!1,this.g=null}j(I){this.h=arguments,this.g?this.i=!0:We(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Dt(p){Ae.call(this),this.h=p,this.g={}}_(Dt,Ae);var yt=[];function $e(p){k(p.g,function(I,D){this.g.hasOwnProperty(D)&&Z(I)},p),p.g={}}Dt.prototype.N=function(){Dt.aa.N.call(this),$e(this)},Dt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var wt=a.JSON.stringify,te=a.JSON.parse,Le=class{stringify(p){return a.JSON.stringify(p,void 0)}parse(p){return a.JSON.parse(p,void 0)}};function Q(){}Q.prototype.h=null;function Ce(p){return p.h||(p.h=p.i())}function re(){}var Me={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function je(){ze.call(this,"d")}_(je,ze);function Mt(){ze.call(this,"c")}_(Mt,ze);var Nt={},$t=null;function en(){return $t=$t||new it}Nt.La="serverreachability";function Ut(p){ze.call(this,Nt.La,p)}_(Ut,ze);function wn(p){const I=en();Ge(I,new Ut(I))}Nt.STAT_EVENT="statevent";function Dn(p,I){ze.call(this,Nt.STAT_EVENT,p),this.stat=I}_(Dn,ze);function xn(p){const I=en();Ge(I,new Dn(I,p))}Nt.Ma="timingevent";function ur(p,I){ze.call(this,Nt.Ma,p),this.size=I}_(ur,ze);function Er(p,I){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){p()},I)}function Ii(){this.g=!0}Ii.prototype.xa=function(){this.g=!1};function Bs(p,I,D,V,ue,xe){p.info(function(){if(p.g)if(xe)for(var qe="",Kt=xe.split("&"),In=0;In<Kt.length;In++){var nn=Kt[In].split("=");if(1<nn.length){var ti=nn[0];nn=nn[1];var ni=ti.split("_");qe=2<=ni.length&&ni[1]=="type"?qe+(ti+"="+nn+"&"):qe+(ti+"=redacted&")}}else qe=null;else qe=xe;return"XMLHTTP REQ ("+V+") [attempt "+ue+"]: "+I+`
`+D+`
`+qe})}function hr(p,I,D,V,ue,xe,qe){p.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+ue+"]: "+I+`
`+D+`
`+xe+" "+qe})}function qn(p,I,D,V){p.info(function(){return"XMLHTTP TEXT ("+I+"): "+po(p,D)+(V?" "+V:"")})}function Ft(p,I){p.info(function(){return"TIMEOUT: "+I})}Ii.prototype.info=function(){};function po(p,I){if(!p.g)return I;if(!I)return null;try{var D=JSON.parse(I);if(D){for(p=0;p<D.length;p++)if(Array.isArray(D[p])){var V=D[p];if(!(2>V.length)){var ue=V[1];if(Array.isArray(ue)&&!(1>ue.length)){var xe=ue[0];if(xe!="noop"&&xe!="stop"&&xe!="close")for(var qe=1;qe<ue.length;qe++)ue[qe]=""}}}}return wt(D)}catch{return I}}var Hs={NO_ERROR:0,TIMEOUT:8},F={},G;function ne(){}_(ne,Q),ne.prototype.g=function(){return new XMLHttpRequest},ne.prototype.i=function(){return{}},G=new ne;function O(p,I,D,V){this.j=p,this.i=I,this.l=D,this.R=V||1,this.U=new Dt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new W}function W(){this.i=null,this.g="",this.h=!1}var Y={},ee={};function $(p,I,D){p.L=1,p.v=mo(kt(I)),p.m=D,p.P=!0,he(p,null)}function he(p,I){p.F=Date.now(),ge(p),p.A=kt(p.v);var D=p.A,V=p.R;Array.isArray(V)||(V=[String(V)]),wc(D.i,"t",V),p.C=0,D=p.j.J,p.h=new W,p.g=al(p.j,D?I:null,!p.m),0<p.O&&(p.M=new nt(m(p.Y,p,p.g),p.O)),I=p.U,D=p.g,V=p.ca;var ue="readystatechange";Array.isArray(ue)||(ue&&(yt[0]=ue.toString()),ue=yt);for(var xe=0;xe<ue.length;xe++){var qe=Pe(D,ue[xe],V||I.handleEvent,!1,I.h||I);if(!qe)break;I.g[qe.key]=qe}I=p.H?b(p.H):{},p.m?(p.u||(p.u="POST"),I["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,I)):(p.u="GET",p.g.ea(p.A,p.u,null,I)),wn(),Bs(p.i,p.u,p.A,p.l,p.R,p.m)}O.prototype.ca=function(p){p=p.target;const I=this.M;I&&Yn(p)==3?I.j():this.Y(p)},O.prototype.Y=function(p){try{if(p==this.g)e:{const ni=Yn(this.g);var I=this.g.Ba();const ii=this.g.Z();if(!(3>ni)&&(ni!=3||this.g&&(this.h.h||this.g.oa()||il(this.g)))){this.J||ni!=4||I==7||(I==8||0>=ii?wn(3):wn(2)),Ue(this);var D=this.g.Z();this.X=D;t:if(de(this)){var V=il(this.g);p="";var ue=V.length,xe=Yn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Je(this),Ne(this);var qe="";break t}this.h.i=new a.TextDecoder}for(I=0;I<ue;I++)this.h.h=!0,p+=this.h.i.decode(V[I],{stream:!(xe&&I==ue-1)});V.length=0,this.h.g+=p,this.C=0,qe=this.h.g}else qe=this.g.oa();if(this.o=D==200,hr(this.i,this.u,this.A,this.l,this.R,ni,D),this.o){if(this.T&&!this.K){t:{if(this.g){var Kt,In=this.g;if((Kt=In.g?In.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(Kt)){var nn=Kt;break t}}nn=null}if(D=nn)qn(this.i,this.l,D,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ct(this,D);else{this.o=!1,this.s=3,xn(12),Je(this),Ne(this);break e}}if(this.P){D=!0;let Rn;for(;!this.J&&this.C<qe.length;)if(Rn=_e(this,qe),Rn==ee){ni==4&&(this.s=4,xn(14),D=!1),qn(this.i,this.l,null,"[Incomplete Response]");break}else if(Rn==Y){this.s=4,xn(15),qn(this.i,this.l,qe,"[Invalid Chunk]"),D=!1;break}else qn(this.i,this.l,Rn,null),ct(this,Rn);if(de(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),ni!=4||qe.length!=0||this.h.h||(this.s=1,xn(16),D=!1),this.o=this.o&&D,!D)qn(this.i,this.l,qe,"[Invalid Chunked Response]"),Je(this),Ne(this);else if(0<qe.length&&!this.W){this.W=!0;var ti=this.j;ti.g==this&&ti.ba&&!ti.M&&(ti.j.info("Great, no buffering proxy detected. Bytes received: "+qe.length),Ir(ti),ti.M=!0,xn(11))}}else qn(this.i,this.l,qe,null),ct(this,qe);ni==4&&Je(this),this.o&&!this.J&&(ni==4?_h(this.j,this):(this.o=!1,ge(this)))}else Ec(this.g),D==400&&0<qe.indexOf("Unknown SID")?(this.s=3,xn(12)):(this.s=0,xn(13)),Je(this),Ne(this)}}}catch{}finally{}};function de(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function _e(p,I){var D=p.C,V=I.indexOf(`
`,D);return V==-1?ee:(D=Number(I.substring(D,V)),isNaN(D)?Y:(V+=1,V+D>I.length?ee:(I=I.slice(V,V+D),p.C=V+D,I)))}O.prototype.cancel=function(){this.J=!0,Je(this)};function ge(p){p.S=Date.now()+p.I,et(p,p.I)}function et(p,I){if(p.B!=null)throw Error("WatchDog timer not null");p.B=Er(m(p.ba,p),I)}function Ue(p){p.B&&(a.clearTimeout(p.B),p.B=null)}O.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(Ft(this.i,this.A),this.L!=2&&(wn(),xn(17)),Je(this),this.s=2,Ne(this)):et(this,this.S-p)};function Ne(p){p.j.G==0||p.J||_h(p.j,p)}function Je(p){Ue(p);var I=p.M;I&&typeof I.ma=="function"&&I.ma(),p.M=null,$e(p.U),p.g&&(I=p.g,p.g=null,I.abort(),I.ma())}function ct(p,I){try{var D=p.j;if(D.G!=0&&(D.g==p||xt(D.h,p))){if(!p.K&&xt(D.h,p)&&D.G==3){try{var V=D.Da.g.parse(I)}catch{V=null}if(Array.isArray(V)&&V.length==3){var ue=V;if(ue[0]==0){e:if(!D.u){if(D.g)if(D.g.F+3e3<p.F)_o(D),sl(D);else break e;Cc(D),xn(18)}}else D.za=ue[1],0<D.za-D.T&&37500>ue[2]&&D.F&&D.v==0&&!D.C&&(D.C=Er(m(D.Za,D),6e3));if(1>=Ve(D.h)&&D.ca){try{D.ca()}catch{}D.ca=void 0}}else Gs(D,11)}else if((p.K||D.g==p)&&_o(D),!w(I))for(ue=D.Da.g.parse(I),I=0;I<ue.length;I++){let nn=ue[I];if(D.T=nn[0],nn=nn[1],D.G==2)if(nn[0]=="c"){D.K=nn[1],D.ia=nn[2];const ti=nn[3];ti!=null&&(D.la=ti,D.j.info("VER="+D.la));const ni=nn[4];ni!=null&&(D.Aa=ni,D.j.info("SVER="+D.Aa));const ii=nn[5];ii!=null&&typeof ii=="number"&&0<ii&&(V=1.5*ii,D.L=V,D.j.info("backChannelRequestTimeoutMs_="+V)),V=D;const Rn=p.g;if(Rn){const gn=Rn.g?Rn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(gn){var xe=V.h;xe.g||gn.indexOf("spdy")==-1&&gn.indexOf("quic")==-1&&gn.indexOf("h2")==-1||(xe.j=xe.l,xe.g=new Set,xe.h&&(dt(xe,xe.h),xe.h=null))}if(V.D){const xo=Rn.g?Rn.g.getResponseHeader("X-HTTP-Session-Id"):null;xo&&(V.ya=xo,Qt(V.I,V.D,xo))}}D.G=3,D.l&&D.l.ua(),D.ba&&(D.R=Date.now()-p.F,D.j.info("Handshake RTT: "+D.R+"ms")),V=D;var qe=p;if(V.qa=Ic(V,V.J?V.ia:null,V.W),qe.K){Et(V.h,qe);var Kt=qe,In=V.L;In&&(Kt.I=In),Kt.B&&(Ue(Kt),ge(Kt)),V.g=qe}else bc(V);0<D.i.length&&Zo(D)}else nn[0]!="stop"&&nn[0]!="close"||Gs(D,7);else D.G==3&&(nn[0]=="stop"||nn[0]=="close"?nn[0]=="stop"?Gs(D,7):rl(D):nn[0]!="noop"&&D.l&&D.l.ta(nn),D.v=0)}}wn(4)}catch{}}var vt=class{constructor(p,I){this.g=p,this.map=I}};function Ct(p){this.l=p||10,a.PerformanceNavigationTiming?(p=a.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function tt(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Ve(p){return p.h?1:p.g?p.g.size:0}function xt(p,I){return p.h?p.h==I:p.g?p.g.has(I):!1}function dt(p,I){p.g?p.g.add(I):p.h=I}function Et(p,I){p.h&&p.h==I?p.h=null:p.g&&p.g.has(I)&&p.g.delete(I)}Ct.prototype.cancel=function(){if(this.i=Jt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Jt(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let I=p.i;for(const D of p.g.values())I=I.concat(D.D);return I}return E(p.i)}function ln(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(c(p)){for(var I=[],D=p.length,V=0;V<D;V++)I.push(p[V]);return I}I=[],D=0;for(V in p)I[D++]=p[V];return I}function Mn(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(c(p)||typeof p=="string"){var I=[];p=p.length;for(var D=0;D<p;D++)I.push(D);return I}I=[],D=0;for(const V in p)I[D++]=V;return I}}}function Wt(p,I){if(p.forEach&&typeof p.forEach=="function")p.forEach(I,void 0);else if(c(p)||typeof p=="string")Array.prototype.forEach.call(p,I,void 0);else for(var D=Mn(p),V=ln(p),ue=V.length,xe=0;xe<ue;xe++)I.call(void 0,V[xe],D&&D[xe],p)}var Ht=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Cn(p,I){if(p){p=p.split("&");for(var D=0;D<p.length;D++){var V=p[D].indexOf("="),ue=null;if(0<=V){var xe=p[D].substring(0,V);ue=p[D].substring(V+1)}else xe=p[D];I(xe,ue?decodeURIComponent(ue.replace(/\+/g," ")):"")}}}function Pt(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof Pt){this.h=p.h,fn(this,p.j),this.o=p.o,this.g=p.g,wi(this,p.s),this.l=p.l;var I=p.i,D=new el;D.i=I.i,I.g&&(D.g=new Map(I.g),D.h=I.h),pi(this,D),this.m=p.m}else p&&(I=String(p).match(Ht))?(this.h=!1,fn(this,I[1]||"",!0),this.o=Vs(I[2]||""),this.g=Vs(I[3]||"",!0),wi(this,I[4]),this.l=Vs(I[5]||"",!0),pi(this,I[6]||"",!0),this.m=Vs(I[7]||"")):(this.h=!1,this.i=new el(null,this.h))}Pt.prototype.toString=function(){var p=[],I=this.j;I&&p.push(ms(I,sp,!0),":");var D=this.g;return(D||I=="file")&&(p.push("//"),(I=this.o)&&p.push(ms(I,sp,!0),"@"),p.push(encodeURIComponent(String(D)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),D=this.s,D!=null&&p.push(":",String(D))),(D=this.l)&&(this.g&&D.charAt(0)!="/"&&p.push("/"),p.push(ms(D,D.charAt(0)=="/"?ph:q0,!0))),(D=this.i.toString())&&p.push("?",D),(D=this.m)&&p.push("#",ms(D,Qa)),p.join("")};function kt(p){return new Pt(p)}function fn(p,I,D){p.j=D?Vs(I,!0):I,p.j&&(p.j=p.j.replace(/:$/,""))}function wi(p,I){if(I){if(I=Number(I),isNaN(I)||0>I)throw Error("Bad port number "+I);p.s=I}else p.s=null}function pi(p,I,D){I instanceof el?(p.i=I,Y0(p.i,p.h)):(D||(I=ms(I,mh)),p.i=new el(I,p.h))}function Qt(p,I,D){p.i.set(I,D)}function mo(p){return Qt(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function Vs(p,I){return p?I?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function ms(p,I,D){return typeof p=="string"?(p=encodeURI(p).replace(I,Sc),D&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Sc(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var sp=/[#\/\?@]/g,q0=/[#\?:]/g,ph=/[#\?]/g,mh=/[#\?@]/g,Qa=/#/g;function el(p,I){this.h=this.g=null,this.i=p||null,this.j=!!I}function $r(p){p.g||(p.g=new Map,p.h=0,p.i&&Cn(p.i,function(I,D){p.add(decodeURIComponent(I.replace(/\+/g," ")),D)}))}n=el.prototype,n.add=function(p,I){$r(this),this.i=null,p=go(this,p);var D=this.g.get(p);return D||this.g.set(p,D=[]),D.push(I),this.h+=1,this};function tn(p,I){$r(p),I=go(p,I),p.g.has(I)&&(p.i=null,p.h-=p.g.get(I).length,p.g.delete(I))}function gh(p,I){return $r(p),I=go(p,I),p.g.has(I)}n.forEach=function(p,I){$r(this),this.g.forEach(function(D,V){D.forEach(function(ue){p.call(I,ue,V,this)},this)},this)},n.na=function(){$r(this);const p=Array.from(this.g.values()),I=Array.from(this.g.keys()),D=[];for(let V=0;V<I.length;V++){const ue=p[V];for(let xe=0;xe<ue.length;xe++)D.push(I[V])}return D},n.V=function(p){$r(this);let I=[];if(typeof p=="string")gh(this,p)&&(I=I.concat(this.g.get(go(this,p))));else{p=Array.from(this.g.values());for(let D=0;D<p.length;D++)I=I.concat(p[D])}return I},n.set=function(p,I){return $r(this),this.i=null,p=go(this,p),gh(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[I]),this.h+=1,this},n.get=function(p,I){return p?(p=this.V(p),0<p.length?String(p[0]):I):I};function wc(p,I,D){tn(p,I),0<D.length&&(p.i=null,p.g.set(go(p,I),E(D)),p.h+=D.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],I=Array.from(this.g.keys());for(var D=0;D<I.length;D++){var V=I[D];const xe=encodeURIComponent(String(V)),qe=this.V(V);for(V=0;V<qe.length;V++){var ue=xe;qe[V]!==""&&(ue+="="+encodeURIComponent(String(qe[V]))),p.push(ue)}}return this.i=p.join("&")};function go(p,I){return I=String(I),p.j&&(I=I.toLowerCase()),I}function Y0(p,I){I&&!p.j&&($r(p),p.i=null,p.g.forEach(function(D,V){var ue=V.toLowerCase();V!=ue&&(tn(this,V),wc(this,ue,D))},p)),p.j=I}function $0(p,I){const D=new Ii;if(a.Image){const V=new Image;V.onload=v(Kr,D,"TestLoadImage: loaded",!0,I,V),V.onerror=v(Kr,D,"TestLoadImage: error",!1,I,V),V.onabort=v(Kr,D,"TestLoadImage: abort",!1,I,V),V.ontimeout=v(Kr,D,"TestLoadImage: timeout",!1,I,V),a.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=p}else I(!1)}function ei(p,I){const D=new Ii,V=new AbortController,ue=setTimeout(()=>{V.abort(),Kr(D,"TestPingServer: timeout",!1,I)},1e4);fetch(p,{signal:V.signal}).then(xe=>{clearTimeout(ue),xe.ok?Kr(D,"TestPingServer: ok",!0,I):Kr(D,"TestPingServer: server error",!1,I)}).catch(()=>{clearTimeout(ue),Kr(D,"TestPingServer: error",!1,I)})}function Kr(p,I,D,V,ue){try{ue&&(ue.onload=null,ue.onerror=null,ue.onabort=null,ue.ontimeout=null),V(D)}catch{}}function K0(){this.g=new Le}function vh(p,I,D){const V=D||"";try{Wt(p,function(ue,xe){let qe=ue;h(ue)&&(qe=wt(ue)),I.push(V+xe+"="+encodeURIComponent(qe))})}catch(ue){throw I.push(V+"type="+encodeURIComponent("_badmap")),ue}}function Mc(p){this.l=p.Ub||null,this.j=p.eb||!1}_(Mc,Q),Mc.prototype.g=function(){return new vo(this.l,this.j)},Mc.prototype.i=function(p){return function(){return p}}({});function vo(p,I){it.call(this),this.D=p,this.o=I,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(vo,it),n=vo.prototype,n.open=function(p,I){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=I,this.readyState=1,nl(this)},n.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const I={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(I.body=p),(this.D||a).fetch(new Request(this.A,I)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,tl(this)),this.readyState=0},n.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,nl(this)),this.g&&(this.readyState=3,nl(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Tr(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function Tr(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}n.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var I=p.value?p.value:new Uint8Array(0);(I=this.v.decode(I,{stream:!p.done}))&&(this.response=this.responseText+=I)}p.done?tl(this):nl(this),this.readyState==3&&Tr(this)}},n.Ra=function(p){this.g&&(this.response=this.responseText=p,tl(this))},n.Qa=function(p){this.g&&(this.response=p,tl(this))},n.ga=function(){this.g&&tl(this)};function tl(p){p.readyState=4,p.l=null,p.j=null,p.v=null,nl(p)}n.setRequestHeader=function(p,I){this.u.append(p,I)},n.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],I=this.h.entries();for(var D=I.next();!D.done;)D=D.value,p.push(D[0]+": "+D[1]),D=I.next();return p.join(`\r
`)};function nl(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(vo.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Ar(p){let I="";return k(p,function(D,V){I+=V,I+=":",I+=D,I+=`\r
`}),I}function br(p,I,D){e:{for(V in D){var V=!1;break e}V=!0}V||(D=Ar(D),typeof p=="string"?D!=null&&encodeURIComponent(String(D)):Qt(p,I,D))}function En(p){it.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(En,it);var yh=/^https?$/i,op=["POST","PUT"];n=En.prototype,n.Ha=function(p){this.J=p},n.ea=function(p,I,D,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);I=I?I.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():G.g(),this.v=this.o?Ce(this.o):Ce(G),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(I,String(p),!0),this.B=!1}catch(xe){ap(this,xe);return}if(p=D||"",D=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var ue in V)D.set(ue,V[ue]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const xe of V.keys())D.set(xe,V.get(xe));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(D.keys()).find(xe=>xe.toLowerCase()=="content-type"),ue=a.FormData&&p instanceof a.FormData,!(0<=Array.prototype.indexOf.call(op,I,void 0))||V||ue||D.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[xe,qe]of D)this.g.setRequestHeader(xe,qe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{cp(this),this.u=!0,this.g.send(p),this.u=!1}catch(xe){ap(this,xe)}};function ap(p,I){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=I,p.m=5,Cr(p),yo(p)}function Cr(p){p.A||(p.A=!0,Ge(p,"complete"),Ge(p,"error"))}n.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,Ge(this,"complete"),Ge(this,"abort"),yo(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),yo(this,!0)),En.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?lp(this):this.bb())},n.bb=function(){lp(this)};function lp(p){if(p.h&&typeof o<"u"&&(!p.v[1]||Yn(p)!=4||p.Z()!=2)){if(p.u&&Yn(p)==4)bt(p.Ea,0,p);else if(Ge(p,"readystatechange"),Yn(p)==4){p.h=!1;try{const qe=p.Z();e:switch(qe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var I=!0;break e;default:I=!1}var D;if(!(D=I)){var V;if(V=qe===0){var ue=String(p.D).match(Ht)[1]||null;!ue&&a.self&&a.self.location&&(ue=a.self.location.protocol.slice(0,-1)),V=!yh.test(ue?ue.toLowerCase():"")}D=V}if(D)Ge(p,"complete"),Ge(p,"success");else{p.m=6;try{var xe=2<Yn(p)?p.g.statusText:""}catch{xe=""}p.l=xe+" ["+p.Z()+"]",Cr(p)}}finally{yo(p)}}}}function yo(p,I){if(p.g){cp(p);const D=p.g,V=p.v[0]?()=>{}:null;p.g=null,p.v=null,I||Ge(p,"ready");try{D.onreadystatechange=V}catch{}}}function cp(p){p.I&&(a.clearTimeout(p.I),p.I=null)}n.isActive=function(){return!!this.g};function Yn(p){return p.g?p.g.readyState:0}n.Z=function(){try{return 2<Yn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(p){if(this.g){var I=this.g.responseText;return p&&I.indexOf(p)==0&&(I=I.substring(p.length)),te(I)}};function il(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function Ec(p){const I={};p=(p.g&&2<=Yn(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<p.length;V++){if(w(p[V]))continue;var D=L(p[V]);const ue=D[0];if(D=D[1],typeof D!="string")continue;D=D.trim();const xe=I[ue]||[];I[ue]=xe,xe.push(D)}P(I,function(V){return V.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Zr(p,I,D){return D&&D.internalChannelParams&&D.internalChannelParams[p]||I}function Tc(p){this.Aa=0,this.i=[],this.j=new Ii,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Zr("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Zr("baseRetryDelayMs",5e3,p),this.cb=Zr("retryDelaySeedMs",1e4,p),this.Wa=Zr("forwardChannelMaxRetries",2,p),this.wa=Zr("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new Ct(p&&p.concurrentRequestLimit),this.Da=new K0,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Tc.prototype,n.la=8,n.G=1,n.connect=function(p,I,D,V){xn(0),this.W=p,this.H=I||{},D&&V!==void 0&&(this.H.OSID=D,this.H.OAID=V),this.F=this.X,this.I=Ic(this,null,this.W),Zo(this)};function rl(p){if(Ac(p),p.G==3){var I=p.U++,D=kt(p.I);if(Qt(D,"SID",p.K),Qt(D,"RID",I),Qt(D,"TYPE","terminate"),Ri(p,D),I=new O(p,p.j,I),I.L=2,I.v=mo(kt(D)),D=!1,a.navigator&&a.navigator.sendBeacon)try{D=a.navigator.sendBeacon(I.v.toString(),"")}catch{}!D&&a.Image&&(new Image().src=I.v,D=!0),D||(I.g=al(I.j,null),I.g.ea(I.v)),I.F=Date.now(),ge(I)}xh(p)}function sl(p){p.g&&(Ir(p),p.g.cancel(),p.g=null)}function Ac(p){sl(p),p.u&&(a.clearTimeout(p.u),p.u=null),_o(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&a.clearTimeout(p.s),p.s=null)}function Zo(p){if(!tt(p.h)&&!p.s){p.s=!0;var I=p.Ga;Se||ie(),q||(Se(),q=!0),le.add(I,p),p.B=0}}function Jo(p,I){return Ve(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=I.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=Er(m(p.Ga,p,I),ol(p,p.B)),p.B++,!0)}n.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const ue=new O(this,this.j,p);let xe=this.o;if(this.S&&(xe?(xe=b(xe),T(xe,this.S)):xe=this.S),this.m!==null||this.O||(ue.H=xe,xe=null),this.P)e:{for(var I=0,D=0;D<this.i.length;D++){t:{var V=this.i[D];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(I+=V,4096<I){I=D;break e}if(I===4096||D===this.i.length-1){I=D+1;break e}}I=1e3}else I=1e3;I=gs(this,ue,I),D=kt(this.I),Qt(D,"RID",p),Qt(D,"CVER",22),this.D&&Qt(D,"X-HTTP-Session-Id",this.D),Ri(this,D),xe&&(this.O?I="headers="+encodeURIComponent(String(Ar(xe)))+"&"+I:this.m&&br(D,this.m,xe)),dt(this.h,ue),this.Ua&&Qt(D,"TYPE","init"),this.P?(Qt(D,"$req",I),Qt(D,"SID","null"),ue.T=!0,$(ue,D,null)):$(ue,D,I),this.G=2}}else this.G==3&&(p?Xi(this,p):this.i.length==0||tt(this.h)||Xi(this))};function Xi(p,I){var D;I?D=I.l:D=p.U++;const V=kt(p.I);Qt(V,"SID",p.K),Qt(V,"RID",D),Qt(V,"AID",p.T),Ri(p,V),p.m&&p.o&&br(V,p.m,p.o),D=new O(p,p.j,D,p.B+1),p.m===null&&(D.H=p.o),I&&(p.i=I.D.concat(p.i)),I=gs(p,D,1e3),D.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),dt(p.h,D),$(D,V,I)}function Ri(p,I){p.H&&k(p.H,function(D,V){Qt(I,V,D)}),p.l&&Wt({},function(D,V){Qt(I,V,D)})}function gs(p,I,D){D=Math.min(p.i.length,D);var V=p.l?m(p.l.Na,p.l,p):null;e:{var ue=p.i;let xe=-1;for(;;){const qe=["count="+D];xe==-1?0<D?(xe=ue[0].g,qe.push("ofs="+xe)):xe=0:qe.push("ofs="+xe);let Kt=!0;for(let In=0;In<D;In++){let nn=ue[In].g;const ti=ue[In].map;if(nn-=xe,0>nn)xe=Math.max(0,ue[In].g-100),Kt=!1;else try{vh(ti,qe,"req"+nn+"_")}catch{V&&V(ti)}}if(Kt){V=qe.join("&");break e}}}return p=p.i.splice(0,D),I.D=p,V}function bc(p){if(!p.g&&!p.u){p.Y=1;var I=p.Fa;Se||ie(),q||(Se(),q=!0),le.add(I,p),p.v=0}}function Cc(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=Er(m(p.Fa,p),ol(p,p.v)),p.v++,!0)}n.Fa=function(){if(this.u=null,vs(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=Er(m(this.ab,this),p)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,xn(10),sl(this),vs(this))};function Ir(p){p.A!=null&&(a.clearTimeout(p.A),p.A=null)}function vs(p){p.g=new O(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var I=kt(p.qa);Qt(I,"RID","rpc"),Qt(I,"SID",p.K),Qt(I,"AID",p.T),Qt(I,"CI",p.F?"0":"1"),!p.F&&p.ja&&Qt(I,"TO",p.ja),Qt(I,"TYPE","xmlhttp"),Ri(p,I),p.m&&p.o&&br(I,p.m,p.o),p.L&&(p.g.I=p.L);var D=p.g;p=p.ia,D.L=1,D.v=mo(kt(I)),D.m=null,D.P=!0,he(D,p)}n.Za=function(){this.C!=null&&(this.C=null,sl(this),Cc(this),xn(19))};function _o(p){p.C!=null&&(a.clearTimeout(p.C),p.C=null)}function _h(p,I){var D=null;if(p.g==I){_o(p),Ir(p),p.g=null;var V=2}else if(xt(p.h,I))D=I.D,Et(p.h,I),V=1;else return;if(p.G!=0){if(I.o)if(V==1){D=I.m?I.m.length:0,I=Date.now()-I.F;var ue=p.B;V=en(),Ge(V,new ur(V,D)),Zo(p)}else bc(p);else if(ue=I.s,ue==3||ue==0&&0<I.X||!(V==1&&Jo(p,I)||V==2&&Cc(p)))switch(D&&0<D.length&&(I=p.h,I.i=I.i.concat(D)),ue){case 1:Gs(p,5);break;case 4:Gs(p,10);break;case 3:Gs(p,6);break;default:Gs(p,2)}}}function ol(p,I){let D=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(D*=2),D*I}function Gs(p,I){if(p.j.info("Error code "+I),I==2){var D=m(p.fb,p),V=p.Xa;const ue=!V;V=new Pt(V||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||fn(V,"https"),mo(V),ue?$0(V.toString(),D):ei(V.toString(),D)}else xn(2);p.G=0,p.l&&p.l.sa(I),xh(p),Ac(p)}n.fb=function(p){p?(this.j.info("Successfully pinged google.com"),xn(2)):(this.j.info("Failed to ping google.com"),xn(1))};function xh(p){if(p.G=0,p.ka=[],p.l){const I=Jt(p.h);(I.length!=0||p.i.length!=0)&&(S(p.ka,I),S(p.ka,p.i),p.h.i.length=0,E(p.i),p.i.length=0),p.l.ra()}}function Ic(p,I,D){var V=D instanceof Pt?kt(D):new Pt(D);if(V.g!="")I&&(V.g=I+"."+V.g),wi(V,V.s);else{var ue=a.location;V=ue.protocol,I=I?I+"."+ue.hostname:ue.hostname,ue=+ue.port;var xe=new Pt(null);V&&fn(xe,V),I&&(xe.g=I),ue&&wi(xe,ue),D&&(xe.l=D),V=xe}return D=p.D,I=p.ya,D&&I&&Qt(V,D,I),Qt(V,"VER",p.la),Ri(p,V),V}function al(p,I,D){if(I&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return I=p.Ca&&!p.pa?new En(new Mc({eb:D})):new En(p.pa),I.Ha(p.J),I}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Sh(){}n=Sh.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function qi(p,I){it.call(this),this.g=new Tc(I),this.l=p,this.h=I&&I.messageUrlParams||null,p=I&&I.messageHeaders||null,I&&I.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=I&&I.initMessageHeaders||null,I&&I.messageContentType&&(p?p["X-WebChannel-Content-Type"]=I.messageContentType:p={"X-WebChannel-Content-Type":I.messageContentType}),I&&I.va&&(p?p["X-WebChannel-Client-Profile"]=I.va:p={"X-WebChannel-Client-Profile":I.va}),this.g.S=p,(p=I&&I.Sb)&&!w(p)&&(this.g.m=p),this.v=I&&I.supportsCrossDomainXhr||!1,this.u=I&&I.sendRawJson||!1,(I=I&&I.httpSessionIdParam)&&!w(I)&&(this.g.D=I,p=this.h,p!==null&&I in p&&(p=this.h,I in p&&delete p[I])),this.j=new Rr(this)}_(qi,it),qi.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},qi.prototype.close=function(){rl(this.g)},qi.prototype.o=function(p){var I=this.g;if(typeof p=="string"){var D={};D.__data__=p,p=D}else this.u&&(D={},D.__data__=wt(p),p=D);I.i.push(new vt(I.Ya++,p)),I.G==3&&Zo(I)},qi.prototype.N=function(){this.g.l=null,delete this.j,rl(this.g),delete this.g,qi.aa.N.call(this)};function wh(p){je.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var I=p.__sm__;if(I){e:{for(const D in I){p=D;break e}p=void 0}(this.i=p)&&(p=this.i,I=I!==null&&p in I?I[p]:void 0),this.data=I}else this.data=p}_(wh,je);function Rc(){Mt.call(this),this.status=1}_(Rc,Mt);function Rr(p){this.g=p}_(Rr,Sh),Rr.prototype.ua=function(){Ge(this.g,"a")},Rr.prototype.ta=function(p){Ge(this.g,new wh(p))},Rr.prototype.sa=function(p){Ge(this.g,new Rc)},Rr.prototype.ra=function(){Ge(this.g,"b")},qi.prototype.send=qi.prototype.o,qi.prototype.open=qi.prototype.m,qi.prototype.close=qi.prototype.close,Hs.NO_ERROR=0,Hs.TIMEOUT=8,Hs.HTTP_ERROR=6,F.COMPLETE="complete",re.EventType=Me,Me.OPEN="a",Me.CLOSE="b",Me.ERROR="c",Me.MESSAGE="d",it.prototype.listen=it.prototype.K,En.prototype.listenOnce=En.prototype.L,En.prototype.getLastError=En.prototype.Ka,En.prototype.getLastErrorCode=En.prototype.Ba,En.prototype.getStatus=En.prototype.Z,En.prototype.getResponseJson=En.prototype.Oa,En.prototype.getResponseText=En.prototype.oa,En.prototype.send=En.prototype.ea,En.prototype.setWithCredentials=En.prototype.Ha}).apply(typeof ig<"u"?ig:typeof self<"u"?self:typeof window<"u"?window:{});const eC="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Qi.UNAUTHENTICATED=new Qi(null),Qi.GOOGLE_CREDENTIALS=new Qi("google-credentials-uid"),Qi.FIRST_PARTY=new Qi("first-party-uid"),Qi.MOCK_USER=new Qi("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tp="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rh=new z0("@firebase/firestore");function Rs(n,...e){if(rh.logLevel<=dn.DEBUG){const t=e.map(W1);rh.debug(`Firestore (${tp}): ${n}`,...t)}}function c3(n,...e){if(rh.logLevel<=dn.ERROR){const t=e.map(W1);rh.error(`Firestore (${tp}): ${n}`,...t)}}function D9(n,...e){if(rh.logLevel<=dn.WARN){const t=e.map(W1);rh.warn(`Firestore (${tp}): ${n}`,...t)}}function W1(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Id(n="Unexpected state"){const e=`FIRESTORE (${tp}) INTERNAL ASSERTION FAILED: `+n;throw c3(e),new Error(e)}function Ff(n,e){n||Id()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ti={CANCELLED:"cancelled",INVALID_ARGUMENT:"invalid-argument",FAILED_PRECONDITION:"failed-precondition"};class Ai extends ps{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u3{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class k9{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Qi.UNAUTHENTICATED))}shutdown(){}}class O9{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class U9{constructor(e){this.t=e,this.currentUser=Qi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Ff(this.o===void 0);let i=this.i;const r=c=>this.i!==i?(i=this.i,t(c)):Promise.resolve();let s=new zf;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new zf,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const c=s;e.enqueueRetryable(async()=>{await c.promise,await r(this.currentUser)})},a=c=>{Rs("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(Rs("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new zf)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(Rs("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Ff(typeof i.accessToken=="string"),new u3(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ff(e===null||typeof e=="string"),new Qi(e)}}class F9{constructor(e,t,i){this.l=e,this.h=t,this.P=i,this.type="FirstParty",this.user=Qi.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class z9{constructor(e,t,i){this.l=e,this.h=t,this.P=i}getToken(){return Promise.resolve(new F9(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Qi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class B9{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class H9{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Ff(this.o===void 0);const i=s=>{s.error!=null&&Rs("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,Rs("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>i(s))};const r=s=>{Rs("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?r(s):Rs("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ff(typeof t.token=="string"),this.R=t.token,new B9(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv{constructor(e,t,i){t===void 0?t=0:t>e.length&&Id(),i===void 0?i=e.length-t:i>e.length-t&&Id(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return Lv.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Lv?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let r=0;r<i;r++){const s=e.get(r),o=t.get(r);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class os extends Lv{construct(e,t,i){return new os(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new Ai(Ti.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(r=>r.length>0))}return new os(t)}static emptyPath(){return new os([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{constructor(e){this.path=e}static fromPath(e){return new Wl(os.fromString(e))}static fromName(e){return new Wl(os.fromString(e).popFirst(5))}static empty(){return new Wl(os.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&os.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return os.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Wl(new os(e.slice()))}}function V9(n){return n.name==="IndexedDbTransactionError"}class Nv{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Nv("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Nv&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G9{constructor(e,t=null,i=[],r=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function W9(n){return new G9(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tC,rn;(rn=tC||(tC={}))[rn.OK=0]="OK",rn[rn.CANCELLED=1]="CANCELLED",rn[rn.UNKNOWN=2]="UNKNOWN",rn[rn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rn[rn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rn[rn.NOT_FOUND=5]="NOT_FOUND",rn[rn.ALREADY_EXISTS=6]="ALREADY_EXISTS",rn[rn.PERMISSION_DENIED=7]="PERMISSION_DENIED",rn[rn.UNAUTHENTICATED=16]="UNAUTHENTICATED",rn[rn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rn[rn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rn[rn.ABORTED=10]="ABORTED",rn[rn.OUT_OF_RANGE=11]="OUT_OF_RANGE",rn[rn.UNIMPLEMENTED=12]="UNIMPLEMENTED",rn[rn.INTERNAL=13]="INTERNAL",rn[rn.UNAVAILABLE=14]="UNAVAILABLE",rn[rn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */new l3([4294967295,4294967295],0);function dx(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j9{constructor(e,t,i=1e3,r=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=i,this.qo=r,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-i);r>0&&Rs("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j1{constructor(e,t,i,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new zf,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,i,r,s){const o=Date.now()+i,a=new j1(e,t,o,r,s);return a.start(i),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ai(Ti.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}var nC,iC;(iC=nC||(nC={})).ea="default",iC.Cache="cache";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X9(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rC=new Map;function q9(n,e,t,i){if(e===!0&&i===!0)throw new Ai(Ti.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function sC(n){if(Wl.isDocumentKey(n))throw new Ai(Ti.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Y9(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(i){return i.constructor?i.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Id()}function $9(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ai(Ti.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Y9(n);throw new Ai(Ti.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e){var t,i;if(e.host===void 0){if(e.ssl!==void 0)throw new Ai(Ti.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ai(Ti.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}q9("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=X9((i=e.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ai(Ti.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ai(Ti.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ai(Ti.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class X1{constructor(e,t,i,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new oC({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ai(Ti.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ai(Ti.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new oC(e),e.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new k9;switch(i.type){case"firstParty":return new z9(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Ai(Ti.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const i=rC.get(t);i&&(Rs("ComponentProvider","Removing Datastore"),rC.delete(t),i.terminate())}(this),Promise.resolve()}}function K9(n,e,t,i={}){var r;const s=(n=$9(n,X1))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&D9("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let a,c;if(typeof i.mockUserToken=="string")a=i.mockUserToken,c=Qi.MOCK_USER;else{a=JL(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);const h=i.mockUserToken.sub||i.mockUserToken.user_id;if(!h)throw new Ai(Ti.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Qi(h)}n._authCredentials=new O9(new u3(a,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new q1(this.firestore,e,this._query)}}class H0{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new H0(this.firestore,e,this._key)}}class Fu extends q1{constructor(e,t,i){super(e,t,W9(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new H0(this.firestore,null,new Wl(e))}withConverter(e){return new Fu(this.firestore,e,this._path)}}function Z9(n,e,...t){if(n=ho(n),n instanceof X1){const i=os.fromString(e,...t);return sC(i),new Fu(n,null,i)}{if(!(n instanceof H0||n instanceof Fu))throw new Ai(Ti.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(os.fromString(e,...t));return sC(i),new Fu(n.firestore,null,i)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new j9(this,"async_queue_retry"),this.Vu=()=>{const i=dx();i&&Rs("AsyncQueue","Visibility state changed to "+i.visibilityState),this.t_.jo()},this.mu=e;const t=dx();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=dx();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new zf;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!V9(e))throw e;Rs("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(i=>{this.Eu=i,this.du=!1;const r=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(i);throw c3("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.du=!1,i))));return this.mu=t,t}enqueueAfterDelay(e,t,i){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const r=j1.createAndSchedule(this,e,t,i,s=>this.yu(s));return this.Tu.push(r),r}fu(){this.Eu&&Id()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}class J9 extends X1{constructor(e,t,i,r){super(e,t,i,r),this.type="firestore",this._queue=new aC,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new aC(e),this._firestoreClient=void 0,await e}}}function Q9(n,e){const t=typeof n=="object"?n:B0(),i=typeof n=="string"?n:"(default)",r=Ja(t,"firestore").getImmediate({identifier:i});if(!r._initialized){const s=$L("firestore");s&&K9(r,...s)}return r}(function(e,t=!0){(function(r){tp=r})(xc),Os(new ds("firestore",(i,{instanceIdentifier:r,options:s})=>{const o=i.getProvider("app").getImmediate(),a=new J9(new U9(i.getProvider("auth-internal")),new H9(i.getProvider("app-check-internal")),function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Ai(Ti.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Nv(h.options.projectId,f)}(o,r),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Sr(eC,"4.7.3",e),Sr(eC,"4.7.3","esm2017")})();var eW="firebase",tW="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Sr(eW,tW,"app");function Y1(n,e){var t={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(t[i[r]]=n[i[r]]);return t}function h3(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const nW=h3,f3=new _c("auth","Firebase",h3());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dv=new z0("@firebase/auth");function iW(n,...e){Dv.logLevel<=dn.WARN&&Dv.warn(`Auth (${xc}): ${n}`,...e)}function wg(n,...e){Dv.logLevel<=dn.ERROR&&Dv.error(`Auth (${xc}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qo(n,...e){throw $1(n,...e)}function ro(n,...e){return $1(n,...e)}function d3(n,e,t){const i=Object.assign(Object.assign({},nW()),{[e]:t});return new _c("auth","Firebase",i).create(e,{appName:n.name})}function Ql(n){return d3(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function $1(n,...e){if(typeof n!="string"){const t=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(t,...i)}return f3.create(n,...e)}function Ot(n,e,...t){if(!n)throw $1(e,...t)}function Oo(n){const e="INTERNAL ASSERTION FAILED: "+n;throw wg(e),new Error(e)}function Yo(n,e){n||Oo(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HS(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function rW(){return lC()==="http:"||lC()==="https:"}function lC(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sW(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(rW()||QL()||"connection"in navigator)?navigator.onLine:!0}function oW(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(e,t){this.shortDelay=e,this.longDelay=t,Yo(t>e,"Short delay should be less than long delay!"),this.isMobile=fG()||pG()}get(){return sW()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K1(n,e){Yo(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p3{static initialize(e,t,i){this.fetchImpl=e,t&&(this.headersImpl=t),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Oo("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Oo("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Oo("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aW={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lW=new np(3e4,6e4);function Z1(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function dh(n,e,t,i,r={}){return m3(n,r,async()=>{let s={},o={};i&&(e==="GET"?o=i:s={body:JSON.stringify(i)});const a=ep(Object.assign({key:n.config.apiKey},o)).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const h=Object.assign({method:e,headers:c},s);return dG()||(h.referrerPolicy="no-referrer"),p3.fetch()(g3(n,n.config.apiHost,t,a),h)})}async function m3(n,e,t){n._canInitEmulator=!1;const i=Object.assign(Object.assign({},aW),e);try{const r=new uW(n),s=await Promise.race([t(),r.promise]);r.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw rg(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[c,h]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw rg(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw rg(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw rg(n,"user-disabled",o);const f=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw d3(n,f,h);qo(n,f)}}catch(r){if(r instanceof ps)throw r;qo(n,"network-request-failed",{message:String(r)})}}async function cW(n,e,t,i,r={}){const s=await dh(n,e,t,i,r);return"mfaPendingCredential"in s&&qo(n,"multi-factor-auth-required",{_serverResponse:s}),s}function g3(n,e,t,i){const r=`${e}${t}?${i}`;return n.config.emulator?K1(n.config,r):`${n.config.apiScheme}://${r}`}class uW{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,i)=>{this.timer=setTimeout(()=>i(ro(this.auth,"network-request-failed")),lW.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function rg(n,e,t){const i={appName:n.name};t.email&&(i.email=t.email),t.phoneNumber&&(i.phoneNumber=t.phoneNumber);const r=ro(n,e,i);return r.customData._tokenResponse=t,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hW(n,e){return dh(n,"POST","/v1/accounts:delete",e)}async function v3(n,e){return dh(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bf(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function fW(n,e=!1){const t=ho(n),i=await t.getIdToken(e),r=J1(i);Ot(r&&r.exp&&r.auth_time&&r.iat,t.auth,"internal-error");const s=typeof r.firebase=="object"?r.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:r,token:i,authTime:Bf(px(r.auth_time)),issuedAtTime:Bf(px(r.iat)),expirationTime:Bf(px(r.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function px(n){return Number(n)*1e3}function J1(n){const[e,t,i]=n.split(".");if(e===void 0||t===void 0||i===void 0)return wg("JWT malformed, contained fewer than 3 sections"),null;try{const r=qL(t);return r?JSON.parse(r):(wg("Failed to decode base64 JWT payload"),null)}catch(r){return wg("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function cC(n){const e=J1(n);return Ot(e,"internal-error"),Ot(typeof e.exp<"u","internal-error"),Ot(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rd(n,e,t=!1){if(t)return e;try{return await e}catch(i){throw i instanceof ps&&dW(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function dW({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pW{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const i=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),i}else{this.errorBackoff=3e4;const r=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Bf(this.lastLoginAt),this.creationTime=Bf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kv(n){var e;const t=n.auth,i=await n.getIdToken(),r=await Rd(n,v3(t,{idToken:i}));Ot(r==null?void 0:r.users.length,t,"internal-error");const s=r.users[0];n._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?y3(s.providerUserInfo):[],a=gW(n.providerData,o),c=n.isAnonymous,h=!(n.email&&s.passwordHash)&&!(a!=null&&a.length),f=c?h:!1,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new VS(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(n,d)}async function mW(n){const e=ho(n);await kv(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function gW(n,e){return[...n.filter(i=>!e.some(r=>r.providerId===i.providerId)),...e]}function y3(n){return n.map(e=>{var{providerId:t}=e,i=Y1(e,["providerId"]);return{providerId:t,uid:i.rawId||"",displayName:i.displayName||null,email:i.email||null,phoneNumber:i.phoneNumber||null,photoURL:i.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vW(n,e){const t=await m3(n,{},async()=>{const i=ep({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:s}=n.config,o=g3(n,r,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",p3.fetch()(o,{method:"POST",headers:a,body:i})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function yW(n,e){return dh(n,"POST","/v2/accounts:revokeToken",Z1(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ot(e.idToken,"internal-error"),Ot(typeof e.idToken<"u","internal-error"),Ot(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):cC(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Ot(e.length!==0,"internal-error");const t=cC(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Ot(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:i,refreshToken:r,expiresIn:s}=await vW(e,t);this.updateTokensAndExpiration(i,r,Number(s))}updateTokensAndExpiration(e,t,i){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,t){const{refreshToken:i,accessToken:r,expirationTime:s}=t,o=new zu;return i&&(Ot(typeof i=="string","internal-error",{appName:e}),o.refreshToken=i),r&&(Ot(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),s&&(Ot(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new zu,this.toJSON())}_performRefresh(){return Oo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ma(n,e){Ot(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Uo{constructor(e){var{uid:t,auth:i,stsTokenManager:r}=e,s=Y1(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new pW(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=i,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new VS(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Rd(this,this.stsTokenManager.getToken(this.auth,e));return Ot(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return fW(this,e)}reload(){return mW(this)}_assign(e){this!==e&&(Ot(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Uo(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Ot(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),t&&await kv(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ia(this.auth.app))return Promise.reject(Ql(this.auth));const e=await this.getIdToken();return await Rd(this,hW(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var i,r,s,o,a,c,h,f;const d=(i=t.displayName)!==null&&i!==void 0?i:void 0,m=(r=t.email)!==null&&r!==void 0?r:void 0,v=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,_=(o=t.photoURL)!==null&&o!==void 0?o:void 0,E=(a=t.tenantId)!==null&&a!==void 0?a:void 0,S=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,y=(h=t.createdAt)!==null&&h!==void 0?h:void 0,w=(f=t.lastLoginAt)!==null&&f!==void 0?f:void 0,{uid:M,emailVerified:R,isAnonymous:z,providerData:k,stsTokenManager:P}=t;Ot(M&&P,e,"internal-error");const b=zu.fromJSON(this.name,P);Ot(typeof M=="string",e,"internal-error"),ma(d,e.name),ma(m,e.name),Ot(typeof R=="boolean",e,"internal-error"),Ot(typeof z=="boolean",e,"internal-error"),ma(v,e.name),ma(_,e.name),ma(E,e.name),ma(S,e.name),ma(y,e.name),ma(w,e.name);const A=new Uo({uid:M,auth:e,email:m,emailVerified:R,displayName:d,isAnonymous:z,photoURL:_,phoneNumber:v,tenantId:E,stsTokenManager:b,createdAt:y,lastLoginAt:w});return k&&Array.isArray(k)&&(A.providerData=k.map(T=>Object.assign({},T))),S&&(A._redirectEventId=S),A}static async _fromIdTokenResponse(e,t,i=!1){const r=new zu;r.updateFromServerResponse(t);const s=new Uo({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:i});return await kv(s),s}static async _fromGetAccountInfoResponse(e,t,i){const r=t.users[0];Ot(r.localId!==void 0,"internal-error");const s=r.providerUserInfo!==void 0?y3(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(s!=null&&s.length),a=new zu;a.updateFromIdToken(i);const c=new Uo({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:o}),h={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new VS(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(s!=null&&s.length)};return Object.assign(c,h),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC=new Map;function Fo(n){Yo(n instanceof Function,"Expected a class definition");let e=uC.get(n);return e?(Yo(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,uC.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _3{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}_3.type="NONE";const hC=_3;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mg(n,e,t){return`firebase:${n}:${e}:${t}`}class Bu{constructor(e,t,i){this.persistence=e,this.auth=t,this.userKey=i;const{config:r,name:s}=this.auth;this.fullUserKey=Mg(this.userKey,r.apiKey,s),this.fullPersistenceKey=Mg("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Uo._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,i="authUser"){if(!t.length)return new Bu(Fo(hC),e,i);const r=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let s=r[0]||Fo(hC);const o=Mg(i,e.config.apiKey,e.name);let a=null;for(const h of t)try{const f=await h._get(o);if(f){const d=Uo._fromJSON(e,f);h!==s&&(a=d),s=h;break}}catch{}const c=r.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new Bu(s,e,i):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new Bu(s,e,i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fC(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(M3(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(x3(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(T3(e))return"Blackberry";if(A3(e))return"Webos";if(S3(e))return"Safari";if((e.includes("chrome/")||w3(e))&&!e.includes("edge/"))return"Chrome";if(E3(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(t);if((i==null?void 0:i.length)===2)return i[1]}return"Other"}function x3(n=rr()){return/firefox\//i.test(n)}function S3(n=rr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function w3(n=rr()){return/crios\//i.test(n)}function M3(n=rr()){return/iemobile/i.test(n)}function E3(n=rr()){return/android/i.test(n)}function T3(n=rr()){return/blackberry/i.test(n)}function A3(n=rr()){return/webos/i.test(n)}function Q1(n=rr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function _W(n=rr()){var e;return Q1(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function xW(){return mG()&&document.documentMode===10}function b3(n=rr()){return Q1(n)||E3(n)||A3(n)||T3(n)||/windows phone/i.test(n)||M3(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C3(n,e=[]){let t;switch(n){case"Browser":t=fC(rr());break;case"Worker":t=`${fC(rr())}-${n}`;break;default:t=n}const i=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${xc}/${i}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SW{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const i=s=>new Promise((o,a)=>{try{const c=e(s);o(c)}catch(c){a(c)}});i.onAbort=t,this.queue.push(i);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const i of this.queue)await i(e),i.onAbort&&t.push(i.onAbort)}catch(i){t.reverse();for(const r of t)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i==null?void 0:i.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wW(n,e={}){return dh(n,"GET","/v2/passwordPolicy",Z1(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MW=6;class EW{constructor(e){var t,i,r,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:MW,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(i=e.allowedNonAlphanumericCharacters)===null||i===void 0?void 0:i.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,i,r,s,o,a;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(i=c.meetsMaxPasswordLength)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(r=c.containsLowercaseLetter)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(a=c.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),c}validatePasswordLengthOptions(e,t){const i=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;i&&(t.meetsMinPasswordLength=e.length>=i),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let i;for(let r=0;r<e.length;r++)i=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,t,i,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TW{constructor(e,t,i,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=i,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new dC(this),this.idTokenSubscription=new dC(this),this.beforeStateQueue=new SW(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=f3,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Fo(t)),this._initializationPromise=this.queue(async()=>{var i,r;if(!this._deleted&&(this.persistenceManager=await Bu.create(this,e),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await v3(this,{idToken:e}),i=await Uo._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(i)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(Ia(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const i=await this.assertedPersistence.getCurrentUser();let r=i,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(r=c.user,s=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=i,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Ot(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await kv(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=oW()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ia(this.app))return Promise.reject(Ql(this));const t=e?ho(e):null;return t&&Ot(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Ot(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ia(this.app)?Promise.reject(Ql(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ia(this.app)?Promise.reject(Ql(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Fo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await wW(this),t=new EW(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new _c("auth","Firebase",e())}onAuthStateChanged(e,t,i){return this.registerStateListener(this.authStateSubscription,e,t,i)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,i){return this.registerStateListener(this.idTokenSubscription,e,t,i)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(i.tenantId=this.tenantId),await yW(this,i)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const i=await this.getOrInitRedirectPersistenceManager(t);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Fo(e)||this._popupRedirectResolver;Ot(t,this,"argument-error"),this.redirectPersistenceManager=await Bu.create(this,[Fo(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,i;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((i=this.redirectUser)===null||i===void 0?void 0:i._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const i=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==i&&(this.lastNotifiedUid=i,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,i,r){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ot(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const c=e.addObserver(t,i,r);return()=>{o=!0,c()}}else{const c=e.addObserver(t);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ot(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=C3(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const i=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());i&&(t["X-Firebase-Client"]=i);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&iW(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function eM(n){return ho(n)}class dC{constructor(e){this.auth=e,this.observer=null,this.addObserver=SG(t=>this.observer=t)}get next(){return Ot(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tM={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function AW(n){tM=n}function bW(n){return tM.loadJS(n)}function CW(){return tM.gapiScript}function IW(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RW(n,e){const t=Ja(n,"auth");if(t.isInitialized()){const r=t.getImmediate(),s=t.getOptions();if(bd(s,e??{}))return r;qo(r,"already-initialized")}return t.initialize({options:e})}function PW(n,e){const t=(e==null?void 0:e.persistence)||[],i=(Array.isArray(t)?t:[t]).map(Fo);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(i,e==null?void 0:e.popupRedirectResolver)}function LW(n,e,t){const i=eM(n);Ot(i._canInitEmulator,i,"emulator-config-failed"),Ot(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const r=!1,s=I3(e),{host:o,port:a}=NW(e),c=a===null?"":`:${a}`;i.config.emulator={url:`${s}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),DW()}function I3(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function NW(n){const e=I3(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const i=t[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const s=r[1];return{host:s,port:pC(i.substr(s.length+1))}}else{const[s,o]=i.split(":");return{host:s,port:pC(o)}}}function pC(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function DW(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R3{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Oo("not implemented")}_getIdTokenResponse(e){return Oo("not implemented")}_linkToIdToken(e,t){return Oo("not implemented")}_getReauthenticationResolver(e){return Oo("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hu(n,e){return cW(n,"POST","/v1/accounts:signInWithIdp",Z1(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kW="http://localhost";class cc extends R3{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new cc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):qo("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:r}=t,s=Y1(t,["providerId","signInMethod"]);if(!i||!r)return null;const o=new cc(i,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Hu(e,t)}_linkToIdToken(e,t){const i=this.buildRequest();return i.idToken=t,Hu(e,i)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Hu(e,t)}buildRequest(){const e={requestUri:kW,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=ep(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P3{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip extends P3{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa extends ip{constructor(){super("facebook.com")}static credential(e){return cc._fromParams({providerId:wa.PROVIDER_ID,signInMethod:wa.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return wa.credentialFromTaggedObject(e)}static credentialFromError(e){return wa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return wa.credential(e.oauthAccessToken)}catch{return null}}}wa.FACEBOOK_SIGN_IN_METHOD="facebook.com";wa.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma extends ip{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return cc._fromParams({providerId:Ma.PROVIDER_ID,signInMethod:Ma.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Ma.credentialFromTaggedObject(e)}static credentialFromError(e){return Ma.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:i}=e;if(!t&&!i)return null;try{return Ma.credential(t,i)}catch{return null}}}Ma.GOOGLE_SIGN_IN_METHOD="google.com";Ma.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea extends ip{constructor(){super("github.com")}static credential(e){return cc._fromParams({providerId:Ea.PROVIDER_ID,signInMethod:Ea.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ea.credentialFromTaggedObject(e)}static credentialFromError(e){return Ea.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ea.credential(e.oauthAccessToken)}catch{return null}}}Ea.GITHUB_SIGN_IN_METHOD="github.com";Ea.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta extends ip{constructor(){super("twitter.com")}static credential(e,t){return cc._fromParams({providerId:Ta.PROVIDER_ID,signInMethod:Ta.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ta.credentialFromTaggedObject(e)}static credentialFromError(e){return Ta.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:i}=e;if(!t||!i)return null;try{return Ta.credential(t,i)}catch{return null}}}Ta.TWITTER_SIGN_IN_METHOD="twitter.com";Ta.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sh{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,i,r=!1){const s=await Uo._fromIdTokenResponse(e,i,r),o=mC(i);return new sh({user:s,providerId:o,_tokenResponse:i,operationType:t})}static async _forOperation(e,t,i){await e._updateTokensIfNecessary(i,!0);const r=mC(i);return new sh({user:e,providerId:r,_tokenResponse:i,operationType:t})}}function mC(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ov extends ps{constructor(e,t,i,r){var s;super(t.code,t.message),this.operationType=i,this.user=r,Object.setPrototypeOf(this,Ov.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,t,i,r){return new Ov(e,t,i,r)}}function L3(n,e,t,i){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Ov._fromErrorAndOperation(n,s,e,i):s})}async function OW(n,e,t=!1){const i=await Rd(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return sh._forOperation(n,"link",i)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UW(n,e,t=!1){const{auth:i}=n;if(Ia(i.app))return Promise.reject(Ql(i));const r="reauthenticate";try{const s=await Rd(n,L3(i,r,e,n),t);Ot(s.idToken,i,"internal-error");const o=J1(s.idToken);Ot(o,i,"internal-error");const{sub:a}=o;return Ot(n.uid===a,i,"user-mismatch"),sh._forOperation(n,r,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&qo(i,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FW(n,e,t=!1){if(Ia(n.app))return Promise.reject(Ql(n));const i="signIn",r=await L3(n,i,e),s=await sh._fromIdTokenResponse(n,i,r);return t||await n._updateCurrentUser(s.user),s}function zW(n,e,t,i){return ho(n).onIdTokenChanged(e,t,i)}function BW(n,e,t){return ho(n).beforeAuthStateChanged(e,t)}const Uv="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N3{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Uv,"1"),this.storage.removeItem(Uv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HW=1e3,VW=10;class D3 extends N3{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=b3(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const i=this.storage.getItem(t),r=this.localCache[t];i!==r&&e(t,r,i)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const i=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(i);!t&&this.localCache[i]===o||this.notifyListeners(i,o)},s=this.storage.getItem(i);xW()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,VW):r()}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:i}),!0)})},HW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}D3.type="LOCAL";const GW=D3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3 extends N3{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}k3.type="SESSION";const O3=k3;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WW(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(r=>r.isListeningto(e));if(t)return t;const i=new V0(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:i,eventType:r,data:s}=t.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:i,eventType:r});const a=Array.from(o).map(async h=>h(t.origin,s)),c=await WW(a);t.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}V0.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nM(n="",e=10){let t="";for(let i=0;i<e;i++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jW{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,i=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{const h=nM("",20);r.port1.start();const f=setTimeout(()=>{c(new Error("unsupported_event"))},i);o={messageChannel:r,onMessage(d){const m=d;if(m.data.eventId===h)switch(m.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(m.data.response);break;default:clearTimeout(f),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function so(){return window}function XW(n){so().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U3(){return typeof so().WorkerGlobalScope<"u"&&typeof so().importScripts=="function"}async function qW(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function YW(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function $W(){return U3()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F3="firebaseLocalStorageDb",KW=1,Fv="firebaseLocalStorage",z3="fbase_key";class rp{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function G0(n,e){return n.transaction([Fv],e?"readwrite":"readonly").objectStore(Fv)}function ZW(){const n=indexedDB.deleteDatabase(F3);return new rp(n).toPromise()}function GS(){const n=indexedDB.open(F3,KW);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(Fv,{keyPath:z3})}catch(r){t(r)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(Fv)?e(i):(i.close(),await ZW(),e(await GS()))})})}async function gC(n,e,t){const i=G0(n,!0).put({[z3]:e,value:t});return new rp(i).toPromise()}async function JW(n,e){const t=G0(n,!1).get(e),i=await new rp(t).toPromise();return i===void 0?null:i.value}function vC(n,e){const t=G0(n,!0).delete(e);return new rp(t).toPromise()}const QW=800,e7=3;class B3{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await GS(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(t++>e7)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return U3()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=V0._getInstance($W()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await qW(),!this.activeServiceWorker)return;this.sender=new jW(this.activeServiceWorker);const i=await this.sender._send("ping",{},800);i&&!((e=i[0])===null||e===void 0)&&e.fulfilled&&!((t=i[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||YW()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await GS();return await gC(e,Uv,"1"),await vC(e,Uv),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(i=>gC(i,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(i=>JW(i,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>vC(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const s=G0(r,!1).getAll();return new rp(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],i=new Set;if(e.length!==0)for(const{fbase_key:r,value:s}of e)i.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!i.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const i=this.listeners[e];if(i)for(const r of Array.from(i))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),QW)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}B3.type="LOCAL";const t7=B3;new np(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n7(n,e){return e?Fo(e):(Ot(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iM extends R3{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Hu(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Hu(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Hu(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function i7(n){return FW(n.auth,new iM(n),n.bypassAuthState)}function r7(n){const{auth:e,user:t}=n;return Ot(t,e,"internal-error"),UW(t,new iM(n),n.bypassAuthState)}async function s7(n){const{auth:e,user:t}=n;return Ot(t,e,"internal-error"),OW(t,new iM(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H3{constructor(e,t,i,r,s=!1){this.auth=e,this.resolver=i,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:i,postBody:r,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:t,sessionId:i,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return i7;case"linkViaPopup":case"linkViaRedirect":return s7;case"reauthViaPopup":case"reauthViaRedirect":return r7;default:qo(this.auth,"internal-error")}}resolve(e){Yo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Yo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o7=new np(2e3,1e4);class Cu extends H3{constructor(e,t,i,r,s){super(e,t,r,s),this.provider=i,this.authWindow=null,this.pollId=null,Cu.currentPopupAction&&Cu.currentPopupAction.cancel(),Cu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ot(e,this.auth,"internal-error"),e}async onExecution(){Yo(this.filter.length===1,"Popup operations only handle one event");const e=nM();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ro(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ro(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Cu.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,i;if(!((i=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||i===void 0)&&i.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ro(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,o7.get())};e()}}Cu.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a7="pendingRedirect",Eg=new Map;class l7 extends H3{constructor(e,t,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,i),this.eventId=null}async execute(){let e=Eg.get(this.auth._key());if(!e){try{const i=await c7(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(t){e=()=>Promise.reject(t)}Eg.set(this.auth._key(),e)}return this.bypassAuthState||Eg.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function c7(n,e){const t=f7(e),i=h7(n);if(!await i._isAvailable())return!1;const r=await i._get(t)==="true";return await i._remove(t),r}function u7(n,e){Eg.set(n._key(),e)}function h7(n){return Fo(n._redirectPersistence)}function f7(n){return Mg(a7,n.config.apiKey,n.name)}async function d7(n,e,t=!1){if(Ia(n.app))return Promise.reject(Ql(n));const i=eM(n),r=n7(i,e),o=await new l7(i,r,t).execute();return o&&!t&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p7=10*60*1e3;class m7{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(t=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!g7(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var i;if(e.error&&!V3(e)){const r=((i=e.error.code)===null||i===void 0?void 0:i.split("auth/")[1])||"internal-error";t.onError(ro(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const i=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=p7&&this.cachedEventUids.clear(),this.cachedEventUids.has(yC(e))}saveEventToCache(e){this.cachedEventUids.add(yC(e)),this.lastProcessedEventTime=Date.now()}}function yC(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function V3({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function g7(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return V3(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v7(n,e={}){return dh(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y7=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_7=/^https?/;async function x7(n){if(n.config.emulator)return;const{authorizedDomains:e}=await v7(n);for(const t of e)try{if(S7(t))return}catch{}qo(n,"unauthorized-domain")}function S7(n){const e=HS(),{protocol:t,hostname:i}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===i}if(!_7.test(t))return!1;if(y7.test(n))return i===n;const r=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w7=new np(3e4,6e4);function _C(){const n=so().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function M7(n){return new Promise((e,t)=>{var i,r,s;function o(){_C(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{_C(),t(ro(n,"network-request-failed"))},timeout:w7.get()})}if(!((r=(i=so().gapi)===null||i===void 0?void 0:i.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((s=so().gapi)===null||s===void 0)&&s.load)o();else{const a=IW("iframefcb");return so()[a]=()=>{gapi.load?o():t(ro(n,"network-request-failed"))},bW(`${CW()}?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw Tg=null,e})}let Tg=null;function E7(n){return Tg=Tg||M7(n),Tg}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T7=new np(5e3,15e3),A7="__/auth/iframe",b7="emulator/auth/iframe",C7={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},I7=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function R7(n){const e=n.config;Ot(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?K1(e,b7):`https://${n.config.authDomain}/${A7}`,i={apiKey:e.apiKey,appName:n.name,v:xc},r=I7.get(n.config.apiHost);r&&(i.eid=r);const s=n._getFrameworks();return s.length&&(i.fw=s.join(",")),`${t}?${ep(i).slice(1)}`}async function P7(n){const e=await E7(n),t=so().gapi;return Ot(t,n,"internal-error"),e.open({where:document.body,url:R7(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:C7,dontclear:!0},i=>new Promise(async(r,s)=>{await i.restyle({setHideOnLeave:!1});const o=ro(n,"network-request-failed"),a=so().setTimeout(()=>{s(o)},T7.get());function c(){so().clearTimeout(a),r(i)}i.ping(c).then(c,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L7={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},N7=500,D7=600,k7="_blank",O7="http://localhost";class xC{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function U7(n,e,t,i=N7,r=D7){const s=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c=Object.assign(Object.assign({},L7),{width:i.toString(),height:r.toString(),top:s,left:o}),h=rr().toLowerCase();t&&(a=w3(h)?k7:t),x3(h)&&(e=e||O7,c.scrollbars="yes");const f=Object.entries(c).reduce((m,[v,_])=>`${m}${v}=${_},`,"");if(_W(h)&&a!=="_self")return F7(e||"",a),new xC(null);const d=window.open(e||"",a,f);Ot(d,n,"popup-blocked");try{d.focus()}catch{}return new xC(d)}function F7(n,e){const t=document.createElement("a");t.href=n,t.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z7="__/auth/handler",B7="emulator/auth/handler",H7=encodeURIComponent("fac");async function SC(n,e,t,i,r,s){Ot(n.config.authDomain,n,"auth-domain-config-required"),Ot(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:i,v:xc,eventId:r};if(e instanceof P3){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",xG(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[f,d]of Object.entries({}))o[f]=d}if(e instanceof ip){const f=e.getScopes().filter(d=>d!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const f of Object.keys(a))a[f]===void 0&&delete a[f];const c=await n._getAppCheckToken(),h=c?`#${H7}=${encodeURIComponent(c)}`:"";return`${V7(n)}?${ep(a).slice(1)}${h}`}function V7({config:n}){return n.emulator?K1(n,B7):`https://${n.authDomain}/${z7}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mx="webStorageSupport";class G7{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=O3,this._completeRedirectFn=d7,this._overrideRedirectResult=u7}async _openPopup(e,t,i,r){var s;Yo((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await SC(e,t,i,HS(),r);return U7(e,o,nM())}async _openRedirect(e,t,i,r){await this._originValidation(e);const s=await SC(e,t,i,HS(),r);return XW(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:r,promise:s}=this.eventManagers[t];return r?Promise.resolve(r):(Yo(s,"If manager is not set, promise should be"),s)}const i=this.initAndGetManager(e);return this.eventManagers[t]={promise:i},i.catch(()=>{delete this.eventManagers[t]}),i}async initAndGetManager(e){const t=await P7(e),i=new m7(e);return t.register("authEvent",r=>(Ot(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:i.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=t,i}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(mx,{type:mx},r=>{var s;const o=(s=r==null?void 0:r[0])===null||s===void 0?void 0:s[mx];o!==void 0&&t(!!o),qo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=x7(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return b3()||S3()||Q1()}}const W7=G7;var wC="@firebase/auth",MC="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j7{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(i=>{e((i==null?void 0:i.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Ot(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X7(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function q7(n){Os(new ds("auth",(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;Ot(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:C3(n)},h=new TW(i,r,s,c);return PW(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,i)=>{e.getProvider("auth-internal").initialize()})),Os(new ds("auth-internal",e=>{const t=eM(e.getProvider("auth").getImmediate());return(i=>new j7(i))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Sr(wC,MC,X7(n)),Sr(wC,MC,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y7=5*60,$7=ZL("authIdTokenMaxAge")||Y7;let EC=null;const K7=n=>async e=>{const t=e&&await e.getIdTokenResult(),i=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(i&&i>$7)return;const r=t==null?void 0:t.token;EC!==r&&(EC=r,await fetch(n,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function Z7(n=B0()){const e=Ja(n,"auth");if(e.isInitialized())return e.getImmediate();const t=RW(n,{popupRedirectResolver:W7,persistence:[t7,GW,O3]}),i=ZL("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(i,location.origin);if(location.origin===s.origin){const o=K7(s.toString());BW(t,o,()=>o(t.currentUser)),zW(t,a=>o(a))}}const r=YL("auth");return r&&LW(t,`http://${r}`),t}function J7(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}AW({loadJS(n){return new Promise((e,t)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=e,i.onerror=r=>{const s=ro("internal-error");s.customData=r,t(s)},i.type="text/javascript",i.charset="UTF-8",J7().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});q7("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G3="firebasestorage.googleapis.com",Q7="storageBucket",ej=2*60*1e3,tj=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo extends ps{constructor(e,t,i=0){super(gx(e),`Firebase Storage: ${t} (${gx(e)})`),this.status_=i,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,fo.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return gx(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var lo;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(lo||(lo={}));function gx(n){return"storage/"+n}function nj(){const n="An unknown error occurred, please check the error payload for server response.";return new fo(lo.UNKNOWN,n)}function ij(){return new fo(lo.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function rj(){return new fo(lo.CANCELED,"User canceled the upload/download.")}function sj(n){return new fo(lo.INVALID_URL,"Invalid URL '"+n+"'.")}function oj(n){return new fo(lo.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function TC(n){return new fo(lo.INVALID_ARGUMENT,n)}function W3(){return new fo(lo.APP_DELETED,"The Firebase app was deleted.")}function aj(n){return new fo(lo.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let i;try{i=Ps.makeFromUrl(e,t)}catch{return new Ps(e,"")}if(i.path==="")return i;throw oj(e)}static makeFromUrl(e,t){let i=null;const r="([A-Za-z0-9.\\-_]+)";function s(R){R.path.charAt(R.path.length-1)==="/"&&(R.path_=R.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function h(R){R.path_=decodeURIComponent(R.path)}const f="v[A-Za-z0-9_]+",d=t.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",v=new RegExp(`^https?://${d}/${f}/b/${r}/o${m}`,"i"),_={bucket:1,path:3},E=t===G3?"(?:storage.googleapis.com|storage.cloud.google.com)":t,S="([^?#]*)",y=new RegExp(`^https?://${E}/${r}/${S}`,"i"),M=[{regex:a,indices:c,postModify:s},{regex:v,indices:_,postModify:h},{regex:y,indices:{bucket:1,path:2},postModify:h}];for(let R=0;R<M.length;R++){const z=M[R],k=z.regex.exec(e);if(k){const P=k[z.indices.bucket];let b=k[z.indices.path];b||(b=""),i=new Ps(P,b),z.postModify(i);break}}if(i==null)throw sj(e);return i}}class lj{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cj(n,e,t){let i=1,r=null,s=null,o=!1,a=0;function c(){return a===2}let h=!1;function f(...S){h||(h=!0,e.apply(null,S))}function d(S){r=setTimeout(()=>{r=null,n(v,c())},S)}function m(){s&&clearTimeout(s)}function v(S,...y){if(h){m();return}if(S){m(),f.call(null,S,...y);return}if(c()||o){m(),f.call(null,S,...y);return}i<64&&(i*=2);let M;a===1?(a=2,M=0):M=(i+Math.random())*1e3,d(M)}let _=!1;function E(S){_||(_=!0,m(),!h&&(r!==null?(S||(a=2),clearTimeout(r),d(0)):S||(a=1)))}return d(0),s=setTimeout(()=>{o=!0,E(!0)},t),E}function uj(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hj(n){return n!==void 0}function AC(n,e,t,i){if(i<e)throw TC(`Invalid value for '${n}'. Expected ${e} or greater.`);if(i>t)throw TC(`Invalid value for '${n}'. Expected ${t} or less.`)}function fj(n){const e=encodeURIComponent;let t="?";for(const i in n)if(n.hasOwnProperty(i)){const r=e(i)+"="+e(n[i]);t=t+r+"&"}return t=t.slice(0,-1),t}var zv;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(zv||(zv={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dj(n,e){const t=n>=500&&n<600,r=[408,429].indexOf(n)!==-1,s=e.indexOf(n)!==-1;return t||r||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pj{constructor(e,t,i,r,s,o,a,c,h,f,d,m=!0){this.url_=e,this.method_=t,this.headers_=i,this.body_=r,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=h,this.progressCallback_=f,this.connectionFactory_=d,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,_)=>{this.resolve_=v,this.reject_=_,this.start_()})}start_(){const e=(i,r)=>{if(r){i(!1,new sg(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const c=a.loaded,h=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,h)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===zv.NO_ERROR,c=s.getStatus();if(!a||dj(c,this.additionalRetryCodes_)&&this.retry){const f=s.getErrorCode()===zv.ABORT;i(!1,new sg(!1,null,f));return}const h=this.successCodes_.indexOf(c)!==-1;i(!0,new sg(h,s))})},t=(i,r)=>{const s=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());hj(c)?s(c):s()}catch(c){o(c)}else if(a!==null){const c=nj();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(r.canceled){const c=this.appDelete_?W3():rj();o(c)}else{const c=ij();o(c)}};this.canceled_?t(!1,new sg(!1,null,!0)):this.backoffId_=cj(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&uj(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class sg{constructor(e,t,i){this.wasSuccessCode=e,this.connection=t,this.canceled=!!i}}function mj(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function gj(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function vj(n,e){e&&(n["X-Firebase-GMPID"]=e)}function yj(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function _j(n,e,t,i,r,s,o=!0){const a=fj(n.urlParams),c=n.url+a,h=Object.assign({},n.headers);return vj(h,e),mj(h,t),gj(h,s),yj(h,i),new pj(c,n.method,h,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,r,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xj(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function Sj(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bv{constructor(e,t){this._service=e,t instanceof Ps?this._location=t:this._location=Ps.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Bv(e,t)}get root(){const e=new Ps(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Sj(this._location.path)}get storage(){return this._service}get parent(){const e=xj(this._location.path);if(e===null)return null;const t=new Ps(this._location.bucket,e);return new Bv(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw aj(e)}}function bC(n,e){const t=e==null?void 0:e[Q7];return t==null?null:Ps.makeFromBucketSpec(t,n)}function wj(n,e,t,i={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:r}=i;r&&(n._overrideAuthToken=typeof r=="string"?r:JL(r,n.app.options.projectId))}class Mj{constructor(e,t,i,r,s){this.app=e,this._authProvider=t,this._appCheckProvider=i,this._url=r,this._firebaseVersion=s,this._bucket=null,this._host=G3,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=ej,this._maxUploadRetryTime=tj,this._requests=new Set,r!=null?this._bucket=Ps.makeFromBucketSpec(r,this._host):this._bucket=bC(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Ps.makeFromBucketSpec(this._url,e):this._bucket=bC(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){AC("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){AC("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Bv(this,e)}_makeRequest(e,t,i,r,s=!0){if(this._deleted)return new lj(W3());{const o=_j(e,this._appId,i,r,t,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[i,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,i,r).getPromise()}}const CC="@firebase/storage",IC="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j3="storage";function Ej(n=B0(),e){n=ho(n);const i=Ja(n,j3).getImmediate({identifier:e}),r=$L("storage");return r&&Tj(i,...r),i}function Tj(n,e,t,i={}){wj(n,e,t,i)}function Aj(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),i=n.getProvider("auth-internal"),r=n.getProvider("app-check-internal");return new Mj(t,i,r,e,xc)}function bj(){Os(new ds(j3,Aj,"PUBLIC").setMultipleInstances(!0)),Sr(CC,IC,""),Sr(CC,IC,"esm2017")}bj();const X3="@firebase/installations",rM="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q3=1e4,Y3=`w:${rM}`,$3="FIS_v2",Cj="https://firebaseinstallations.googleapis.com/v1",Ij=60*60*1e3,Rj="installations",Pj="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lj={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},uc=new _c(Rj,Pj,Lj);function K3(n){return n instanceof ps&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z3({projectId:n}){return`${Cj}/projects/${n}/installations`}function J3(n){return{token:n.token,requestStatus:2,expiresIn:Dj(n.expiresIn),creationTime:Date.now()}}async function Q3(n,e){const i=(await e.json()).error;return uc.create("request-failed",{requestName:n,serverCode:i.code,serverMessage:i.message,serverStatus:i.status})}function eN({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function Nj(n,{refreshToken:e}){const t=eN(n);return t.append("Authorization",kj(e)),t}async function tN(n){const e=await n();return e.status>=500&&e.status<600?n():e}function Dj(n){return Number(n.replace("s","000"))}function kj(n){return`${$3} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oj({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const i=Z3(n),r=eN(n),s=e.getImmediate({optional:!0});if(s){const h=await s.getHeartbeatsHeader();h&&r.append("x-firebase-client",h)}const o={fid:t,authVersion:$3,appId:n.appId,sdkVersion:Y3},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await tN(()=>fetch(i,a));if(c.ok){const h=await c.json();return{fid:h.fid||t,registrationStatus:2,refreshToken:h.refreshToken,authToken:J3(h.authToken)}}else throw await Q3("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nN(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uj(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj=/^[cdef][\w-]{21}$/,WS="";function zj(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=Bj(n);return Fj.test(t)?t:WS}catch{return WS}}function Bj(n){return Uj(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W0(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iN=new Map;function rN(n,e){const t=W0(n);sN(t,e),Hj(t,e)}function sN(n,e){const t=iN.get(n);if(t)for(const i of t)i(e)}function Hj(n,e){const t=Vj();t&&t.postMessage({key:n,fid:e}),Gj()}let jl=null;function Vj(){return!jl&&"BroadcastChannel"in self&&(jl=new BroadcastChannel("[Firebase] FID Change"),jl.onmessage=n=>{sN(n.data.key,n.data.fid)}),jl}function Gj(){iN.size===0&&jl&&(jl.close(),jl=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wj="firebase-installations-database",jj=1,hc="firebase-installations-store";let vx=null;function sM(){return vx||(vx=r3(Wj,jj,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(hc)}}})),vx}async function Hv(n,e){const t=W0(n),r=(await sM()).transaction(hc,"readwrite"),s=r.objectStore(hc),o=await s.get(t);return await s.put(e,t),await r.done,(!o||o.fid!==e.fid)&&rN(n,e.fid),e}async function oN(n){const e=W0(n),i=(await sM()).transaction(hc,"readwrite");await i.objectStore(hc).delete(e),await i.done}async function j0(n,e){const t=W0(n),r=(await sM()).transaction(hc,"readwrite"),s=r.objectStore(hc),o=await s.get(t),a=e(o);return a===void 0?await s.delete(t):await s.put(a,t),await r.done,a&&(!o||o.fid!==a.fid)&&rN(n,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oM(n){let e;const t=await j0(n.appConfig,i=>{const r=Xj(i),s=qj(n,r);return e=s.registrationPromise,s.installationEntry});return t.fid===WS?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function Xj(n){const e=n||{fid:zj(),registrationStatus:0};return aN(e)}function qj(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(uc.create("app-offline"));return{installationEntry:e,registrationPromise:r}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=Yj(n,t);return{installationEntry:t,registrationPromise:i}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:$j(n)}:{installationEntry:e}}async function Yj(n,e){try{const t=await Oj(n,e);return Hv(n.appConfig,t)}catch(t){throw K3(t)&&t.customData.serverCode===409?await oN(n.appConfig):await Hv(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function $j(n){let e=await RC(n.appConfig);for(;e.registrationStatus===1;)await nN(100),e=await RC(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:i}=await oM(n);return i||t}return e}function RC(n){return j0(n,e=>{if(!e)throw uc.create("installation-not-found");return aN(e)})}function aN(n){return Kj(n)?{fid:n.fid,registrationStatus:0}:n}function Kj(n){return n.registrationStatus===1&&n.registrationTime+q3<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zj({appConfig:n,heartbeatServiceProvider:e},t){const i=Jj(n,t),r=Nj(n,t),s=e.getImmediate({optional:!0});if(s){const h=await s.getHeartbeatsHeader();h&&r.append("x-firebase-client",h)}const o={installation:{sdkVersion:Y3,appId:n.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await tN(()=>fetch(i,a));if(c.ok){const h=await c.json();return J3(h)}else throw await Q3("Generate Auth Token",c)}function Jj(n,{fid:e}){return`${Z3(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aM(n,e=!1){let t;const i=await j0(n.appConfig,s=>{if(!lN(s))throw uc.create("not-registered");const o=s.authToken;if(!e&&tX(o))return s;if(o.requestStatus===1)return t=Qj(n,e),s;{if(!navigator.onLine)throw uc.create("app-offline");const a=iX(s);return t=eX(n,a),a}});return t?await t:i.authToken}async function Qj(n,e){let t=await PC(n.appConfig);for(;t.authToken.requestStatus===1;)await nN(100),t=await PC(n.appConfig);const i=t.authToken;return i.requestStatus===0?aM(n,e):i}function PC(n){return j0(n,e=>{if(!lN(e))throw uc.create("not-registered");const t=e.authToken;return rX(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function eX(n,e){try{const t=await Zj(n,e),i=Object.assign(Object.assign({},e),{authToken:t});return await Hv(n.appConfig,i),t}catch(t){if(K3(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await oN(n.appConfig);else{const i=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Hv(n.appConfig,i)}throw t}}function lN(n){return n!==void 0&&n.registrationStatus===2}function tX(n){return n.requestStatus===2&&!nX(n)}function nX(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+Ij}function iX(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function rX(n){return n.requestStatus===1&&n.requestTime+q3<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sX(n){const e=n,{installationEntry:t,registrationPromise:i}=await oM(e);return i?i.catch(console.error):aM(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oX(n,e=!1){const t=n;return await aX(t),(await aM(t,e)).token}async function aX(n){const{registrationPromise:e}=await oM(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lX(n){if(!n||!n.options)throw yx("App Configuration");if(!n.name)throw yx("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw yx(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function yx(n){return uc.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cN="installations",cX="installations-internal",uX=n=>{const e=n.getProvider("app").getImmediate(),t=lX(e),i=Ja(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:i,_delete:()=>Promise.resolve()}},hX=n=>{const e=n.getProvider("app").getImmediate(),t=Ja(e,cN).getImmediate();return{getId:()=>sX(t),getToken:r=>oX(t,r)}};function fX(){Os(new ds(cN,uX,"PUBLIC")),Os(new ds(cX,hX,"PRIVATE"))}fX();Sr(X3,rM);Sr(X3,rM,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vv="analytics",dX="firebase_id",pX="origin",mX=60*1e3,gX="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",lM="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wr=new z0("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vX={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Gr=new _c("analytics","Analytics",vX);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yX(n){if(!n.startsWith(lM)){const e=Gr.create("invalid-gtag-resource",{gtagURL:n});return wr.warn(e.message),""}return n}function uN(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function _X(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function xX(n,e){const t=_X("firebase-js-sdk-policy",{createScriptURL:yX}),i=document.createElement("script"),r=`${lM}?l=${n}&id=${e}`;i.src=t?t==null?void 0:t.createScriptURL(r):r,i.async=!0,document.head.appendChild(i)}function SX(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function wX(n,e,t,i,r,s){const o=i[r];try{if(o)await e[o];else{const c=(await uN(t)).find(h=>h.measurementId===r);c&&await e[c.appId]}}catch(a){wr.error(a)}n("config",r,s)}async function MX(n,e,t,i,r){try{let s=[];if(r&&r.send_to){let o=r.send_to;Array.isArray(o)||(o=[o]);const a=await uN(t);for(const c of o){const h=a.find(d=>d.measurementId===c),f=h&&e[h.appId];if(f)s.push(f);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),n("event",i,r||{})}catch(s){wr.error(s)}}function EX(n,e,t,i){async function r(s,...o){try{if(s==="event"){const[a,c]=o;await MX(n,e,t,a,c)}else if(s==="config"){const[a,c]=o;await wX(n,e,t,i,a,c)}else if(s==="consent"){const[a,c]=o;n("consent",a,c)}else if(s==="get"){const[a,c,h]=o;n("get",a,c,h)}else if(s==="set"){const[a]=o;n("set",a)}else n(s,...o)}catch(a){wr.error(a)}}return r}function TX(n,e,t,i,r){let s=function(...o){window[i].push(arguments)};return window[r]&&typeof window[r]=="function"&&(s=window[r]),window[r]=EX(s,n,e,t),{gtagCore:s,wrappedGtag:window[r]}}function AX(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(lM)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bX=30,CX=1e3;class IX{constructor(e={},t=CX){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const hN=new IX;function RX(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function PX(n){var e;const{appId:t,apiKey:i}=n,r={method:"GET",headers:RX(i)},s=gX.replace("{app-id}",t),o=await fetch(s,r);if(o.status!==200&&o.status!==304){let a="";try{const c=await o.json();!((e=c.error)===null||e===void 0)&&e.message&&(a=c.error.message)}catch{}throw Gr.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function LX(n,e=hN,t){const{appId:i,apiKey:r,measurementId:s}=n.options;if(!i)throw Gr.create("no-app-id");if(!r){if(s)return{measurementId:s,appId:i};throw Gr.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new kX;return setTimeout(async()=>{a.abort()},mX),fN({appId:i,apiKey:r,measurementId:s},o,a,e)}async function fN(n,{throttleEndTimeMillis:e,backoffCount:t},i,r=hN){var s;const{appId:o,measurementId:a}=n;try{await NX(i,e)}catch(c){if(a)return wr.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:a};throw c}try{const c=await PX(n);return r.deleteThrottleMetadata(o),c}catch(c){const h=c;if(!DX(h)){if(r.deleteThrottleMetadata(o),a)return wr.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${h==null?void 0:h.message}]`),{appId:o,measurementId:a};throw c}const f=Number((s=h==null?void 0:h.customData)===null||s===void 0?void 0:s.httpStatus)===503?Wb(t,r.intervalMillis,bX):Wb(t,r.intervalMillis),d={throttleEndTimeMillis:Date.now()+f,backoffCount:t+1};return r.setThrottleMetadata(o,d),wr.debug(`Calling attemptFetch again in ${f} millis`),fN(n,d,i,r)}}function NX(n,e){return new Promise((t,i)=>{const r=Math.max(e-Date.now(),0),s=setTimeout(t,r);n.addEventListener(()=>{clearTimeout(s),i(Gr.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function DX(n){if(!(n instanceof ps)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class kX{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function OX(n,e,t,i,r){if(r&&r.global){n("event",t,i);return}else{const s=await e,o=Object.assign(Object.assign({},i),{send_to:s});n("event",t,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function UX(){if(e3())try{await t3()}catch(n){return wr.warn(Gr.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return wr.warn(Gr.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function FX(n,e,t,i,r,s,o){var a;const c=LX(n);c.then(v=>{t[v.measurementId]=v.appId,n.options.measurementId&&v.measurementId!==n.options.measurementId&&wr.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${v.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(v=>wr.error(v)),e.push(c);const h=UX().then(v=>{if(v)return i.getId()}),[f,d]=await Promise.all([c,h]);AX(s)||xX(s,f.measurementId),r("js",new Date);const m=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return m[pX]="firebase",m.update=!0,d!=null&&(m[dX]=d),r("config",f.measurementId,m),f.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zX{constructor(e){this.app=e}_delete(){return delete Hf[this.app.options.appId],Promise.resolve()}}let Hf={},LC=[];const NC={};let _x="dataLayer",BX="gtag",DC,dN,kC=!1;function HX(){const n=[];if(QL()&&n.push("This is a browser extension environment."),gG()||n.push("Cookies are not available."),n.length>0){const e=n.map((i,r)=>`(${r+1}) ${i}`).join(" "),t=Gr.create("invalid-analytics-context",{errorInfo:e});wr.warn(t.message)}}function VX(n,e,t){HX();const i=n.options.appId;if(!i)throw Gr.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)wr.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Gr.create("no-api-key");if(Hf[i]!=null)throw Gr.create("already-exists",{id:i});if(!kC){SX(_x);const{wrappedGtag:s,gtagCore:o}=TX(Hf,LC,NC,_x,BX);dN=s,DC=o,kC=!0}return Hf[i]=FX(n,LC,NC,e,DC,_x,t),new zX(n)}function GX(n=B0()){n=ho(n);const e=Ja(n,Vv);return e.isInitialized()?e.getImmediate():WX(n)}function WX(n,e={}){const t=Ja(n,Vv);if(t.isInitialized()){const r=t.getImmediate();if(bd(e,t.getOptions()))return r;throw Gr.create("already-initialized")}return t.initialize({options:e})}function jX(n,e,t,i){n=ho(n),OX(dN,Hf[n.app.options.appId],e,t,i).catch(r=>wr.error(r))}const OC="@firebase/analytics",UC="0.10.8";function XX(){Os(new ds(Vv,(e,{options:t})=>{const i=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();return VX(i,r,t)},"PUBLIC")),Os(new ds("analytics-internal",n,"PRIVATE")),Sr(OC,UC),Sr(OC,UC,"esm2017");function n(e){try{const t=e.getProvider(Vv).getImmediate();return{logEvent:(i,r,s)=>jX(t,i,r,s)}}catch(t){throw Gr.create("interop-component-reg-failed",{reason:t})}}}XX();const qX={apiKey:"AIzaSyDqbGzrgYMB59lbdQdvtrEzPrKOtRoR7JQ",authDomain:"lims-simulation.firebaseapp.com",projectId:"lims-simulation",storageBucket:"lims-simulation.firebasestorage.app",messagingSenderId:"278209641444",appId:"1:278209641444:web:706addd879296831fd65f1",measurementId:"G-S0YNCHE6ME"},X0=s3(qX),YX=Z7(X0),Ag=Q9(X0),$X=Ej(X0),KX=GX(X0),ZX=async()=>{console.log(" Testing Firebase connection...");try{console.log(" Testing Firestore...");const n=Z9(Ag,"test");return console.log(" Firestore connected successfully"),console.log(" Testing Authentication..."),console.log(" Auth service initialized:",!!YX),console.log(" Testing Storage..."),console.log(" Storage service initialized:",!!$X),console.log(" Testing Analytics..."),console.log(" Analytics service initialized:",!!KX),console.log(" All Firebase services are ready!"),!0}catch(n){return console.error(" Firebase connection test failed:",n),!1}},JX=()=>({projectId:Ag.app.options.projectId,authDomain:Ag.app.options.authDomain,storageBucket:Ag.app.options.storageBucket});function QX(){const[n,e]=be.useState(null),[t,i]=be.useState(null),[r,s]=be.useState(null);return be.useEffect(()=>{(async()=>{try{const a=await ZX();if(e(a),a){const c=JX();i(c),console.log(" Firebase project info:",c)}}catch(a){e(!1),s(a instanceof Error?a.message:"Unknown error"),console.error(" Firebase connection failed:",a)}})()},[]),{isConnected:n,projectInfo:t,connectionError:r}}function eq(){iG();const{addNotification:n}=zs(),{isConnected:e,projectInfo:t,connectionError:i}=QX();return be.useEffect(()=>{n({type:"info",title:"Welcome to 3D Lab Manager",message:"Use WASD or arrow keys to move around. Press E to interact with equipment."})},[n]),be.useEffect(()=>{e===!0?n({type:"success",title:" Firebase Connected",message:`Connected to project: ${t==null?void 0:t.projectId}`}):e===!1&&n({type:"error",title:" Firebase Connection Failed",message:i||"Unable to connect to Firebase"})},[e,t,i,n]),K.jsxs("div",{className:"w-screen h-screen bg-gray-900 relative overflow-hidden",children:[K.jsx("div",{className:"absolute top-4 right-4 z-50",children:K.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium ${e===!0?"bg-green-100 text-green-800":e===!1?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:e===!0?" Firebase Connected":e===!1?" Firebase Disconnected":" Connecting to Firebase..."})}),K.jsx(F8,{}),K.jsx(nG,{})]})}K2(document.getElementById("root")).render(K.jsx(be.StrictMode,{children:K.jsx(eq,{})}));
